var xy=d=>{throw TypeError(d)};var Gd=(d,t,e)=>t.has(d)||xy("Cannot "+e);var Rt=(d,t,e)=>(Gd(d,t,"read from private field"),e?e.call(d):t.get(d)),Be=(d,t,e)=>t.has(d)?xy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(d):t.set(d,e),de=(d,t,e,i)=>(Gd(d,t,"write to private field"),i?i.call(d,e):t.set(d,e),e),Ue=(d,t,e)=>(Gd(d,t,"access private method"),e);var Vd=(d,t,e,i)=>({set _(n){de(d,t,n,e)},get _(){return Rt(d,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function e0(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Xd={exports:{}},Eo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ry;function y1(){if(Ry)return Eo;Ry=1;var d=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,n,r){var a=null;if(r!==void 0&&(a=""+r),n.key!==void 0&&(a=""+n.key),"key"in n){r={};for(var l in n)l!=="key"&&(r[l]=n[l])}else r=n;return n=r.ref,{$$typeof:d,type:i,key:a,ref:n!==void 0?n:null,props:r}}return Eo.Fragment=t,Eo.jsx=e,Eo.jsxs=e,Eo}var _y;function b1(){return _y||(_y=1,Xd.exports=y1()),Xd.exports}var ct=b1(),Yd={exports:{}},Dt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function A1(){if(Dy)return Dt;Dy=1;var d=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function v(k){return k===null||typeof k!="object"?null:(k=m&&k[m]||k["@@iterator"],typeof k=="function"?k:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function E(k,j,K){this.props=k,this.context=j,this.refs=w,this.updater=K||S}E.prototype.isReactComponent={},E.prototype.setState=function(k,j){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,j,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function C(){}C.prototype=E.prototype;function T(k,j,K){this.props=k,this.context=j,this.refs=w,this.updater=K||S}var _=T.prototype=new C;_.constructor=T,b(_,E.prototype),_.isPureReactComponent=!0;var R=Array.isArray;function D(){}var M={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function P(k,j,K){var st=K.ref;return{$$typeof:d,type:k,key:j,ref:st!==void 0?st:null,props:K}}function B(k,j){return P(k.type,j,k.props)}function U(k){return typeof k=="object"&&k!==null&&k.$$typeof===d}function Z(k){var j={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(K){return j[K]})}var q=/\/+/g;function Q(k,j){return typeof k=="object"&&k!==null&&k.key!=null?Z(""+k.key):j.toString(36)}function nt(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(D,D):(k.status="pending",k.then(function(j){k.status==="pending"&&(k.status="fulfilled",k.value=j)},function(j){k.status==="pending"&&(k.status="rejected",k.reason=j)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function N(k,j,K,st,ht){var J=typeof k;(J==="undefined"||J==="boolean")&&(k=null);var V=!1;if(k===null)V=!0;else switch(J){case"bigint":case"string":case"number":V=!0;break;case"object":switch(k.$$typeof){case d:case t:V=!0;break;case f:return V=k._init,N(V(k._payload),j,K,st,ht)}}if(V)return ht=ht(k),V=st===""?"."+Q(k,0):st,R(ht)?(K="",V!=null&&(K=V.replace(q,"$&/")+"/"),N(ht,j,K,"",function(At){return At})):ht!=null&&(U(ht)&&(ht=B(ht,K+(ht.key==null||k&&k.key===ht.key?"":(""+ht.key).replace(q,"$&/")+"/")+V)),j.push(ht)),1;V=0;var rt=st===""?".":st+":";if(R(k))for(var lt=0;lt<k.length;lt++)st=k[lt],J=rt+Q(st,lt),V+=N(st,j,K,J,ht);else if(lt=v(k),typeof lt=="function")for(k=lt.call(k),lt=0;!(st=k.next()).done;)st=st.value,J=rt+Q(st,lt++),V+=N(st,j,K,J,ht);else if(J==="object"){if(typeof k.then=="function")return N(nt(k),j,K,st,ht);throw j=String(k),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return V}function I(k,j,K){if(k==null)return k;var st=[],ht=0;return N(k,st,"","",function(J){return j.call(K,J,ht++)}),st}function $(k){if(k._status===-1){var j=k._result;j=j(),j.then(function(K){(k._status===0||k._status===-1)&&(k._status=1,k._result=K)},function(K){(k._status===0||k._status===-1)&&(k._status=2,k._result=K)}),k._status===-1&&(k._status=0,k._result=j)}if(k._status===1)return k._result.default;throw k._result}var at=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},ut={map:I,forEach:function(k,j,K){I(k,function(){j.apply(this,arguments)},K)},count:function(k){var j=0;return I(k,function(){j++}),j},toArray:function(k){return I(k,function(j){return j})||[]},only:function(k){if(!U(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return Dt.Activity=p,Dt.Children=ut,Dt.Component=E,Dt.Fragment=e,Dt.Profiler=n,Dt.PureComponent=T,Dt.StrictMode=i,Dt.Suspense=c,Dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Dt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return M.H.useMemoCache(k)}},Dt.cache=function(k){return function(){return k.apply(null,arguments)}},Dt.cacheSignal=function(){return null},Dt.cloneElement=function(k,j,K){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var st=b({},k.props),ht=k.key;if(j!=null)for(J in j.key!==void 0&&(ht=""+j.key),j)!L.call(j,J)||J==="key"||J==="__self"||J==="__source"||J==="ref"&&j.ref===void 0||(st[J]=j[J]);var J=arguments.length-2;if(J===1)st.children=K;else if(1<J){for(var V=Array(J),rt=0;rt<J;rt++)V[rt]=arguments[rt+2];st.children=V}return P(k.type,ht,st)},Dt.createContext=function(k){return k={$$typeof:a,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:r,_context:k},k},Dt.createElement=function(k,j,K){var st,ht={},J=null;if(j!=null)for(st in j.key!==void 0&&(J=""+j.key),j)L.call(j,st)&&st!=="key"&&st!=="__self"&&st!=="__source"&&(ht[st]=j[st]);var V=arguments.length-2;if(V===1)ht.children=K;else if(1<V){for(var rt=Array(V),lt=0;lt<V;lt++)rt[lt]=arguments[lt+2];ht.children=rt}if(k&&k.defaultProps)for(st in V=k.defaultProps,V)ht[st]===void 0&&(ht[st]=V[st]);return P(k,J,ht)},Dt.createRef=function(){return{current:null}},Dt.forwardRef=function(k){return{$$typeof:l,render:k}},Dt.isValidElement=U,Dt.lazy=function(k){return{$$typeof:f,_payload:{_status:-1,_result:k},_init:$}},Dt.memo=function(k,j){return{$$typeof:u,type:k,compare:j===void 0?null:j}},Dt.startTransition=function(k){var j=M.T,K={};M.T=K;try{var st=k(),ht=M.S;ht!==null&&ht(K,st),typeof st=="object"&&st!==null&&typeof st.then=="function"&&st.then(D,at)}catch(J){at(J)}finally{j!==null&&K.types!==null&&(j.types=K.types),M.T=j}},Dt.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Dt.use=function(k){return M.H.use(k)},Dt.useActionState=function(k,j,K){return M.H.useActionState(k,j,K)},Dt.useCallback=function(k,j){return M.H.useCallback(k,j)},Dt.useContext=function(k){return M.H.useContext(k)},Dt.useDebugValue=function(){},Dt.useDeferredValue=function(k,j){return M.H.useDeferredValue(k,j)},Dt.useEffect=function(k,j){return M.H.useEffect(k,j)},Dt.useEffectEvent=function(k){return M.H.useEffectEvent(k)},Dt.useId=function(){return M.H.useId()},Dt.useImperativeHandle=function(k,j,K){return M.H.useImperativeHandle(k,j,K)},Dt.useInsertionEffect=function(k,j){return M.H.useInsertionEffect(k,j)},Dt.useLayoutEffect=function(k,j){return M.H.useLayoutEffect(k,j)},Dt.useMemo=function(k,j){return M.H.useMemo(k,j)},Dt.useOptimistic=function(k,j){return M.H.useOptimistic(k,j)},Dt.useReducer=function(k,j,K){return M.H.useReducer(k,j,K)},Dt.useRef=function(k){return M.H.useRef(k)},Dt.useState=function(k){return M.H.useState(k)},Dt.useSyncExternalStore=function(k,j,K){return M.H.useSyncExternalStore(k,j,K)},Dt.useTransition=function(){return M.H.useTransition()},Dt.version="19.2.0",Dt}var My;function qf(){return My||(My=1,Yd.exports=A1()),Yd.exports}var ot=qf(),Wd={exports:{}},wo={},Kd={exports:{}},qd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oy;function S1(){return Oy||(Oy=1,(function(d){function t(N,I){var $=N.length;N.push(I);t:for(;0<$;){var at=$-1>>>1,ut=N[at];if(0<n(ut,I))N[at]=I,N[$]=ut,$=at;else break t}}function e(N){return N.length===0?null:N[0]}function i(N){if(N.length===0)return null;var I=N[0],$=N.pop();if($!==I){N[0]=$;t:for(var at=0,ut=N.length,k=ut>>>1;at<k;){var j=2*(at+1)-1,K=N[j],st=j+1,ht=N[st];if(0>n(K,$))st<ut&&0>n(ht,K)?(N[at]=ht,N[st]=$,at=st):(N[at]=K,N[j]=$,at=j);else if(st<ut&&0>n(ht,$))N[at]=ht,N[st]=$,at=st;else break t}}return I}function n(N,I){var $=N.sortIndex-I.sortIndex;return $!==0?$:N.id-I.id}if(d.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;d.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();d.unstable_now=function(){return a.now()-l}}var c=[],u=[],f=1,p=null,m=3,v=!1,S=!1,b=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function _(N){for(var I=e(u);I!==null;){if(I.callback===null)i(u);else if(I.startTime<=N)i(u),I.sortIndex=I.expirationTime,t(c,I);else break;I=e(u)}}function R(N){if(b=!1,_(N),!S)if(e(c)!==null)S=!0,D||(D=!0,Z());else{var I=e(u);I!==null&&nt(R,I.startTime-N)}}var D=!1,M=-1,L=5,P=-1;function B(){return w?!0:!(d.unstable_now()-P<L)}function U(){if(w=!1,D){var N=d.unstable_now();P=N;var I=!0;try{t:{S=!1,b&&(b=!1,C(M),M=-1),v=!0;var $=m;try{e:{for(_(N),p=e(c);p!==null&&!(p.expirationTime>N&&B());){var at=p.callback;if(typeof at=="function"){p.callback=null,m=p.priorityLevel;var ut=at(p.expirationTime<=N);if(N=d.unstable_now(),typeof ut=="function"){p.callback=ut,_(N),I=!0;break e}p===e(c)&&i(c),_(N)}else i(c);p=e(c)}if(p!==null)I=!0;else{var k=e(u);k!==null&&nt(R,k.startTime-N),I=!1}}break t}finally{p=null,m=$,v=!1}I=void 0}}finally{I?Z():D=!1}}}var Z;if(typeof T=="function")Z=function(){T(U)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Q=q.port2;q.port1.onmessage=U,Z=function(){Q.postMessage(null)}}else Z=function(){E(U,0)};function nt(N,I){M=E(function(){N(d.unstable_now())},I)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(N){N.callback=null},d.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<N?Math.floor(1e3/N):5},d.unstable_getCurrentPriorityLevel=function(){return m},d.unstable_next=function(N){switch(m){case 1:case 2:case 3:var I=3;break;default:I=m}var $=m;m=I;try{return N()}finally{m=$}},d.unstable_requestPaint=function(){w=!0},d.unstable_runWithPriority=function(N,I){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var $=m;m=N;try{return I()}finally{m=$}},d.unstable_scheduleCallback=function(N,I,$){var at=d.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?at+$:at):$=at,N){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=$+ut,N={id:f++,callback:I,priorityLevel:N,startTime:$,expirationTime:ut,sortIndex:-1},$>at?(N.sortIndex=$,t(u,N),e(c)===null&&N===e(u)&&(b?(C(M),M=-1):b=!0,nt(R,$-at))):(N.sortIndex=ut,t(c,N),S||v||(S=!0,D||(D=!0,Z()))),N},d.unstable_shouldYield=B,d.unstable_wrapCallback=function(N){var I=m;return function(){var $=m;m=I;try{return N.apply(this,arguments)}finally{m=$}}}})(qd)),qd}var Ly;function E1(){return Ly||(Ly=1,Kd.exports=S1()),Kd.exports}var Qd={exports:{}},si={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function w1(){if(Py)return si;Py=1;var d=qf();function t(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},n=Symbol.for("react.portal");function r(c,u,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:p==null?null:""+p,children:c,containerInfo:u,implementation:f}}var a=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return si.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,si.createPortal=function(c,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return r(c,u,null,f)},si.flushSync=function(c){var u=a.T,f=i.p;try{if(a.T=null,i.p=2,c)return c()}finally{a.T=u,i.p=f,i.d.f()}},si.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(c,u))},si.prefetchDNS=function(c){typeof c=="string"&&i.d.D(c)},si.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?i.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):f==="script"&&i.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},si.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=l(u.as,u.crossOrigin);i.d.M(c,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(c)},si.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin);i.d.L(c,f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},si.preloadModule=function(c,u){if(typeof c=="string")if(u){var f=l(u.as,u.crossOrigin);i.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(c)},si.requestFormReset=function(c){i.d.r(c)},si.unstable_batchedUpdates=function(c,u){return c(u)},si.useFormState=function(c,u,f){return a.H.useFormState(c,u,f)},si.useFormStatus=function(){return a.H.useHostTransitionStatus()},si.version="19.2.0",si}var Ny;function T1(){if(Ny)return Qd.exports;Ny=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(t){console.error(t)}}return d(),Qd.exports=w1(),Qd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function C1(){if(Iy)return wo;Iy=1;var d=E1(),t=qf(),e=T1();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function r(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function a(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function l(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(r(s)!==s)throw Error(i(188))}function u(s){var o=s.alternate;if(!o){if(o=r(s),o===null)throw Error(i(188));return o!==s?null:s}for(var h=s,g=o;;){var y=h.return;if(y===null)break;var A=y.alternate;if(A===null){if(g=y.return,g!==null){h=g;continue}break}if(y.child===A.child){for(A=y.child;A;){if(A===h)return c(y),s;if(A===g)return c(y),o;A=A.sibling}throw Error(i(188))}if(h.return!==g.return)h=y,g=A;else{for(var x=!1,O=y.child;O;){if(O===h){x=!0,h=y,g=A;break}if(O===g){x=!0,g=y,h=A;break}O=O.sibling}if(!x){for(O=A.child;O;){if(O===h){x=!0,h=A,g=y;break}if(O===g){x=!0,g=A,h=y;break}O=O.sibling}if(!x)throw Error(i(189))}}if(h.alternate!==g)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function Z(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var q=Symbol.for("react.client.reference");function Q(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===q?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case D:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case S:return"Portal";case T:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case _:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case M:return o=s.displayName||null,o!==null?o:Q(s.type)||"Memo";case L:o=s._payload,s=s._init;try{return Q(s(o))}catch{}}return null}var nt=Array.isArray,N=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},at=[],ut=-1;function k(s){return{current:s}}function j(s){0>ut||(s.current=at[ut],at[ut]=null,ut--)}function K(s,o){ut++,at[ut]=s.current,s.current=o}var st=k(null),ht=k(null),J=k(null),V=k(null);function rt(s,o){switch(K(J,o),K(ht,s),K(st,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Kv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Kv(o),s=qv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}j(st),K(st,s)}function lt(){j(st),j(ht),j(J)}function At(s){s.memoizedState!==null&&K(V,s);var o=st.current,h=qv(o,s.type);o!==h&&(K(ht,s),K(st,h))}function dt(s){ht.current===s&&(j(st),j(ht)),V.current===s&&(j(V),yo._currentValue=$)}var Bt,bt;function _t(s){if(Bt===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Bt=o&&o[1]||"",bt=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Bt+s+bt}var Ht=!1;function It(s,o){if(!s||Ht)return"";Ht=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(W){var Y=W}Reflect.construct(s,[],it)}else{try{it.call()}catch(W){Y=W}s.call(it.prototype)}}else{try{throw Error()}catch(W){Y=W}(it=s())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(W){if(W&&Y&&typeof W.stack=="string")return[W.stack,Y.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=g.DetermineComponentFrameRoot(),x=A[0],O=A[1];if(x&&O){var F=x.split(`
`),X=O.split(`
`);for(y=g=0;g<F.length&&!F[g].includes("DetermineComponentFrameRoot");)g++;for(;y<X.length&&!X[y].includes("DetermineComponentFrameRoot");)y++;if(g===F.length||y===X.length)for(g=F.length-1,y=X.length-1;1<=g&&0<=y&&F[g]!==X[y];)y--;for(;1<=g&&0<=y;g--,y--)if(F[g]!==X[y]){if(g!==1||y!==1)do if(g--,y--,0>y||F[g]!==X[y]){var tt=`
`+F[g].replace(" at new "," at ");return s.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",s.displayName)),tt}while(1<=g&&0<=y);break}}}finally{Ht=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?_t(h):""}function li(s,o){switch(s.tag){case 26:case 27:case 5:return _t(s.type);case 16:return _t("Lazy");case 13:return s.child!==o&&o!==null?_t("Suspense Fallback"):_t("Suspense");case 19:return _t("SuspenseList");case 0:case 15:return It(s.type,!1);case 11:return It(s.type.render,!1);case 1:return It(s.type,!0);case 31:return _t("Activity");default:return""}}function ji(s){try{var o="",h=null;do o+=li(s,h),h=s,s=s.return;while(s);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var $i=Object.prototype.hasOwnProperty,_a=d.unstable_scheduleCallback,ts=d.unstable_cancelCallback,Dh=d.unstable_shouldYield,Mh=d.unstable_requestPaint,ci=d.unstable_now,Oh=d.unstable_getCurrentPriorityLevel,dl=d.unstable_ImmediatePriority,ln=d.unstable_UserBlockingPriority,cn=d.unstable_NormalPriority,gn=d.unstable_LowPriority,Ar=d.unstable_IdlePriority,tS=d.log,eS=d.unstable_setDisableYieldValue,Da=null,_i=null;function es(s){if(typeof tS=="function"&&eS(s),_i&&typeof _i.setStrictMode=="function")try{_i.setStrictMode(Da,s)}catch{}}var Di=Math.clz32?Math.clz32:sS,iS=Math.log,nS=Math.LN2;function sS(s){return s>>>=0,s===0?32:31-(iS(s)/nS|0)|0}var fl=256,pl=262144,gl=4194304;function ks(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ml(s,o,h){var g=s.pendingLanes;if(g===0)return 0;var y=0,A=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var O=g&134217727;return O!==0?(g=O&~A,g!==0?y=ks(g):(x&=O,x!==0?y=ks(x):h||(h=O&~s,h!==0&&(y=ks(h))))):(O=g&~A,O!==0?y=ks(O):x!==0?y=ks(x):h||(h=g&~s,h!==0&&(y=ks(h)))),y===0?0:o!==0&&o!==y&&(o&A)===0&&(A=y&-y,h=o&-o,A>=h||A===32&&(h&4194048)!==0)?o:y}function Ma(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function rS(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mp(){var s=gl;return gl<<=1,(gl&62914560)===0&&(gl=4194304),s}function Lh(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function Oa(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function aS(s,o,h,g,y,A){var x=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var O=s.entanglements,F=s.expirationTimes,X=s.hiddenUpdates;for(h=x&~h;0<h;){var tt=31-Di(h),it=1<<tt;O[tt]=0,F[tt]=-1;var Y=X[tt];if(Y!==null)for(X[tt]=null,tt=0;tt<Y.length;tt++){var W=Y[tt];W!==null&&(W.lane&=-536870913)}h&=~it}g!==0&&Op(s,g,0),A!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=A&~(x&~o))}function Op(s,o,h){s.pendingLanes|=o,s.suspendedLanes&=~o;var g=31-Di(o);s.entangledLanes|=o,s.entanglements[g]=s.entanglements[g]|1073741824|h&261930}function Lp(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var g=31-Di(h),y=1<<g;y&o|s[g]&o&&(s[g]|=o),h&=~y}}function Pp(s,o){var h=o&-o;return h=(h&42)!==0?1:Ph(h),(h&(s.suspendedLanes|o))!==0?0:h}function Ph(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Nh(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Np(){var s=I.p;return s!==0?s:(s=window.event,s===void 0?32:by(s.type))}function Ip(s,o){var h=I.p;try{return I.p=s,o()}finally{I.p=h}}var is=Math.random().toString(36).slice(2),Xe="__reactFiber$"+is,vi="__reactProps$"+is,Sr="__reactContainer$"+is,Ih="__reactEvents$"+is,oS="__reactListeners$"+is,lS="__reactHandles$"+is,kp="__reactResources$"+is,La="__reactMarker$"+is;function kh(s){delete s[Xe],delete s[vi],delete s[Ih],delete s[oS],delete s[lS]}function Er(s){var o=s[Xe];if(o)return o;for(var h=s.parentNode;h;){if(o=h[Sr]||h[Xe]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(s=ny(s);s!==null;){if(h=s[Xe])return h;s=ny(s)}return o}s=h,h=s.parentNode}return null}function wr(s){if(s=s[Xe]||s[Sr]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Pa(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function Tr(s){var o=s[kp];return o||(o=s[kp]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function je(s){s[La]=!0}var Fp=new Set,Bp={};function Fs(s,o){Cr(s,o),Cr(s+"Capture",o)}function Cr(s,o){for(Bp[s]=o,s=0;s<o.length;s++)Fp.add(o[s])}var cS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Up={},Hp={};function hS(s){return $i.call(Hp,s)?!0:$i.call(Up,s)?!1:cS.test(s)?Hp[s]=!0:(Up[s]=!0,!1)}function vl(s,o,h){if(hS(o))if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+h)}}function yl(s,o,h){if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+h)}}function Dn(s,o,h,g){if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(o,h,""+g)}}function Gi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function zp(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function uS(s,o,h){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var y=g.get,A=g.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(x){h=""+x,A.call(this,x)}}),Object.defineProperty(s,o,{enumerable:g.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Fh(s){if(!s._valueTracker){var o=zp(s)?"checked":"value";s._valueTracker=uS(s,o,""+s[o])}}function jp(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var h=o.getValue(),g="";return s&&(g=zp(s)?s.checked?"true":"false":s.value),s=g,s!==h?(o.setValue(s),!0):!1}function bl(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var dS=/[\n"\\]/g;function Vi(s){return s.replace(dS,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Bh(s,o,h,g,y,A,x,O){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),o!=null?x==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Gi(o)):s.value!==""+Gi(o)&&(s.value=""+Gi(o)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),o!=null?Uh(s,x,Gi(o)):h!=null?Uh(s,x,Gi(h)):g!=null&&s.removeAttribute("value"),y==null&&A!=null&&(s.defaultChecked=!!A),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?s.name=""+Gi(O):s.removeAttribute("name")}function $p(s,o,h,g,y,A,x,O){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),o!=null||h!=null){if(!(A!=="submit"&&A!=="reset"||o!=null)){Fh(s);return}h=h!=null?""+Gi(h):"",o=o!=null?""+Gi(o):h,O||o===s.value||(s.value=o),s.defaultValue=o}g=g??y,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=O?s.checked:!!g,s.defaultChecked=!!g,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),Fh(s)}function Uh(s,o,h){o==="number"&&bl(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function xr(s,o,h,g){if(s=s.options,o){o={};for(var y=0;y<h.length;y++)o["$"+h[y]]=!0;for(h=0;h<s.length;h++)y=o.hasOwnProperty("$"+s[h].value),s[h].selected!==y&&(s[h].selected=y),y&&g&&(s[h].defaultSelected=!0)}else{for(h=""+Gi(h),o=null,y=0;y<s.length;y++){if(s[y].value===h){s[y].selected=!0,g&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function Gp(s,o,h){if(o!=null&&(o=""+Gi(o),o!==s.value&&(s.value=o),h==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=h!=null?""+Gi(h):""}function Vp(s,o,h,g){if(o==null){if(g!=null){if(h!=null)throw Error(i(92));if(nt(g)){if(1<g.length)throw Error(i(93));g=g[0]}h=g}h==null&&(h=""),o=h}h=Gi(o),s.defaultValue=h,g=s.textContent,g===h&&g!==""&&g!==null&&(s.value=g),Fh(s)}function Rr(s,o){if(o){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=o;return}}s.textContent=o}var fS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xp(s,o,h){var g=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":g?s.setProperty(o,h):typeof h!="number"||h===0||fS.has(o)?o==="float"?s.cssFloat=h:s[o]=(""+h).trim():s[o]=h+"px"}function Yp(s,o,h){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var y in o)g=o[y],o.hasOwnProperty(y)&&h[y]!==g&&Xp(s,y,g)}else for(var A in o)o.hasOwnProperty(A)&&Xp(s,A,o[A])}function Hh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Al(s){return gS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Mn(){}var zh=null;function jh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var _r=null,Dr=null;function Wp(s){var o=wr(s);if(o&&(s=o.stateNode)){var h=s[vi]||null;t:switch(s=o.stateNode,o.type){case"input":if(Bh(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Vi(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var g=h[o];if(g!==s&&g.form===s.form){var y=g[vi]||null;if(!y)throw Error(i(90));Bh(g,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<h.length;o++)g=h[o],g.form===s.form&&jp(g)}break t;case"textarea":Gp(s,h.value,h.defaultValue);break t;case"select":o=h.value,o!=null&&xr(s,!!h.multiple,o,!1)}}}var $h=!1;function Kp(s,o,h){if($h)return s(o,h);$h=!0;try{var g=s(o);return g}finally{if($h=!1,(_r!==null||Dr!==null)&&(oc(),_r&&(o=_r,s=Dr,Dr=_r=null,Wp(o),s)))for(o=0;o<s.length;o++)Wp(s[o])}}function Na(s,o){var h=s.stateNode;if(h===null)return null;var g=h[vi]||null;if(g===null)return null;h=g[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break t;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(i(231,o,typeof h));return h}var On=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gh=!1;if(On)try{var Ia={};Object.defineProperty(Ia,"passive",{get:function(){Gh=!0}}),window.addEventListener("test",Ia,Ia),window.removeEventListener("test",Ia,Ia)}catch{Gh=!1}var ns=null,Vh=null,Sl=null;function qp(){if(Sl)return Sl;var s,o=Vh,h=o.length,g,y="value"in ns?ns.value:ns.textContent,A=y.length;for(s=0;s<h&&o[s]===y[s];s++);var x=h-s;for(g=1;g<=x&&o[h-g]===y[A-g];g++);return Sl=y.slice(s,1<g?1-g:void 0)}function El(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function wl(){return!0}function Qp(){return!1}function yi(s){function o(h,g,y,A,x){this._reactName=h,this._targetInst=y,this.type=g,this.nativeEvent=A,this.target=x,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(h=s[O],this[O]=h?h(A):A[O]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?wl:Qp,this.isPropagationStopped=Qp,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=wl)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=wl)},persist:function(){},isPersistent:wl}),o}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tl=yi(Bs),ka=p({},Bs,{view:0,detail:0}),mS=yi(ka),Xh,Yh,Fa,Cl=p({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Fa&&(Fa&&s.type==="mousemove"?(Xh=s.screenX-Fa.screenX,Yh=s.screenY-Fa.screenY):Yh=Xh=0,Fa=s),Xh)},movementY:function(s){return"movementY"in s?s.movementY:Yh}}),Zp=yi(Cl),vS=p({},Cl,{dataTransfer:0}),yS=yi(vS),bS=p({},ka,{relatedTarget:0}),Wh=yi(bS),AS=p({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),SS=yi(AS),ES=p({},Bs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),wS=yi(ES),TS=p({},Bs,{data:0}),Jp=yi(TS),CS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _S(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=RS[s])?!!o[s]:!1}function Kh(){return _S}var DS=p({},ka,{key:function(s){if(s.key){var o=CS[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=El(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kh,charCode:function(s){return s.type==="keypress"?El(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?El(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),MS=yi(DS),OS=p({},Cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tg=yi(OS),LS=p({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kh}),PS=yi(LS),NS=p({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),IS=yi(NS),kS=p({},Cl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),FS=yi(kS),BS=p({},Bs,{newState:0,oldState:0}),US=yi(BS),HS=[9,13,27,32],qh=On&&"CompositionEvent"in window,Ba=null;On&&"documentMode"in document&&(Ba=document.documentMode);var zS=On&&"TextEvent"in window&&!Ba,eg=On&&(!qh||Ba&&8<Ba&&11>=Ba),ig=" ",ng=!1;function sg(s,o){switch(s){case"keyup":return HS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Mr=!1;function jS(s,o){switch(s){case"compositionend":return rg(o);case"keypress":return o.which!==32?null:(ng=!0,ig);case"textInput":return s=o.data,s===ig&&ng?null:s;default:return null}}function $S(s,o){if(Mr)return s==="compositionend"||!qh&&sg(s,o)?(s=qp(),Sl=Vh=ns=null,Mr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return eg&&o.locale!=="ko"?null:o.data;default:return null}}var GS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ag(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!GS[s.type]:o==="textarea"}function og(s,o,h,g){_r?Dr?Dr.push(g):Dr=[g]:_r=g,o=pc(o,"onChange"),0<o.length&&(h=new Tl("onChange","change",null,h,g),s.push({event:h,listeners:o}))}var Ua=null,Ha=null;function VS(s){$v(s,0)}function xl(s){var o=Pa(s);if(jp(o))return s}function lg(s,o){if(s==="change")return o}var cg=!1;if(On){var Qh;if(On){var Zh="oninput"in document;if(!Zh){var hg=document.createElement("div");hg.setAttribute("oninput","return;"),Zh=typeof hg.oninput=="function"}Qh=Zh}else Qh=!1;cg=Qh&&(!document.documentMode||9<document.documentMode)}function ug(){Ua&&(Ua.detachEvent("onpropertychange",dg),Ha=Ua=null)}function dg(s){if(s.propertyName==="value"&&xl(Ha)){var o=[];og(o,Ha,s,jh(s)),Kp(VS,o)}}function XS(s,o,h){s==="focusin"?(ug(),Ua=o,Ha=h,Ua.attachEvent("onpropertychange",dg)):s==="focusout"&&ug()}function YS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return xl(Ha)}function WS(s,o){if(s==="click")return xl(o)}function KS(s,o){if(s==="input"||s==="change")return xl(o)}function qS(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Mi=typeof Object.is=="function"?Object.is:qS;function za(s,o){if(Mi(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),g=Object.keys(o);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var y=h[g];if(!$i.call(o,y)||!Mi(s[y],o[y]))return!1}return!0}function fg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function pg(s,o){var h=fg(s);s=0;for(var g;h;){if(h.nodeType===3){if(g=s+h.textContent.length,s<=o&&g>=o)return{node:h,offset:o-s};s=g}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=fg(h)}}function gg(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?gg(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function mg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=bl(s.document);o instanceof s.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)s=o.contentWindow;else break;o=bl(s.document)}return o}function Jh(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var QS=On&&"documentMode"in document&&11>=document.documentMode,Or=null,tu=null,ja=null,eu=!1;function vg(s,o,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;eu||Or==null||Or!==bl(g)||(g=Or,"selectionStart"in g&&Jh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),ja&&za(ja,g)||(ja=g,g=pc(tu,"onSelect"),0<g.length&&(o=new Tl("onSelect","select",null,o,h),s.push({event:o,listeners:g}),o.target=Or)))}function Us(s,o){var h={};return h[s.toLowerCase()]=o.toLowerCase(),h["Webkit"+s]="webkit"+o,h["Moz"+s]="moz"+o,h}var Lr={animationend:Us("Animation","AnimationEnd"),animationiteration:Us("Animation","AnimationIteration"),animationstart:Us("Animation","AnimationStart"),transitionrun:Us("Transition","TransitionRun"),transitionstart:Us("Transition","TransitionStart"),transitioncancel:Us("Transition","TransitionCancel"),transitionend:Us("Transition","TransitionEnd")},iu={},yg={};On&&(yg=document.createElement("div").style,"AnimationEvent"in window||(delete Lr.animationend.animation,delete Lr.animationiteration.animation,delete Lr.animationstart.animation),"TransitionEvent"in window||delete Lr.transitionend.transition);function Hs(s){if(iu[s])return iu[s];if(!Lr[s])return s;var o=Lr[s],h;for(h in o)if(o.hasOwnProperty(h)&&h in yg)return iu[s]=o[h];return s}var bg=Hs("animationend"),Ag=Hs("animationiteration"),Sg=Hs("animationstart"),ZS=Hs("transitionrun"),JS=Hs("transitionstart"),tE=Hs("transitioncancel"),Eg=Hs("transitionend"),wg=new Map,nu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nu.push("scrollEnd");function hn(s,o){wg.set(s,o),Fs(o,[s])}var Rl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Xi=[],Pr=0,su=0;function _l(){for(var s=Pr,o=su=Pr=0;o<s;){var h=Xi[o];Xi[o++]=null;var g=Xi[o];Xi[o++]=null;var y=Xi[o];Xi[o++]=null;var A=Xi[o];if(Xi[o++]=null,g!==null&&y!==null){var x=g.pending;x===null?y.next=y:(y.next=x.next,x.next=y),g.pending=y}A!==0&&Tg(h,y,A)}}function Dl(s,o,h,g){Xi[Pr++]=s,Xi[Pr++]=o,Xi[Pr++]=h,Xi[Pr++]=g,su|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function ru(s,o,h,g){return Dl(s,o,h,g),Ml(s)}function zs(s,o){return Dl(s,null,null,o),Ml(s)}function Tg(s,o,h){s.lanes|=h;var g=s.alternate;g!==null&&(g.lanes|=h);for(var y=!1,A=s.return;A!==null;)A.childLanes|=h,g=A.alternate,g!==null&&(g.childLanes|=h),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(y=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,y&&o!==null&&(y=31-Di(h),s=A.hiddenUpdates,g=s[y],g===null?s[y]=[o]:g.push(o),o.lane=h|536870912),A):null}function Ml(s){if(50<ho)throw ho=0,pd=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Nr={};function eE(s,o,h,g){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(s,o,h,g){return new eE(s,o,h,g)}function au(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ln(s,o){var h=s.alternate;return h===null?(h=Oi(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function Cg(s,o){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,o=h.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Ol(s,o,h,g,y,A){var x=0;if(g=s,typeof s=="function")au(s)&&(x=1);else if(typeof s=="string")x=a1(s,h,st.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case P:return s=Oi(31,h,o,y),s.elementType=P,s.lanes=A,s;case b:return js(h.children,y,A,o);case w:x=8,y|=24;break;case E:return s=Oi(12,h,o,y|2),s.elementType=E,s.lanes=A,s;case R:return s=Oi(13,h,o,y),s.elementType=R,s.lanes=A,s;case D:return s=Oi(19,h,o,y),s.elementType=D,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:x=10;break t;case C:x=9;break t;case _:x=11;break t;case M:x=14;break t;case L:x=16,g=null;break t}x=29,h=Error(i(130,s===null?"null":typeof s,"")),g=null}return o=Oi(x,h,o,y),o.elementType=s,o.type=g,o.lanes=A,o}function js(s,o,h,g){return s=Oi(7,s,g,o),s.lanes=h,s}function ou(s,o,h){return s=Oi(6,s,null,o),s.lanes=h,s}function xg(s){var o=Oi(18,null,null,0);return o.stateNode=s,o}function lu(s,o,h){return o=Oi(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Rg=new WeakMap;function Yi(s,o){if(typeof s=="object"&&s!==null){var h=Rg.get(s);return h!==void 0?h:(o={value:s,source:o,stack:ji(o)},Rg.set(s,o),o)}return{value:s,source:o,stack:ji(o)}}var Ir=[],kr=0,Ll=null,$a=0,Wi=[],Ki=0,ss=null,mn=1,vn="";function Pn(s,o){Ir[kr++]=$a,Ir[kr++]=Ll,Ll=s,$a=o}function _g(s,o,h){Wi[Ki++]=mn,Wi[Ki++]=vn,Wi[Ki++]=ss,ss=s;var g=mn;s=vn;var y=32-Di(g)-1;g&=~(1<<y),h+=1;var A=32-Di(o)+y;if(30<A){var x=y-y%5;A=(g&(1<<x)-1).toString(32),g>>=x,y-=x,mn=1<<32-Di(o)+y|h<<y|g,vn=A+s}else mn=1<<A|h<<y|g,vn=s}function cu(s){s.return!==null&&(Pn(s,1),_g(s,1,0))}function hu(s){for(;s===Ll;)Ll=Ir[--kr],Ir[kr]=null,$a=Ir[--kr],Ir[kr]=null;for(;s===ss;)ss=Wi[--Ki],Wi[Ki]=null,vn=Wi[--Ki],Wi[Ki]=null,mn=Wi[--Ki],Wi[Ki]=null}function Dg(s,o){Wi[Ki++]=mn,Wi[Ki++]=vn,Wi[Ki++]=ss,mn=o.id,vn=o.overflow,ss=s}var Ye=null,fe=null,Xt=!1,rs=null,qi=!1,uu=Error(i(519));function as(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ga(Yi(o,s)),uu}function Mg(s){var o=s.stateNode,h=s.type,g=s.memoizedProps;switch(o[Xe]=s,o[vi]=g,h){case"dialog":jt("cancel",o),jt("close",o);break;case"iframe":case"object":case"embed":jt("load",o);break;case"video":case"audio":for(h=0;h<fo.length;h++)jt(fo[h],o);break;case"source":jt("error",o);break;case"img":case"image":case"link":jt("error",o),jt("load",o);break;case"details":jt("toggle",o);break;case"input":jt("invalid",o),$p(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":jt("invalid",o);break;case"textarea":jt("invalid",o),Vp(o,g.value,g.defaultValue,g.children)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||g.suppressHydrationWarning===!0||Yv(o.textContent,h)?(g.popover!=null&&(jt("beforetoggle",o),jt("toggle",o)),g.onScroll!=null&&jt("scroll",o),g.onScrollEnd!=null&&jt("scrollend",o),g.onClick!=null&&(o.onclick=Mn),o=!0):o=!1,o||as(s,!0)}function Og(s){for(Ye=s.return;Ye;)switch(Ye.tag){case 5:case 31:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:Ye=Ye.return}}function Fr(s){if(s!==Ye)return!1;if(!Xt)return Og(s),Xt=!0,!1;var o=s.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||Dd(s.type,s.memoizedProps)),h=!h),h&&fe&&as(s),Og(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));fe=iy(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));fe=iy(s)}else o===27?(o=fe,As(s.type)?(s=Nd,Nd=null,fe=s):fe=o):fe=Ye?Zi(s.stateNode.nextSibling):null;return!0}function $s(){fe=Ye=null,Xt=!1}function du(){var s=rs;return s!==null&&(Ei===null?Ei=s:Ei.push.apply(Ei,s),rs=null),s}function Ga(s){rs===null?rs=[s]:rs.push(s)}var fu=k(null),Gs=null,Nn=null;function os(s,o,h){K(fu,o._currentValue),o._currentValue=h}function In(s){s._currentValue=fu.current,j(fu)}function pu(s,o,h){for(;s!==null;){var g=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),s===h)break;s=s.return}}function gu(s,o,h,g){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var A=y.dependencies;if(A!==null){var x=y.child;A=A.firstContext;t:for(;A!==null;){var O=A;A=y;for(var F=0;F<o.length;F++)if(O.context===o[F]){A.lanes|=h,O=A.alternate,O!==null&&(O.lanes|=h),pu(A.return,h,s),g||(x=null);break t}A=O.next}}else if(y.tag===18){if(x=y.return,x===null)throw Error(i(341));x.lanes|=h,A=x.alternate,A!==null&&(A.lanes|=h),pu(x,h,s),x=null}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===s){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}}function Br(s,o,h,g){s=null;for(var y=o,A=!1;y!==null;){if(!A){if((y.flags&524288)!==0)A=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var x=y.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var O=y.type;Mi(y.pendingProps.value,x.value)||(s!==null?s.push(O):s=[O])}}else if(y===V.current){if(x=y.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(yo):s=[yo])}y=y.return}s!==null&&gu(o,s,h,g),o.flags|=262144}function Pl(s){for(s=s.firstContext;s!==null;){if(!Mi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Vs(s){Gs=s,Nn=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function We(s){return Lg(Gs,s)}function Nl(s,o){return Gs===null&&Vs(s),Lg(s,o)}function Lg(s,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},Nn===null){if(s===null)throw Error(i(308));Nn=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Nn=Nn.next=o;return h}var iE=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(h,g){s.push(g)}};this.abort=function(){o.aborted=!0,s.forEach(function(h){return h()})}},nE=d.unstable_scheduleCallback,sE=d.unstable_NormalPriority,Me={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mu(){return{controller:new iE,data:new Map,refCount:0}}function Va(s){s.refCount--,s.refCount===0&&nE(sE,function(){s.controller.abort()})}var Xa=null,vu=0,Ur=0,Hr=null;function rE(s,o){if(Xa===null){var h=Xa=[];vu=0,Ur=Ad(),Hr={status:"pending",value:void 0,then:function(g){h.push(g)}}}return vu++,o.then(Pg,Pg),o}function Pg(){if(--vu===0&&Xa!==null){Hr!==null&&(Hr.status="fulfilled");var s=Xa;Xa=null,Ur=0,Hr=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function aE(s,o){var h=[],g={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return s.then(function(){g.status="fulfilled",g.value=o;for(var y=0;y<h.length;y++)(0,h[y])(o)},function(y){for(g.status="rejected",g.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),g}var Ng=N.S;N.S=function(s,o){vv=ci(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&rE(s,o),Ng!==null&&Ng(s,o)};var Xs=k(null);function yu(){var s=Xs.current;return s!==null?s:ae.pooledCache}function Il(s,o){o===null?K(Xs,Xs.current):K(Xs,o.pool)}function Ig(){var s=yu();return s===null?null:{parent:Me._currentValue,pool:s}}var zr=Error(i(460)),bu=Error(i(474)),kl=Error(i(542)),Fl={then:function(){}};function kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Fg(s,o,h){switch(h=s[h],h===void 0?s.push(o):h!==o&&(o.then(Mn,Mn),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Ug(s),s;default:if(typeof o.status=="string")o.then(Mn,Mn);else{if(s=ae,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(g){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=g}},function(g){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Ug(s),s}throw Ws=o,zr}}function Ys(s){try{var o=s._init;return o(s._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Ws=h,zr):h}}var Ws=null;function Bg(){if(Ws===null)throw Error(i(459));var s=Ws;return Ws=null,s}function Ug(s){if(s===zr||s===kl)throw Error(i(483))}var jr=null,Ya=0;function Bl(s){var o=Ya;return Ya+=1,jr===null&&(jr=[]),Fg(jr,s,o)}function Wa(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Ul(s,o){throw o.$$typeof===m?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function Hg(s){function o(z,H){if(s){var G=z.deletions;G===null?(z.deletions=[H],z.flags|=16):G.push(H)}}function h(z,H){if(!s)return null;for(;H!==null;)o(z,H),H=H.sibling;return null}function g(z){for(var H=new Map;z!==null;)z.key!==null?H.set(z.key,z):H.set(z.index,z),z=z.sibling;return H}function y(z,H){return z=Ln(z,H),z.index=0,z.sibling=null,z}function A(z,H,G){return z.index=G,s?(G=z.alternate,G!==null?(G=G.index,G<H?(z.flags|=67108866,H):G):(z.flags|=67108866,H)):(z.flags|=1048576,H)}function x(z){return s&&z.alternate===null&&(z.flags|=67108866),z}function O(z,H,G,et){return H===null||H.tag!==6?(H=ou(G,z.mode,et),H.return=z,H):(H=y(H,G),H.return=z,H)}function F(z,H,G,et){var St=G.type;return St===b?tt(z,H,G.props.children,et,G.key):H!==null&&(H.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===L&&Ys(St)===H.type)?(H=y(H,G.props),Wa(H,G),H.return=z,H):(H=Ol(G.type,G.key,G.props,null,z.mode,et),Wa(H,G),H.return=z,H)}function X(z,H,G,et){return H===null||H.tag!==4||H.stateNode.containerInfo!==G.containerInfo||H.stateNode.implementation!==G.implementation?(H=lu(G,z.mode,et),H.return=z,H):(H=y(H,G.children||[]),H.return=z,H)}function tt(z,H,G,et,St){return H===null||H.tag!==7?(H=js(G,z.mode,et,St),H.return=z,H):(H=y(H,G),H.return=z,H)}function it(z,H,G){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=ou(""+H,z.mode,G),H.return=z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case v:return G=Ol(H.type,H.key,H.props,null,z.mode,G),Wa(G,H),G.return=z,G;case S:return H=lu(H,z.mode,G),H.return=z,H;case L:return H=Ys(H),it(z,H,G)}if(nt(H)||Z(H))return H=js(H,z.mode,G,null),H.return=z,H;if(typeof H.then=="function")return it(z,Bl(H),G);if(H.$$typeof===T)return it(z,Nl(z,H),G);Ul(z,H)}return null}function Y(z,H,G,et){var St=H!==null?H.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return St!==null?null:O(z,H,""+G,et);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case v:return G.key===St?F(z,H,G,et):null;case S:return G.key===St?X(z,H,G,et):null;case L:return G=Ys(G),Y(z,H,G,et)}if(nt(G)||Z(G))return St!==null?null:tt(z,H,G,et,null);if(typeof G.then=="function")return Y(z,H,Bl(G),et);if(G.$$typeof===T)return Y(z,H,Nl(z,G),et);Ul(z,G)}return null}function W(z,H,G,et,St){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return z=z.get(G)||null,O(H,z,""+et,St);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case v:return z=z.get(et.key===null?G:et.key)||null,F(H,z,et,St);case S:return z=z.get(et.key===null?G:et.key)||null,X(H,z,et,St);case L:return et=Ys(et),W(z,H,G,et,St)}if(nt(et)||Z(et))return z=z.get(G)||null,tt(H,z,et,St,null);if(typeof et.then=="function")return W(z,H,G,Bl(et),St);if(et.$$typeof===T)return W(z,H,G,Nl(H,et),St);Ul(H,et)}return null}function vt(z,H,G,et){for(var St=null,qt=null,yt=H,kt=H=0,Gt=null;yt!==null&&kt<G.length;kt++){yt.index>kt?(Gt=yt,yt=null):Gt=yt.sibling;var Qt=Y(z,yt,G[kt],et);if(Qt===null){yt===null&&(yt=Gt);break}s&&yt&&Qt.alternate===null&&o(z,yt),H=A(Qt,H,kt),qt===null?St=Qt:qt.sibling=Qt,qt=Qt,yt=Gt}if(kt===G.length)return h(z,yt),Xt&&Pn(z,kt),St;if(yt===null){for(;kt<G.length;kt++)yt=it(z,G[kt],et),yt!==null&&(H=A(yt,H,kt),qt===null?St=yt:qt.sibling=yt,qt=yt);return Xt&&Pn(z,kt),St}for(yt=g(yt);kt<G.length;kt++)Gt=W(yt,z,kt,G[kt],et),Gt!==null&&(s&&Gt.alternate!==null&&yt.delete(Gt.key===null?kt:Gt.key),H=A(Gt,H,kt),qt===null?St=Gt:qt.sibling=Gt,qt=Gt);return s&&yt.forEach(function(Cs){return o(z,Cs)}),Xt&&Pn(z,kt),St}function wt(z,H,G,et){if(G==null)throw Error(i(151));for(var St=null,qt=null,yt=H,kt=H=0,Gt=null,Qt=G.next();yt!==null&&!Qt.done;kt++,Qt=G.next()){yt.index>kt?(Gt=yt,yt=null):Gt=yt.sibling;var Cs=Y(z,yt,Qt.value,et);if(Cs===null){yt===null&&(yt=Gt);break}s&&yt&&Cs.alternate===null&&o(z,yt),H=A(Cs,H,kt),qt===null?St=Cs:qt.sibling=Cs,qt=Cs,yt=Gt}if(Qt.done)return h(z,yt),Xt&&Pn(z,kt),St;if(yt===null){for(;!Qt.done;kt++,Qt=G.next())Qt=it(z,Qt.value,et),Qt!==null&&(H=A(Qt,H,kt),qt===null?St=Qt:qt.sibling=Qt,qt=Qt);return Xt&&Pn(z,kt),St}for(yt=g(yt);!Qt.done;kt++,Qt=G.next())Qt=W(yt,z,kt,Qt.value,et),Qt!==null&&(s&&Qt.alternate!==null&&yt.delete(Qt.key===null?kt:Qt.key),H=A(Qt,H,kt),qt===null?St=Qt:qt.sibling=Qt,qt=Qt);return s&&yt.forEach(function(v1){return o(z,v1)}),Xt&&Pn(z,kt),St}function se(z,H,G,et){if(typeof G=="object"&&G!==null&&G.type===b&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case v:t:{for(var St=G.key;H!==null;){if(H.key===St){if(St=G.type,St===b){if(H.tag===7){h(z,H.sibling),et=y(H,G.props.children),et.return=z,z=et;break t}}else if(H.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===L&&Ys(St)===H.type){h(z,H.sibling),et=y(H,G.props),Wa(et,G),et.return=z,z=et;break t}h(z,H);break}else o(z,H);H=H.sibling}G.type===b?(et=js(G.props.children,z.mode,et,G.key),et.return=z,z=et):(et=Ol(G.type,G.key,G.props,null,z.mode,et),Wa(et,G),et.return=z,z=et)}return x(z);case S:t:{for(St=G.key;H!==null;){if(H.key===St)if(H.tag===4&&H.stateNode.containerInfo===G.containerInfo&&H.stateNode.implementation===G.implementation){h(z,H.sibling),et=y(H,G.children||[]),et.return=z,z=et;break t}else{h(z,H);break}else o(z,H);H=H.sibling}et=lu(G,z.mode,et),et.return=z,z=et}return x(z);case L:return G=Ys(G),se(z,H,G,et)}if(nt(G))return vt(z,H,G,et);if(Z(G)){if(St=Z(G),typeof St!="function")throw Error(i(150));return G=St.call(G),wt(z,H,G,et)}if(typeof G.then=="function")return se(z,H,Bl(G),et);if(G.$$typeof===T)return se(z,H,Nl(z,G),et);Ul(z,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,H!==null&&H.tag===6?(h(z,H.sibling),et=y(H,G),et.return=z,z=et):(h(z,H),et=ou(G,z.mode,et),et.return=z,z=et),x(z)):h(z,H)}return function(z,H,G,et){try{Ya=0;var St=se(z,H,G,et);return jr=null,St}catch(yt){if(yt===zr||yt===kl)throw yt;var qt=Oi(29,yt,null,z.mode);return qt.lanes=et,qt.return=z,qt}finally{}}}var Ks=Hg(!0),zg=Hg(!1),ls=!1;function Au(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Su(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function cs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function hs(s,o,h){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Zt&2)!==0){var y=g.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),g.pending=o,o=Ml(s),Tg(s,null,h),o}return Dl(s,g,o,h),Ml(s)}function Ka(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Lp(s,h)}}function Eu(s,o){var h=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var y=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var x={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};A===null?y=A=x:A=A.next=x,h=h.next}while(h!==null);A===null?y=A=o:A=A.next=o}else y=A=o;h={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:A,shared:g.shared,callbacks:g.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}var wu=!1;function qa(){if(wu){var s=Hr;if(s!==null)throw s}}function Qa(s,o,h,g){wu=!1;var y=s.updateQueue;ls=!1;var A=y.firstBaseUpdate,x=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var F=O,X=F.next;F.next=null,x===null?A=X:x.next=X,x=F;var tt=s.alternate;tt!==null&&(tt=tt.updateQueue,O=tt.lastBaseUpdate,O!==x&&(O===null?tt.firstBaseUpdate=X:O.next=X,tt.lastBaseUpdate=F))}if(A!==null){var it=y.baseState;x=0,tt=X=F=null,O=A;do{var Y=O.lane&-536870913,W=Y!==O.lane;if(W?($t&Y)===Y:(g&Y)===Y){Y!==0&&Y===Ur&&(wu=!0),tt!==null&&(tt=tt.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});t:{var vt=s,wt=O;Y=o;var se=h;switch(wt.tag){case 1:if(vt=wt.payload,typeof vt=="function"){it=vt.call(se,it,Y);break t}it=vt;break t;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=wt.payload,Y=typeof vt=="function"?vt.call(se,it,Y):vt,Y==null)break t;it=p({},it,Y);break t;case 2:ls=!0}}Y=O.callback,Y!==null&&(s.flags|=64,W&&(s.flags|=8192),W=y.callbacks,W===null?y.callbacks=[Y]:W.push(Y))}else W={lane:Y,tag:O.tag,payload:O.payload,callback:O.callback,next:null},tt===null?(X=tt=W,F=it):tt=tt.next=W,x|=Y;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;W=O,O=W.next,W.next=null,y.lastBaseUpdate=W,y.shared.pending=null}}while(!0);tt===null&&(F=it),y.baseState=F,y.firstBaseUpdate=X,y.lastBaseUpdate=tt,A===null&&(y.shared.lanes=0),gs|=x,s.lanes=x,s.memoizedState=it}}function jg(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function $g(s,o){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)jg(h[s],o)}var $r=k(null),Hl=k(0);function Gg(s,o){s=Gn,K(Hl,s),K($r,o),Gn=s|o.baseLanes}function Tu(){K(Hl,Gn),K($r,$r.current)}function Cu(){Gn=Hl.current,j($r),j(Hl)}var Li=k(null),Qi=null;function us(s){var o=s.alternate;K(Ce,Ce.current&1),K(Li,s),Qi===null&&(o===null||$r.current!==null||o.memoizedState!==null)&&(Qi=s)}function xu(s){K(Ce,Ce.current),K(Li,s),Qi===null&&(Qi=s)}function Vg(s){s.tag===22?(K(Ce,Ce.current),K(Li,s),Qi===null&&(Qi=s)):ds()}function ds(){K(Ce,Ce.current),K(Li,Li.current)}function Pi(s){j(Li),Qi===s&&(Qi=null),j(Ce)}var Ce=k(0);function zl(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Ld(h)||Pd(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var kn=0,Pt=null,ie=null,Oe=null,jl=!1,Gr=!1,qs=!1,$l=0,Za=0,Vr=null,oE=0;function Ee(){throw Error(i(321))}function Ru(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!Mi(s[h],o[h]))return!1;return!0}function _u(s,o,h,g,y,A){return kn=A,Pt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,N.H=s===null||s.memoizedState===null?_m:$u,qs=!1,A=h(g,y),qs=!1,Gr&&(A=Yg(o,h,g,y)),Xg(s),A}function Xg(s){N.H=eo;var o=ie!==null&&ie.next!==null;if(kn=0,Oe=ie=Pt=null,jl=!1,Za=0,Vr=null,o)throw Error(i(300));s===null||Le||(s=s.dependencies,s!==null&&Pl(s)&&(Le=!0))}function Yg(s,o,h,g){Pt=s;var y=0;do{if(Gr&&(Vr=null),Za=0,Gr=!1,25<=y)throw Error(i(301));if(y+=1,Oe=ie=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}N.H=Dm,A=o(h,g)}while(Gr);return A}function lE(){var s=N.H,o=s.useState()[0];return o=typeof o.then=="function"?Ja(o):o,s=s.useState()[0],(ie!==null?ie.memoizedState:null)!==s&&(Pt.flags|=1024),o}function Du(){var s=$l!==0;return $l=0,s}function Mu(s,o,h){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~h}function Ou(s){if(jl){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}jl=!1}kn=0,Oe=ie=Pt=null,Gr=!1,Za=$l=0,Vr=null}function hi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Oe===null?Pt.memoizedState=Oe=s:Oe=Oe.next=s,Oe}function xe(){if(ie===null){var s=Pt.alternate;s=s!==null?s.memoizedState:null}else s=ie.next;var o=Oe===null?Pt.memoizedState:Oe.next;if(o!==null)Oe=o,ie=s;else{if(s===null)throw Pt.alternate===null?Error(i(467)):Error(i(310));ie=s,s={memoizedState:ie.memoizedState,baseState:ie.baseState,baseQueue:ie.baseQueue,queue:ie.queue,next:null},Oe===null?Pt.memoizedState=Oe=s:Oe=Oe.next=s}return Oe}function Gl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ja(s){var o=Za;return Za+=1,Vr===null&&(Vr=[]),s=Fg(Vr,s,o),o=Pt,(Oe===null?o.memoizedState:Oe.next)===null&&(o=o.alternate,N.H=o===null||o.memoizedState===null?_m:$u),s}function Vl(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ja(s);if(s.$$typeof===T)return We(s)}throw Error(i(438,String(s)))}function Lu(s){var o=null,h=Pt.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var g=Pt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Gl(),Pt.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(s),g=0;g<s;g++)h[g]=B;return o.index++,h}function Fn(s,o){return typeof o=="function"?o(s):o}function Xl(s){var o=xe();return Pu(o,ie,s)}function Pu(s,o,h){var g=s.queue;if(g===null)throw Error(i(311));g.lastRenderedReducer=h;var y=s.baseQueue,A=g.pending;if(A!==null){if(y!==null){var x=y.next;y.next=A.next,A.next=x}o.baseQueue=y=A,g.pending=null}if(A=s.baseState,y===null)s.memoizedState=A;else{o=y.next;var O=x=null,F=null,X=o,tt=!1;do{var it=X.lane&-536870913;if(it!==X.lane?($t&it)===it:(kn&it)===it){var Y=X.revertLane;if(Y===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),it===Ur&&(tt=!0);else if((kn&Y)===Y){X=X.next,Y===Ur&&(tt=!0);continue}else it={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},F===null?(O=F=it,x=A):F=F.next=it,Pt.lanes|=Y,gs|=Y;it=X.action,qs&&h(A,it),A=X.hasEagerState?X.eagerState:h(A,it)}else Y={lane:it,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},F===null?(O=F=Y,x=A):F=F.next=Y,Pt.lanes|=it,gs|=it;X=X.next}while(X!==null&&X!==o);if(F===null?x=A:F.next=O,!Mi(A,s.memoizedState)&&(Le=!0,tt&&(h=Hr,h!==null)))throw h;s.memoizedState=A,s.baseState=x,s.baseQueue=F,g.lastRenderedState=A}return y===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function Nu(s){var o=xe(),h=o.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=s;var g=h.dispatch,y=h.pending,A=o.memoizedState;if(y!==null){h.pending=null;var x=y=y.next;do A=s(A,x.action),x=x.next;while(x!==y);Mi(A,o.memoizedState)||(Le=!0),o.memoizedState=A,o.baseQueue===null&&(o.baseState=A),h.lastRenderedState=A}return[A,g]}function Wg(s,o,h){var g=Pt,y=xe(),A=Xt;if(A){if(h===void 0)throw Error(i(407));h=h()}else h=o();var x=!Mi((ie||y).memoizedState,h);if(x&&(y.memoizedState=h,Le=!0),y=y.queue,Fu(Qg.bind(null,g,y,s),[s]),y.getSnapshot!==o||x||Oe!==null&&Oe.memoizedState.tag&1){if(g.flags|=2048,Xr(9,{destroy:void 0},qg.bind(null,g,y,h,o),null),ae===null)throw Error(i(349));A||(kn&127)!==0||Kg(g,o,h)}return h}function Kg(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=Pt.updateQueue,o===null?(o=Gl(),Pt.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function qg(s,o,h,g){o.value=h,o.getSnapshot=g,Zg(o)&&Jg(s)}function Qg(s,o,h){return h(function(){Zg(o)&&Jg(s)})}function Zg(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!Mi(s,h)}catch{return!0}}function Jg(s){var o=zs(s,2);o!==null&&wi(o,s,2)}function Iu(s){var o=hi();if(typeof s=="function"){var h=s;if(s=h(),qs){es(!0);try{h()}finally{es(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:s},o}function tm(s,o,h,g){return s.baseState=h,Pu(s,ie,typeof g=="function"?g:Fn)}function cE(s,o,h,g,y){if(Kl(s))throw Error(i(485));if(s=o.action,s!==null){var A={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){A.listeners.push(x)}};N.T!==null?h(!0):A.isTransition=!1,g(A),h=o.pending,h===null?(A.next=o.pending=A,em(o,A)):(A.next=h.next,o.pending=h.next=A)}}function em(s,o){var h=o.action,g=o.payload,y=s.state;if(o.isTransition){var A=N.T,x={};N.T=x;try{var O=h(y,g),F=N.S;F!==null&&F(x,O),im(s,o,O)}catch(X){ku(s,o,X)}finally{A!==null&&x.types!==null&&(A.types=x.types),N.T=A}}else try{A=h(y,g),im(s,o,A)}catch(X){ku(s,o,X)}}function im(s,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){nm(s,o,g)},function(g){return ku(s,o,g)}):nm(s,o,h)}function nm(s,o,h){o.status="fulfilled",o.value=h,sm(o),s.state=h,o=s.pending,o!==null&&(h=o.next,h===o?s.pending=null:(h=h.next,o.next=h,em(s,h)))}function ku(s,o,h){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=h,sm(o),o=o.next;while(o!==g)}s.action=null}function sm(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function rm(s,o){return o}function am(s,o){if(Xt){var h=ae.formState;if(h!==null){t:{var g=Pt;if(Xt){if(fe){e:{for(var y=fe,A=qi;y.nodeType!==8;){if(!A){y=null;break e}if(y=Zi(y.nextSibling),y===null){y=null;break e}}A=y.data,y=A==="F!"||A==="F"?y:null}if(y){fe=Zi(y.nextSibling),g=y.data==="F!";break t}}as(g)}g=!1}g&&(o=h[0])}}return h=hi(),h.memoizedState=h.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rm,lastRenderedState:o},h.queue=g,h=Cm.bind(null,Pt,g),g.dispatch=h,g=Iu(!1),A=ju.bind(null,Pt,!1,g.queue),g=hi(),y={state:o,dispatch:null,action:s,pending:null},g.queue=y,h=cE.bind(null,Pt,y,A,h),y.dispatch=h,g.memoizedState=s,[o,h,!1]}function om(s){var o=xe();return lm(o,ie,s)}function lm(s,o,h){if(o=Pu(s,o,rm)[0],s=Xl(Fn)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=Ja(o)}catch(x){throw x===zr?kl:x}else g=o;o=xe();var y=o.queue,A=y.dispatch;return h!==o.memoizedState&&(Pt.flags|=2048,Xr(9,{destroy:void 0},hE.bind(null,y,h),null)),[g,A,s]}function hE(s,o){s.action=o}function cm(s){var o=xe(),h=ie;if(h!==null)return lm(o,h,s);xe(),o=o.memoizedState,h=xe();var g=h.queue.dispatch;return h.memoizedState=s,[o,g,!1]}function Xr(s,o,h,g){return s={tag:s,create:h,deps:g,inst:o,next:null},o=Pt.updateQueue,o===null&&(o=Gl(),Pt.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=s.next=s:(g=h.next,h.next=s,s.next=g,o.lastEffect=s),s}function hm(){return xe().memoizedState}function Yl(s,o,h,g){var y=hi();Pt.flags|=s,y.memoizedState=Xr(1|o,{destroy:void 0},h,g===void 0?null:g)}function Wl(s,o,h,g){var y=xe();g=g===void 0?null:g;var A=y.memoizedState.inst;ie!==null&&g!==null&&Ru(g,ie.memoizedState.deps)?y.memoizedState=Xr(o,A,h,g):(Pt.flags|=s,y.memoizedState=Xr(1|o,A,h,g))}function um(s,o){Yl(8390656,8,s,o)}function Fu(s,o){Wl(2048,8,s,o)}function uE(s){Pt.flags|=4;var o=Pt.updateQueue;if(o===null)o=Gl(),Pt.updateQueue=o,o.events=[s];else{var h=o.events;h===null?o.events=[s]:h.push(s)}}function dm(s){var o=xe().memoizedState;return uE({ref:o,nextImpl:s}),function(){if((Zt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function fm(s,o){return Wl(4,2,s,o)}function pm(s,o){return Wl(4,4,s,o)}function gm(s,o){if(typeof o=="function"){s=s();var h=o(s);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function mm(s,o,h){h=h!=null?h.concat([s]):null,Wl(4,4,gm.bind(null,o,s),h)}function Bu(){}function vm(s,o){var h=xe();o=o===void 0?null:o;var g=h.memoizedState;return o!==null&&Ru(o,g[1])?g[0]:(h.memoizedState=[s,o],s)}function ym(s,o){var h=xe();o=o===void 0?null:o;var g=h.memoizedState;if(o!==null&&Ru(o,g[1]))return g[0];if(g=s(),qs){es(!0);try{s()}finally{es(!1)}}return h.memoizedState=[g,o],g}function Uu(s,o,h){return h===void 0||(kn&1073741824)!==0&&($t&261930)===0?s.memoizedState=o:(s.memoizedState=h,s=bv(),Pt.lanes|=s,gs|=s,h)}function bm(s,o,h,g){return Mi(h,o)?h:$r.current!==null?(s=Uu(s,h,g),Mi(s,o)||(Le=!0),s):(kn&42)===0||(kn&1073741824)!==0&&($t&261930)===0?(Le=!0,s.memoizedState=h):(s=bv(),Pt.lanes|=s,gs|=s,o)}function Am(s,o,h,g,y){var A=I.p;I.p=A!==0&&8>A?A:8;var x=N.T,O={};N.T=O,ju(s,!1,o,h);try{var F=y(),X=N.S;if(X!==null&&X(O,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var tt=aE(F,g);to(s,o,tt,ki(s))}else to(s,o,g,ki(s))}catch(it){to(s,o,{then:function(){},status:"rejected",reason:it},ki())}finally{I.p=A,x!==null&&O.types!==null&&(x.types=O.types),N.T=x}}function dE(){}function Hu(s,o,h,g){if(s.tag!==5)throw Error(i(476));var y=Sm(s).queue;Am(s,y,o,$,h===null?dE:function(){return Em(s),h(g)})}function Sm(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:$},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:h},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Em(s){var o=Sm(s);o.next===null&&(o=s.alternate.memoizedState),to(s,o.next.queue,{},ki())}function zu(){return We(yo)}function wm(){return xe().memoizedState}function Tm(){return xe().memoizedState}function fE(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var h=ki();s=cs(h);var g=hs(o,s,h);g!==null&&(wi(g,o,h),Ka(g,o,h)),o={cache:mu()},s.payload=o;return}o=o.return}}function pE(s,o,h){var g=ki();h={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Kl(s)?xm(o,h):(h=ru(s,o,h,g),h!==null&&(wi(h,s,g),Rm(h,o,g)))}function Cm(s,o,h){var g=ki();to(s,o,h,g)}function to(s,o,h,g){var y={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Kl(s))xm(o,y);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=o.lastRenderedReducer,A!==null))try{var x=o.lastRenderedState,O=A(x,h);if(y.hasEagerState=!0,y.eagerState=O,Mi(O,x))return Dl(s,o,y,0),ae===null&&_l(),!1}catch{}finally{}if(h=ru(s,o,y,g),h!==null)return wi(h,s,g),Rm(h,o,g),!0}return!1}function ju(s,o,h,g){if(g={lane:2,revertLane:Ad(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Kl(s)){if(o)throw Error(i(479))}else o=ru(s,h,g,2),o!==null&&wi(o,s,2)}function Kl(s){var o=s.alternate;return s===Pt||o!==null&&o===Pt}function xm(s,o){Gr=jl=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function Rm(s,o,h){if((h&4194048)!==0){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Lp(s,h)}}var eo={readContext:We,use:Vl,useCallback:Ee,useContext:Ee,useEffect:Ee,useImperativeHandle:Ee,useLayoutEffect:Ee,useInsertionEffect:Ee,useMemo:Ee,useReducer:Ee,useRef:Ee,useState:Ee,useDebugValue:Ee,useDeferredValue:Ee,useTransition:Ee,useSyncExternalStore:Ee,useId:Ee,useHostTransitionStatus:Ee,useFormState:Ee,useActionState:Ee,useOptimistic:Ee,useMemoCache:Ee,useCacheRefresh:Ee};eo.useEffectEvent=Ee;var _m={readContext:We,use:Vl,useCallback:function(s,o){return hi().memoizedState=[s,o===void 0?null:o],s},useContext:We,useEffect:um,useImperativeHandle:function(s,o,h){h=h!=null?h.concat([s]):null,Yl(4194308,4,gm.bind(null,o,s),h)},useLayoutEffect:function(s,o){return Yl(4194308,4,s,o)},useInsertionEffect:function(s,o){Yl(4,2,s,o)},useMemo:function(s,o){var h=hi();o=o===void 0?null:o;var g=s();if(qs){es(!0);try{s()}finally{es(!1)}}return h.memoizedState=[g,o],g},useReducer:function(s,o,h){var g=hi();if(h!==void 0){var y=h(o);if(qs){es(!0);try{h(o)}finally{es(!1)}}}else y=o;return g.memoizedState=g.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},g.queue=s,s=s.dispatch=pE.bind(null,Pt,s),[g.memoizedState,s]},useRef:function(s){var o=hi();return s={current:s},o.memoizedState=s},useState:function(s){s=Iu(s);var o=s.queue,h=Cm.bind(null,Pt,o);return o.dispatch=h,[s.memoizedState,h]},useDebugValue:Bu,useDeferredValue:function(s,o){var h=hi();return Uu(h,s,o)},useTransition:function(){var s=Iu(!1);return s=Am.bind(null,Pt,s.queue,!0,!1),hi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,h){var g=Pt,y=hi();if(Xt){if(h===void 0)throw Error(i(407));h=h()}else{if(h=o(),ae===null)throw Error(i(349));($t&127)!==0||Kg(g,o,h)}y.memoizedState=h;var A={value:h,getSnapshot:o};return y.queue=A,um(Qg.bind(null,g,A,s),[s]),g.flags|=2048,Xr(9,{destroy:void 0},qg.bind(null,g,A,h,o),null),h},useId:function(){var s=hi(),o=ae.identifierPrefix;if(Xt){var h=vn,g=mn;h=(g&~(1<<32-Di(g)-1)).toString(32)+h,o="_"+o+"R_"+h,h=$l++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=oE++,o="_"+o+"r_"+h.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:zu,useFormState:am,useActionState:am,useOptimistic:function(s){var o=hi();o.memoizedState=o.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=ju.bind(null,Pt,!0,h),h.dispatch=o,[s,o]},useMemoCache:Lu,useCacheRefresh:function(){return hi().memoizedState=fE.bind(null,Pt)},useEffectEvent:function(s){var o=hi(),h={impl:s};return o.memoizedState=h,function(){if((Zt&2)!==0)throw Error(i(440));return h.impl.apply(void 0,arguments)}}},$u={readContext:We,use:Vl,useCallback:vm,useContext:We,useEffect:Fu,useImperativeHandle:mm,useInsertionEffect:fm,useLayoutEffect:pm,useMemo:ym,useReducer:Xl,useRef:hm,useState:function(){return Xl(Fn)},useDebugValue:Bu,useDeferredValue:function(s,o){var h=xe();return bm(h,ie.memoizedState,s,o)},useTransition:function(){var s=Xl(Fn)[0],o=xe().memoizedState;return[typeof s=="boolean"?s:Ja(s),o]},useSyncExternalStore:Wg,useId:wm,useHostTransitionStatus:zu,useFormState:om,useActionState:om,useOptimistic:function(s,o){var h=xe();return tm(h,ie,s,o)},useMemoCache:Lu,useCacheRefresh:Tm};$u.useEffectEvent=dm;var Dm={readContext:We,use:Vl,useCallback:vm,useContext:We,useEffect:Fu,useImperativeHandle:mm,useInsertionEffect:fm,useLayoutEffect:pm,useMemo:ym,useReducer:Nu,useRef:hm,useState:function(){return Nu(Fn)},useDebugValue:Bu,useDeferredValue:function(s,o){var h=xe();return ie===null?Uu(h,s,o):bm(h,ie.memoizedState,s,o)},useTransition:function(){var s=Nu(Fn)[0],o=xe().memoizedState;return[typeof s=="boolean"?s:Ja(s),o]},useSyncExternalStore:Wg,useId:wm,useHostTransitionStatus:zu,useFormState:cm,useActionState:cm,useOptimistic:function(s,o){var h=xe();return ie!==null?tm(h,ie,s,o):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:Lu,useCacheRefresh:Tm};Dm.useEffectEvent=dm;function Gu(s,o,h,g){o=s.memoizedState,h=h(g,o),h=h==null?o:p({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Vu={enqueueSetState:function(s,o,h){s=s._reactInternals;var g=ki(),y=cs(g);y.payload=o,h!=null&&(y.callback=h),o=hs(s,y,g),o!==null&&(wi(o,s,g),Ka(o,s,g))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var g=ki(),y=cs(g);y.tag=1,y.payload=o,h!=null&&(y.callback=h),o=hs(s,y,g),o!==null&&(wi(o,s,g),Ka(o,s,g))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=ki(),g=cs(h);g.tag=2,o!=null&&(g.callback=o),o=hs(s,g,h),o!==null&&(wi(o,s,h),Ka(o,s,h))}};function Mm(s,o,h,g,y,A,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,A,x):o.prototype&&o.prototype.isPureReactComponent?!za(h,g)||!za(y,A):!0}function Om(s,o,h,g){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,g),o.state!==s&&Vu.enqueueReplaceState(o,o.state,null)}function Qs(s,o){var h=o;if("ref"in o){h={};for(var g in o)g!=="ref"&&(h[g]=o[g])}if(s=s.defaultProps){h===o&&(h=p({},h));for(var y in s)h[y]===void 0&&(h[y]=s[y])}return h}function Lm(s){Rl(s)}function Pm(s){console.error(s)}function Nm(s){Rl(s)}function ql(s,o){try{var h=s.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function Im(s,o,h){try{var g=s.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Xu(s,o,h){return h=cs(h),h.tag=3,h.payload={element:null},h.callback=function(){ql(s,o)},h}function km(s){return s=cs(s),s.tag=3,s}function Fm(s,o,h,g){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var A=g.value;s.payload=function(){return y(A)},s.callback=function(){Im(o,h,g)}}var x=h.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Im(o,h,g),typeof y!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var O=g.stack;this.componentDidCatch(g.value,{componentStack:O!==null?O:""})})}function gE(s,o,h,g,y){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=h.alternate,o!==null&&Br(o,h,y,!0),h=Li.current,h!==null){switch(h.tag){case 31:case 13:return Qi===null?lc():h.alternate===null&&we===0&&(we=3),h.flags&=-257,h.flags|=65536,h.lanes=y,g===Fl?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([g]):o.add(g),vd(s,g,y)),!1;case 22:return h.flags|=65536,g===Fl?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([g]):h.add(g)),vd(s,g,y)),!1}throw Error(i(435,h.tag))}return vd(s,g,y),lc(),!1}if(Xt)return o=Li.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,g!==uu&&(s=Error(i(422),{cause:g}),Ga(Yi(s,h)))):(g!==uu&&(o=Error(i(423),{cause:g}),Ga(Yi(o,h))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,g=Yi(g,h),y=Xu(s.stateNode,g,y),Eu(s,y),we!==4&&(we=2)),!1;var A=Error(i(520),{cause:g});if(A=Yi(A,h),co===null?co=[A]:co.push(A),we!==4&&(we=2),o===null)return!0;g=Yi(g,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,s=y&-y,h.lanes|=s,s=Xu(h.stateNode,g,s),Eu(h,s),!1;case 1:if(o=h.type,A=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ms===null||!ms.has(A))))return h.flags|=65536,y&=-y,h.lanes|=y,y=km(y),Fm(y,s,h,g),Eu(h,y),!1}h=h.return}while(h!==null);return!1}var Yu=Error(i(461)),Le=!1;function Ke(s,o,h,g){o.child=s===null?zg(o,null,h,g):Ks(o,s.child,h,g)}function Bm(s,o,h,g,y){h=h.render;var A=o.ref;if("ref"in g){var x={};for(var O in g)O!=="ref"&&(x[O]=g[O])}else x=g;return Vs(o),g=_u(s,o,h,x,A,y),O=Du(),s!==null&&!Le?(Mu(s,o,y),Bn(s,o,y)):(Xt&&O&&cu(o),o.flags|=1,Ke(s,o,g,y),o.child)}function Um(s,o,h,g,y){if(s===null){var A=h.type;return typeof A=="function"&&!au(A)&&A.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=A,Hm(s,o,A,g,y)):(s=Ol(h.type,null,g,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(A=s.child,!ed(s,y)){var x=A.memoizedProps;if(h=h.compare,h=h!==null?h:za,h(x,g)&&s.ref===o.ref)return Bn(s,o,y)}return o.flags|=1,s=Ln(A,g),s.ref=o.ref,s.return=o,o.child=s}function Hm(s,o,h,g,y){if(s!==null){var A=s.memoizedProps;if(za(A,g)&&s.ref===o.ref)if(Le=!1,o.pendingProps=g=A,ed(s,y))(s.flags&131072)!==0&&(Le=!0);else return o.lanes=s.lanes,Bn(s,o,y)}return Wu(s,o,h,g,y)}function zm(s,o,h,g){var y=g.children,A=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(A=A!==null?A.baseLanes|h:h,s!==null){for(g=o.child=s.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;g=y&~A}else g=0,o.child=null;return jm(s,o,A,h,g)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Il(o,A!==null?A.cachePool:null),A!==null?Gg(o,A):Tu(),Vg(o);else return g=o.lanes=536870912,jm(s,o,A!==null?A.baseLanes|h:h,h,g)}else A!==null?(Il(o,A.cachePool),Gg(o,A),ds(),o.memoizedState=null):(s!==null&&Il(o,null),Tu(),ds());return Ke(s,o,y,h),o.child}function io(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function jm(s,o,h,g,y){var A=yu();return A=A===null?null:{parent:Me._currentValue,pool:A},o.memoizedState={baseLanes:h,cachePool:A},s!==null&&Il(o,null),Tu(),Vg(o),s!==null&&Br(s,o,g,!0),o.childLanes=y,null}function Ql(s,o){return o=Jl({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function $m(s,o,h){return Ks(o,s.child,null,h),s=Ql(o,o.pendingProps),s.flags|=2,Pi(o),o.memoizedState=null,s}function mE(s,o,h){var g=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(Xt){if(g.mode==="hidden")return s=Ql(o,g),o.lanes=536870912,io(null,s);if(xu(o),(s=fe)?(s=ey(s,qi),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ss!==null?{id:mn,overflow:vn}:null,retryLane:536870912,hydrationErrors:null},h=xg(s),h.return=o,o.child=h,Ye=o,fe=null)):s=null,s===null)throw as(o);return o.lanes=536870912,null}return Ql(o,g)}var A=s.memoizedState;if(A!==null){var x=A.dehydrated;if(xu(o),y)if(o.flags&256)o.flags&=-257,o=$m(s,o,h);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(Le||Br(s,o,h,!1),y=(h&s.childLanes)!==0,Le||y){if(g=ae,g!==null&&(x=Pp(g,h),x!==0&&x!==A.retryLane))throw A.retryLane=x,zs(s,x),wi(g,s,x),Yu;lc(),o=$m(s,o,h)}else s=A.treeContext,fe=Zi(x.nextSibling),Ye=o,Xt=!0,rs=null,qi=!1,s!==null&&Dg(o,s),o=Ql(o,g),o.flags|=4096;return o}return s=Ln(s.child,{mode:g.mode,children:g.children}),s.ref=o.ref,o.child=s,s.return=o,s}function Zl(s,o){var h=o.ref;if(h===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(s===null||s.ref!==h)&&(o.flags|=4194816)}}function Wu(s,o,h,g,y){return Vs(o),h=_u(s,o,h,g,void 0,y),g=Du(),s!==null&&!Le?(Mu(s,o,y),Bn(s,o,y)):(Xt&&g&&cu(o),o.flags|=1,Ke(s,o,h,y),o.child)}function Gm(s,o,h,g,y,A){return Vs(o),o.updateQueue=null,h=Yg(o,g,h,y),Xg(s),g=Du(),s!==null&&!Le?(Mu(s,o,A),Bn(s,o,A)):(Xt&&g&&cu(o),o.flags|=1,Ke(s,o,h,A),o.child)}function Vm(s,o,h,g,y){if(Vs(o),o.stateNode===null){var A=Nr,x=h.contextType;typeof x=="object"&&x!==null&&(A=We(x)),A=new h(g,A),o.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Vu,o.stateNode=A,A._reactInternals=o,A=o.stateNode,A.props=g,A.state=o.memoizedState,A.refs={},Au(o),x=h.contextType,A.context=typeof x=="object"&&x!==null?We(x):Nr,A.state=o.memoizedState,x=h.getDerivedStateFromProps,typeof x=="function"&&(Gu(o,h,x,g),A.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(x=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),x!==A.state&&Vu.enqueueReplaceState(A,A.state,null),Qa(o,g,A,y),qa(),A.state=o.memoizedState),typeof A.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(s===null){A=o.stateNode;var O=o.memoizedProps,F=Qs(h,O);A.props=F;var X=A.context,tt=h.contextType;x=Nr,typeof tt=="object"&&tt!==null&&(x=We(tt));var it=h.getDerivedStateFromProps;tt=typeof it=="function"||typeof A.getSnapshotBeforeUpdate=="function",O=o.pendingProps!==O,tt||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(O||X!==x)&&Om(o,A,g,x),ls=!1;var Y=o.memoizedState;A.state=Y,Qa(o,g,A,y),qa(),X=o.memoizedState,O||Y!==X||ls?(typeof it=="function"&&(Gu(o,h,it,g),X=o.memoizedState),(F=ls||Mm(o,h,F,g,Y,X,x))?(tt||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(o.flags|=4194308)):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=X),A.props=g,A.state=X,A.context=x,g=F):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{A=o.stateNode,Su(s,o),x=o.memoizedProps,tt=Qs(h,x),A.props=tt,it=o.pendingProps,Y=A.context,X=h.contextType,F=Nr,typeof X=="object"&&X!==null&&(F=We(X)),O=h.getDerivedStateFromProps,(X=typeof O=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(x!==it||Y!==F)&&Om(o,A,g,F),ls=!1,Y=o.memoizedState,A.state=Y,Qa(o,g,A,y),qa();var W=o.memoizedState;x!==it||Y!==W||ls||s!==null&&s.dependencies!==null&&Pl(s.dependencies)?(typeof O=="function"&&(Gu(o,h,O,g),W=o.memoizedState),(tt=ls||Mm(o,h,tt,g,Y,W,F)||s!==null&&s.dependencies!==null&&Pl(s.dependencies))?(X||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,W,F),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,W,F)),typeof A.componentDidUpdate=="function"&&(o.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof A.componentDidUpdate!="function"||x===s.memoizedProps&&Y===s.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&Y===s.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=W),A.props=g,A.state=W,A.context=F,g=tt):(typeof A.componentDidUpdate!="function"||x===s.memoizedProps&&Y===s.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&Y===s.memoizedState||(o.flags|=1024),g=!1)}return A=g,Zl(s,o),g=(o.flags&128)!==0,A||g?(A=o.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:A.render(),o.flags|=1,s!==null&&g?(o.child=Ks(o,s.child,null,y),o.child=Ks(o,null,h,y)):Ke(s,o,h,y),o.memoizedState=A.state,s=o.child):s=Bn(s,o,y),s}function Xm(s,o,h,g){return $s(),o.flags|=256,Ke(s,o,h,g),o.child}var Ku={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qu(s){return{baseLanes:s,cachePool:Ig()}}function Qu(s,o,h){return s=s!==null?s.childLanes&~h:0,o&&(s|=Ii),s}function Ym(s,o,h){var g=o.pendingProps,y=!1,A=(o.flags&128)!==0,x;if((x=A)||(x=s!==null&&s.memoizedState===null?!1:(Ce.current&2)!==0),x&&(y=!0,o.flags&=-129),x=(o.flags&32)!==0,o.flags&=-33,s===null){if(Xt){if(y?us(o):ds(),(s=fe)?(s=ey(s,qi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ss!==null?{id:mn,overflow:vn}:null,retryLane:536870912,hydrationErrors:null},h=xg(s),h.return=o,o.child=h,Ye=o,fe=null)):s=null,s===null)throw as(o);return Pd(s)?o.lanes=32:o.lanes=536870912,null}var O=g.children;return g=g.fallback,y?(ds(),y=o.mode,O=Jl({mode:"hidden",children:O},y),g=js(g,y,h,null),O.return=o,g.return=o,O.sibling=g,o.child=O,g=o.child,g.memoizedState=qu(h),g.childLanes=Qu(s,x,h),o.memoizedState=Ku,io(null,g)):(us(o),Zu(o,O))}var F=s.memoizedState;if(F!==null&&(O=F.dehydrated,O!==null)){if(A)o.flags&256?(us(o),o.flags&=-257,o=Ju(s,o,h)):o.memoizedState!==null?(ds(),o.child=s.child,o.flags|=128,o=null):(ds(),O=g.fallback,y=o.mode,g=Jl({mode:"visible",children:g.children},y),O=js(O,y,h,null),O.flags|=2,g.return=o,O.return=o,g.sibling=O,o.child=g,Ks(o,s.child,null,h),g=o.child,g.memoizedState=qu(h),g.childLanes=Qu(s,x,h),o.memoizedState=Ku,o=io(null,g));else if(us(o),Pd(O)){if(x=O.nextSibling&&O.nextSibling.dataset,x)var X=x.dgst;x=X,g=Error(i(419)),g.stack="",g.digest=x,Ga({value:g,source:null,stack:null}),o=Ju(s,o,h)}else if(Le||Br(s,o,h,!1),x=(h&s.childLanes)!==0,Le||x){if(x=ae,x!==null&&(g=Pp(x,h),g!==0&&g!==F.retryLane))throw F.retryLane=g,zs(s,g),wi(x,s,g),Yu;Ld(O)||lc(),o=Ju(s,o,h)}else Ld(O)?(o.flags|=192,o.child=s.child,o=null):(s=F.treeContext,fe=Zi(O.nextSibling),Ye=o,Xt=!0,rs=null,qi=!1,s!==null&&Dg(o,s),o=Zu(o,g.children),o.flags|=4096);return o}return y?(ds(),O=g.fallback,y=o.mode,F=s.child,X=F.sibling,g=Ln(F,{mode:"hidden",children:g.children}),g.subtreeFlags=F.subtreeFlags&65011712,X!==null?O=Ln(X,O):(O=js(O,y,h,null),O.flags|=2),O.return=o,g.return=o,g.sibling=O,o.child=g,io(null,g),g=o.child,O=s.child.memoizedState,O===null?O=qu(h):(y=O.cachePool,y!==null?(F=Me._currentValue,y=y.parent!==F?{parent:F,pool:F}:y):y=Ig(),O={baseLanes:O.baseLanes|h,cachePool:y}),g.memoizedState=O,g.childLanes=Qu(s,x,h),o.memoizedState=Ku,io(s.child,g)):(us(o),h=s.child,s=h.sibling,h=Ln(h,{mode:"visible",children:g.children}),h.return=o,h.sibling=null,s!==null&&(x=o.deletions,x===null?(o.deletions=[s],o.flags|=16):x.push(s)),o.child=h,o.memoizedState=null,h)}function Zu(s,o){return o=Jl({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Jl(s,o){return s=Oi(22,s,null,o),s.lanes=0,s}function Ju(s,o,h){return Ks(o,s.child,null,h),s=Zu(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Wm(s,o,h){s.lanes|=o;var g=s.alternate;g!==null&&(g.lanes|=o),pu(s.return,o,h)}function td(s,o,h,g,y,A){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:y,treeForkCount:A}:(x.isBackwards=o,x.rendering=null,x.renderingStartTime=0,x.last=g,x.tail=h,x.tailMode=y,x.treeForkCount=A)}function Km(s,o,h){var g=o.pendingProps,y=g.revealOrder,A=g.tail;g=g.children;var x=Ce.current,O=(x&2)!==0;if(O?(x=x&1|2,o.flags|=128):x&=1,K(Ce,x),Ke(s,o,g,h),g=Xt?$a:0,!O&&s!==null&&(s.flags&128)!==0)t:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wm(s,h,o);else if(s.tag===19)Wm(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break t;for(;s.sibling===null;){if(s.return===null||s.return===o)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(h=o.child,y=null;h!==null;)s=h.alternate,s!==null&&zl(s)===null&&(y=h),h=h.sibling;h=y,h===null?(y=o.child,o.child=null):(y=h.sibling,h.sibling=null),td(o,!1,y,h,A,g);break;case"backwards":case"unstable_legacy-backwards":for(h=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&zl(s)===null){o.child=y;break}s=y.sibling,y.sibling=h,h=y,y=s}td(o,!0,h,null,A,g);break;case"together":td(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function Bn(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),gs|=o.lanes,(h&o.childLanes)===0)if(s!==null){if(Br(s,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,h=Ln(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=Ln(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function ed(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Pl(s)))}function vE(s,o,h){switch(o.tag){case 3:rt(o,o.stateNode.containerInfo),os(o,Me,s.memoizedState.cache),$s();break;case 27:case 5:At(o);break;case 4:rt(o,o.stateNode.containerInfo);break;case 10:os(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,xu(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(us(o),o.flags|=128,null):(h&o.child.childLanes)!==0?Ym(s,o,h):(us(o),s=Bn(s,o,h),s!==null?s.sibling:null);us(o);break;case 19:var y=(s.flags&128)!==0;if(g=(h&o.childLanes)!==0,g||(Br(s,o,h,!1),g=(h&o.childLanes)!==0),y){if(g)return Km(s,o,h);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),K(Ce,Ce.current),g)break;return null;case 22:return o.lanes=0,zm(s,o,h,o.pendingProps);case 24:os(o,Me,s.memoizedState.cache)}return Bn(s,o,h)}function qm(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps)Le=!0;else{if(!ed(s,h)&&(o.flags&128)===0)return Le=!1,vE(s,o,h);Le=(s.flags&131072)!==0}else Le=!1,Xt&&(o.flags&1048576)!==0&&_g(o,$a,o.index);switch(o.lanes=0,o.tag){case 16:t:{var g=o.pendingProps;if(s=Ys(o.elementType),o.type=s,typeof s=="function")au(s)?(g=Qs(s,g),o.tag=1,o=Vm(null,o,s,g,h)):(o.tag=0,o=Wu(null,o,s,g,h));else{if(s!=null){var y=s.$$typeof;if(y===_){o.tag=11,o=Bm(null,o,s,g,h);break t}else if(y===M){o.tag=14,o=Um(null,o,s,g,h);break t}}throw o=Q(s)||s,Error(i(306,o,""))}}return o;case 0:return Wu(s,o,o.type,o.pendingProps,h);case 1:return g=o.type,y=Qs(g,o.pendingProps),Vm(s,o,g,y,h);case 3:t:{if(rt(o,o.stateNode.containerInfo),s===null)throw Error(i(387));g=o.pendingProps;var A=o.memoizedState;y=A.element,Su(s,o),Qa(o,g,null,h);var x=o.memoizedState;if(g=x.cache,os(o,Me,g),g!==A.cache&&gu(o,[Me],h,!0),qa(),g=x.element,A.isDehydrated)if(A={element:g,isDehydrated:!1,cache:x.cache},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){o=Xm(s,o,g,h);break t}else if(g!==y){y=Yi(Error(i(424)),o),Ga(y),o=Xm(s,o,g,h);break t}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(fe=Zi(s.firstChild),Ye=o,Xt=!0,rs=null,qi=!0,h=zg(o,null,g,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if($s(),g===y){o=Bn(s,o,h);break t}Ke(s,o,g,h)}o=o.child}return o;case 26:return Zl(s,o),s===null?(h=oy(o.type,null,o.pendingProps,null))?o.memoizedState=h:Xt||(h=o.type,s=o.pendingProps,g=gc(J.current).createElement(h),g[Xe]=o,g[vi]=s,qe(g,h,s),je(g),o.stateNode=g):o.memoizedState=oy(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return At(o),s===null&&Xt&&(g=o.stateNode=sy(o.type,o.pendingProps,J.current),Ye=o,qi=!0,y=fe,As(o.type)?(Nd=y,fe=Zi(g.firstChild)):fe=y),Ke(s,o,o.pendingProps.children,h),Zl(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Xt&&((y=g=fe)&&(g=YE(g,o.type,o.pendingProps,qi),g!==null?(o.stateNode=g,Ye=o,fe=Zi(g.firstChild),qi=!1,y=!0):y=!1),y||as(o)),At(o),y=o.type,A=o.pendingProps,x=s!==null?s.memoizedProps:null,g=A.children,Dd(y,A)?g=null:x!==null&&Dd(y,x)&&(o.flags|=32),o.memoizedState!==null&&(y=_u(s,o,lE,null,null,h),yo._currentValue=y),Zl(s,o),Ke(s,o,g,h),o.child;case 6:return s===null&&Xt&&((s=h=fe)&&(h=WE(h,o.pendingProps,qi),h!==null?(o.stateNode=h,Ye=o,fe=null,s=!0):s=!1),s||as(o)),null;case 13:return Ym(s,o,h);case 4:return rt(o,o.stateNode.containerInfo),g=o.pendingProps,s===null?o.child=Ks(o,null,g,h):Ke(s,o,g,h),o.child;case 11:return Bm(s,o,o.type,o.pendingProps,h);case 7:return Ke(s,o,o.pendingProps,h),o.child;case 8:return Ke(s,o,o.pendingProps.children,h),o.child;case 12:return Ke(s,o,o.pendingProps.children,h),o.child;case 10:return g=o.pendingProps,os(o,o.type,g.value),Ke(s,o,g.children,h),o.child;case 9:return y=o.type._context,g=o.pendingProps.children,Vs(o),y=We(y),g=g(y),o.flags|=1,Ke(s,o,g,h),o.child;case 14:return Um(s,o,o.type,o.pendingProps,h);case 15:return Hm(s,o,o.type,o.pendingProps,h);case 19:return Km(s,o,h);case 31:return mE(s,o,h);case 22:return zm(s,o,h,o.pendingProps);case 24:return Vs(o),g=We(Me),s===null?(y=yu(),y===null&&(y=ae,A=mu(),y.pooledCache=A,A.refCount++,A!==null&&(y.pooledCacheLanes|=h),y=A),o.memoizedState={parent:g,cache:y},Au(o),os(o,Me,y)):((s.lanes&h)!==0&&(Su(s,o),Qa(o,null,null,h),qa()),y=s.memoizedState,A=o.memoizedState,y.parent!==g?(y={parent:g,cache:g},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),os(o,Me,g)):(g=A.cache,os(o,Me,g),g!==y.cache&&gu(o,[Me],h,!0))),Ke(s,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Un(s){s.flags|=4}function id(s,o,h,g,y){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(wv())s.flags|=8192;else throw Ws=Fl,bu}else s.flags&=-16777217}function Qm(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!dy(o))if(wv())s.flags|=8192;else throw Ws=Fl,bu}function tc(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Mp():536870912,s.lanes|=o,qr|=o)}function no(s,o){if(!Xt)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function pe(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,g=0;if(o)for(var y=s.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags&65011712,g|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=g,s.childLanes=h,o}function yE(s,o,h){var g=o.pendingProps;switch(hu(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pe(o),null;case 1:return pe(o),null;case 3:return h=o.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),In(Me),lt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Fr(o)?Un(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,du())),pe(o),null;case 26:var y=o.type,A=o.memoizedState;return s===null?(Un(o),A!==null?(pe(o),Qm(o,A)):(pe(o),id(o,y,null,g,h))):A?A!==s.memoizedState?(Un(o),pe(o),Qm(o,A)):(pe(o),o.flags&=-16777217):(s=s.memoizedProps,s!==g&&Un(o),pe(o),id(o,y,s,g,h)),null;case 27:if(dt(o),h=J.current,y=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==g&&Un(o);else{if(!g){if(o.stateNode===null)throw Error(i(166));return pe(o),null}s=st.current,Fr(o)?Mg(o):(s=sy(y,g,h),o.stateNode=s,Un(o))}return pe(o),null;case 5:if(dt(o),y=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==g&&Un(o);else{if(!g){if(o.stateNode===null)throw Error(i(166));return pe(o),null}if(A=st.current,Fr(o))Mg(o);else{var x=gc(J.current);switch(A){case 1:A=x.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:A=x.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":A=x.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":A=x.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":A=x.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof g.is=="string"?x.createElement("select",{is:g.is}):x.createElement("select"),g.multiple?A.multiple=!0:g.size&&(A.size=g.size);break;default:A=typeof g.is=="string"?x.createElement(y,{is:g.is}):x.createElement(y)}}A[Xe]=o,A[vi]=g;t:for(x=o.child;x!==null;){if(x.tag===5||x.tag===6)A.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===o)break t;for(;x.sibling===null;){if(x.return===null||x.return===o)break t;x=x.return}x.sibling.return=x.return,x=x.sibling}o.stateNode=A;t:switch(qe(A,y,g),y){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break t;case"img":g=!0;break t;default:g=!1}g&&Un(o)}}return pe(o),id(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,h),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==g&&Un(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(i(166));if(s=J.current,Fr(o)){if(s=o.stateNode,h=o.memoizedProps,g=null,y=Ye,y!==null)switch(y.tag){case 27:case 5:g=y.memoizedProps}s[Xe]=o,s=!!(s.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||Yv(s.nodeValue,h)),s||as(o,!0)}else s=gc(s).createTextNode(g),s[Xe]=o,o.stateNode=s}return pe(o),null;case 31:if(h=o.memoizedState,s===null||s.memoizedState!==null){if(g=Fr(o),h!==null){if(s===null){if(!g)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Xe]=o}else $s(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pe(o),s=!1}else h=du(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=h),s=!0;if(!s)return o.flags&256?(Pi(o),o):(Pi(o),null);if((o.flags&128)!==0)throw Error(i(558))}return pe(o),null;case 13:if(g=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Fr(o),g!==null&&g.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Xe]=o}else $s(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pe(o),y=!1}else y=du(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Pi(o),o):(Pi(o),null)}return Pi(o),(o.flags&128)!==0?(o.lanes=h,o):(h=g!==null,s=s!==null&&s.memoizedState!==null,h&&(g=o.child,y=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(y=g.alternate.memoizedState.cachePool.pool),A=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==y&&(g.flags|=2048)),h!==s&&h&&(o.child.flags|=8192),tc(o,o.updateQueue),pe(o),null);case 4:return lt(),s===null&&Td(o.stateNode.containerInfo),pe(o),null;case 10:return In(o.type),pe(o),null;case 19:if(j(Ce),g=o.memoizedState,g===null)return pe(o),null;if(y=(o.flags&128)!==0,A=g.rendering,A===null)if(y)no(g,!1);else{if(we!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(A=zl(s),A!==null){for(o.flags|=128,no(g,!1),s=A.updateQueue,o.updateQueue=s,tc(o,s),o.subtreeFlags=0,s=h,h=o.child;h!==null;)Cg(h,s),h=h.sibling;return K(Ce,Ce.current&1|2),Xt&&Pn(o,g.treeForkCount),o.child}s=s.sibling}g.tail!==null&&ci()>rc&&(o.flags|=128,y=!0,no(g,!1),o.lanes=4194304)}else{if(!y)if(s=zl(A),s!==null){if(o.flags|=128,y=!0,s=s.updateQueue,o.updateQueue=s,tc(o,s),no(g,!0),g.tail===null&&g.tailMode==="hidden"&&!A.alternate&&!Xt)return pe(o),null}else 2*ci()-g.renderingStartTime>rc&&h!==536870912&&(o.flags|=128,y=!0,no(g,!1),o.lanes=4194304);g.isBackwards?(A.sibling=o.child,o.child=A):(s=g.last,s!==null?s.sibling=A:o.child=A,g.last=A)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ci(),s.sibling=null,h=Ce.current,K(Ce,y?h&1|2:h&1),Xt&&Pn(o,g.treeForkCount),s):(pe(o),null);case 22:case 23:return Pi(o),Cu(),g=o.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(h&536870912)!==0&&(o.flags&128)===0&&(pe(o),o.subtreeFlags&6&&(o.flags|=8192)):pe(o),h=o.updateQueue,h!==null&&tc(o,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==h&&(o.flags|=2048),s!==null&&j(Xs),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),In(Me),pe(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function bE(s,o){switch(hu(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return In(Me),lt(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return dt(o),null;case 31:if(o.memoizedState!==null){if(Pi(o),o.alternate===null)throw Error(i(340));$s()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(Pi(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));$s()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return j(Ce),null;case 4:return lt(),null;case 10:return In(o.type),null;case 22:case 23:return Pi(o),Cu(),s!==null&&j(Xs),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return In(Me),null;case 25:return null;default:return null}}function Zm(s,o){switch(hu(o),o.tag){case 3:In(Me),lt();break;case 26:case 27:case 5:dt(o);break;case 4:lt();break;case 31:o.memoizedState!==null&&Pi(o);break;case 13:Pi(o);break;case 19:j(Ce);break;case 10:In(o.type);break;case 22:case 23:Pi(o),Cu(),s!==null&&j(Xs);break;case 24:In(Me)}}function so(s,o){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var y=g.next;h=y;do{if((h.tag&s)===s){g=void 0;var A=h.create,x=h.inst;g=A(),x.destroy=g}h=h.next}while(h!==y)}}catch(O){ee(o,o.return,O)}}function fs(s,o,h){try{var g=o.updateQueue,y=g!==null?g.lastEffect:null;if(y!==null){var A=y.next;g=A;do{if((g.tag&s)===s){var x=g.inst,O=x.destroy;if(O!==void 0){x.destroy=void 0,y=o;var F=h,X=O;try{X()}catch(tt){ee(y,F,tt)}}}g=g.next}while(g!==A)}}catch(tt){ee(o,o.return,tt)}}function Jm(s){var o=s.updateQueue;if(o!==null){var h=s.stateNode;try{$g(o,h)}catch(g){ee(s,s.return,g)}}}function tv(s,o,h){h.props=Qs(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(g){ee(s,o,g)}}function ro(s,o){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof h=="function"?s.refCleanup=h(g):h.current=g}}catch(y){ee(s,o,y)}}function yn(s,o){var h=s.ref,g=s.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(y){ee(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){ee(s,o,y)}else h.current=null}function ev(s){var o=s.type,h=s.memoizedProps,g=s.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break t;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(y){ee(s,s.return,y)}}function nd(s,o,h){try{var g=s.stateNode;zE(g,s.type,h,o),g[vi]=o}catch(y){ee(s,s.return,y)}}function iv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&As(s.type)||s.tag===4}function sd(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||iv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&As(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function rd(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(s),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Mn));else if(g!==4&&(g===27&&As(s.type)&&(h=s.stateNode,o=null),s=s.child,s!==null))for(rd(s,o,h),s=s.sibling;s!==null;)rd(s,o,h),s=s.sibling}function ec(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?h.insertBefore(s,o):h.appendChild(s);else if(g!==4&&(g===27&&As(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(ec(s,o,h),s=s.sibling;s!==null;)ec(s,o,h),s=s.sibling}function nv(s){var o=s.stateNode,h=s.memoizedProps;try{for(var g=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);qe(o,g,h),o[Xe]=s,o[vi]=h}catch(A){ee(s,s.return,A)}}var Hn=!1,Pe=!1,ad=!1,sv=typeof WeakSet=="function"?WeakSet:Set,$e=null;function AE(s,o){if(s=s.containerInfo,Rd=Ec,s=mg(s),Jh(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else t:{h=(h=s.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var y=g.anchorOffset,A=g.focusNode;g=g.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break t}var x=0,O=-1,F=-1,X=0,tt=0,it=s,Y=null;e:for(;;){for(var W;it!==h||y!==0&&it.nodeType!==3||(O=x+y),it!==A||g!==0&&it.nodeType!==3||(F=x+g),it.nodeType===3&&(x+=it.nodeValue.length),(W=it.firstChild)!==null;)Y=it,it=W;for(;;){if(it===s)break e;if(Y===h&&++X===y&&(O=x),Y===A&&++tt===g&&(F=x),(W=it.nextSibling)!==null)break;it=Y,Y=it.parentNode}it=W}h=O===-1||F===-1?null:{start:O,end:F}}else h=null}h=h||{start:0,end:0}}else h=null;for(_d={focusedElem:s,selectionRange:h},Ec=!1,$e=o;$e!==null;)if(o=$e,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,$e=s;else for(;$e!==null;){switch(o=$e,A=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(h=0;h<s.length;h++)y=s[h],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,h=o,y=A.memoizedProps,A=A.memoizedState,g=h.stateNode;try{var vt=Qs(h.type,y);s=g.getSnapshotBeforeUpdate(vt,A),g.__reactInternalSnapshotBeforeUpdate=s}catch(wt){ee(h,h.return,wt)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,h=s.nodeType,h===9)Od(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Od(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,$e=s;break}$e=o.return}}function rv(s,o,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:jn(s,h),g&4&&so(5,h);break;case 1:if(jn(s,h),g&4)if(s=h.stateNode,o===null)try{s.componentDidMount()}catch(x){ee(h,h.return,x)}else{var y=Qs(h.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(x){ee(h,h.return,x)}}g&64&&Jm(h),g&512&&ro(h,h.return);break;case 3:if(jn(s,h),g&64&&(s=h.updateQueue,s!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{$g(s,o)}catch(x){ee(h,h.return,x)}}break;case 27:o===null&&g&4&&nv(h);case 26:case 5:jn(s,h),o===null&&g&4&&ev(h),g&512&&ro(h,h.return);break;case 12:jn(s,h);break;case 31:jn(s,h),g&4&&lv(s,h);break;case 13:jn(s,h),g&4&&cv(s,h),g&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=DE.bind(null,h),KE(s,h))));break;case 22:if(g=h.memoizedState!==null||Hn,!g){o=o!==null&&o.memoizedState!==null||Pe,y=Hn;var A=Pe;Hn=g,(Pe=o)&&!A?$n(s,h,(h.subtreeFlags&8772)!==0):jn(s,h),Hn=y,Pe=A}break;case 30:break;default:jn(s,h)}}function av(s){var o=s.alternate;o!==null&&(s.alternate=null,av(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&kh(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ge=null,bi=!1;function zn(s,o,h){for(h=h.child;h!==null;)ov(s,o,h),h=h.sibling}function ov(s,o,h){if(_i&&typeof _i.onCommitFiberUnmount=="function")try{_i.onCommitFiberUnmount(Da,h)}catch{}switch(h.tag){case 26:Pe||yn(h,o),zn(s,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Pe||yn(h,o);var g=ge,y=bi;As(h.type)&&(ge=h.stateNode,bi=!1),zn(s,o,h),go(h.stateNode),ge=g,bi=y;break;case 5:Pe||yn(h,o);case 6:if(g=ge,y=bi,ge=null,zn(s,o,h),ge=g,bi=y,ge!==null)if(bi)try{(ge.nodeType===9?ge.body:ge.nodeName==="HTML"?ge.ownerDocument.body:ge).removeChild(h.stateNode)}catch(A){ee(h,o,A)}else try{ge.removeChild(h.stateNode)}catch(A){ee(h,o,A)}break;case 18:ge!==null&&(bi?(s=ge,Jv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),sa(s)):Jv(ge,h.stateNode));break;case 4:g=ge,y=bi,ge=h.stateNode.containerInfo,bi=!0,zn(s,o,h),ge=g,bi=y;break;case 0:case 11:case 14:case 15:fs(2,h,o),Pe||fs(4,h,o),zn(s,o,h);break;case 1:Pe||(yn(h,o),g=h.stateNode,typeof g.componentWillUnmount=="function"&&tv(h,o,g)),zn(s,o,h);break;case 21:zn(s,o,h);break;case 22:Pe=(g=Pe)||h.memoizedState!==null,zn(s,o,h),Pe=g;break;default:zn(s,o,h)}}function lv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{sa(s)}catch(h){ee(o,o.return,h)}}}function cv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{sa(s)}catch(h){ee(o,o.return,h)}}function SE(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new sv),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new sv),o;default:throw Error(i(435,s.tag))}}function ic(s,o){var h=SE(s);o.forEach(function(g){if(!h.has(g)){h.add(g);var y=ME.bind(null,s,g);g.then(y,y)}})}function Ai(s,o){var h=o.deletions;if(h!==null)for(var g=0;g<h.length;g++){var y=h[g],A=s,x=o,O=x;t:for(;O!==null;){switch(O.tag){case 27:if(As(O.type)){ge=O.stateNode,bi=!1;break t}break;case 5:ge=O.stateNode,bi=!1;break t;case 3:case 4:ge=O.stateNode.containerInfo,bi=!0;break t}O=O.return}if(ge===null)throw Error(i(160));ov(A,x,y),ge=null,bi=!1,A=y.alternate,A!==null&&(A.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)hv(o,s),o=o.sibling}var un=null;function hv(s,o){var h=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ai(o,s),Si(s),g&4&&(fs(3,s,s.return),so(3,s),fs(5,s,s.return));break;case 1:Ai(o,s),Si(s),g&512&&(Pe||h===null||yn(h,h.return)),g&64&&Hn&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var y=un;if(Ai(o,s),Si(s),g&512&&(Pe||h===null||yn(h,h.return)),g&4){var A=h!==null?h.memoizedState:null;if(g=s.memoizedState,h===null)if(g===null)if(s.stateNode===null){t:{g=s.type,h=s.memoizedProps,y=y.ownerDocument||y;e:switch(g){case"title":A=y.getElementsByTagName("title")[0],(!A||A[La]||A[Xe]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=y.createElement(g),y.head.insertBefore(A,y.querySelector("head > title"))),qe(A,g,h),A[Xe]=s,je(A),g=A;break t;case"link":var x=hy("link","href",y).get(g+(h.href||""));if(x){for(var O=0;O<x.length;O++)if(A=x[O],A.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&A.getAttribute("rel")===(h.rel==null?null:h.rel)&&A.getAttribute("title")===(h.title==null?null:h.title)&&A.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){x.splice(O,1);break e}}A=y.createElement(g),qe(A,g,h),y.head.appendChild(A);break;case"meta":if(x=hy("meta","content",y).get(g+(h.content||""))){for(O=0;O<x.length;O++)if(A=x[O],A.getAttribute("content")===(h.content==null?null:""+h.content)&&A.getAttribute("name")===(h.name==null?null:h.name)&&A.getAttribute("property")===(h.property==null?null:h.property)&&A.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&A.getAttribute("charset")===(h.charSet==null?null:h.charSet)){x.splice(O,1);break e}}A=y.createElement(g),qe(A,g,h),y.head.appendChild(A);break;default:throw Error(i(468,g))}A[Xe]=s,je(A),g=A}s.stateNode=g}else uy(y,s.type,s.stateNode);else s.stateNode=cy(y,g,s.memoizedProps);else A!==g?(A===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):A.count--,g===null?uy(y,s.type,s.stateNode):cy(y,g,s.memoizedProps)):g===null&&s.stateNode!==null&&nd(s,s.memoizedProps,h.memoizedProps)}break;case 27:Ai(o,s),Si(s),g&512&&(Pe||h===null||yn(h,h.return)),h!==null&&g&4&&nd(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Ai(o,s),Si(s),g&512&&(Pe||h===null||yn(h,h.return)),s.flags&32){y=s.stateNode;try{Rr(y,"")}catch(vt){ee(s,s.return,vt)}}g&4&&s.stateNode!=null&&(y=s.memoizedProps,nd(s,y,h!==null?h.memoizedProps:y)),g&1024&&(ad=!0);break;case 6:if(Ai(o,s),Si(s),g&4){if(s.stateNode===null)throw Error(i(162));g=s.memoizedProps,h=s.stateNode;try{h.nodeValue=g}catch(vt){ee(s,s.return,vt)}}break;case 3:if(yc=null,y=un,un=mc(o.containerInfo),Ai(o,s),un=y,Si(s),g&4&&h!==null&&h.memoizedState.isDehydrated)try{sa(o.containerInfo)}catch(vt){ee(s,s.return,vt)}ad&&(ad=!1,uv(s));break;case 4:g=un,un=mc(s.stateNode.containerInfo),Ai(o,s),Si(s),un=g;break;case 12:Ai(o,s),Si(s);break;case 31:Ai(o,s),Si(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,ic(s,g)));break;case 13:Ai(o,s),Si(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(sc=ci()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,ic(s,g)));break;case 22:y=s.memoizedState!==null;var F=h!==null&&h.memoizedState!==null,X=Hn,tt=Pe;if(Hn=X||y,Pe=tt||F,Ai(o,s),Pe=tt,Hn=X,Si(s),g&8192)t:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(h===null||F||Hn||Pe||Zs(s)),h=null,o=s;;){if(o.tag===5||o.tag===26){if(h===null){F=h=o;try{if(A=F.stateNode,y)x=A.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{O=F.stateNode;var it=F.memoizedProps.style,Y=it!=null&&it.hasOwnProperty("display")?it.display:null;O.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(vt){ee(F,F.return,vt)}}}else if(o.tag===6){if(h===null){F=o;try{F.stateNode.nodeValue=y?"":F.memoizedProps}catch(vt){ee(F,F.return,vt)}}}else if(o.tag===18){if(h===null){F=o;try{var W=F.stateNode;y?ty(W,!0):ty(F.stateNode,!1)}catch(vt){ee(F,F.return,vt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break t;for(;o.sibling===null;){if(o.return===null||o.return===s)break t;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=s.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,ic(s,h))));break;case 19:Ai(o,s),Si(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,ic(s,g)));break;case 30:break;case 21:break;default:Ai(o,s),Si(s)}}function Si(s){var o=s.flags;if(o&2){try{for(var h,g=s.return;g!==null;){if(iv(g)){h=g;break}g=g.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var y=h.stateNode,A=sd(s);ec(s,A,y);break;case 5:var x=h.stateNode;h.flags&32&&(Rr(x,""),h.flags&=-33);var O=sd(s);ec(s,O,x);break;case 3:case 4:var F=h.stateNode.containerInfo,X=sd(s);rd(s,X,F);break;default:throw Error(i(161))}}catch(tt){ee(s,s.return,tt)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function uv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;uv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function jn(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)rv(s,o.alternate,o),o=o.sibling}function Zs(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:fs(4,o,o.return),Zs(o);break;case 1:yn(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&tv(o,o.return,h),Zs(o);break;case 27:go(o.stateNode);case 26:case 5:yn(o,o.return),Zs(o);break;case 22:o.memoizedState===null&&Zs(o);break;case 30:Zs(o);break;default:Zs(o)}s=s.sibling}}function $n(s,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,y=s,A=o,x=A.flags;switch(A.tag){case 0:case 11:case 15:$n(y,A,h),so(4,A);break;case 1:if($n(y,A,h),g=A,y=g.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(X){ee(g,g.return,X)}if(g=A,y=g.updateQueue,y!==null){var O=g.stateNode;try{var F=y.shared.hiddenCallbacks;if(F!==null)for(y.shared.hiddenCallbacks=null,y=0;y<F.length;y++)jg(F[y],O)}catch(X){ee(g,g.return,X)}}h&&x&64&&Jm(A),ro(A,A.return);break;case 27:nv(A);case 26:case 5:$n(y,A,h),h&&g===null&&x&4&&ev(A),ro(A,A.return);break;case 12:$n(y,A,h);break;case 31:$n(y,A,h),h&&x&4&&lv(y,A);break;case 13:$n(y,A,h),h&&x&4&&cv(y,A);break;case 22:A.memoizedState===null&&$n(y,A,h),ro(A,A.return);break;case 30:break;default:$n(y,A,h)}o=o.sibling}}function od(s,o){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Va(h))}function ld(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Va(s))}function dn(s,o,h,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)dv(s,o,h,g),o=o.sibling}function dv(s,o,h,g){var y=o.flags;switch(o.tag){case 0:case 11:case 15:dn(s,o,h,g),y&2048&&so(9,o);break;case 1:dn(s,o,h,g);break;case 3:dn(s,o,h,g),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Va(s)));break;case 12:if(y&2048){dn(s,o,h,g),s=o.stateNode;try{var A=o.memoizedProps,x=A.id,O=A.onPostCommit;typeof O=="function"&&O(x,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(F){ee(o,o.return,F)}}else dn(s,o,h,g);break;case 31:dn(s,o,h,g);break;case 13:dn(s,o,h,g);break;case 23:break;case 22:A=o.stateNode,x=o.alternate,o.memoizedState!==null?A._visibility&2?dn(s,o,h,g):ao(s,o):A._visibility&2?dn(s,o,h,g):(A._visibility|=2,Yr(s,o,h,g,(o.subtreeFlags&10256)!==0||!1)),y&2048&&od(x,o);break;case 24:dn(s,o,h,g),y&2048&&ld(o.alternate,o);break;default:dn(s,o,h,g)}}function Yr(s,o,h,g,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var A=s,x=o,O=h,F=g,X=x.flags;switch(x.tag){case 0:case 11:case 15:Yr(A,x,O,F,y),so(8,x);break;case 23:break;case 22:var tt=x.stateNode;x.memoizedState!==null?tt._visibility&2?Yr(A,x,O,F,y):ao(A,x):(tt._visibility|=2,Yr(A,x,O,F,y)),y&&X&2048&&od(x.alternate,x);break;case 24:Yr(A,x,O,F,y),y&&X&2048&&ld(x.alternate,x);break;default:Yr(A,x,O,F,y)}o=o.sibling}}function ao(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=s,g=o,y=g.flags;switch(g.tag){case 22:ao(h,g),y&2048&&od(g.alternate,g);break;case 24:ao(h,g),y&2048&&ld(g.alternate,g);break;default:ao(h,g)}o=o.sibling}}var oo=8192;function Wr(s,o,h){if(s.subtreeFlags&oo)for(s=s.child;s!==null;)fv(s,o,h),s=s.sibling}function fv(s,o,h){switch(s.tag){case 26:Wr(s,o,h),s.flags&oo&&s.memoizedState!==null&&o1(h,un,s.memoizedState,s.memoizedProps);break;case 5:Wr(s,o,h);break;case 3:case 4:var g=un;un=mc(s.stateNode.containerInfo),Wr(s,o,h),un=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=oo,oo=16777216,Wr(s,o,h),oo=g):Wr(s,o,h));break;default:Wr(s,o,h)}}function pv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function lo(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];$e=g,mv(g,s)}pv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)gv(s),s=s.sibling}function gv(s){switch(s.tag){case 0:case 11:case 15:lo(s),s.flags&2048&&fs(9,s,s.return);break;case 3:lo(s);break;case 12:lo(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,nc(s)):lo(s);break;default:lo(s)}}function nc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];$e=g,mv(g,s)}pv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:fs(8,o,o.return),nc(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,nc(o));break;default:nc(o)}s=s.sibling}}function mv(s,o){for(;$e!==null;){var h=$e;switch(h.tag){case 0:case 11:case 15:fs(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Va(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,$e=g;else t:for(h=s;$e!==null;){g=$e;var y=g.sibling,A=g.return;if(av(g),g===h){$e=null;break t}if(y!==null){y.return=A,$e=y;break t}$e=A}}}var EE={getCacheForType:function(s){var o=We(Me),h=o.data.get(s);return h===void 0&&(h=s(),o.data.set(s,h)),h},cacheSignal:function(){return We(Me).controller.signal}},wE=typeof WeakMap=="function"?WeakMap:Map,Zt=0,ae=null,zt=null,$t=0,te=0,Ni=null,ps=!1,Kr=!1,cd=!1,Gn=0,we=0,gs=0,Js=0,hd=0,Ii=0,qr=0,co=null,Ei=null,ud=!1,sc=0,vv=0,rc=1/0,ac=null,ms=null,Fe=0,vs=null,Qr=null,Vn=0,dd=0,fd=null,yv=null,ho=0,pd=null;function ki(){return(Zt&2)!==0&&$t!==0?$t&-$t:N.T!==null?Ad():Np()}function bv(){if(Ii===0)if(($t&536870912)===0||Xt){var s=pl;pl<<=1,(pl&3932160)===0&&(pl=262144),Ii=s}else Ii=536870912;return s=Li.current,s!==null&&(s.flags|=32),Ii}function wi(s,o,h){(s===ae&&(te===2||te===9)||s.cancelPendingCommit!==null)&&(Zr(s,0),ys(s,$t,Ii,!1)),Oa(s,h),((Zt&2)===0||s!==ae)&&(s===ae&&((Zt&2)===0&&(Js|=h),we===4&&ys(s,$t,Ii,!1)),bn(s))}function Av(s,o,h){if((Zt&6)!==0)throw Error(i(327));var g=!h&&(o&127)===0&&(o&s.expiredLanes)===0||Ma(s,o),y=g?xE(s,o):md(s,o,!0),A=g;do{if(y===0){Kr&&!g&&ys(s,o,0,!1);break}else{if(h=s.current.alternate,A&&!TE(h)){y=md(s,o,!1),A=!1;continue}if(y===2){if(A=o,s.errorRecoveryDisabledLanes&A)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){o=x;t:{var O=s;y=co;var F=O.current.memoizedState.isDehydrated;if(F&&(Zr(O,x).flags|=256),x=md(O,x,!1),x!==2){if(cd&&!F){O.errorRecoveryDisabledLanes|=A,Js|=A,y=4;break t}A=Ei,Ei=y,A!==null&&(Ei===null?Ei=A:Ei.push.apply(Ei,A))}y=x}if(A=!1,y!==2)continue}}if(y===1){Zr(s,0),ys(s,o,0,!0);break}t:{switch(g=s,A=y,A){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:ys(g,o,Ii,!ps);break t;case 2:Ei=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(y=sc+300-ci(),10<y)){if(ys(g,o,Ii,!ps),ml(g,0,!0)!==0)break t;Vn=o,g.timeoutHandle=Qv(Sv.bind(null,g,h,Ei,ac,ud,o,Ii,Js,qr,ps,A,"Throttled",-0,0),y);break t}Sv(g,h,Ei,ac,ud,o,Ii,Js,qr,ps,A,null,-0,0)}}break}while(!0);bn(s)}function Sv(s,o,h,g,y,A,x,O,F,X,tt,it,Y,W){if(s.timeoutHandle=-1,it=o.subtreeFlags,it&8192||(it&16785408)===16785408){it={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mn},fv(o,A,it);var vt=(A&62914560)===A?sc-ci():(A&4194048)===A?vv-ci():0;if(vt=l1(it,vt),vt!==null){Vn=A,s.cancelPendingCommit=vt(Dv.bind(null,s,o,A,h,g,y,x,O,F,tt,it,null,Y,W)),ys(s,A,x,!X);return}}Dv(s,o,A,h,g,y,x,O,F)}function TE(s){for(var o=s;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var y=h[g],A=y.getSnapshot;y=y.value;try{if(!Mi(A(),y))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ys(s,o,h,g){o&=~hd,o&=~Js,s.suspendedLanes|=o,s.pingedLanes&=~o,g&&(s.warmLanes|=o),g=s.expirationTimes;for(var y=o;0<y;){var A=31-Di(y),x=1<<A;g[A]=-1,y&=~x}h!==0&&Op(s,h,o)}function oc(){return(Zt&6)===0?(uo(0),!1):!0}function gd(){if(zt!==null){if(te===0)var s=zt.return;else s=zt,Nn=Gs=null,Ou(s),jr=null,Ya=0,s=zt;for(;s!==null;)Zm(s.alternate,s),s=s.return;zt=null}}function Zr(s,o){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,GE(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Vn=0,gd(),ae=s,zt=h=Ln(s.current,null),$t=o,te=0,Ni=null,ps=!1,Kr=Ma(s,o),cd=!1,qr=Ii=hd=Js=gs=we=0,Ei=co=null,ud=!1,(o&8)!==0&&(o|=o&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=o;0<g;){var y=31-Di(g),A=1<<y;o|=s[y],g&=~A}return Gn=o,_l(),h}function Ev(s,o){Pt=null,N.H=eo,o===zr||o===kl?(o=Bg(),te=3):o===bu?(o=Bg(),te=4):te=o===Yu?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ni=o,zt===null&&(we=1,ql(s,Yi(o,s.current)))}function wv(){var s=Li.current;return s===null?!0:($t&4194048)===$t?Qi===null:($t&62914560)===$t||($t&536870912)!==0?s===Qi:!1}function Tv(){var s=N.H;return N.H=eo,s===null?eo:s}function Cv(){var s=N.A;return N.A=EE,s}function lc(){we=4,ps||($t&4194048)!==$t&&Li.current!==null||(Kr=!0),(gs&134217727)===0&&(Js&134217727)===0||ae===null||ys(ae,$t,Ii,!1)}function md(s,o,h){var g=Zt;Zt|=2;var y=Tv(),A=Cv();(ae!==s||$t!==o)&&(ac=null,Zr(s,o)),o=!1;var x=we;t:do try{if(te!==0&&zt!==null){var O=zt,F=Ni;switch(te){case 8:gd(),x=6;break t;case 3:case 2:case 9:case 6:Li.current===null&&(o=!0);var X=te;if(te=0,Ni=null,Jr(s,O,F,X),h&&Kr){x=0;break t}break;default:X=te,te=0,Ni=null,Jr(s,O,F,X)}}CE(),x=we;break}catch(tt){Ev(s,tt)}while(!0);return o&&s.shellSuspendCounter++,Nn=Gs=null,Zt=g,N.H=y,N.A=A,zt===null&&(ae=null,$t=0,_l()),x}function CE(){for(;zt!==null;)xv(zt)}function xE(s,o){var h=Zt;Zt|=2;var g=Tv(),y=Cv();ae!==s||$t!==o?(ac=null,rc=ci()+500,Zr(s,o)):Kr=Ma(s,o);t:do try{if(te!==0&&zt!==null){o=zt;var A=Ni;e:switch(te){case 1:te=0,Ni=null,Jr(s,o,A,1);break;case 2:case 9:if(kg(A)){te=0,Ni=null,Rv(o);break}o=function(){te!==2&&te!==9||ae!==s||(te=7),bn(s)},A.then(o,o);break t;case 3:te=7;break t;case 4:te=5;break t;case 7:kg(A)?(te=0,Ni=null,Rv(o)):(te=0,Ni=null,Jr(s,o,A,7));break;case 5:var x=null;switch(zt.tag){case 26:x=zt.memoizedState;case 5:case 27:var O=zt;if(x?dy(x):O.stateNode.complete){te=0,Ni=null;var F=O.sibling;if(F!==null)zt=F;else{var X=O.return;X!==null?(zt=X,cc(X)):zt=null}break e}}te=0,Ni=null,Jr(s,o,A,5);break;case 6:te=0,Ni=null,Jr(s,o,A,6);break;case 8:gd(),we=6;break t;default:throw Error(i(462))}}RE();break}catch(tt){Ev(s,tt)}while(!0);return Nn=Gs=null,N.H=g,N.A=y,Zt=h,zt!==null?0:(ae=null,$t=0,_l(),we)}function RE(){for(;zt!==null&&!Dh();)xv(zt)}function xv(s){var o=qm(s.alternate,s,Gn);s.memoizedProps=s.pendingProps,o===null?cc(s):zt=o}function Rv(s){var o=s,h=o.alternate;switch(o.tag){case 15:case 0:o=Gm(h,o,o.pendingProps,o.type,void 0,$t);break;case 11:o=Gm(h,o,o.pendingProps,o.type.render,o.ref,$t);break;case 5:Ou(o);default:Zm(h,o),o=zt=Cg(o,Gn),o=qm(h,o,Gn)}s.memoizedProps=s.pendingProps,o===null?cc(s):zt=o}function Jr(s,o,h,g){Nn=Gs=null,Ou(o),jr=null,Ya=0;var y=o.return;try{if(gE(s,y,o,h,$t)){we=1,ql(s,Yi(h,s.current)),zt=null;return}}catch(A){if(y!==null)throw zt=y,A;we=1,ql(s,Yi(h,s.current)),zt=null;return}o.flags&32768?(Xt||g===1?s=!0:Kr||($t&536870912)!==0?s=!1:(ps=s=!0,(g===2||g===9||g===3||g===6)&&(g=Li.current,g!==null&&g.tag===13&&(g.flags|=16384))),_v(o,s)):cc(o)}function cc(s){var o=s;do{if((o.flags&32768)!==0){_v(o,ps);return}s=o.return;var h=yE(o.alternate,o,Gn);if(h!==null){zt=h;return}if(o=o.sibling,o!==null){zt=o;return}zt=o=s}while(o!==null);we===0&&(we=5)}function _v(s,o){do{var h=bE(s.alternate,s);if(h!==null){h.flags&=32767,zt=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(s=s.sibling,s!==null)){zt=s;return}zt=s=h}while(s!==null);we=6,zt=null}function Dv(s,o,h,g,y,A,x,O,F){s.cancelPendingCommit=null;do hc();while(Fe!==0);if((Zt&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(A=o.lanes|o.childLanes,A|=su,aS(s,h,A,x,O,F),s===ae&&(zt=ae=null,$t=0),Qr=o,vs=s,Vn=h,dd=A,fd=y,yv=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,OE(cn,function(){return Nv(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=N.T,N.T=null,y=I.p,I.p=2,x=Zt,Zt|=4;try{AE(s,o,h)}finally{Zt=x,I.p=y,N.T=g}}Fe=1,Mv(),Ov(),Lv()}}function Mv(){if(Fe===1){Fe=0;var s=vs,o=Qr,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=N.T,N.T=null;var g=I.p;I.p=2;var y=Zt;Zt|=4;try{hv(o,s);var A=_d,x=mg(s.containerInfo),O=A.focusedElem,F=A.selectionRange;if(x!==O&&O&&O.ownerDocument&&gg(O.ownerDocument.documentElement,O)){if(F!==null&&Jh(O)){var X=F.start,tt=F.end;if(tt===void 0&&(tt=X),"selectionStart"in O)O.selectionStart=X,O.selectionEnd=Math.min(tt,O.value.length);else{var it=O.ownerDocument||document,Y=it&&it.defaultView||window;if(Y.getSelection){var W=Y.getSelection(),vt=O.textContent.length,wt=Math.min(F.start,vt),se=F.end===void 0?wt:Math.min(F.end,vt);!W.extend&&wt>se&&(x=se,se=wt,wt=x);var z=pg(O,wt),H=pg(O,se);if(z&&H&&(W.rangeCount!==1||W.anchorNode!==z.node||W.anchorOffset!==z.offset||W.focusNode!==H.node||W.focusOffset!==H.offset)){var G=it.createRange();G.setStart(z.node,z.offset),W.removeAllRanges(),wt>se?(W.addRange(G),W.extend(H.node,H.offset)):(G.setEnd(H.node,H.offset),W.addRange(G))}}}}for(it=[],W=O;W=W.parentNode;)W.nodeType===1&&it.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<it.length;O++){var et=it[O];et.element.scrollLeft=et.left,et.element.scrollTop=et.top}}Ec=!!Rd,_d=Rd=null}finally{Zt=y,I.p=g,N.T=h}}s.current=o,Fe=2}}function Ov(){if(Fe===2){Fe=0;var s=vs,o=Qr,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=N.T,N.T=null;var g=I.p;I.p=2;var y=Zt;Zt|=4;try{rv(s,o.alternate,o)}finally{Zt=y,I.p=g,N.T=h}}Fe=3}}function Lv(){if(Fe===4||Fe===3){Fe=0,Mh();var s=vs,o=Qr,h=Vn,g=yv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Fe=5:(Fe=0,Qr=vs=null,Pv(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(ms=null),Nh(h),o=o.stateNode,_i&&typeof _i.onCommitFiberRoot=="function")try{_i.onCommitFiberRoot(Da,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=N.T,y=I.p,I.p=2,N.T=null;try{for(var A=s.onRecoverableError,x=0;x<g.length;x++){var O=g[x];A(O.value,{componentStack:O.stack})}}finally{N.T=o,I.p=y}}(Vn&3)!==0&&hc(),bn(s),y=s.pendingLanes,(h&261930)!==0&&(y&42)!==0?s===pd?ho++:(ho=0,pd=s):ho=0,uo(0)}}function Pv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Va(o)))}function hc(){return Mv(),Ov(),Lv(),Nv()}function Nv(){if(Fe!==5)return!1;var s=vs,o=dd;dd=0;var h=Nh(Vn),g=N.T,y=I.p;try{I.p=32>h?32:h,N.T=null,h=fd,fd=null;var A=vs,x=Vn;if(Fe=0,Qr=vs=null,Vn=0,(Zt&6)!==0)throw Error(i(331));var O=Zt;if(Zt|=4,gv(A.current),dv(A,A.current,x,h),Zt=O,uo(0,!1),_i&&typeof _i.onPostCommitFiberRoot=="function")try{_i.onPostCommitFiberRoot(Da,A)}catch{}return!0}finally{I.p=y,N.T=g,Pv(s,o)}}function Iv(s,o,h){o=Yi(h,o),o=Xu(s.stateNode,o,2),s=hs(s,o,2),s!==null&&(Oa(s,2),bn(s))}function ee(s,o,h){if(s.tag===3)Iv(s,s,h);else for(;o!==null;){if(o.tag===3){Iv(o,s,h);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ms===null||!ms.has(g))){s=Yi(h,s),h=km(2),g=hs(o,h,2),g!==null&&(Fm(h,g,o,s),Oa(g,2),bn(g));break}}o=o.return}}function vd(s,o,h){var g=s.pingCache;if(g===null){g=s.pingCache=new wE;var y=new Set;g.set(o,y)}else y=g.get(o),y===void 0&&(y=new Set,g.set(o,y));y.has(h)||(cd=!0,y.add(h),s=_E.bind(null,s,o,h),o.then(s,s))}function _E(s,o,h){var g=s.pingCache;g!==null&&g.delete(o),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,ae===s&&($t&h)===h&&(we===4||we===3&&($t&62914560)===$t&&300>ci()-sc?(Zt&2)===0&&Zr(s,0):hd|=h,qr===$t&&(qr=0)),bn(s)}function kv(s,o){o===0&&(o=Mp()),s=zs(s,o),s!==null&&(Oa(s,o),bn(s))}function DE(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),kv(s,h)}function ME(s,o){var h=0;switch(s.tag){case 31:case 13:var g=s.stateNode,y=s.memoizedState;y!==null&&(h=y.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(i(314))}g!==null&&g.delete(o),kv(s,h)}function OE(s,o){return _a(s,o)}var uc=null,ta=null,yd=!1,dc=!1,bd=!1,bs=0;function bn(s){s!==ta&&s.next===null&&(ta===null?uc=ta=s:ta=ta.next=s),dc=!0,yd||(yd=!0,PE())}function uo(s,o){if(!bd&&dc){bd=!0;do for(var h=!1,g=uc;g!==null;){if(s!==0){var y=g.pendingLanes;if(y===0)var A=0;else{var x=g.suspendedLanes,O=g.pingedLanes;A=(1<<31-Di(42|s)+1)-1,A&=y&~(x&~O),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(h=!0,Hv(g,A))}else A=$t,A=ml(g,g===ae?A:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(A&3)===0||Ma(g,A)||(h=!0,Hv(g,A));g=g.next}while(h);bd=!1}}function LE(){Fv()}function Fv(){dc=yd=!1;var s=0;bs!==0&&$E()&&(s=bs);for(var o=ci(),h=null,g=uc;g!==null;){var y=g.next,A=Bv(g,o);A===0?(g.next=null,h===null?uc=y:h.next=y,y===null&&(ta=h)):(h=g,(s!==0||(A&3)!==0)&&(dc=!0)),g=y}Fe!==0&&Fe!==5||uo(s),bs!==0&&(bs=0)}function Bv(s,o){for(var h=s.suspendedLanes,g=s.pingedLanes,y=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var x=31-Di(A),O=1<<x,F=y[x];F===-1?((O&h)===0||(O&g)!==0)&&(y[x]=rS(O,o)):F<=o&&(s.expiredLanes|=O),A&=~O}if(o=ae,h=$t,h=ml(s,s===o?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,h===0||s===o&&(te===2||te===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&ts(g),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||Ma(s,h)){if(o=h&-h,o===s.callbackPriority)return o;switch(g!==null&&ts(g),Nh(h)){case 2:case 8:h=ln;break;case 32:h=cn;break;case 268435456:h=Ar;break;default:h=cn}return g=Uv.bind(null,s),h=_a(h,g),s.callbackPriority=o,s.callbackNode=h,o}return g!==null&&g!==null&&ts(g),s.callbackPriority=2,s.callbackNode=null,2}function Uv(s,o){if(Fe!==0&&Fe!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(hc()&&s.callbackNode!==h)return null;var g=$t;return g=ml(s,s===ae?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(Av(s,g,o),Bv(s,ci()),s.callbackNode!=null&&s.callbackNode===h?Uv.bind(null,s):null)}function Hv(s,o){if(hc())return null;Av(s,o,!0)}function PE(){VE(function(){(Zt&6)!==0?_a(dl,LE):Fv()})}function Ad(){if(bs===0){var s=Ur;s===0&&(s=fl,fl<<=1,(fl&261888)===0&&(fl=256)),bs=s}return bs}function zv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Al(""+s)}function jv(s,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,s.id&&h.setAttribute("form",s.id),o.parentNode.insertBefore(h,o),s=new FormData(s),h.parentNode.removeChild(h),s}function NE(s,o,h,g,y){if(o==="submit"&&h&&h.stateNode===y){var A=zv((y[vi]||null).action),x=g.submitter;x&&(o=(o=x[vi]||null)?zv(o.formAction):x.getAttribute("formAction"),o!==null&&(A=o,x=null));var O=new Tl("action","action",null,g,y);s.push({event:O,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(bs!==0){var F=x?jv(y,x):new FormData(y);Hu(h,{pending:!0,data:F,method:y.method,action:A},null,F)}}else typeof A=="function"&&(O.preventDefault(),F=x?jv(y,x):new FormData(y),Hu(h,{pending:!0,data:F,method:y.method,action:A},A,F))},currentTarget:y}]})}}for(var Sd=0;Sd<nu.length;Sd++){var Ed=nu[Sd],IE=Ed.toLowerCase(),kE=Ed[0].toUpperCase()+Ed.slice(1);hn(IE,"on"+kE)}hn(bg,"onAnimationEnd"),hn(Ag,"onAnimationIteration"),hn(Sg,"onAnimationStart"),hn("dblclick","onDoubleClick"),hn("focusin","onFocus"),hn("focusout","onBlur"),hn(ZS,"onTransitionRun"),hn(JS,"onTransitionStart"),hn(tE,"onTransitionCancel"),hn(Eg,"onTransitionEnd"),Cr("onMouseEnter",["mouseout","mouseover"]),Cr("onMouseLeave",["mouseout","mouseover"]),Cr("onPointerEnter",["pointerout","pointerover"]),Cr("onPointerLeave",["pointerout","pointerover"]),Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fo));function $v(s,o){o=(o&4)!==0;for(var h=0;h<s.length;h++){var g=s[h],y=g.event;g=g.listeners;t:{var A=void 0;if(o)for(var x=g.length-1;0<=x;x--){var O=g[x],F=O.instance,X=O.currentTarget;if(O=O.listener,F!==A&&y.isPropagationStopped())break t;A=O,y.currentTarget=X;try{A(y)}catch(tt){Rl(tt)}y.currentTarget=null,A=F}else for(x=0;x<g.length;x++){if(O=g[x],F=O.instance,X=O.currentTarget,O=O.listener,F!==A&&y.isPropagationStopped())break t;A=O,y.currentTarget=X;try{A(y)}catch(tt){Rl(tt)}y.currentTarget=null,A=F}}}}function jt(s,o){var h=o[Ih];h===void 0&&(h=o[Ih]=new Set);var g=s+"__bubble";h.has(g)||(Gv(o,s,2,!1),h.add(g))}function wd(s,o,h){var g=0;o&&(g|=4),Gv(h,s,g,o)}var fc="_reactListening"+Math.random().toString(36).slice(2);function Td(s){if(!s[fc]){s[fc]=!0,Fp.forEach(function(h){h!=="selectionchange"&&(FE.has(h)||wd(h,!1,s),wd(h,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[fc]||(o[fc]=!0,wd("selectionchange",!1,o))}}function Gv(s,o,h,g){switch(by(o)){case 2:var y=u1;break;case 8:y=d1;break;default:y=Ud}h=y.bind(null,o,h,s),y=void 0,!Gh||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),g?y!==void 0?s.addEventListener(o,h,{capture:!0,passive:y}):s.addEventListener(o,h,!0):y!==void 0?s.addEventListener(o,h,{passive:y}):s.addEventListener(o,h,!1)}function Cd(s,o,h,g,y){var A=g;if((o&1)===0&&(o&2)===0&&g!==null)t:for(;;){if(g===null)return;var x=g.tag;if(x===3||x===4){var O=g.stateNode.containerInfo;if(O===y)break;if(x===4)for(x=g.return;x!==null;){var F=x.tag;if((F===3||F===4)&&x.stateNode.containerInfo===y)return;x=x.return}for(;O!==null;){if(x=Er(O),x===null)return;if(F=x.tag,F===5||F===6||F===26||F===27){g=A=x;continue t}O=O.parentNode}}g=g.return}Kp(function(){var X=A,tt=jh(h),it=[];t:{var Y=wg.get(s);if(Y!==void 0){var W=Tl,vt=s;switch(s){case"keypress":if(El(h)===0)break t;case"keydown":case"keyup":W=MS;break;case"focusin":vt="focus",W=Wh;break;case"focusout":vt="blur",W=Wh;break;case"beforeblur":case"afterblur":W=Wh;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=Zp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=yS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=PS;break;case bg:case Ag:case Sg:W=SS;break;case Eg:W=IS;break;case"scroll":case"scrollend":W=mS;break;case"wheel":W=FS;break;case"copy":case"cut":case"paste":W=wS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=tg;break;case"toggle":case"beforetoggle":W=US}var wt=(o&4)!==0,se=!wt&&(s==="scroll"||s==="scrollend"),z=wt?Y!==null?Y+"Capture":null:Y;wt=[];for(var H=X,G;H!==null;){var et=H;if(G=et.stateNode,et=et.tag,et!==5&&et!==26&&et!==27||G===null||z===null||(et=Na(H,z),et!=null&&wt.push(po(H,et,G))),se)break;H=H.return}0<wt.length&&(Y=new W(Y,vt,null,h,tt),it.push({event:Y,listeners:wt}))}}if((o&7)===0){t:{if(Y=s==="mouseover"||s==="pointerover",W=s==="mouseout"||s==="pointerout",Y&&h!==zh&&(vt=h.relatedTarget||h.fromElement)&&(Er(vt)||vt[Sr]))break t;if((W||Y)&&(Y=tt.window===tt?tt:(Y=tt.ownerDocument)?Y.defaultView||Y.parentWindow:window,W?(vt=h.relatedTarget||h.toElement,W=X,vt=vt?Er(vt):null,vt!==null&&(se=r(vt),wt=vt.tag,vt!==se||wt!==5&&wt!==27&&wt!==6)&&(vt=null)):(W=null,vt=X),W!==vt)){if(wt=Zp,et="onMouseLeave",z="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(wt=tg,et="onPointerLeave",z="onPointerEnter",H="pointer"),se=W==null?Y:Pa(W),G=vt==null?Y:Pa(vt),Y=new wt(et,H+"leave",W,h,tt),Y.target=se,Y.relatedTarget=G,et=null,Er(tt)===X&&(wt=new wt(z,H+"enter",vt,h,tt),wt.target=G,wt.relatedTarget=se,et=wt),se=et,W&&vt)e:{for(wt=BE,z=W,H=vt,G=0,et=z;et;et=wt(et))G++;et=0;for(var St=H;St;St=wt(St))et++;for(;0<G-et;)z=wt(z),G--;for(;0<et-G;)H=wt(H),et--;for(;G--;){if(z===H||H!==null&&z===H.alternate){wt=z;break e}z=wt(z),H=wt(H)}wt=null}else wt=null;W!==null&&Vv(it,Y,W,wt,!1),vt!==null&&se!==null&&Vv(it,se,vt,wt,!0)}}t:{if(Y=X?Pa(X):window,W=Y.nodeName&&Y.nodeName.toLowerCase(),W==="select"||W==="input"&&Y.type==="file")var qt=lg;else if(ag(Y))if(cg)qt=KS;else{qt=YS;var yt=XS}else W=Y.nodeName,!W||W.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?X&&Hh(X.elementType)&&(qt=lg):qt=WS;if(qt&&(qt=qt(s,X))){og(it,qt,h,tt);break t}yt&&yt(s,Y,X),s==="focusout"&&X&&Y.type==="number"&&X.memoizedProps.value!=null&&Uh(Y,"number",Y.value)}switch(yt=X?Pa(X):window,s){case"focusin":(ag(yt)||yt.contentEditable==="true")&&(Or=yt,tu=X,ja=null);break;case"focusout":ja=tu=Or=null;break;case"mousedown":eu=!0;break;case"contextmenu":case"mouseup":case"dragend":eu=!1,vg(it,h,tt);break;case"selectionchange":if(QS)break;case"keydown":case"keyup":vg(it,h,tt)}var kt;if(qh)t:{switch(s){case"compositionstart":var Gt="onCompositionStart";break t;case"compositionend":Gt="onCompositionEnd";break t;case"compositionupdate":Gt="onCompositionUpdate";break t}Gt=void 0}else Mr?sg(s,h)&&(Gt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Gt="onCompositionStart");Gt&&(eg&&h.locale!=="ko"&&(Mr||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Mr&&(kt=qp()):(ns=tt,Vh="value"in ns?ns.value:ns.textContent,Mr=!0)),yt=pc(X,Gt),0<yt.length&&(Gt=new Jp(Gt,s,null,h,tt),it.push({event:Gt,listeners:yt}),kt?Gt.data=kt:(kt=rg(h),kt!==null&&(Gt.data=kt)))),(kt=zS?jS(s,h):$S(s,h))&&(Gt=pc(X,"onBeforeInput"),0<Gt.length&&(yt=new Jp("onBeforeInput","beforeinput",null,h,tt),it.push({event:yt,listeners:Gt}),yt.data=kt)),NE(it,s,X,h,tt)}$v(it,o)})}function po(s,o,h){return{instance:s,listener:o,currentTarget:h}}function pc(s,o){for(var h=o+"Capture",g=[];s!==null;){var y=s,A=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||A===null||(y=Na(s,h),y!=null&&g.unshift(po(s,y,A)),y=Na(s,o),y!=null&&g.push(po(s,y,A))),s.tag===3)return g;s=s.return}return[]}function BE(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Vv(s,o,h,g,y){for(var A=o._reactName,x=[];h!==null&&h!==g;){var O=h,F=O.alternate,X=O.stateNode;if(O=O.tag,F!==null&&F===g)break;O!==5&&O!==26&&O!==27||X===null||(F=X,y?(X=Na(h,A),X!=null&&x.unshift(po(h,X,F))):y||(X=Na(h,A),X!=null&&x.push(po(h,X,F)))),h=h.return}x.length!==0&&s.push({event:o,listeners:x})}var UE=/\r\n?/g,HE=/\u0000|\uFFFD/g;function Xv(s){return(typeof s=="string"?s:""+s).replace(UE,`
`).replace(HE,"")}function Yv(s,o){return o=Xv(o),Xv(s)===o}function ne(s,o,h,g,y,A){switch(h){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||Rr(s,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&Rr(s,""+g);break;case"className":yl(s,"class",g);break;case"tabIndex":yl(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":yl(s,h,g);break;case"style":Yp(s,g,A);break;case"data":if(o!=="object"){yl(s,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||h!=="href")){s.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(h);break}g=Al(""+g),s.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(h==="formAction"?(o!=="input"&&ne(s,o,"name",y.name,y,null),ne(s,o,"formEncType",y.formEncType,y,null),ne(s,o,"formMethod",y.formMethod,y,null),ne(s,o,"formTarget",y.formTarget,y,null)):(ne(s,o,"encType",y.encType,y,null),ne(s,o,"method",y.method,y,null),ne(s,o,"target",y.target,y,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(h);break}g=Al(""+g),s.setAttribute(h,g);break;case"onClick":g!=null&&(s.onclick=Mn);break;case"onScroll":g!=null&&jt("scroll",s);break;case"onScrollEnd":g!=null&&jt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(h=g.__html,h!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}h=Al(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,""+g):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":g===!0?s.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,g):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(h,g):s.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(h):s.setAttribute(h,g);break;case"popover":jt("beforetoggle",s),jt("toggle",s),vl(s,"popover",g);break;case"xlinkActuate":Dn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Dn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Dn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Dn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Dn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Dn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Dn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Dn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Dn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":vl(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=pS.get(h)||h,vl(s,h,g))}}function xd(s,o,h,g,y,A){switch(h){case"style":Yp(s,g,A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(h=g.__html,h!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"children":typeof g=="string"?Rr(s,g):(typeof g=="number"||typeof g=="bigint")&&Rr(s,""+g);break;case"onScroll":g!=null&&jt("scroll",s);break;case"onScrollEnd":g!=null&&jt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Mn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bp.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),o=h.slice(2,y?h.length-7:void 0),A=s[vi]||null,A=A!=null?A[h]:null,typeof A=="function"&&s.removeEventListener(o,A,y),typeof g=="function")){typeof A!="function"&&A!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(o,g,y);break t}h in s?s[h]=g:g===!0?s.setAttribute(h,""):vl(s,h,g)}}}function qe(s,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":jt("error",s),jt("load",s);var g=!1,y=!1,A;for(A in h)if(h.hasOwnProperty(A)){var x=h[A];if(x!=null)switch(A){case"src":g=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ne(s,o,A,x,h,null)}}y&&ne(s,o,"srcSet",h.srcSet,h,null),g&&ne(s,o,"src",h.src,h,null);return;case"input":jt("invalid",s);var O=A=x=y=null,F=null,X=null;for(g in h)if(h.hasOwnProperty(g)){var tt=h[g];if(tt!=null)switch(g){case"name":y=tt;break;case"type":x=tt;break;case"checked":F=tt;break;case"defaultChecked":X=tt;break;case"value":A=tt;break;case"defaultValue":O=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(i(137,o));break;default:ne(s,o,g,tt,h,null)}}$p(s,A,O,F,X,x,y,!1);return;case"select":jt("invalid",s),g=x=A=null;for(y in h)if(h.hasOwnProperty(y)&&(O=h[y],O!=null))switch(y){case"value":A=O;break;case"defaultValue":x=O;break;case"multiple":g=O;default:ne(s,o,y,O,h,null)}o=A,h=x,s.multiple=!!g,o!=null?xr(s,!!g,o,!1):h!=null&&xr(s,!!g,h,!0);return;case"textarea":jt("invalid",s),A=y=g=null;for(x in h)if(h.hasOwnProperty(x)&&(O=h[x],O!=null))switch(x){case"value":g=O;break;case"defaultValue":y=O;break;case"children":A=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:ne(s,o,x,O,h,null)}Vp(s,g,y,A);return;case"option":for(F in h)if(h.hasOwnProperty(F)&&(g=h[F],g!=null))switch(F){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:ne(s,o,F,g,h,null)}return;case"dialog":jt("beforetoggle",s),jt("toggle",s),jt("cancel",s),jt("close",s);break;case"iframe":case"object":jt("load",s);break;case"video":case"audio":for(g=0;g<fo.length;g++)jt(fo[g],s);break;case"image":jt("error",s),jt("load",s);break;case"details":jt("toggle",s);break;case"embed":case"source":case"link":jt("error",s),jt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in h)if(h.hasOwnProperty(X)&&(g=h[X],g!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ne(s,o,X,g,h,null)}return;default:if(Hh(o)){for(tt in h)h.hasOwnProperty(tt)&&(g=h[tt],g!==void 0&&xd(s,o,tt,g,h,void 0));return}}for(O in h)h.hasOwnProperty(O)&&(g=h[O],g!=null&&ne(s,o,O,g,h,null))}function zE(s,o,h,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,A=null,x=null,O=null,F=null,X=null,tt=null;for(W in h){var it=h[W];if(h.hasOwnProperty(W)&&it!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":F=it;default:g.hasOwnProperty(W)||ne(s,o,W,null,g,it)}}for(var Y in g){var W=g[Y];if(it=h[Y],g.hasOwnProperty(Y)&&(W!=null||it!=null))switch(Y){case"type":A=W;break;case"name":y=W;break;case"checked":X=W;break;case"defaultChecked":tt=W;break;case"value":x=W;break;case"defaultValue":O=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,o));break;default:W!==it&&ne(s,o,Y,W,g,it)}}Bh(s,x,O,F,X,tt,A,y);return;case"select":W=x=O=Y=null;for(A in h)if(F=h[A],h.hasOwnProperty(A)&&F!=null)switch(A){case"value":break;case"multiple":W=F;default:g.hasOwnProperty(A)||ne(s,o,A,null,g,F)}for(y in g)if(A=g[y],F=h[y],g.hasOwnProperty(y)&&(A!=null||F!=null))switch(y){case"value":Y=A;break;case"defaultValue":O=A;break;case"multiple":x=A;default:A!==F&&ne(s,o,y,A,g,F)}o=O,h=x,g=W,Y!=null?xr(s,!!h,Y,!1):!!g!=!!h&&(o!=null?xr(s,!!h,o,!0):xr(s,!!h,h?[]:"",!1));return;case"textarea":W=Y=null;for(O in h)if(y=h[O],h.hasOwnProperty(O)&&y!=null&&!g.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:ne(s,o,O,null,g,y)}for(x in g)if(y=g[x],A=h[x],g.hasOwnProperty(x)&&(y!=null||A!=null))switch(x){case"value":Y=y;break;case"defaultValue":W=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==A&&ne(s,o,x,y,g,A)}Gp(s,Y,W);return;case"option":for(var vt in h)if(Y=h[vt],h.hasOwnProperty(vt)&&Y!=null&&!g.hasOwnProperty(vt))switch(vt){case"selected":s.selected=!1;break;default:ne(s,o,vt,null,g,Y)}for(F in g)if(Y=g[F],W=h[F],g.hasOwnProperty(F)&&Y!==W&&(Y!=null||W!=null))switch(F){case"selected":s.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:ne(s,o,F,Y,g,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in h)Y=h[wt],h.hasOwnProperty(wt)&&Y!=null&&!g.hasOwnProperty(wt)&&ne(s,o,wt,null,g,Y);for(X in g)if(Y=g[X],W=h[X],g.hasOwnProperty(X)&&Y!==W&&(Y!=null||W!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(137,o));break;default:ne(s,o,X,Y,g,W)}return;default:if(Hh(o)){for(var se in h)Y=h[se],h.hasOwnProperty(se)&&Y!==void 0&&!g.hasOwnProperty(se)&&xd(s,o,se,void 0,g,Y);for(tt in g)Y=g[tt],W=h[tt],!g.hasOwnProperty(tt)||Y===W||Y===void 0&&W===void 0||xd(s,o,tt,Y,g,W);return}}for(var z in h)Y=h[z],h.hasOwnProperty(z)&&Y!=null&&!g.hasOwnProperty(z)&&ne(s,o,z,null,g,Y);for(it in g)Y=g[it],W=h[it],!g.hasOwnProperty(it)||Y===W||Y==null&&W==null||ne(s,o,it,Y,g,W)}function Wv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function jE(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,h=performance.getEntriesByType("resource"),g=0;g<h.length;g++){var y=h[g],A=y.transferSize,x=y.initiatorType,O=y.duration;if(A&&O&&Wv(x)){for(x=0,O=y.responseEnd,g+=1;g<h.length;g++){var F=h[g],X=F.startTime;if(X>O)break;var tt=F.transferSize,it=F.initiatorType;tt&&Wv(it)&&(F=F.responseEnd,x+=tt*(F<O?1:(O-X)/(F-X)))}if(--g,o+=8*(A+x)/(y.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Rd=null,_d=null;function gc(s){return s.nodeType===9?s:s.ownerDocument}function Kv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Dd(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Md=null;function $E(){var s=window.event;return s&&s.type==="popstate"?s===Md?!1:(Md=s,!0):(Md=null,!1)}var Qv=typeof setTimeout=="function"?setTimeout:void 0,GE=typeof clearTimeout=="function"?clearTimeout:void 0,Zv=typeof Promise=="function"?Promise:void 0,VE=typeof queueMicrotask=="function"?queueMicrotask:typeof Zv<"u"?function(s){return Zv.resolve(null).then(s).catch(XE)}:Qv;function XE(s){setTimeout(function(){throw s})}function As(s){return s==="head"}function Jv(s,o){var h=o,g=0;do{var y=h.nextSibling;if(s.removeChild(h),y&&y.nodeType===8)if(h=y.data,h==="/$"||h==="/&"){if(g===0){s.removeChild(y),sa(o);return}g--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")g++;else if(h==="html")go(s.ownerDocument.documentElement);else if(h==="head"){h=s.ownerDocument.head,go(h);for(var A=h.firstChild;A;){var x=A.nextSibling,O=A.nodeName;A[La]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&A.rel.toLowerCase()==="stylesheet"||h.removeChild(A),A=x}}else h==="body"&&go(s.ownerDocument.body);h=y}while(h);sa(o)}function ty(s,o){var h=s;s=0;do{var g=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),g&&g.nodeType===8)if(h=g.data,h==="/$"){if(s===0)break;s--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||s++;h=g}while(h)}function Od(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Od(h),kh(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function YE(s,o,h,g){for(;s.nodeType===1;){var y=h;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[La])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var A=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Zi(s.nextSibling),s===null)break}return null}function WE(s,o,h){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=Zi(s.nextSibling),s===null))return null;return s}function ey(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Zi(s.nextSibling),s===null))return null;return s}function Ld(s){return s.data==="$?"||s.data==="$~"}function Pd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function KE(s,o){var h=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||h.readyState!=="loading")o();else{var g=function(){o(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Zi(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var Nd=null;function iy(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"||h==="/&"){if(o===0)return Zi(s.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}s=s.nextSibling}return null}function ny(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return s;o--}else h!=="/$"&&h!=="/&"||o++}s=s.previousSibling}return null}function sy(s,o,h){switch(o=gc(h),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function go(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);kh(s)}var Ji=new Map,ry=new Set;function mc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Xn=I.d;I.d={f:qE,r:QE,D:ZE,C:JE,L:t1,m:e1,X:n1,S:i1,M:s1};function qE(){var s=Xn.f(),o=oc();return s||o}function QE(s){var o=wr(s);o!==null&&o.tag===5&&o.type==="form"?Em(o):Xn.r(s)}var ea=typeof document>"u"?null:document;function ay(s,o,h){var g=ea;if(g&&typeof o=="string"&&o){var y=Vi(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),ry.has(y)||(ry.add(y),s={rel:s,crossOrigin:h,href:o},g.querySelector(y)===null&&(o=g.createElement("link"),qe(o,"link",s),je(o),g.head.appendChild(o)))}}function ZE(s){Xn.D(s),ay("dns-prefetch",s,null)}function JE(s,o){Xn.C(s,o),ay("preconnect",s,o)}function t1(s,o,h){Xn.L(s,o,h);var g=ea;if(g&&s&&o){var y='link[rel="preload"][as="'+Vi(o)+'"]';o==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+Vi(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+Vi(h.imageSizes)+'"]')):y+='[href="'+Vi(s)+'"]';var A=y;switch(o){case"style":A=ia(s);break;case"script":A=na(s)}Ji.has(A)||(s=p({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:s,as:o},h),Ji.set(A,s),g.querySelector(y)!==null||o==="style"&&g.querySelector(mo(A))||o==="script"&&g.querySelector(vo(A))||(o=g.createElement("link"),qe(o,"link",s),je(o),g.head.appendChild(o)))}}function e1(s,o){Xn.m(s,o);var h=ea;if(h&&s){var g=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+Vi(g)+'"][href="'+Vi(s)+'"]',A=y;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=na(s)}if(!Ji.has(A)&&(s=p({rel:"modulepreload",href:s},o),Ji.set(A,s),h.querySelector(y)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(vo(A)))return}g=h.createElement("link"),qe(g,"link",s),je(g),h.head.appendChild(g)}}}function i1(s,o,h){Xn.S(s,o,h);var g=ea;if(g&&s){var y=Tr(g).hoistableStyles,A=ia(s);o=o||"default";var x=y.get(A);if(!x){var O={loading:0,preload:null};if(x=g.querySelector(mo(A)))O.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":o},h),(h=Ji.get(A))&&Id(s,h);var F=x=g.createElement("link");je(F),qe(F,"link",s),F._p=new Promise(function(X,tt){F.onload=X,F.onerror=tt}),F.addEventListener("load",function(){O.loading|=1}),F.addEventListener("error",function(){O.loading|=2}),O.loading|=4,vc(x,o,g)}x={type:"stylesheet",instance:x,count:1,state:O},y.set(A,x)}}}function n1(s,o){Xn.X(s,o);var h=ea;if(h&&s){var g=Tr(h).hoistableScripts,y=na(s),A=g.get(y);A||(A=h.querySelector(vo(y)),A||(s=p({src:s,async:!0},o),(o=Ji.get(y))&&kd(s,o),A=h.createElement("script"),je(A),qe(A,"link",s),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(y,A))}}function s1(s,o){Xn.M(s,o);var h=ea;if(h&&s){var g=Tr(h).hoistableScripts,y=na(s),A=g.get(y);A||(A=h.querySelector(vo(y)),A||(s=p({src:s,async:!0,type:"module"},o),(o=Ji.get(y))&&kd(s,o),A=h.createElement("script"),je(A),qe(A,"link",s),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(y,A))}}function oy(s,o,h,g){var y=(y=J.current)?mc(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=ia(h.href),h=Tr(y).hoistableStyles,g=h.get(o),g||(g={type:"style",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=ia(h.href);var A=Tr(y).hoistableStyles,x=A.get(s);if(x||(y=y.ownerDocument||y,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,x),(A=y.querySelector(mo(s)))&&!A._p&&(x.instance=A,x.state.loading=5),Ji.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ji.set(s,h),A||r1(y,s,h,x.state))),o&&g===null)throw Error(i(528,""));return x}if(o&&g!==null)throw Error(i(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=na(h),h=Tr(y).hoistableScripts,g=h.get(o),g||(g={type:"script",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function ia(s){return'href="'+Vi(s)+'"'}function mo(s){return'link[rel="stylesheet"]['+s+"]"}function ly(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function r1(s,o,h,g){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=s.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),qe(o,"link",h),je(o),s.head.appendChild(o))}function na(s){return'[src="'+Vi(s)+'"]'}function vo(s){return"script[async]"+s}function cy(s,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var g=s.querySelector('style[data-href~="'+Vi(h.href)+'"]');if(g)return o.instance=g,je(g),g;var y=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),je(g),qe(g,"style",y),vc(g,h.precedence,s),o.instance=g;case"stylesheet":y=ia(h.href);var A=s.querySelector(mo(y));if(A)return o.state.loading|=4,o.instance=A,je(A),A;g=ly(h),(y=Ji.get(y))&&Id(g,y),A=(s.ownerDocument||s).createElement("link"),je(A);var x=A;return x._p=new Promise(function(O,F){x.onload=O,x.onerror=F}),qe(A,"link",g),o.state.loading|=4,vc(A,h.precedence,s),o.instance=A;case"script":return A=na(h.src),(y=s.querySelector(vo(A)))?(o.instance=y,je(y),y):(g=h,(y=Ji.get(A))&&(g=p({},h),kd(g,y)),s=s.ownerDocument||s,y=s.createElement("script"),je(y),qe(y,"link",g),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,vc(g,h.precedence,s));return o.instance}function vc(s,o,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=g.length?g[g.length-1]:null,A=y,x=0;x<g.length;x++){var O=g[x];if(O.dataset.precedence===o)A=O;else if(A!==y)break}A?A.parentNode.insertBefore(s,A.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(s,o.firstChild))}function Id(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function kd(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var yc=null;function hy(s,o,h){if(yc===null){var g=new Map,y=yc=new Map;y.set(h,g)}else y=yc,g=y.get(h),g||(g=new Map,y.set(h,g));if(g.has(s))return g;for(g.set(s,null),h=h.getElementsByTagName(s),y=0;y<h.length;y++){var A=h[y];if(!(A[La]||A[Xe]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var x=A.getAttribute(o)||"";x=s+x;var O=g.get(x);O?O.push(A):g.set(x,[A])}}return g}function uy(s,o,h){s=s.ownerDocument||s,s.head.insertBefore(h,o==="title"?s.querySelector("head > title"):null)}function a1(s,o,h){if(h===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function dy(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function o1(s,o,h,g){if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var y=ia(g.href),A=o.querySelector(mo(y));if(A){o=A._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=bc.bind(s),o.then(s,s)),h.state.loading|=4,h.instance=A,je(A);return}A=o.ownerDocument||o,g=ly(g),(y=Ji.get(y))&&Id(g,y),A=A.createElement("link"),je(A);var x=A;x._p=new Promise(function(O,F){x.onload=O,x.onerror=F}),qe(A,"link",g),h.instance=A}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(s.count++,h=bc.bind(s),o.addEventListener("load",h),o.addEventListener("error",h))}}var Fd=0;function l1(s,o){return s.stylesheets&&s.count===0&&Sc(s,s.stylesheets),0<s.count||0<s.imgCount?function(h){var g=setTimeout(function(){if(s.stylesheets&&Sc(s,s.stylesheets),s.unsuspend){var A=s.unsuspend;s.unsuspend=null,A()}},6e4+o);0<s.imgBytes&&Fd===0&&(Fd=62500*jE());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Sc(s,s.stylesheets),s.unsuspend)){var A=s.unsuspend;s.unsuspend=null,A()}},(s.imgBytes>Fd?50:800)+o);return s.unsuspend=h,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(y)}}:null}function bc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Sc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ac=null;function Sc(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ac=new Map,o.forEach(c1,s),Ac=null,bc.call(s))}function c1(s,o){if(!(o.state.loading&4)){var h=Ac.get(s);if(h)var g=h.get(null);else{h=new Map,Ac.set(s,h);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<y.length;A++){var x=y[A];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(h.set(x.dataset.precedence,x),g=x)}g&&h.set(null,g)}y=o.instance,x=y.getAttribute("data-precedence"),A=h.get(x)||g,A===g&&h.set(null,y),h.set(x,y),this.count++,g=bc.bind(this),y.addEventListener("load",g),y.addEventListener("error",g),A?A.parentNode.insertBefore(y,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var yo={$$typeof:T,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function h1(s,o,h,g,y,A,x,O,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lh(0),this.hiddenUpdates=Lh(null),this.identifierPrefix=g,this.onUncaughtError=y,this.onCaughtError=A,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function fy(s,o,h,g,y,A,x,O,F,X,tt,it){return s=new h1(s,o,h,x,F,X,tt,it,O),o=1,A===!0&&(o|=24),A=Oi(3,null,null,o),s.current=A,A.stateNode=s,o=mu(),o.refCount++,s.pooledCache=o,o.refCount++,A.memoizedState={element:g,isDehydrated:h,cache:o},Au(A),s}function py(s){return s?(s=Nr,s):Nr}function gy(s,o,h,g,y,A){y=py(y),g.context===null?g.context=y:g.pendingContext=y,g=cs(o),g.payload={element:h},A=A===void 0?null:A,A!==null&&(g.callback=A),h=hs(s,g,o),h!==null&&(wi(h,s,o),Ka(h,s,o))}function my(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function Bd(s,o){my(s,o),(s=s.alternate)&&my(s,o)}function vy(s){if(s.tag===13||s.tag===31){var o=zs(s,67108864);o!==null&&wi(o,s,67108864),Bd(s,67108864)}}function yy(s){if(s.tag===13||s.tag===31){var o=ki();o=Ph(o);var h=zs(s,o);h!==null&&wi(h,s,o),Bd(s,o)}}var Ec=!0;function u1(s,o,h,g){var y=N.T;N.T=null;var A=I.p;try{I.p=2,Ud(s,o,h,g)}finally{I.p=A,N.T=y}}function d1(s,o,h,g){var y=N.T;N.T=null;var A=I.p;try{I.p=8,Ud(s,o,h,g)}finally{I.p=A,N.T=y}}function Ud(s,o,h,g){if(Ec){var y=Hd(g);if(y===null)Cd(s,o,g,wc,h),Ay(s,g);else if(p1(y,s,o,h,g))g.stopPropagation();else if(Ay(s,g),o&4&&-1<f1.indexOf(s)){for(;y!==null;){var A=wr(y);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var x=ks(A.pendingLanes);if(x!==0){var O=A;for(O.pendingLanes|=2,O.entangledLanes|=2;x;){var F=1<<31-Di(x);O.entanglements[1]|=F,x&=~F}bn(A),(Zt&6)===0&&(rc=ci()+500,uo(0))}}break;case 31:case 13:O=zs(A,2),O!==null&&wi(O,A,2),oc(),Bd(A,2)}if(A=Hd(g),A===null&&Cd(s,o,g,wc,h),A===y)break;y=A}y!==null&&g.stopPropagation()}else Cd(s,o,g,null,h)}}function Hd(s){return s=jh(s),zd(s)}var wc=null;function zd(s){if(wc=null,s=Er(s),s!==null){var o=r(s);if(o===null)s=null;else{var h=o.tag;if(h===13){if(s=a(o),s!==null)return s;s=null}else if(h===31){if(s=l(o),s!==null)return s;s=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return wc=s,null}function by(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oh()){case dl:return 2;case ln:return 8;case cn:case gn:return 32;case Ar:return 268435456;default:return 32}default:return 32}}var jd=!1,Ss=null,Es=null,ws=null,bo=new Map,Ao=new Map,Ts=[],f1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ay(s,o){switch(s){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":bo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ao.delete(o.pointerId)}}function So(s,o,h,g,y,A){return s===null||s.nativeEvent!==A?(s={blockedOn:o,domEventName:h,eventSystemFlags:g,nativeEvent:A,targetContainers:[y]},o!==null&&(o=wr(o),o!==null&&vy(o)),s):(s.eventSystemFlags|=g,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function p1(s,o,h,g,y){switch(o){case"focusin":return Ss=So(Ss,s,o,h,g,y),!0;case"dragenter":return Es=So(Es,s,o,h,g,y),!0;case"mouseover":return ws=So(ws,s,o,h,g,y),!0;case"pointerover":var A=y.pointerId;return bo.set(A,So(bo.get(A)||null,s,o,h,g,y)),!0;case"gotpointercapture":return A=y.pointerId,Ao.set(A,So(Ao.get(A)||null,s,o,h,g,y)),!0}return!1}function Sy(s){var o=Er(s.target);if(o!==null){var h=r(o);if(h!==null){if(o=h.tag,o===13){if(o=a(h),o!==null){s.blockedOn=o,Ip(s.priority,function(){yy(h)});return}}else if(o===31){if(o=l(h),o!==null){s.blockedOn=o,Ip(s.priority,function(){yy(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Tc(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var h=Hd(s.nativeEvent);if(h===null){h=s.nativeEvent;var g=new h.constructor(h.type,h);zh=g,h.target.dispatchEvent(g),zh=null}else return o=wr(h),o!==null&&vy(o),s.blockedOn=h,!1;o.shift()}return!0}function Ey(s,o,h){Tc(s)&&h.delete(o)}function g1(){jd=!1,Ss!==null&&Tc(Ss)&&(Ss=null),Es!==null&&Tc(Es)&&(Es=null),ws!==null&&Tc(ws)&&(ws=null),bo.forEach(Ey),Ao.forEach(Ey)}function Cc(s,o){s.blockedOn===o&&(s.blockedOn=null,jd||(jd=!0,d.unstable_scheduleCallback(d.unstable_NormalPriority,g1)))}var xc=null;function wy(s){xc!==s&&(xc=s,d.unstable_scheduleCallback(d.unstable_NormalPriority,function(){xc===s&&(xc=null);for(var o=0;o<s.length;o+=3){var h=s[o],g=s[o+1],y=s[o+2];if(typeof g!="function"){if(zd(g||h)===null)continue;break}var A=wr(h);A!==null&&(s.splice(o,3),o-=3,Hu(A,{pending:!0,data:y,method:h.method,action:g},g,y))}}))}function sa(s){function o(F){return Cc(F,s)}Ss!==null&&Cc(Ss,s),Es!==null&&Cc(Es,s),ws!==null&&Cc(ws,s),bo.forEach(o),Ao.forEach(o);for(var h=0;h<Ts.length;h++){var g=Ts[h];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Ts.length&&(h=Ts[0],h.blockedOn===null);)Sy(h),h.blockedOn===null&&Ts.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var y=h[g],A=h[g+1],x=y[vi]||null;if(typeof A=="function")x||wy(h);else if(x){var O=null;if(A&&A.hasAttribute("formAction")){if(y=A,x=A[vi]||null)O=x.formAction;else if(zd(y)!==null)continue}else O=x.action;typeof O=="function"?h[g+1]=O:(h.splice(g,3),g-=3),wy(h)}}}function Ty(){function s(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(x){return y=x})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),g||setTimeout(h,20)}function h(){if(!g&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function $d(s){this._internalRoot=s}Rc.prototype.render=$d.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var h=o.current,g=ki();gy(h,g,s,o,null,null)},Rc.prototype.unmount=$d.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;gy(s.current,2,null,s,null,null),oc(),o[Sr]=null}};function Rc(s){this._internalRoot=s}Rc.prototype.unstable_scheduleHydration=function(s){if(s){var o=Np();s={blockedOn:null,target:s,priority:o};for(var h=0;h<Ts.length&&o!==0&&o<Ts[h].priority;h++);Ts.splice(h,0,s),h===0&&Sy(s)}};var Cy=t.version;if(Cy!=="19.2.0")throw Error(i(527,Cy,"19.2.0"));I.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=u(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var m1={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_c.isDisabled&&_c.supportsFiber)try{Da=_c.inject(m1),_i=_c}catch{}}return wo.createRoot=function(s,o){if(!n(s))throw Error(i(299));var h=!1,g="",y=Lm,A=Pm,x=Nm;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),o=fy(s,1,!1,null,null,h,g,null,y,A,x,Ty),s[Sr]=o.current,Td(s),new $d(o)},wo.hydrateRoot=function(s,o,h){if(!n(s))throw Error(i(299));var g=!1,y="",A=Lm,x=Pm,O=Nm,F=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(x=h.onCaughtError),h.onRecoverableError!==void 0&&(O=h.onRecoverableError),h.formState!==void 0&&(F=h.formState)),o=fy(s,1,!0,o,h??null,g,y,F,A,x,O,Ty),o.context=py(null),h=o.current,g=ki(),g=Ph(g),y=cs(g),y.callback=null,hs(h,y,g),h=g,o.current.lanes=h,Oa(o,h),bn(o),s[Sr]=o.current,Td(s),new Rc(o)},wo.version="19.2.0",wo}var ky;function x1(){if(ky)return Wd.exports;ky=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(t){console.error(t)}}return d(),Wd.exports=C1(),Wd.exports}var R1=x1();const di=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Sf=[.001,0,0,.001,0,0],Zd=1.35,Fi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Rn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},$o="pdfjs_internal_editor_",Mt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Vt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},i0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Qe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ho={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Re={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},oa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Zo={ERRORS:0,WARNINGS:1,INFOS:5},Ea={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Dc={moveTo:0,lineTo:1,curveTo:2,closePath:3},n0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let fh=Zo.WARNINGS;function _1(d){Number.isInteger(d)&&(fh=d)}function D1(){return fh}function ph(d){fh>=Zo.INFOS&&console.info(`Info: ${d}`)}function Ot(d){fh>=Zo.WARNINGS&&console.warn(`Warning: ${d}`)}function he(d){throw new Error(d)}function Yt(d,t){d||he(t)}function M1(d){switch(d?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Qf(d,t=null,e=null){if(!d)return null;if(e&&typeof d=="string"&&(e.addDefaultProtocol&&d.startsWith("www.")&&d.match(/\./g)?.length>=2&&(d=`http://${d}`),e.tryConvertEncoding))try{d=I1(d)}catch{}const i=t?URL.parse(d,t):URL.parse(d);return M1(i)?i:null}function Zf(d,t,e=!1){const i=URL.parse(d);return i?(i.hash=t,i.href):e&&Qf(d,"http://example.com")?d.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ft(d,t,e,i=!1){return Object.defineProperty(d,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const mr=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();let Fy=class extends mr{constructor(t,e){super(t,"PasswordException"),this.code=e}},Jd=class extends mr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}},sh=class extends mr{constructor(t){super(t,"InvalidPDFException")}},Go=class extends mr{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}},O1=class extends mr{constructor(t){super(t,"FormatError")}},Jn=class extends mr{constructor(t){super(t,"AbortException")}};function s0(d){(typeof d!="object"||d?.length===void 0)&&he("Invalid argument for bytesToString");const t=d.length,e=8192;if(t<e)return String.fromCharCode.apply(null,d);const i=[];for(let n=0;n<t;n+=e){const r=Math.min(n+e,t),a=d.subarray(n,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Jo(d){typeof d!="string"&&he("Invalid argument for stringToBytes");const t=d.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=d.charCodeAt(i)&255;return e}function L1(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function P1(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function N1(){try{return new Function(""),!0}catch{return!1}}let Ve=class{static get isLittleEndian(){return Ft(this,"isLittleEndian",P1())}static get isEvalSupported(){return Ft(this,"isEvalSupported",N1())}static get isOffscreenCanvasSupported(){return Ft(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ft(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ft(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Ft(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}};const tf=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));let gt=class{static makeHexColor(t,e,i){return`#${tf[t]}${tf[e]}${tf[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const n=t[i],r=t[i+1];t[i]=n*e[0]+r*e[2]+e[4],t[i+1]=n*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5];for(let f=0;f<6;f+=2){const p=t[i+f],m=t[i+f+1];t[i+f]=p*n+m*a+c,t[i+f+1]=p*r+m*l+u}}static applyInverseTransform(t,e){const i=t[0],n=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-i*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,i){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5],f=t[0],p=t[1],m=t[2],v=t[3];let S=n*f+c,b=S,w=n*m+c,E=w,C=l*p+u,T=C,_=l*v+u,R=_;if(r!==0||a!==0){const D=r*f,M=r*m,L=a*p,P=a*v;S+=L,E+=L,w+=P,b+=P,C+=D,R+=D,_+=M,T+=M}i[0]=Math.min(i[0],S,w,b,E),i[1]=Math.min(i[1],C,_,T,R),i[2]=Math.max(i[2],S,w,b,E),i[3]=Math.max(i[3],C,_,T,R)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],n=t[1],r=t[2],a=t[3],l=i**2+n**2,c=i*r+n*a,u=r**2+a**2,f=(l+u)/2,p=Math.sqrt(f**2-(l*u-c**2));e[0]=Math.sqrt(f+p||1),e[1]=Math.sqrt(f-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[i,r,n,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,n,r){r[0]=Math.min(r[0],t,i),r[1]=Math.min(r[1],e,n),r[2]=Math.max(r[2],t,i),r[3]=Math.max(r[3],e,n)}static#t(t,e,i,n,r,a,l,c,u,f){if(u<=0||u>=1)return;const p=1-u,m=u*u,v=m*u,S=p*(p*(p*t+3*u*e)+3*m*i)+v*n,b=p*(p*(p*r+3*u*a)+3*m*l)+v*c;f[0]=Math.min(f[0],S),f[1]=Math.min(f[1],b),f[2]=Math.max(f[2],S),f[3]=Math.max(f[3],b)}static#e(t,e,i,n,r,a,l,c,u,f,p,m){if(Math.abs(u)<1e-12){Math.abs(f)>=1e-12&&this.#t(t,e,i,n,r,a,l,c,-p/f,m);return}const v=f**2-4*p*u;if(v<0)return;const S=Math.sqrt(v),b=2*u;this.#t(t,e,i,n,r,a,l,c,(-f+S)/b,m),this.#t(t,e,i,n,r,a,l,c,(-f-S)/b,m)}static bezierBoundingBox(t,e,i,n,r,a,l,c,u){u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],e,c),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],e,c),this.#e(t,i,r,l,e,n,a,c,3*(-t+3*(i-r)+l),6*(t-2*i+r),3*(i-t),u),this.#e(t,i,r,l,e,n,a,c,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),u)}};function I1(d){return decodeURIComponent(escape(d))}let ef=null,By=null;function r0(d){return ef||(ef=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,By=new Map([["","t"]])),d.replaceAll(ef,(t,e,i)=>e?e.normalize("NFKC"):By.get(i))}function Jf(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const d=new Uint8Array(32);return crypto.getRandomValues(d),s0(d)}const tp="pdfjs_internal_id_";function k1(d,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,n,...r]=e;if(!d(i)&&!Number.isInteger(i)||!t(n))return!1;const a=r.length;let l=!0;switch(n.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function ai(d,t,e){return Math.min(Math.max(d,t),e)}function a0(d){return Uint8Array.prototype.toBase64?d.toBase64():btoa(s0(d))}function F1(d){return Uint8Array.fromBase64?Uint8Array.fromBase64(d):Jo(atob(d))}typeof Promise.try!="function"&&(Promise.try=function(d,...t){return new Promise(e=>{e(d(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(d){return d.reduce((t,e)=>t+e,0)});let Ef=class o0{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(r){if(!r)return;let a=null;const l=r.name;if(l==="#text")a=r.value;else if(o0.shouldBuildText(l))r?.attributes?.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&e.push({str:a}),!!r.children)for(const c of r.children)n(c)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}},ep=class{static setupStorage(t,e,i,n,r){const a=n.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",l=>{n.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of i.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:r}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}l&&r.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,r=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:r,linkService:i});const l=r!=="richText",c=t.div;if(c.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=p}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);a.append(p),l&&Ef.shouldBuildText(n.name)&&u.push(p)}return{textDivs:u}}const f=[[n,-1,a]];for(;f.length>0;){const[p,m,v]=f.at(-1);if(m+1===p.children.length){f.pop();continue}const S=p.children[++f.at(-1)[1]];if(S===null)continue;const{name:b}=S;if(b==="#text"){const E=document.createTextNode(S.value);u.push(E),v.append(E);continue}const w=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,b):document.createElement(b);if(v.append(w),S.attributes&&this.setAttributes({html:w,element:S,storage:e,intent:r,linkService:i}),S.children?.length>0)f.push([S,-1,w]);else if(S.value){const E=document.createTextNode(S.value);l&&Ef.shouldBuildText(b)&&u.push(E),w.append(E)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}};const Yn="http://www.w3.org/2000/svg";let ur=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};async function xa(d,t="text"){if(Lo(d,document.baseURI)){const e=await fetch(d);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",d,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}let ip=class l0{constructor({viewBox:t,userUnit:e,scale:i,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=n,this.offsetX=r,this.offsetY=a,i*=e;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let f,p,m,v;switch(n%=360,n<0&&(n+=360),n){case 180:f=-1,p=0,m=0,v=1;break;case 90:f=0,p=1,m=1,v=0;break;case 270:f=0,p=-1,m=-1,v=0;break;case 0:f=1,p=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,v=-v);let S,b,w,E;f===0?(S=Math.abs(u-t[1])*i+r,b=Math.abs(c-t[0])*i+a,w=(t[3]-t[1])*i,E=(t[2]-t[0])*i):(S=Math.abs(c-t[0])*i+r,b=Math.abs(u-t[1])*i+a,w=(t[2]-t[0])*i,E=(t[3]-t[1])*i),this.transform=[f*i,p*i,m*i,v*i,S-f*i*c-m*i*u,b-p*i*c-v*i*u],this.width=w,this.height=E}get rawDims(){const t=this.viewBox;return Ft(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new l0({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:r})}convertToViewportPoint(t,e){const i=[t,e];return gt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];gt.applyTransform(e,this.transform);const i=[t[2],t[3]];return gt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return gt.applyInverseTransform(i,this.transform),i}},gh=class extends mr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}};function tl(d){const t=d.length;let e=0;for(;e<t&&d[e].trim()==="";)e++;return d.substring(e,e+5).toLowerCase()==="data:"}function mh(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function c0(d){return[d]=d.split(/[#?]/,1),d.substring(d.lastIndexOf("/")+1)}function h0(d,t="document.pdf"){if(typeof d!="string")return t;if(tl(d))return Ot('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(d);if(!i)return t;const n=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return n(a);if(i.searchParams.size>0){const l=Array.from(i.searchParams.values()).reverse();for(const u of l)if(r.test(u))return n(u);const c=Array.from(i.searchParams.keys()).reverse();for(const u of c)if(r.test(u))return n(u)}if(i.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(c)return n(c[0])}return t}let Uy=class{started=Object.create(null);times=[];time(t){t in this.started&&Ot(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ot(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-n}ms
`);return t.join("")}};function Lo(d,t){const e=t?URL.parse(d,t):URL.parse(d);return e?.protocol==="http:"||e?.protocol==="https:"}function zi(d){d.preventDefault()}function Ae(d){d.preventDefault(),d.stopPropagation()}function B1(d){console.log("Deprecated API usage: "+d)}let rh=class{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const u=e[7]||"Z";let f=parseInt(e[8],10);f=f>=0&&f<=23?f:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,u==="-"?(a+=f,l+=p):u==="+"&&(a-=f,l-=p),new Date(Date.UTC(i,n,r,a,l,c))}};function u0(d,{scale:t=1,rotation:e=0}){const{width:i,height:n}=d.attributes.style,r=[0,0,parseInt(i),parseInt(n)];return new ip({viewBox:r,userUnit:1,scale:t,rotation:e})}function Ra(d){if(d.startsWith("#")){const t=parseInt(d.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(t=>parseInt(t)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ot(`Not a valid color format: "${d}"`),[0,0,0])}function U1(d){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of d.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;d.set(e,Ra(i))}t.remove()}function ye(d){const{a:t,b:e,c:i,d:n,e:r,f:a}=d.getTransform();return[t,e,i,n,r,a]}function An(d){const{a:t,b:e,c:i,d:n,e:r,f:a}=d.getTransform().invertSelf();return[t,e,i,n,r,a]}function Ls(d,t,e=!1,i=!0){if(t instanceof ip){const{pageWidth:n,pageHeight:r}=t.rawDims,{style:a}=d,l=Ve.isCSSRoundSupported,c=`var(--total-scale-factor) * ${n}px`,u=`var(--total-scale-factor) * ${r}px`,f=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,p=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!e||t.rotation%180===0?(a.width=f,a.height=p):(a.width=p,a.height=f)}i&&d.setAttribute("data-main-rotation",t.rotation)}let Ps=class wf{constructor(){const{pixelRatio:t}=wf;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,n,r=-1){let a=1/0,l=1/0,c=1/0;i=wf.capPixels(i,r),i>0&&(a=Math.sqrt(i/(t*e))),n!==-1&&(l=n/t,c=n/e);const u=Math.min(a,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}};const ah=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];let H1=class{static get isDarkMode(){return Ft(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}},d0=class{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),Ft(this,"commentForegroundColor",Ra(i))}};function f0(d,t,e,i){i=Math.min(Math.max(i??1,0),1);const n=255*(1-i);return d=Math.round(d*i+n),t=Math.round(t*i+n),e=Math.round(e*i+n),[d,t,e]}function Hy(d,t){const e=d[0]/255,i=d[1]/255,n=d[2]/255,r=Math.max(e,i,n),a=Math.min(e,i,n),l=(r+a)/2;if(r===a)t[0]=t[1]=0;else{const c=r-a;switch(t[1]=l<.5?c/(r+a):c/(2-r-a),r){case e:t[0]=((i-n)/c+(i<n?6:0))*60;break;case i:t[0]=((n-e)/c+2)*60;break;case n:t[0]=((e-i)/c+4)*60;break}}t[2]=l}function Tf(d,t){const e=d[0],i=d[1],n=d[2],r=(1-Math.abs(2*n-1))*i,a=r*(1-Math.abs(e/60%2-1)),l=n-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+l,t[1]=a+l,t[2]=l;break;case 1:t[0]=a+l,t[1]=r+l,t[2]=l;break;case 2:t[0]=l,t[1]=r+l,t[2]=a+l;break;case 3:t[0]=l,t[1]=a+l,t[2]=r+l;break;case 4:t[0]=a+l,t[1]=l,t[2]=r+l;break;case 5:case 6:t[0]=r+l,t[1]=l,t[2]=a+l;break}}function zy(d){return d<=.03928?d/12.92:((d+.055)/1.055)**2.4}function jy(d,t,e){Tf(d,e),e.map(zy);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];Tf(t,e),e.map(zy);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)}const $y=new Map;function p0(d,t){const e=d[0]+d[1]*256+d[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=$y.get(e);if(i)return i;const n=new Float32Array(9),r=n.subarray(0,3),a=n.subarray(3,6);Hy(d,a);const l=n.subarray(6,9);Hy(t,l);const c=l[2]<.5,u=c?12:4.5;if(a[2]=c?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),jy(a,l,r)<u){let f,p;c?(f=a[2],p=1):(f=0,p=a[2]);const m=.005;for(;p-f>m;){const v=a[2]=(f+p)/2;c===jy(a,l,r)<u?f=v:p=v}a[2]=c?p:f}return Tf(a,r),i=gt.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),$y.set(e,i),i}function np({html:d,dir:t,className:e},i){const n=document.createDocumentFragment();if(typeof d=="string"){const r=document.createElement("p");r.dir=t||"auto";const a=d.split(/(?:\r\n?|\n)/);for(let l=0,c=a.length;l<c;++l){const u=a[l];r.append(document.createTextNode(u)),l<c-1&&r.append(document.createElement("br"))}n.append(r)}else ep.render({xfaHtml:d,div:n,intent:"richText"});n.firstChild.classList.add("richText",e),i.append(n)}let z1=class Kc{#t=null;#e=null;#n;#i=null;#a=null;#s=null;#r=null;#o=null;static#c=null;constructor(t){this.#n=t,Kc.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",zi,{signal:e}),t.addEventListener("pointerdown",Kc.#l,{signal:e}));const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const n=this.#n.toolbarPosition;if(n){const{style:r}=t,a=this.#n._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,Ae(t)}#u(t){this.#n._focusEventsAllowed=!0,Ae(t)}#f(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",zi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Kc.#c[t]),this.#f(i)&&i.addEventListener("click",n=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#s)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const n=this.#r=this.#m;e?(this.#i.insertBefore(i,e),this.#i.insertBefore(n,e)):this.#i.append(i,n),this.#s=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#n);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,i){const n=this.#i.querySelector(i);n&&t==="comment"&&this.addComment(e,n)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}},j1=class{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",zi,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,e){let i=0,n=0;for(const r of t){const a=r.y+r.height;if(a<i)continue;const l=r.x+(e?r.width:0);if(a>i){n=l,i=a;continue}e?l>n&&(n=l):l<n&&(n=l)}return[e?1-n:n,i]}show(t,e,i){const[n,r]=this.#a(e,i),{style:a}=this.#e||=this.#i();t.append(this.#e),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,e,i,n){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",i);const l=this.#n._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",zi,{signal:l}),r.addEventListener("click",n,{signal:l})),this.#t.append(r)}};function g0(d,t,e){for(const i of e)t.addEventListener(i,d[i].bind(d))}let $1=class{#t=0;get id(){return`${$o}${this.#t++}`}},G1=class m0{#t=Jf();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const r=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Ft(this,"_isSVGFittingCanvas",r)}async#i(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof e=="string"?(i.url=e,n=await xa(e,"blob")):e instanceof File?n=i.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const r=m0._isSVGFittingCanvas,a=new FileReader,l=new Image,c=new Promise((u,f)=>{l.onload=()=>{i.bitmap=l,i.isSvg=!0,u()},a.onload=async()=>{const p=i.svgUrl=a.result;l.src=await r?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=f});a.readAsDataURL(n),await c}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){Ot(n),i=null}return this.#n.set(t,i),i&&this.#n.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:n,type:r}=t;return this.#i(`${e}_${i}_${n}_${r}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i?.bitmap)return i.refCounter+=1,i;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),i={bitmap:n.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,i),this.#n.set(i.id,i),i}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}},V1=class{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:i,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(n&&t(),this.#e)return;const c={cmd:t,undo:e,post:i,type:r};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(c);return}if(a&&this.#t[this.#i].type===r){l&&(c.undo=this.#t[this.#i].undo),this.#t[this.#i]=c;return}const u=this.#i+1;u===this.#n?this.#t.splice(0,1):(this.#i=u,u<this.#t.length&&this.#t.splice(u)),this.#t.push(c)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}},el=class{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ve.platform;for(const[i,n,r={}]of t)for(const a of i){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:n,options:{bubbles:r=!1,args:a=[],checker:l=null}}=i;l&&!l(t,e)||(n.bind(t,...a,e)(),r||Ae(e))}},X1=class v0{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return U1(t),Ft(this,"_colors",t)}convert(t){const e=Ra(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((r,a)=>r===e[a]))return v0._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?gt.makeHexColor(...e):t}},wa=class Cf{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#s=null;#r=null;#o=null;#c=new V1;#l=null;#d=null;#u=null;#f=0;#m=new Set;#p=null;#h=null;#g=new Set;_editorUndoBar=null;#v=!1;#b=!1;#y=!1;#C=null;#w=null;#A=null;#R=null;#E=!1;#T=null;#M=new $1;#_=!1;#D=!1;#F=!1;#L=null;#N=null;#B=null;#I=null;#G=null;#x=Mt.NONE;#S=new Set;#P=null;#U=null;#z=null;#Y=null;#X=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#k=null;#V=null;#Z=null;#J=null;#H=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Cf.prototype,e=a=>a.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Ft(this,"_keyboardManager",new el([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,i,n,r,a,l,c,u,f,p,m,v,S,b,w){const E=this._signal=this.#t.signal;this.#V=t,this.#Z=e,this.#J=i,this.#s=n,this.#l=r,this.#U=a,this.#X=c,this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:E}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),l._on("setpreference",this.onSetPreference.bind(this),{signal:E}),l._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:E}),this.#lt(),this.#dt(),this.#et(),this.#r=c.annotationStorage,this.#C=c.filterFactory,this.#z=u,this.#R=f||null,this.#v=p,this.#b=m,this.#y=v,this.#G=S||null,this.viewParameters={realScale:ur.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=w!==!1,r?.setSidebarUiManager(this)}destroy(){this.#H?.resolve(),this.#H=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#g.clear(),this.#I?.clear(),this.#e=null,this.#S.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#T?.hide(),this.#T=null,this.#B?.destroy(),this.#B=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#k&&(clearTimeout(this.#k),this.#k=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Ft(this,"hcmFilter",this.#z?this.#C.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Ft(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Ft(this,"_highlightColors",this.#R?new Map(this.#R.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ft(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[n,r]of t){const a=n.endsWith("_HCM");if(i&&a){e.set(n.replace("_HCM",""),r);continue}!i&&!a&&e.set(n,r)}return Ft(this,"highlightColors",e)}get highlightColorNames(){return Ft(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#B=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,n){this.#l?.showDialog(this,t,e,i,n)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),n=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await i}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#a.values()){const{x:n,y:r,width:a,height:l}=i.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=r&&e<=r+l)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ur.PDF_TO_CSS_UNITS;for(const e of this.#g)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#a.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l}=i,c=i.toString(),f=this.#Q(i).closest(".textLayer"),p=this.getSelectionBoxes(f);if(!p)return;i.empty();const m=this.#tt(f),v=this.#x===Mt.NONE,S=()=>{const b=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l,text:c});v&&this.showAllEditors("highlight",!0,!0),e&&b?.editComment()};if(v){this.switchToMode(Mt.HIGHLIGHT,S);return}S()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(this.#T||=new j1(this),this.#T.show(i,n,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${$o}${t}`,i=this.#r.getRawValue(e);return i&&this.#r.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#P&&(this.#T?.hide(),this.#P=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#P)return;const n=this.#Q(t).closest(".textLayer");if(!n){this.#P&&(this.#T?.hide(),this.#P=null,this.#O({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#P=e,this.#O({hasSelectedText:!0}),!(this.#x!==Mt.HIGHLIGHT&&this.#x!==Mt.NONE)&&(this.#x===Mt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#E=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#x===Mt.HIGHLIGHT?this.#tt(n):null;if(r?.toggleDrawing(),this.#D){const a=new AbortController,l=this.combinedSignal(a),c=u=>{u.type==="pointerup"&&u.button!==0||(a.abort(),r?.toggleDrawing(!0),u.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}else r?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#x===Mt.HIGHLIGHT?this.highlightSelection(t):this.#v&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#A)return;this.#A=new AbortController;const t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ht(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#S)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#L)return;this.#L=new AbortController;const t=this.combinedSignal(this.#L);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ut(){this.#L?.abort(),this.#L=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ut(),this.#nt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#S){const n=i.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of this.#h)if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Ot(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const c of i){const u=await n.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)this.#st(c);this.#rt(r)},l=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(r){Ot(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#x!==Mt.NONE&&!this.isEditorHandlingKeyboard&&Cf._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,n])=>this.#W[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#x===Mt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[Vt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#O({isEditing:this.#x!==Mt.NONE,isEmpty:this.#q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ht(),this.#nt(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#_?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,n=!1,r=!1){if(this.#x!==t&&!(this.#H&&(await this.#H.promise,!this.#H))){if(this.#H=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#x===Mt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#x=t,t===Mt.NONE){this.setEditingState(!1),this.#pt();for(const a of this.#i.values())a.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#H.resolve();return}for(const a of this.#i.values())a.addStandaloneCommentButton();t===Mt.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const a of this.#a.values())a.updateMode(t);if(t===Mt.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#h.map(c=>c._editorType)));const a=new Set,l=[];for(const c of this.#i.values()){const{annotationElementId:u,hasComment:f,deleted:p}=c;u&&a.add(u),f&&!p&&l.push(c.getData())}for(const c of this.#n){const{id:u,popupRef:f,contentsObj:p}=c;f&&p?.str&&!a.has(u)&&!this.#m.has(u)&&l.push(c)}this.#l?.showSidebar(l)}if(!e){i&&this.addNewEditorFromKeyboard(),this.#H.resolve();return}for(const a of this.#i.values())a.uid===e?(this.setSelected(a),r?a.editComment():n?a.enterInEditMode():a.focus()):a.unselect();this.#H.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#x&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case Vt.CREATE:this.currentLayer.addNewEditor(e);return;case Vt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#S)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const r of this.#i.values())r.editorType===t&&r.show(e);(this.#Y?.get(Vt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[Vt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#F!==t){this.#F=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#_){this.#_=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#_){this.#_=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#I?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#S);return t}updateUI(t){this.#gt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#S.has(t)){this.#S.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#S.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#S)e!==t&&e.unselect();this.#S.clear(),this.#S.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#S.has(t)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(t){t.unselect(),this.#S.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#q()})}cleanUndoStack(t){this.#c.cleanType(t)}#q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#S],i=()=>{this._editorUndoBar?.show(n,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},n=()=>{for(const r of e)this.#st(r)};this.addCommands({cmd:i,undo:n,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#S)e.unselect();this.#S.clear();for(const e of t)e.isEmpty()||(this.#S.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#S)t.commit();this.#rt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#x!==Mt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#S)t.unselect();this.#S.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[n,r]=this.#j,a=[...this.#S],l=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const c of a)this.#i.has(c.id)&&(c.translateInPage(n,r),c.translationDone())},undo:()=>{for(const c of a)this.#i.has(c.id)&&(c.translateInPage(-n,-r),c.translationDone())},mustExec:!1})},l);for(const c of a)c.translateInPage(t,e),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#S)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:n,y:r,pageIndex:a},l]of t)l.newX=n,l.newY=r,l.newPageIndex=a,e||=n!==l.savedX||r!==l.savedY||a!==l.savedPageIndex;if(!e)return!1;const i=(n,r,a,l)=>{if(this.#i.has(n.id)){const c=this.#a.get(l);c?n._setParentAndPosition(c,r,a):(n.pageIndex=l,n.x=r,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:a,newPageIndex:l}]of t)i(n,r,a,l)},undo:()=>{for(const[n,{savedX:r,savedY:a,savedPageIndex:l}]of t)i(n,r,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const i of this.#p.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#x}isEditingMode(){return this.#x!==Mt.NONE}get imageManager(){return Ft(this,"imageManager",new G1)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,f=e.rangeCount;u<f;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:n,width:r,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,f,p,m)=>({x:(f-n)/a,y:1-(u+p-i)/r,width:m/a,height:p/r});break;case"180":l=(u,f,p,m)=>({x:1-(u+p-i)/r,y:1-(f+m-n)/a,width:p/r,height:m/a});break;case"270":l=(u,f,p,m)=>({x:1-(f+m-n)/a,y:(u-i)/r,width:m/a,height:p/r});break;default:l=(u,f,p,m)=>({x:(u-i)/r,y:(f-n)/a,width:p/r,height:m/a});break}const c=[];for(let u=0,f=e.rangeCount;u<f;u++){const p=e.getRangeAt(u);if(!p.collapsed)for(const{x:m,y:v,width:S,height:b}of p.getClientRects())S===0||b===0||c.push(l(m,v,S,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#x===Mt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const n=this.#I?.get(t);n&&(n.setCanvas(e,i),this.#I.delete(t))}addMissingCanvas(t,e){(this.#I||=new Map).set(t,e)}},Gy=class xs{#t=null;#e=!1;#n=null;#i=null;#a=null;#s=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#u=t._uiManager.useNewAltTextFlow,xs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){xs._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",xs.#f.missing),e.setAttribute("data-l10n-id",xs.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",zi,{signal:i}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const n=r=>{r.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#r=!0,n(r))},{signal:i}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await xs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:n,cancel:r=!1}){i&&(this.#l=i,this.#d=n),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",xs.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",xs.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const n=100,r=this.#c._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}},Mc=class{#t=null;#e=null;#n=!1;#i=null;#a=null;#s=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=this.#i.commentButtonColor;n&&(i.backgroundColor=n)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:n,y:r,width:a,height:l}=this.#i.parent.boundingClientRect;return[(t-n)/a,(e+i-r)/l]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=this.#i._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",zi,{signal:i}),e&&(t.addEventListener("focusin",r=>{this.#i._focusEventsAllowed=!1,Ae(r)},{capture:!0,signal:i}),t.addEventListener("focusout",r=>{this.#i._focusEventsAllowed=!0,Ae(r)},{capture:!0,signal:i})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const n=r=>{r.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#n=!0,n(r))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,n;if(e)[i,n]=e;else{[i,n]=this.#i.commentButtonPosition;const{width:f,height:p,x:m,y:v}=this.#i;i=m+i*f,n=v+n*p}const r=this.#i.parent.boundingClientRect,{x:a,y:l,width:c,height:u}=r;this.#i._uiManager.editComment(this.#i,a+i*c,l+n*u,{...t,parentDimensions:r})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#s=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#s=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#s=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}},sp=class y0{#t;#e=!1;#n=null;#i;#a;#s;#r;#o=null;#c;#l=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:a=null,signal:l}){this.#t=t,this.#n=i,this.#i=e,this.#a=n,this.#s=r,this.#r=a,this.#d=new AbortController,this.#c=AbortSignal.any([l,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ps.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const n=this.#o=new AbortController,r=AbortSignal.any([this.#c,n.signal]),a=this.#t,l={capture:!0,signal:r,passive:!1},c=u=>{u.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};a.addEventListener("pointerdown",u=>{u.pointerType==="touch"&&(Ae(u),c(u))},l),a.addEventListener("pointerup",c,l),a.addEventListener("pointercancel",c,l);return}if(!this.#u){this.#u=new AbortController;const n=AbortSignal.any([this.#c,this.#u.signal]),r=this.#t,a={signal:n,capture:!1,passive:!1};r.addEventListener("touchmove",this.#m.bind(this),a);const l=this.#p.bind(this);r.addEventListener("touchend",l,a),r.addEventListener("touchcancel",l,a),a.capture=!0,r.addEventListener("pointerdown",Ae,a),r.addEventListener("pointermove",Ae,a),r.addEventListener("pointercancel",Ae,a),r.addEventListener("pointerup",Ae,a),this.#a?.()}if(Ae(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;Ae(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:n,screenY:r}=e,{screenX:a,screenY:l}=i,c=this.#l,{touch0X:u,touch0Y:f,touch1X:p,touch1Y:m}=c,v=p-u,S=m-f,b=a-n,w=l-r,E=Math.hypot(b,w)||1,C=Math.hypot(v,S)||1;if(!this.#e&&Math.abs(C-E)<=y0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=n,c.touch0Y=r,c.touch1X=a,c.touch1Y=l,!this.#e){this.#e=!0;return}const T=[(n+a)/2,(r+l)/2];this.#s?.(T,C,E)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#r?.()),this.#l&&(Ae(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}},ve=class Jt{#t=null;#e=null;#n=null;#i=null;#a=null;#s=!1;#r=null;#o="";#c=null;#l=null;#d=null;#u=null;#f=null;#m="";#p=!1;#h=null;#g=!1;#v=!1;#b=!1;#y=null;#C=0;#w=0;#A=null;#R=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#E=!1;#T=Jt._zIndex++;static _borderLineWidth=-1;static _colorManager=new X1;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Jt.prototype._resizeWithKeyboard,e=wa.TRANSLATE_SMALL,i=wa.TRANSLATE_BIG;return Ft(this,"_resizerKeyboardManager",new el([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Jt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[r,a];const[l,c]=this.parentDimensions;this.x=t.x/l,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ft(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Y1({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Jt._l10n??=t,Jt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Jt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Jt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){he("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#E}set _isDraggable(t){this.#E=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#k(),this.#u?.remove(),this.#u=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[r,a]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/r,this.y=(e+n)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n),this._onTranslated()}#M([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#M(this.parentDimensions,t,e)}translateInPage(t,e){this.#h||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#h||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[n,r]}=this;if(this.x+=t/n,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[c,u]=this.getBaseTranslation();a+=c,l+=u;const{style:f}=i;f.left=`${(100*a).toFixed(2)}%`,f.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}get _hasBeenResized(){return!!this.#h&&(this.#h[2]!==this.width||this.#h[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Jt,n=i/t,r=i/e;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,n]}=this;let{x:r,y:a,width:l,height:c}=this;if(l*=i,c*=n,r*=i,a*=n,this._mustFixPosition)switch(t){case 0:r=ai(r,0,i-l),a=ai(a,0,n-c);break;case 90:r=ai(r,0,i-c),a=ai(a,l,n);break;case 180:r=ai(r,l,i),a=ai(a,c,n);break;case 270:r=ai(r,c,i),a=ai(a,0,n-l);break}this.x=r/=i,this.y=a/=n;const[u,f]=this.getBaseTranslation();r+=u,a+=f,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#_(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Jt.#_(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Jt.#_(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#F(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const n=document.createElement("div");this.#c.append(n),n.classList.add("resizer",i),n.setAttribute("data-resizer-name",i),n.addEventListener("pointerdown",this.#L.bind(this,i),{signal:e}),n.addEventListener("contextmenu",zi,{signal:e}),n.tabIndex=-1}this.div.prepend(this.#c)}#L(t,e){e.preventDefault();const{isMac:i}=Ve.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#n?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#I.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Ae,{passive:!1,signal:a}),window.addEventListener("contextmenu",zi,{signal:a}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=l,this.div.style.cursor=c,this.#B()};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})}#N(t,e,i,n){this.width=i,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=this.#d;this.#d=null;const r=this.x,a=this.y,l=this.width,c=this.height;r===t&&a===e&&l===i&&c===n||this.addCommands({cmd:this.#N.bind(this,r,a,l,c),undo:this.#N.bind(this,t,e,i,n),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#I(t,e){const[i,n]=this.parentDimensions,r=this.x,a=this.y,l=this.width,c=this.height,u=Jt.MIN_SIZE/i,f=Jt.MIN_SIZE/n,p=this.#D(this.rotation),m=(N,I)=>[p[0]*N+p[2]*I,p[1]*N+p[3]*I],v=this.#D(360-this.rotation),S=(N,I)=>[v[0]*N+v[2]*I,v[1]*N+v[3]*I];let b,w,E=!1,C=!1;switch(t){case"topLeft":E=!0,b=(N,I)=>[0,0],w=(N,I)=>[N,I];break;case"topMiddle":b=(N,I)=>[N/2,0],w=(N,I)=>[N/2,I];break;case"topRight":E=!0,b=(N,I)=>[N,0],w=(N,I)=>[0,I];break;case"middleRight":C=!0,b=(N,I)=>[N,I/2],w=(N,I)=>[0,I/2];break;case"bottomRight":E=!0,b=(N,I)=>[N,I],w=(N,I)=>[0,0];break;case"bottomMiddle":b=(N,I)=>[N/2,I],w=(N,I)=>[N/2,0];break;case"bottomLeft":E=!0,b=(N,I)=>[0,I],w=(N,I)=>[N,0];break;case"middleLeft":C=!0,b=(N,I)=>[0,I/2],w=(N,I)=>[N,I/2];break}const T=b(l,c),_=w(l,c);let R=m(..._);const D=Jt._round(r+R[0]),M=Jt._round(a+R[1]);let L=1,P=1,B,U;if(e.fromKeyboard)({deltaX:B,deltaY:U}=e);else{const{screenX:N,screenY:I}=e,[$,at]=this.#l;[B,U]=this.screenToPageTranslation(N-$,I-at),this.#l[0]=N,this.#l[1]=I}if([B,U]=S(B/i,U/n),E){const N=Math.hypot(l,c);L=P=Math.max(Math.min(Math.hypot(_[0]-T[0]-B,_[1]-T[1]-U)/N,1/l,1/c),u/l,f/c)}else C?L=ai(Math.abs(_[0]-T[0]-B),u,1)/l:P=ai(Math.abs(_[1]-T[1]-U),f,1)/c;const Z=Jt._round(l*L),q=Jt._round(c*P);R=m(...w(Z,q));const Q=D-R[0],nt=M-R[1];this.#h||=[this.x,this.y,this.width,this.height],this.width=Z,this.height=q,this.x=Q,this.y=nt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new z1(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Gy.initialize(Jt._l10n),this.#n=new Gy(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new Mc(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:n}}=this.#i;return{text:e,richText:t,date:i,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Mc(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#i||=new Mc(this),this.#i.setInitialText(t,i),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Mc(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,n]=t.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,l=a+r+1,c=n-100,u=l+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),g0(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#R||=new sp({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#x.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#x(t,e,i){let r=.7*(i/e)+1-.7;if(r===1)return;const a=this.#D(this.rotation),l=(D,M)=>[a[0]*D+a[2]*M,a[1]*D+a[3]*M],[c,u]=this.parentDimensions,f=this.x,p=this.y,m=this.width,v=this.height,S=Jt.MIN_SIZE/c,b=Jt.MIN_SIZE/u;r=Math.max(Math.min(r,1/m,1/v),S/m,b/v);const w=Jt._round(m*r),E=Jt._round(v*r);if(w===m&&E===v)return;this.#h||=[f,p,m,v];const C=l(m/2,v/2),T=Jt._round(f+C[0]),_=Jt._round(p+C[1]),R=l(w/2,E/2);this.x=T-R[0],this.y=_-R[1],this.width=w,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(t){const{isMac:e}=Ve.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(t);return}this.#P(t)}#P(t){const{isMac:e}=Ve.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:r},l=u=>{n.abort(),this.#r=null,this.#p=!1,this._uiManager.endDragSession()||this.#P(u),i&&this._onStopDragging()};e&&(this.#C=t.clientX,this.#w=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",u=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:f,clientY:p,pointerId:m}=u;if(m!==this.#r){Ae(u);return}const[v,S]=this.screenToPageTranslation(f-this.#C,p-this.#w);this.#C=f,this.#w=p,this._uiManager.dragSelectedEditors(v,S)},a),window.addEventListener("touchmove",Ae,a),window.addEventListener("pointerdown",u=>{u.pointerType===this.#o&&(this.#R||u.isPrimary)&&l(u),Ae(u)},a));const c=u=>{if(!this.#r||this.#r===u.pointerId){l(u);return}Ae(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const n=this.parentScale,[r,a]=this.pageDimensions,[l,c]=this.pageTranslation,u=t/n,f=e/n,p=this.x*r,m=this.y*a,v=this.width*r,S=this.height*a;switch(i){case 0:return[p+u+l,a-m-f-S+c,p+u+v+l,a-m-f+c];case 90:return[p+f+l,a-m+u+c,p+f+S+l,a-m+u+v+c];case 180:return[p-u-v+l,a-m+f+c,p-u+l,a-m+f+S+c];case 270:return[p-f-S+l,a-m-u-v+c,p-f+l,a-m-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,r,a]=t,l=r-i,c=a-n;switch(this.rotation){case 0:return[i,e-a,l,c];case 90:return[i,e-n,c,l];case 180:return[r,e-n,l,c];case 270:return[r,e-a,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Jt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:n,deleted:r,richText:a},uid:l,pageIndex:c,creationDate:u,modificationDate:f}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:a,contentsObj:{str:t},creationDate:u,modificationDate:i||f,popupRef:!r,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return e<a&&n>0&&t<r&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,n.#t=t.accessibilityData,n._isCopy=t.isCopy||!1;const[r,a]=n.pageDimensions,[l,c,u,f]=n.getRectInCurrentCoords(t.rect,a);return n.x=l/r,n.y=c/a,n.width=u/r,n.height=f/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#k(),this.removeEditToolbar(),this.#A){for(const t of this.#A.values())clearTimeout(t);this.#A=null}this.parent=null,this.#R?.destroy(),this.#R=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,n,r,a]=this.getPDFRect();return[Jt._round(i+(r-i)*t),Jt._round(n+(a-n)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const a=this.#Y.bind(this),l=this.#X.bind(this),c=this._uiManager._signal;for(const u of this.#e){const f=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",this.#W.bind(this,f),{signal:c}),u.setAttribute("data-l10n-id",Jt._l10nResizer[f])}}const i=this.#e[0];let n=0;for(const a of e){if(a===i)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==n){if(r<n)for(let l=0;l<n-r;l++)this.#c.append(this.#c.firstChild);else if(r>n)for(let l=0;l<r-n;l++)this.#c.firstChild.before(this.#c.lastChild);let a=0;for(const l of e){const u=this.#e[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Jt._l10nResizer[u])}}this.#j(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){Jt._resizerKeyboardManager.exec(this,t)}#X(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#k()}#W(t){this.#m=this.#b?t:""}#j(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#I(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#k(){this.#b=!1,this.#j(-1),this.#B()}_stopResizingWithKeyboard(){this.#k(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#A||=new Map;const{action:i}=t;let n=this.#A.get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),this.#A.delete(i),this.#A.size===0&&(this.#A=null)},Jt._telemetryTimeout),this.#A.set(i,n);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(t){if(!this.#u&&!this.deleted){this.#u=t.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}},Y1=class extends ve{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}};const Vy=3285377520,tn=4294901760,Sn=65535;let b0=class{constructor(t){this.h1=t?t&4294967295:Vy,this.h2=t?t&4294967295:Vy}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,w=t.length;b<w;b++){const E=t.charCodeAt(b);E<=255?e[i++]=E:(e[i++]=E>>>8,e[i++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,r=i-n*4,a=new Uint32Array(e.buffer,0,n);let l=0,c=0,u=this.h1,f=this.h2;const p=3432918353,m=461845907,v=p&Sn,S=m&Sn;for(let b=0;b<n;b++)b&1?(l=a[b],l=l*p&tn|l*v&Sn,l=l<<15|l>>>17,l=l*m&tn|l*S&Sn,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[b],c=c*p&tn|c*v&Sn,c=c<<15|c>>>17,c=c*m&tn|c*S&Sn,f^=c,f=f<<13|f>>>19,f=f*5+3864292196);switch(l=0,r){case 3:l^=e[n*4+2]<<16;case 2:l^=e[n*4+1]<<8;case 1:l^=e[n*4],l=l*p&tn|l*v&Sn,l=l<<15|l>>>17,l=l*m&tn|l*S&Sn,n&1?u^=l:f^=l}this.h1=u,this.h2=f}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&tn|t*36045&Sn,e=e*4283543511&tn|((e<<16|t>>>16)*2950163797&tn)>>>16,t^=e>>>1,t=t*444984403&tn|t*60499&Sn,e=e*3301882366&tn|((e<<16|t>>>16)*3120437893&tn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}};const xf=Object.freeze({map:null,hash:"",transfer:void 0});let rp=class{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof ve&&this.#n.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#i.values())if(i instanceof ve)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let n=!1;if(i!==void 0)for(const[r,a]of Object.entries(e))i[r]!==a&&(n=!0,i[r]=a);else n=!0,this.#i.set(t,e);n&&this.#a(),e instanceof ve&&((this.#n||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new A0(this)}get serializable(){if(this.#i.size===0)return xf;const t=new Map,e=new b0,i=[],n=Object.create(null);let r=!1;for(const[a,l]of this.#i){const c=l instanceof ve?l.serialize(!1,n):l;c&&(t.set(a,c),e.update(`${a}:${JSON.stringify(c)}`),r||=!!c.bitmap)}if(r)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:xf}get editorStats(){let t=null;const e=new Map;let i=0,n=0;for(const r of this.#i.values()){if(!(r instanceof ve)){r.popup&&(r.popup.deleted?n+=1:i+=1);continue}r.isCommentDeleted?n+=1:r.hasEditedComment&&(i+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:l}=a;e.has(l)||e.set(l,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const c=t[l]||=new Map;for(const[u,f]of Object.entries(a)){if(u==="type")continue;let p=c.get(u);p||(p=new Map,c.set(u,p));const m=p.get(f)??0;p.set(f,m+1)}}if((n>0||i>0)&&(t||=Object.create(null),t.comments={deleted:n,edited:i}),!t)return null;for(const[r,a]of e)t[r]=a.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#n?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const e of this.#n.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}},A0=class extends rp{#t;constructor(t){super();const{map:e,hash:i,transfer:n}=t.serializable,r=structuredClone(e,n?{transfer:n}:null);this.#t={map:r,hash:i,transfer:n}}get print(){he("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ft(this,"modifiedIds",{ids:new Set,hash:""})}},W1=class{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Yt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:a}=t,l=new FontFace(n,r,a);this.addNativeFontFace(l);try{await l.load(),this.#t.add(n),i?.(t)}catch{Ot(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}he("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw Ot(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ft(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ft(this,"isSyncFontLoadingSupported",di||Ve.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Yt(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ft(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(_,R){return _.charCodeAt(R)<<24|_.charCodeAt(R+1)<<16|_.charCodeAt(R+2)<<8|_.charCodeAt(R+3)&255}function n(_,R,D,M){const L=_.substring(0,R),P=_.substring(R+D);return L+M+P}let r,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function f(_,R){if(++u>30){Ot("Load test font never loaded."),R();return}if(c.font="30px "+_,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(f.bind(null,_,R))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=n(m,976,p.length,p);const S=16,b=1482184792;let w=i(m,S);for(r=0,a=p.length-3;r<a;r+=4)w=w-b+i(p,r)|0;r<p.length&&(w=w-b+i(p+"XXX",r)|0),m=n(m,S,4,L1(w));const E=`url(data:font/opentype;base64,${btoa(m)});`,C=`@font-face {font-family:"${p}";src:${E}}`;this.insertRule(C);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const _ of[t.loadedName,p]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=_,T.append(R)}this._document.body.append(T),f(p,()=>{T.remove(),e.complete()})}},K1=class{#t;constructor(t,e=null,i,n){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),n&&(this.charProcOperatorList=n)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${a0(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let n;try{n=t.get(i)}catch(a){Ot(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(n||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=r}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}};function q1(d){if(d instanceof URL)return d.href;if(typeof d=="string"){if(di)return d;const t=URL.parse(d,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Q1(d){if(di&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return Jo(d);if(d instanceof ArrayBuffer||ArrayBuffer.isView(d)||typeof d=="object"&&!isNaN(d?.length))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Oc(d){if(typeof d!="string")return null;if(d.endsWith("/"))return d;throw new Error(`Invalid factory url: "${d}" must include trailing slash.`)}const Rf=d=>typeof d=="object"&&Number.isInteger(d?.num)&&d.num>=0&&Number.isInteger(d?.gen)&&d.gen>=0,Z1=d=>typeof d=="object"&&typeof d?.name=="string",S0=k1.bind(null,Rf,Z1);let J1=class{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[n]of this.#t)n.call(this,i)})}addEventListener(t,e,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:r}=i;if(r.aborted){Ot("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);n=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}this.#t.set(e,n)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}};const Lc={DATA:1,ERROR:2},Ne={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Xy(){}function Ti(d){if(d instanceof Jn||d instanceof sh||d instanceof Fy||d instanceof Go||d instanceof Jd)return d;switch(d instanceof Error||typeof d=="object"&&d!==null||he('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new Jn(d.message);case"InvalidPDFException":return new sh(d.message);case"PasswordException":return new Fy(d.message,d.code);case"ResponseException":return new Go(d.message,d.status,d.missing);case"UnknownErrorException":return new Jd(d.message,d.details)}return new Jd(d.message,d.toString())}let Po=class{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,n=this.callbackCapabilities[i];if(!n)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Lc.DATA)n.resolve(t.data);else if(t.callback===Lc.ERROR)n.reject(Ti(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,n=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(a){r.postMessage({sourceName:i,targetName:n,callback:Lc.DATA,callbackId:t.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:n,callback:Lc.ERROR,callbackId:t.callbackId,reason:Ti(a)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,i,n){const r=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const f=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:t,streamId:r,data:e,desiredSize:u.desiredSize},n),f.promise},pull:u=>{const f=Promise.withResolvers();return this.streamControllers[r].pullCall=f,c.postMessage({sourceName:a,targetName:l,stream:Ne.PULL,streamId:r,desiredSize:u.desiredSize}),f.promise},cancel:u=>{Yt(u instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[r].cancelCall=f,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:Ne.CANCEL,streamId:r,reason:Ti(u)}),f.promise}},i)}#n(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,r=this.comObj,a=this,l=this.actionHandler[t.action],c={enqueue(u,f=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=f,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:n,stream:Ne.ENQUEUE,streamId:e,chunk:u},p)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:n,stream:Ne.CLOSE,streamId:e}),delete a.streamSinks[e])},error(u){Yt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:n,stream:Ne.ERROR,streamId:e,reason:Ti(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(l,t.data,c).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ne.START_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ne.START_COMPLETE,streamId:e,reason:Ti(u)})})}#i(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,r=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case Ne.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Ti(t.reason));break;case Ne.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Ti(t.reason));break;case Ne.PULL:if(!l){r.postMessage({sourceName:i,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||Xy).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,reason:Ti(u)})});break;case Ne.ENQUEUE:if(Yt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Ne.CLOSE:if(Yt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#a(a,e);break;case Ne.ERROR:Yt(a,"error should have stream controller"),a.controller.error(Ti(t.reason)),this.#a(a,e);break;case Ne.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Ti(t.reason)),this.#a(a,e);break;case Ne.CANCEL:if(!l)break;const c=Ti(t.reason);Promise.try(l.onCancel||Xy,c).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ne.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ne.CANCEL_COMPLETE,streamId:e,reason:Ti(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}},E0=class{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){he("Abstract method `_createCanvas` called.")}},tw=class extends E0{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}},w0=class{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){he("Abstract method `_fetch` called.")}},Yy=class extends w0{async _fetch(t){const e=await xa(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Jo(e)}},T0=class{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,r){return"none"}destroy(t=!1){}},ew=class extends T0{#t;#e;#n;#i;#a;#s;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#n){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#a.createElementNS(Yn,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#a.createElementNS(Yn,"defs"),t.append(i),i.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const c=t[0],u=new Array(256);for(let p=0;p<256;p++)u[p]=c[p]/255;const f=u.join(",");return[f,f,f]}const[e,i,n]=t,r=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)r[c]=e[c]/255,a[c]=i[c]/255,l[c]=n[c]/255;return[r.join(","),a.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(tl(e)?Ot('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Zf(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,n,r]=this.#d(t),a=t.length===1?i:`${i}${n}${r}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#i}_transfer_map_${this.#r++}`,c=this.#u(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#p(l);return this.#g(i,n,r,u),c}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let r=this.#c.get(n);if(r?.key===i||(r?(r.filter?.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},this.#c.set(n,r)),!t||!e))return r.url;const a=this.#b(t);t=gt.makeHexColor(...a);const l=this.#b(e);if(e=gt.makeHexColor(...l),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const c=new Array(256);for(let v=0;v<=255;v++){const S=v/255;c[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const u=c.join(","),f=`g_${this.#i}_hcm_filter`,p=r.filter=this.#p(f);this.#g(u,u,u,p),this.#m(p);const m=(v,S)=>{const b=a[v]/255,w=l[v]/255,E=new Array(S+1);for(let C=0;C<=S;C++)E[C]=b+C/S*(w-b);return E.join(",")};return this.#g(m(0,5),m(1,5),m(2,5),p),r.url=this.#u(f),r.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),n=`alpha_${i}`;if(e=this.#o.get(n),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_alpha_map_${this.#r++}`,a=this.#u(r);this.#o.set(t,a),this.#o.set(n,a);const l=this.#p(r);return this.#v(i,l),a}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,n;if(t?([i]=this.#d([t]),n=`luminosity_${i}`):n="luminosity",e=this.#o.get(n),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_luminosity_map_${this.#r++}`,a=this.#u(r);this.#o.set(t,a),this.#o.set(n,a);const l=this.#p(r);return this.#f(l),t&&this.#v(i,l),a}addHighlightHCMFilter(t,e,i,n,r){const a=`${e}-${i}-${n}-${r}`;let l=this.#c.get(t);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#c.set(t,l)),!e||!i))return l.url;const[c,u]=[e,i].map(this.#b.bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[m,v]=[n,r].map(this.#b.bind(this));p<f&&([f,p,m,v]=[p,f,v,m]),this.#l.style.color="";const S=(E,C,T)=>{const _=new Array(256),R=(p-f)/T,D=E/255,M=(C-E)/(255*T);let L=0;for(let P=0;P<=T;P++){const B=Math.round(f+P*R),U=D+P*M;for(let Z=L;Z<=B;Z++)_[Z]=U;L=B+1}for(let P=L;P<256;P++)_[P]=_[L-1];return _.join(",")},b=`g_${this.#i}_hcm_${t}_filter`,w=l.filter=this.#p(b);return this.#m(w),this.#g(S(m[0],v[0],5),S(m[1],v[1],5),S(m[2],v[2],5),w),l.url=this.#u(b),l.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(Yn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(Yn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#a.createElementNS(Yn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#h(t,e,i){const n=this.#a.createElementNS(Yn,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)}#g(t,e,i,n){const r=this.#a.createElementNS(Yn,"feComponentTransfer");n.append(r),this.#h(r,"feFuncR",t),this.#h(r,"feFuncG",e),this.#h(r,"feFuncB",i)}#v(t,e){const i=this.#a.createElementNS(Yn,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#b(t){return this.#l.style.color=t,Ra(getComputedStyle(this.#l).getPropertyValue("color"))}},C0=class{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){he("Abstract method `_fetch` called.")}},Wy=class extends C0{async _fetch(t){const e=await xa(t,"arraybuffer");return new Uint8Array(e)}},x0=class{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){he("Abstract method `_fetch` called.")}},Ky=class extends x0{async _fetch(t){const e=await xa(t,"arraybuffer");return new Uint8Array(e)}};di&&Ot("Please use the `legacy` build in Node.js environments.");async function ap(d){const e=await process.getBuiltinModule("fs").promises.readFile(d);return new Uint8Array(e)}let iw=class extends T0{},nw=class extends E0{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}},sw=class extends w0{async _fetch(t){return ap(t)}},rw=class extends C0{async _fetch(t){return ap(t)}},aw=class extends x0{async _fetch(t){return ap(t)}};const ra="__forcedDependency",{floor:qy,ceil:Qy}=Math;function Pc(d,t,e,i,n,r){d[t*4+0]=Math.min(d[t*4+0],e),d[t*4+1]=Math.min(d[t*4+1],i),d[t*4+2]=Math.max(d[t*4+2],n),d[t*4+3]=Math.max(d[t*4+3],r)}const _f=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];let ow=class{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===_f}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}};const Nc=(d,t)=>{if(!d)return;let e=d.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},d.set(t,e)),e};let lw=class{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[ra]:[]};#n=new Map;#i=[];#a=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#u=new Map;#f;#m;#p;#h;#g;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#v(e),i&&(this.#g=new Map)}growOperationsCount(t){t>=this.#h.length&&this.#v(t,this.#h)}#v(t,e){const i=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(i),this.#h=new Uint32Array(i),e&&e.length>0?(this.#h.set(e),this.#h.fill(_f,e.length)):this.#h.fill(_f)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[ra]:{__proto__:this.#e[ra]}},this.#r={__proto__:this.#r},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const i=this.#i.pop();return i!==void 0&&(Nc(this.#g,t)?.dependencies.add(i),this.#h[t]=this.#h[i]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(Nc(this.#g,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(Nc(this.#g,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}pushBaseTransform(t){return this.#s.push(gt.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#n.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(ra,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(ra,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,n,r,a){const l=gt.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform()),c=[1/0,1/0,-1/0,-1/0];gt.axialAlignedBoundingBox([i,r,n,a],l,c);const u=gt.intersect(this.#r,c);return u?(this.#r[0]=u[0],this.#r[1]=u[1],this.#r[2]=u[2],this.#r[3]=u[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,i,n,r,a){const l=this.#r;if(l[0]===1/0)return this;const c=gt.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform());if(l[0]===-1/0)return gt.axialAlignedBoundingBox([i,r,n,a],c,this.#o),this;const u=[1/0,1/0,-1/0,-1/0];return gt.axialAlignedBoundingBox([i,r,n,a],c,u),this.#o[0]=Math.min(this.#o[0],Math.max(u[0],l[0])),this.#o[1]=Math.min(this.#o[1],Math.max(u[1],l[1])),this.#o[2]=Math.max(this.#o[2],Math.min(u[2],l[2])),this.#o[3]=Math.max(this.#o[3],Math.min(u[3],l[3])),this}recordCharacterBBox(t,e,i,n=1,r=0,a=0,l){const c=i.bbox;let u,f;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&this.#u.get(i),u!==!1&&(f=[0,0,0,0],gt.axialAlignedBoundingBox(c,i.fontMatrix,f),(n!==1||r!==0||a!==0)&&gt.scaleMinMax([n,0,0,-n,r,a],f),u)))return this.recordBBox(t,e,f[0],f[2],f[1],f[3]);if(!l)return this.recordFullPageBBox(t);const p=l();return c&&f&&u===void 0&&(u=f[0]<=r-p.actualBoundingBoxLeft&&f[2]>=r+p.actualBoundingBoxRight&&f[1]<=a-p.actualBoundingBoxAscent&&f[3]>=a+p.actualBoundingBoxDescent,this.#u.set(i,u),u)?this.recordBBox(t,e,f[0],f[2],f[1],f[3]):this.recordBBox(t,e,r-p.actualBoundingBoxLeft,r+p.actualBoundingBoxRight,a-p.actualBoundingBoxAscent,a+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,n=this.#t,r=this.#e;for(const a of e)a in this.#t?i.add(n[a]):a in r&&r[a].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#l.add(this.#n.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[ra]),this.#g){const i=Nc(this.#g,t),{dependencies:n}=i;this.#l.forEach(n.add,n),this.#i.forEach(n.add,n),this.#a.forEach(n.add,n),n.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=qy(this.#o[0]*256/this.#f),n=qy(this.#o[1]*256/this.#m),r=Qy(this.#o[2]*256/this.#f),a=Qy(this.#o[3]*256/this.#m);Pc(this.#p,t,i,n,r,a);for(const l of this.#l)l!==t&&Pc(this.#p,l,i,n,r,a);for(const l of this.#i)l!==t&&Pc(this.#p,l,i,n,r,a);for(const l of this.#a)l!==t&&Pc(this.#p,l,i,n,r,a);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of i)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#u.clear(),new ow(this.#h,this.#p)}takeDebugMetadata(){return this.#g}},Zy=class R0{#t;#e;#n;#i=0;#a=0;constructor(t,e,i){if(t instanceof R0&&t.#n===!!i)return t;this.#t=t,this.#e=e,this.#n=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,n,r,a){return this.#n||this.#t.recordClipBox(this.#e,e,i,n,r,a),this}recordBBox(t,e,i,n,r,a){return this.#n||this.#t.recordBBox(this.#e,e,i,n,r,a),this}recordCharacterBBox(t,e,i,n,r,a,l){return this.#n||this.#t.recordCharacterBBox(this.#e,e,i,n,r,a,l),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};const en={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ei={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Df(d,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),d.clip(n)}let op=class{isModifyingCurrentTransform(){return!1}getPattern(){he("Abstract method `getPattern` called.")}},cw=class extends op{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let r;if(n===ei.STROKE||n===ei.FILL){const a=e.current.getClippedPathBoundingBox(n,ye(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=e.cachedCanvases.getCanvas("pattern",l,c),f=u.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-a[0],-a[1]),i=gt.transform(i,[1,0,0,1,a[0],a[1]]),f.transform(...e.baseTransform),this.matrix&&f.transform(...this.matrix),Df(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),r=t.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(i);r.setTransform(p)}else Df(t,this._bbox),r=this._createGradient(t);return r}};function nf(d,t,e,i,n,r,a,l){const c=t.coords,u=t.colors,f=d.data,p=d.width*4;let m;c[e+1]>c[i+1]&&(m=e,e=i,i=m,m=r,r=a,a=m),c[i+1]>c[n+1]&&(m=i,i=n,n=m,m=a,a=l,l=m),c[e+1]>c[i+1]&&(m=e,e=i,i=m,m=r,r=a,a=m);const v=(c[e]+t.offsetX)*t.scaleX,S=(c[e+1]+t.offsetY)*t.scaleY,b=(c[i]+t.offsetX)*t.scaleX,w=(c[i+1]+t.offsetY)*t.scaleY,E=(c[n]+t.offsetX)*t.scaleX,C=(c[n+1]+t.offsetY)*t.scaleY;if(S>=C)return;const T=u[r],_=u[r+1],R=u[r+2],D=u[a],M=u[a+1],L=u[a+2],P=u[l],B=u[l+1],U=u[l+2],Z=Math.round(S),q=Math.round(C);let Q,nt,N,I,$,at,ut,k;for(let j=Z;j<=q;j++){if(j<w){const V=j<S?0:(S-j)/(S-w);Q=v-(v-b)*V,nt=T-(T-D)*V,N=_-(_-M)*V,I=R-(R-L)*V}else{let V;j>C?V=1:w===C?V=0:V=(w-j)/(w-C),Q=b-(b-E)*V,nt=D-(D-P)*V,N=M-(M-B)*V,I=L-(L-U)*V}let K;j<S?K=0:j>C?K=1:K=(S-j)/(S-C),$=v-(v-E)*K,at=T-(T-P)*K,ut=_-(_-B)*K,k=R-(R-U)*K;const st=Math.round(Math.min(Q,$)),ht=Math.round(Math.max(Q,$));let J=p*j+st*4;for(let V=st;V<=ht;V++)K=(Q-V)/(Q-$),K<0?K=0:K>1&&(K=1),f[J++]=nt-(nt-at)*K|0,f[J++]=N-(N-ut)*K|0,f[J++]=I-(I-k)*K|0,f[J++]=255}}function hw(d,t,e){const i=t.coords,n=t.colors;let r,a;switch(t.type){case"lattice":const l=t.verticesPerRow,c=Math.floor(i.length/l)-1,u=l-1;for(r=0;r<c;r++){let f=r*l;for(let p=0;p<u;p++,f++)nf(d,e,i[f],i[f+1],i[f+l],n[f],n[f+1],n[f+l]),nf(d,e,i[f+l+1],i[f+1],i[f+l],n[f+l+1],n[f+1],n[f+l])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)nf(d,e,i[r],i[r+1],i[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}let uw=class extends op{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,f=Math.ceil(this._bounds[3])-c,p=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(f*t[1]*1.1)),3e3),v=u/p,S=f/m,b={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/v,scaleY:1/S},w=p+4,E=m+4,C=i.getCanvas("mesh",w,E),T=C.context,_=T.createImageData(p,m);if(e){const D=_.data;for(let M=0,L=D.length;M<L;M+=4)D[M]=e[0],D[M+1]=e[1],D[M+2]=e[2],D[M+3]=255}for(const D of this._figures)hw(_,D,b);return T.putImageData(_,2,2),{canvas:C.canvas,offsetX:l-2*v,offsetY:c-2*S,scaleX:v,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,n){Df(t,this._bbox);const r=new Float32Array(2);if(n===ei.SHADING)gt.singularValueDecompose2dScale(ye(t),r);else if(this.matrix){gt.singularValueDecompose2dScale(this.matrix,r);const[l,c]=r;gt.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=l,r[1]*=c}else gt.singularValueDecompose2dScale(e.baseTransform,r);const a=this._createMeshCanvas(r,n===ei.SHADING?null:this._background,e.cachedCanvases);return n!==ei.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}},dw=class extends op{getPattern(){return"hotpink"}};function fw(d){switch(d[0]){case"RadialAxial":return new cw(d);case"Mesh":return new uw(d);case"Dummy":return new dw}throw new Error(`Unknown IR type: ${d[0]}`)}const Jy={COLORED:1,UNCOLORED:2};let pw=class _0{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t,e){const{bbox:i,operatorList:n,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:f}=this;u=Math.abs(u),f=Math.abs(f),ph("TilingType: "+a);const p=i[0],m=i[1],v=i[2],S=i[3],b=v-p,w=S-m,E=new Float32Array(2);gt.singularValueDecompose2dScale(this.matrix,E);const[C,T]=E;gt.singularValueDecompose2dScale(this.baseTransform,E);const _=C*E[0],R=T*E[1];let D=b,M=w,L=!1,P=!1;const B=Math.ceil(u*_),U=Math.ceil(f*R),Z=Math.ceil(b*_),q=Math.ceil(w*R);B>=Z?D=u:L=!0,U>=q?M=f:P=!0;const Q=this.getSizeAndScale(D,this.ctx.canvas.width,_),nt=this.getSizeAndScale(M,this.ctx.canvas.height,R),N=t.cachedCanvases.getCanvas("pattern",Q.size,nt.size),I=N.context,$=c.createCanvasGraphics(I,e);if($.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext($,r,l),I.translate(-Q.scale*p,-nt.scale*m),$.transform(0,Q.scale,0,0,nt.scale,0,0),I.save(),$.dependencyTracker?.save(),this.clipBbox($,p,m,v,S),$.baseTransform=ye($.ctx),$.executeOperatorList(n),$.endDrawing(),$.dependencyTracker?.restore(),I.restore(),L||P){const at=N.canvas;L&&(D=u),P&&(M=f);const ut=this.getSizeAndScale(D,this.ctx.canvas.width,_),k=this.getSizeAndScale(M,this.ctx.canvas.height,R),j=ut.size,K=k.size,st=t.cachedCanvases.getCanvas("pattern-workaround",j,K),ht=st.context,J=L?Math.floor(b/u):0,V=P?Math.floor(w/f):0;for(let rt=0;rt<=J;rt++)for(let lt=0;lt<=V;lt++)ht.drawImage(at,j*rt,K*lt,j,K,0,0,j,K);return{canvas:st.canvas,scaleX:ut.scale,scaleY:k.scale,offsetX:p,offsetY:m}}return{canvas:N.canvas,scaleX:Q.scale,scaleY:nt.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,i){const n=Math.max(_0.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=n?r=n:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,n,r){const a=n-e,l=r-i;t.ctx.rect(e,i,a,l),gt.axialAlignedBoundingBox([e,i,n,r],ye(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,r=t.current;switch(e){case Jy.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;n.fillStyle=r.fillColor=a,n.strokeStyle=r.strokeColor=l;break;case Jy.UNCOLORED:n.fillStyle=n.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new O1(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,n,r){let a=i;n!==ei.SHADING&&(a=gt.transform(a,e.baseTransform),this.matrix&&(a=gt.transform(a,this.matrix)));const l=this.createPatternCanvas(e,r);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=t.createPattern(l.canvas,"repeat");return u.setTransform(c),u}};function gw({src:d,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const l=Ve.isLittleEndian?4278190080:255,[c,u]=a?[r,l]:[l,r],f=i>>3,p=i&7,m=d.length;e=new Uint32Array(e.buffer);let v=0;for(let S=0;S<n;S++){for(const w=t+f;t<w;t++){const E=t<m?d[t]:255;e[v++]=E&128?u:c,e[v++]=E&64?u:c,e[v++]=E&32?u:c,e[v++]=E&16?u:c,e[v++]=E&8?u:c,e[v++]=E&4?u:c,e[v++]=E&2?u:c,e[v++]=E&1?u:c}if(p===0)continue;const b=t<m?d[t++]:255;for(let w=0;w<p;w++)e[v++]=b&1<<7-w?u:c}return{srcPos:t,destPos:v}}const tb=16,eb=100,mw=15,ib=10,xi=16,sf=new DOMMatrix,Ui=new Float32Array(2),da=new Float32Array([1/0,1/0,-1/0,-1/0]);function vw(d,t){if(d._removeMirroring)throw new Error("Context is already forwarding operations.");d.__originalSave=d.save,d.__originalRestore=d.restore,d.__originalRotate=d.rotate,d.__originalScale=d.scale,d.__originalTranslate=d.translate,d.__originalTransform=d.transform,d.__originalSetTransform=d.setTransform,d.__originalResetTransform=d.resetTransform,d.__originalClip=d.clip,d.__originalMoveTo=d.moveTo,d.__originalLineTo=d.lineTo,d.__originalBezierCurveTo=d.bezierCurveTo,d.__originalRect=d.rect,d.__originalClosePath=d.closePath,d.__originalBeginPath=d.beginPath,d._removeMirroring=()=>{d.save=d.__originalSave,d.restore=d.__originalRestore,d.rotate=d.__originalRotate,d.scale=d.__originalScale,d.translate=d.__originalTranslate,d.transform=d.__originalTransform,d.setTransform=d.__originalSetTransform,d.resetTransform=d.__originalResetTransform,d.clip=d.__originalClip,d.moveTo=d.__originalMoveTo,d.lineTo=d.__originalLineTo,d.bezierCurveTo=d.__originalBezierCurveTo,d.rect=d.__originalRect,d.closePath=d.__originalClosePath,d.beginPath=d.__originalBeginPath,delete d._removeMirroring},d.save=function(){t.save(),this.__originalSave()},d.restore=function(){t.restore(),this.__originalRestore()},d.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},d.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},d.transform=function(e,i,n,r,a,l){t.transform(e,i,n,r,a,l),this.__originalTransform(e,i,n,r,a,l)},d.setTransform=function(e,i,n,r,a,l){t.setTransform(e,i,n,r,a,l),this.__originalSetTransform(e,i,n,r,a,l)},d.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},d.rotate=function(e){t.rotate(e),this.__originalRotate(e)},d.clip=function(e){t.clip(e),this.__originalClip(e)},d.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},d.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},d.bezierCurveTo=function(e,i,n,r,a,l){t.bezierCurveTo(e,i,n,r,a,l),this.__originalBezierCurveTo(e,i,n,r,a,l)},d.rect=function(e,i,n,r){t.rect(e,i,n,r),this.__originalRect(e,i,n,r)},d.closePath=function(){t.closePath(),this.__originalClosePath()},d.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}let yw=class{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}};function Ic(d,t,e,i,n,r,a,l,c,u){const[f,p,m,v,S,b]=ye(d);if(p===0&&m===0){const C=a*f+S,T=Math.round(C),_=l*v+b,R=Math.round(_),D=(a+c)*f+S,M=Math.abs(Math.round(D)-T)||1,L=(l+u)*v+b,P=Math.abs(Math.round(L)-R)||1;return d.setTransform(Math.sign(f),0,0,Math.sign(v),T,R),d.drawImage(t,e,i,n,r,0,0,M,P),d.setTransform(f,p,m,v,S,b),[M,P]}if(f===0&&v===0){const C=l*m+S,T=Math.round(C),_=a*p+b,R=Math.round(_),D=(l+u)*m+S,M=Math.abs(Math.round(D)-T)||1,L=(a+c)*p+b,P=Math.abs(Math.round(L)-R)||1;return d.setTransform(0,Math.sign(p),Math.sign(m),0,T,R),d.drawImage(t,e,i,n,r,0,0,P,M),d.setTransform(f,p,m,v,S,b),[P,M]}d.drawImage(t,e,i,n,r,a,l,c,u);const w=Math.hypot(f,p),E=Math.hypot(m,v);return[w*c,E*u]}let nb=class{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Sf;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Qe.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=da.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=ei.FILL,e=null){const i=this.minMax.slice();if(t===ei.STROKE){e||he("Stroke bounding box must include transform."),gt.singularValueDecompose2dScale(e,Ui);const n=Ui[0]*this.lineWidth/2,r=Ui[1]*this.lineWidth/2;i[0]-=n,i[1]-=r,i[2]+=n,i[3]+=r}return i}updateClipFromPath(){const t=gt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(da,0)}getClippedPathBoundingBox(t=ei.FILL,e=null){return gt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}};function sb(d,t){if(t instanceof ImageData){d.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%xi,r=(e-n)/xi,a=n===0?r:r+1,l=d.createImageData(i,xi);let c=0,u;const f=t.data,p=l.data;let m,v,S,b;if(t.kind===Ho.GRAYSCALE_1BPP){const w=f.byteLength,E=new Uint32Array(p.buffer,0,p.byteLength>>2),C=E.length,T=i+7>>3,_=4294967295,R=Ve.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(S=m<r?xi:n,u=0,v=0;v<S;v++){const D=w-c;let M=0;const L=D>T?i:D*8-7,P=L&-8;let B=0,U=0;for(;M<P;M+=8)U=f[c++],E[u++]=U&128?_:R,E[u++]=U&64?_:R,E[u++]=U&32?_:R,E[u++]=U&16?_:R,E[u++]=U&8?_:R,E[u++]=U&4?_:R,E[u++]=U&2?_:R,E[u++]=U&1?_:R;for(;M<L;M++)B===0&&(U=f[c++],B=128),E[u++]=U&B?_:R,B>>=1}for(;u<C;)E[u++]=0;d.putImageData(l,0,m*xi)}}else if(t.kind===Ho.RGBA_32BPP){for(v=0,b=i*xi*4,m=0;m<r;m++)p.set(f.subarray(c,c+b)),c+=b,d.putImageData(l,0,v),v+=xi;m<a&&(b=i*n*4,p.set(f.subarray(c,c+b)),d.putImageData(l,0,v))}else if(t.kind===Ho.RGB_24BPP)for(S=xi,b=i*S,m=0;m<a;m++){for(m>=r&&(S=n,b=i*S),u=0,v=b;v--;)p[u++]=f[c++],p[u++]=f[c++],p[u++]=f[c++],p[u++]=255;d.putImageData(l,0,m*xi)}else throw new Error(`bad image kind: ${t.kind}`)}function rb(d,t){if(t.bitmap){d.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%xi,r=(e-n)/xi,a=n===0?r:r+1,l=d.createImageData(i,xi);let c=0;const u=t.data,f=l.data;for(let p=0;p<a;p++){const m=p<r?xi:n;({srcPos:c}=gw({src:u,srcPos:c,dest:f,width:i,height:m,nonBlackColor:0})),d.putImageData(l,0,p*xi)}}function To(d,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)d[i]!==void 0&&(t[i]=d[i]);d.setLineDash!==void 0&&(t.setLineDash(d.getLineDash()),t.lineDashOffset=d.lineDashOffset)}function kc(d){d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0);const{filter:t}=d;t!=="none"&&t!==""&&(d.filter="none")}function ab(d,t){if(t)return!0;gt.singularValueDecompose2dScale(d,Ui);const e=Math.fround(Ps.pixelRatio*ur.PDF_TO_CSS_UNITS);return Ui[0]<=e&&Ui[1]<=e}const bw=["butt","round","square"],Aw=["miter","round","bevel"],Sw={},ob={};let qc=class D0{constructor(t,e,i,n,r,{optionalContentConfig:a,markedContentStack:l=null},c,u,f){this.ctx=t,this.current=new nb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new yw(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=f??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=l,i){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...ye(this.compositeCtx))}this.ctx.save(),kc(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ye(this.ctx)}executeOperatorList(t,e,i,n,r){const a=t.argsArray,l=t.fnArray;let c=e||0;const u=a.length;if(u===c)return c;const f=u-c>ib&&typeof i=="function",p=f?Date.now()+mw:0;let m=0;const v=this.commonObjs,S=this.objs;let b,w;for(;;){if(n!==void 0&&c===n.nextBreakPoint)return n.breakIt(c,i),c;if(!r||r(c))if(b=l[c],w=a[c]??null,b!==Ea.dependency)w===null?this[b](c):this[b](c,...w);else for(const E of w){this.dependencyTracker?.recordNamedData(E,c);const C=E.startsWith("g_")?v:S;if(!C.has(E))return C.get(E,i),c}if(c++,c===u)return c;if(f&&++m>ib){if(Date.now()>p)return i(),c;m=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,n=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=i,c=n,u="prescale1",f,p;for(;r>2&&l>1||a>2&&c>1;){let m=l,v=c;r>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/m),a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/v),f=this.cachedCanvases.getCanvas(u,m,v),p=f.context,p.clearRect(0,0,m,v),p.drawImage(t,0,0,l,c,0,0,m,v),t=f.canvas,l=m,c=v,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t,e){const i=this.ctx,{width:n,height:r}=e,a=this.current.fillColor,l=this.current.patternFill,c=ye(i);let u,f,p,m;if((e.bitmap||e.data)&&e.count>1){const B=e.bitmap||e.data.buffer;f=JSON.stringify(l?c:[c.slice(0,4),a]),u=this._cachedBitmapsMap.get(B),u||(u=new Map,this._cachedBitmapsMap.set(B,u));const U=u.get(f);if(U&&!l){const Z=Math.round(Math.min(c[0],c[2])+c[4]),q=Math.round(Math.min(c[1],c[3])+c[5]);return this.dependencyTracker?.recordDependencies(t,en.transformAndFill),{canvas:U,offsetX:Z,offsetY:q}}p=U}p||(m=this.cachedCanvases.getCanvas("maskCanvas",n,r),rb(m.context,e));let v=gt.transform(c,[1/n,0,0,-1/r,0,0]);v=gt.transform(v,[1,0,0,1,0,-r]);const S=da.slice();gt.axialAlignedBoundingBox([0,0,n,r],v,S);const[b,w,E,C]=S,T=Math.round(E-b)||1,_=Math.round(C-w)||1,R=this.cachedCanvases.getCanvas("fillCanvas",T,_),D=R.context,M=b,L=w;D.translate(-M,-L),D.transform(...v),p||(p=this._scaleImage(m.canvas,An(D)),p=p.img,u&&l&&u.set(f,p)),D.imageSmoothingEnabled=ab(ye(D),e.interpolate),Ic(D,p,0,0,p.width,p.height,0,0,n,r),D.globalCompositeOperation="source-in";const P=gt.transform(An(D),[1,0,0,1,-M,-L]);return D.fillStyle=l?a.getPattern(i,this,P,ei.FILL,t):a,D.fillRect(0,0,n,r),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(f,R.canvas)),this.dependencyTracker?.recordDependencies(t,en.transformAndFill),{canvas:R.canvas,offsetX:Math.round(M),offsetY:Math.round(L)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=bw[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Aw[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,n]of e)switch(i){case"LW":this.setLineWidth(t,n);break;case"LC":this.setLineCap(t,n);break;case"LJ":this.setLineJoin(t,n);break;case"ML":this.setMiterLimit(t,n);break;case"D":this.setDash(t,n[0],n[1]);break;case"RI":this.setRenderingIntent(t,n);break;case"FL":this.setFlatness(t,n);break;case"Font":this.setFont(t,n[0],n[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=n;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=n;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,i);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),To(this.suspendedCtx,a),vw(a,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),To(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const r=n[0],a=n[1],l=n[2]-r,c=n[3]-a;l===0||c===0||(this.genericComposeSMask(e.context,i,l,c,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,r,a,l,c,u,f,p){let m=t.canvas,v=c-f,S=u-p;if(a)if(v<0||S<0||v+i>m.width||S+n>m.height){const w=this.cachedCanvases.getCanvas("maskExtension",i,n),E=w.context;E.drawImage(m,-v,-S),E.globalCompositeOperation="destination-atop",E.fillStyle=a,E.fillRect(0,0,i,n),E.globalCompositeOperation="source-over",m=w.canvas,v=S=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(v,S,i,n),t.clip(w),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(v,S,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const b=new Path2D;b.rect(c,u,i,n),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(m,v,S,i,n,c,u,i,n),e.restore()}save(t){this.inSMaskMode&&To(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&To(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,n,r,a,l){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,n,r,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,n){let[r]=i;if(!n){r||=i[0]=new Path2D,this[e](t,r);return}if(this.dependencyTracker!==null){const a=e===Ea.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-a,n[2]+a,n[1]-a,n[3]+a).recordDependencies(t,["transform"])}if(!(r instanceof Path2D)){const a=i[0]=new Path2D;for(let l=0,c=r.length;l<c;)switch(r[l++]){case Dc.moveTo:a.moveTo(r[l++],r[l++]);break;case Dc.lineTo:a.lineTo(r[l++],r[l++]);break;case Dc.curveTo:a.bezierCurveTo(r[l++],r[l++],r[l++],r[l++],r[l++],r[l++]);break;case Dc.closePath:a.closePath();break;default:Ot(`Unrecognized drawing path operator: ${r[l-1]}`);break}r=a}gt.axialAlignedBoundingBox(n,ye(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const n=this.ctx,r=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const a=r.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=r.getPattern(n,this,An(n),ei.STROKE,t),a){const l=new Path2D;l.addPath(e,n.getTransform().invertSelf().multiplySelf(a)),e=l}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,en.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(ei.STROKE,ye(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const n=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const u=r.isModifyingCurrentTransform()?n.getTransform():null;if(this.dependencyTracker?.save(t),n.save(),n.fillStyle=r.getPattern(n,this,An(n),ei.FILL,t),u){const f=new Path2D;f.addPath(e,n.getTransform().invertSelf().multiplySelf(u)),e=f}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),this.dependencyTracker?.recordDependencies(t,en.fill),l&&(n.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,c)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,en.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Sw}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ob}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;e!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",t),n.recordCloseMarker(t)}if(e!==void 0){const n=new Path2D,r=i.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:u,path:f}of e)f&&n.addPath(f,new DOMMatrix(a).preMultiplySelf(r).translate(l,c).scale(u,-u));i.clip(n)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||Sf,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ot("Invalid font matrix for font "+e),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=n.systemFontInfo?.css||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const u=n.italic?"italic":"normal";let f=i;i<tb?f=tb:i>eb&&(f=eb),this.current.fontSizeScale=i/f,this.ctx.font=`${u} ${c} ${f}px ${l}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,i){const n=new Path2D;return n.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),n}paintChar(t,e,i,n,r,a){const l=this.ctx,c=this.current,u=c.font,f=c.textRenderingMode,p=c.fontSize/c.fontSizeScale,m=f&Qe.FILL_STROKE_MASK,v=!!(f&Qe.ADD_TO_PATH_FLAG),S=c.patternFill&&!u.missingFile,b=c.patternStroke&&!u.missingFile;let w;if((u.disableFontFace||v||S||b)&&!u.missingFile&&(w=u.getPathGenerator(this.commonObjs,e)),w&&(u.disableFontFace||S||b)){l.save(),l.translate(i,n),l.scale(p,-p),this.dependencyTracker?.recordCharacterBBox(t,l,u);let E;if(m===Qe.FILL||m===Qe.FILL_STROKE)if(r){E=l.getTransform(),l.setTransform(...r);const C=this.#n(w,E,r);l.fill(C)}else l.fill(w);if(m===Qe.STROKE||m===Qe.FILL_STROKE)if(a){E||=l.getTransform(),l.setTransform(...a);const{a:C,b:T,c:_,d:R}=E,D=gt.inverseTransform(a),M=gt.transform([C,T,_,R,0,0],D);gt.singularValueDecompose2dScale(M,Ui),l.lineWidth*=Math.max(Ui[0],Ui[1])/p,l.stroke(this.#n(w,E,a))}else l.lineWidth/=p,l.stroke(w);l.restore()}else(m===Qe.FILL||m===Qe.FILL_STROKE)&&(l.fillText(e,i,n),this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n,()=>l.measureText(e))),(m===Qe.STROKE||m===Qe.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n,()=>l.measureText(e)).recordDependencies(t,en.stroke),l.strokeText(e,i,n));v&&((this.pendingTextPaths||=[]).push({transform:ye(l),x:i,y:n,fontSize:p,path:w}),this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return Ft(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,en.showText).resetBBox(t),this.current.textRenderingMode&Qe.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,n=i.font;if(n.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const r=i.fontSize;if(r===0){this.dependencyTracker?.recordOperation(t);return}const a=this.ctx,l=i.fontSizeScale,c=i.charSpacing,u=i.wordSpacing,f=i.fontDirection,p=i.textHScale*f,m=e.length,v=n.vertical,S=v?1:-1,b=n.defaultVMetrics,w=r*i.fontMatrix[0],E=i.textRenderingMode===Qe.FILL&&!n.disableFontFace&&!i.patternFill;a.save(),i.textMatrix&&a.transform(...i.textMatrix),a.translate(i.x,i.y+i.textRise),f>0?a.scale(p,-1):a.scale(p,1);let C,T;if(i.patternFill){a.save();const L=i.fillColor.getPattern(a,this,An(a),ei.FILL,t);C=ye(a),a.restore(),a.fillStyle=L}if(i.patternStroke){a.save();const L=i.strokeColor.getPattern(a,this,An(a),ei.STROKE,t);T=ye(a),a.restore(),a.strokeStyle=L}let _=i.lineWidth;const R=i.textMatrixScale;if(R===0||_===0){const L=i.textRenderingMode&Qe.FILL_STROKE_MASK;(L===Qe.STROKE||L===Qe.FILL_STROKE)&&(_=this.getSinglePixelWidth())}else _/=R;if(l!==1&&(a.scale(l,l),_/=l),a.lineWidth=_,n.isInvalidPDFjsFont){const L=[];let P=0;for(const U of e)L.push(U.unicode),P+=U.width;const B=L.join("");if(a.fillText(B,0,0),this.dependencyTracker!==null){const U=a.measureText(B);this.dependencyTracker.recordBBox(t,this.ctx,-U.actualBoundingBoxLeft,U.actualBoundingBoxRight,-U.actualBoundingBoxAscent,U.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=P*w*p,a.restore(),this.compose();return}let D=0,M;for(M=0;M<m;++M){const L=e[M];if(typeof L=="number"){D+=S*L*r/1e3;continue}let P=!1;const B=(L.isSpace?u:0)+c,U=L.fontChar,Z=L.accent;let q,Q,nt=L.width;if(v){const $=L.vmetric||b,at=-(L.vmetric?$[1]:nt*.5)*w,ut=$[2]*w;nt=$?-$[0]:nt,q=at/l,Q=(D+ut)/l}else q=D/l,Q=0;let N;if(n.remeasure&&nt>0){N=a.measureText(U);const $=N.width*1e3/r*l;if(nt<$&&this.isFontSubpixelAAEnabled){const at=nt/$;P=!0,a.save(),a.scale(at,1),q/=at}else nt!==$&&(q+=(nt-$)/2e3*r/l)}if(this.contentVisible&&(L.isInFont||n.missingFile)){if(E&&!Z)a.fillText(U,q,Q),this.dependencyTracker?.recordCharacterBBox(t,a,N?{bbox:null}:n,r/l,q,Q,()=>N??a.measureText(U));else if(this.paintChar(t,U,q,Q,C,T),Z){const $=q+r*Z.offset.x/l,at=Q-r*Z.offset.y/l;this.paintChar(t,Z.fontChar,$,at,C,T)}}const I=v?nt*w-B*f:nt*w+B*f;D+=I,P&&a.restore()}v?i.y-=D:i.x+=D*p,a.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,n=this.current,r=n.font,a=n.fontSize,l=n.fontDirection,c=r.vertical?1:-1,u=n.charSpacing,f=n.wordSpacing,p=n.textHScale*l,m=n.fontMatrix||Sf,v=e.length,S=n.textRenderingMode===Qe.INVISIBLE;let b,w,E,C;if(S||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(p,l);const T=this.dependencyTracker;for(this.dependencyTracker=T?new Zy(T,t):null,b=0;b<v;++b){if(w=e[b],typeof w=="number"){C=c*w*a/1e3,this.ctx.translate(C,0),n.x+=C*p;continue}const _=(w.isSpace?f:0)+u,R=r.charProcOperatorList[w.operatorListId];R?this.contentVisible&&(this.save(),i.scale(a,a),i.transform(...m),this.executeOperatorList(R),this.restore()):Ot(`Type3 character "${w.operatorListId}" is not available.`);const D=[w.width,0];gt.applyTransform(D,m),E=D[0]*a+_,i.translate(E,0),n.x+=E*p}i.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,n,r,a,l){const c=new Path2D;c.rect(n,r,a-n,l-r),this.ctx.clip(c),this.dependencyTracker?.recordBBox(t,this.ctx,n,a,r,l).recordClipBox(t,this.ctx,n,a,r,l),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const n=this.baseTransform||ye(this.ctx),r={createCanvasGraphics:(a,l)=>new D0(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Zy(this.dependencyTracker,l,!0):null)};i=new pw(e,this.ctx,r,n)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=fw(this.getObject(t,e)),this.cachedPatterns.set(e,n)),i&&(n.matrix=i),n}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const n=this._getPattern(t,e);i.fillStyle=n.getPattern(i,this,An(i),ei.SHADING,t);const r=An(i);if(r){const{width:a,height:l}=i.canvas,c=da.slice();gt.axialAlignedBoundingBox([0,0,a,l],r,c);const[u,f,p,m]=c;this.ctx.fillRect(u,f,p-u,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,en.transform).recordDependencies(t,en.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){he("Should not call beginInlineImage")}beginImageData(){he("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ye(this.ctx),i)){gt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[n,r,a,l]=i,c=new Path2D;c.rect(n,r,a-n,l-r),this.ctx.clip(c),this.dependencyTracker?.recordClipBox(t,this.ctx,n,a,r,l),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||ph("TODO: Support non-isolated groups."),e.knockout&&Ot("Knockout groups not supported.");const n=ye(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=da.slice();gt.axialAlignedBoundingBox(e.bbox,ye(i),r);const a=[0,0,i.canvas.width,i.canvas.height];r=gt.intersect(r,a)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-l,1),f=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,f]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(p,u,f),v=m.context;v.translate(-l,-c),v.transform(...n);let S=new Path2D;const[b,w,E,C]=e.bbox;if(S.rect(b,w,E-b,C-w),e.matrix){const T=new Path2D;T.addPath(S,new DOMMatrix(e.matrix)),S=T}v.clip(S),e.smask&&this.smaskStack.push({canvas:m.canvas,context:v,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(l,c),i.save()),To(i,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=ye(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...r);const a=da.slice();gt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],r,a),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(t,e,i,n,r,a){if(this.#t(),kc(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const l=i[2]-i[0],c=i[3]-i[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=i[0],n[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=l,i[3]=c,gt.singularValueDecompose2dScale(ye(this.ctx),Ui);const{viewportScale:u}=this,f=Math.ceil(l*this.outputScaleX*u),p=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(Ui[0],0,0,-Ui[1],0,c*Ui[1]),kc(this.ctx)}else{kc(this.ctx),this.endPath(t);const u=new Path2D;u.rect(i[0],i[1],l,c),this.ctx.clip(u)}}this.current=new nb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const n=this.ctx,r=this._createMaskCanvas(t,e),a=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,r.offsetX,r.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,n=0,r=0,a,l){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const c=this.ctx;c.save();const u=ye(c);c.transform(i,n,r,a,0,0);const f=this._createMaskCanvas(t,e);c.setTransform(1,0,0,1,f.offsetX-u[4],f.offsetY-u[5]),this.dependencyTracker?.resetBBox(t);for(let p=0,m=l.length;p<m;p+=2){const v=gt.transform(u,[i,n,r,a,l[p],l[p+1]]);c.drawImage(f.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(t,this.ctx,v[4],v[4]+f.canvas.width,v[5],v[5]+f.canvas.height)}c.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,r=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,en.transformAndFill);for(const a of e){const{data:l,width:c,height:u,transform:f}=a,p=this.cachedCanvases.getCanvas("maskCanvas",c,u),m=p.context;m.save();const v=this.getObject(t,l,a);rb(m,v),m.globalCompositeOperation="source-in",m.fillStyle=r?n.getPattern(m,this,An(i),ei.FILL,t):n,m.fillRect(0,0,c,u),m.restore(),i.save(),i.transform(...f),i.scale(1,-1),Ic(i,p.canvas,0,0,c,u,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,c,0,u),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){Ot("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,n,r){if(!this.contentVisible)return;const a=this.getObject(t,e);if(!a){Ot("Dependent image isn't ready yet");return}const l=a.width,c=a.height,u=[];for(let f=0,p=r.length;f<p;f+=2)u.push({transform:[i,0,0,n,r[f],r[f+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(t,a,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,n),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,n=e.height,r=this.ctx;this.save(t);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/i,-1/n);let l;if(e.bitmap)l=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)l=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",i,n).context;sb(f,e),l=this.applyTransferMapsToCanvas(f)}const c=this._scaleImage(l,An(r));r.imageSmoothingEnabled=ab(ye(r),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,r,0,i,-n,0).recordDependencies(t,en.imageXObject).recordOperation(t),Ic(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,i,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const a=e.width,l=e.height,u=this.cachedCanvases.getCanvas("inlineImage",a,l).context;sb(u,e),r=this.applyTransferMapsToCanvas(u)}this.dependencyTracker?.resetBBox(t);for(const a of i)n.save(),n.transform(...a.transform),n.scale(1,-1),Ic(n,r,a.x,a.y,a.w,a.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,1,-1,0),n.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,en.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(n||(this.pendingClip===ob?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ye(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:r}=this.ctx.getTransform();let a,l;if(i===0&&n===0){const c=Math.abs(e),u=Math.abs(r);if(c===u)if(t===0)a=l=1/c;else{const f=c*t;a=l=f<1?1/f:1}else if(t===0)a=1/c,l=1/u;else{const f=c*t,p=u*t;a=f<1?1/f:1,l=p<1?1/p:1}}else{const c=Math.abs(e*r-i*n),u=Math.hypot(e,i),f=Math.hypot(n,r);if(t===0)a=f/c,l=u/c;else{const p=t*c;a=f>p?f/p:1,l=u>p?u/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:n}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(n||1)*r,i.stroke(t);return}const l=i.getLineDash();e&&i.save(),i.scale(r,a),sf.a=1/r,sf.d=1/a;const c=new Path2D;if(c.addPath(t,sf),l.length>0){const u=Math.max(r,a);i.setLineDash(l.map(f=>f/u)),i.lineDashOffset/=u}i.lineWidth=n||1,i.stroke(c),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};for(const d in Ea)qc.prototype[d]!==void 0&&(qc.prototype[Ea[d]]=qc.prototype[d]);let lb=class Qc{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let n=0;for(const u of Qc.strings){const f=e.encode(t[u]);i[u]=f,n+=4+f.length}const r=new ArrayBuffer(n),a=new Uint8Array(r),l=new DataView(r);let c=0;for(const u of Qc.strings){const f=i[u],p=f.length;l.setUint32(c,p),a.set(f,c+4),c+=4+p}return Yt(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Yt(t<Qc.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}},cb=class Zc{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let n=0;for(const m of Zc.strings){const v=e.encode(t[m]);i[m]=v,n+=4+v.length}n+=4;let r,a,l=1+n;t.style&&(r=e.encode(t.style.style),a=e.encode(t.style.weight),l+=4+r.length+4+a.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),f=new DataView(c);let p=0;f.setUint8(p++,t.guessFallback?1:0),f.setUint32(p,0),p+=4,n=0;for(const m of Zc.strings){const v=i[m],S=v.length;n+=4+S,f.setUint32(p,S),u.set(v,p+4),p+=4+S}return f.setUint32(p-n-4,n),t.style&&(f.setUint32(p,r.length),u.set(r,p+4),p+=4+r.length,f.setUint32(p,a.length),u.set(a,p+4),p+=4+a.length),Yt(p<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(p)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Yt(t<Zc.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#n.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const n=this.#e.getUint32(t),r=this.#n.decode(new Uint8Array(this.#t,t+4,n));return{style:i,weight:r}}},Ew=class oe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#a=this.#i+1+6;#s;#r;#o;constructor({data:t,extra:e}){this.#s=t,this.#r=new TextDecoder,this.#o=new DataView(this.#s),e&&Object.assign(this,e)}#c(t){Yt(t<oe.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,n=this.#o.getUint8(e)>>i&3;return n===0?void 0:n===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Yt(t<oe.numbers.length,"Invalid number index"),this.#o.getFloat64(oe.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=oe.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<4;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=oe.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<6;n++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=oe.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<3;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Yt(t<oe.strings.length,"Invalid string index");let e=oe.#a+4;for(let r=0;r<t;r++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),n=new Uint8Array(i);return n.set(new Uint8Array(this.#s,e+4,i)),this.#r.decode(n)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=oe.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);if(r!==0)return new Uint8Array(this.#s,t+4,r)}clearData(){let t=oe.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);new Uint8Array(this.#s,t+4,r).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=oe.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(this.#s,t+4,n)),new lb(r.buffer)}get systemFontInfo(){let t=oe.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const n=new Uint8Array(i);return n.set(new Uint8Array(this.#s,t+4,i)),new cb(n.buffer)}static write(t){const e=t.systemFontInfo?cb.write(t.systemFontInfo):null,i=t.cssFontInfo?lb.write(t.cssFontInfo):null,n=new TextEncoder,r={};let a=0;for(const b of oe.strings)r[b]=n.encode(t[b]),a+=4+r[b].length;const l=oe.#a+4+a+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),f=new DataView(c);let p=0;const m=oe.bools.length;let v=0,S=0;for(let b=0;b<m;b++){const w=t[oe.bools[b]];v|=(w===void 0?0:w?2:1)<<S,S+=2,(S===8||b===m-1)&&(f.setUint8(p++,v),v=0,S=0)}Yt(p===oe.#t,"FontInfo.write: Boolean properties offset mismatch");for(const b of oe.numbers)f.setFloat64(p,t[b]),p+=8;if(Yt(p===oe.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){f.setUint8(p++,4);for(const b of t.bbox)f.setInt16(p,b,!0),p+=2}else f.setUint8(p++,0),p+=8;if(Yt(p===oe.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){f.setUint8(p++,6);for(const b of t.fontMatrix)f.setFloat64(p,b,!0),p+=8}else f.setUint8(p++,0),p+=48;if(Yt(p===oe.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){f.setUint8(p++,1);for(const b of t.defaultVMetrics)f.setInt16(p,b,!0),p+=2}else f.setUint8(p++,0),p+=6;Yt(p===oe.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),f.setUint32(oe.#a,0),p+=4;for(const b of oe.strings){const w=r[b],E=w.length;f.setUint32(p,E),u.set(w,p+4),p+=4+E}if(f.setUint32(oe.#a,p-oe.#a-4),!e)f.setUint32(p,0),p+=4;else{const b=e.byteLength;f.setUint32(p,b),Yt(p+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(e),p+4),p+=4+b}if(!i)f.setUint32(p,0),p+=4;else{const b=i.byteLength;f.setUint32(p,b),Yt(p+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(i),p+4),p+=4+b}return t.data===void 0?(f.setUint32(p,0),p+=4):(f.setUint32(p,t.data.length),u.set(t.data,p+4),p+=4+t.data.length),Yt(p<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(p)}},Os=class{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}},ww=class{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}};const la=Symbol("INTERNAL");let Tw=class{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:i,usage:n,rbGroups:r}){this.#t=!!(t&Fi.DISPLAY),this.#e=!!(t&Fi.PRINT),this.name=e,this.intent=i,this.usage=n,this.rbGroups=r}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==la&&he("Internal method `_setVisible` called."),this.#n=i,this.#i=e}},Cw=class{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=Fi.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new Tw(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(la,!1);for(const i of t.on)this.#e.get(i)._setVisible(la,!0);for(const i of t.off)this.#e.get(i)._setVisible(la,!1);this.#n=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const r=t[n];let a;if(Array.isArray(r))a=this.#a(r);else if(this.#e.has(r))a=this.#e.get(r).visible;else return Ot(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ph("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Ot(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Ot(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Ot(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Ot(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Ot(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Ot(`Unknown optional content policy ${t.policy}.`),!0}return Ot(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const n=this.#e.get(t);if(!n){Ot(`Optional content group not found: ${t}`);return}if(i&&e&&n.rbGroups.length)for(const r of n.rbGroups)for(const a of r)a!==t&&this.#e.get(a)?._setVisible(la,!1,!0);n._setVisible(la,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const r=this.#e.get(n);if(r)switch(i){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new b0;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}},xw=class{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Yt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,r?.length>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(i),!0)});Yt(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Yt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Rw(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new _w(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}},Rw=class{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=mh(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},_w=class{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function Dw(d){let t=!0,e=i("filename\\*","i").exec(d);if(e){e=e[1];let f=l(e);return f=unescape(f),f=c(f),f=u(f),r(f)}if(e=a(d),e){const f=u(e);return r(f)}if(e=i("filename","i").exec(d),e){e=e[1];let f=l(e);return f=u(f),r(f)}function i(f,p){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function n(f,p){if(f){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(f,{fatal:!0}),v=Jo(p);p=m.decode(v),t=!1}catch{}}return p}function r(f){return t&&/[\x80-\xff]/.test(f)&&(f=n("utf-8",f),t&&(f=n("iso-8859-1",f))),f}function a(f){const p=[];let m;const v=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(f))!==null;){let[,b,w,E]=m;if(b=parseInt(b,10),b in p){if(b===0)break;continue}p[b]=[w,E]}const S=[];for(let b=0;b<p.length&&b in p;++b){let[w,E]=p[b];E=l(E),w&&(E=unescape(E),b===0&&(E=c(E))),S.push(E)}return S.join("")}function l(f){if(f.startsWith('"')){const p=f.slice(1).split('\\"');for(let m=0;m<p.length;++m){const v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}f=p.join('"')}return f}function c(f){const p=f.indexOf("'");if(p===-1)return f;const m=f.slice(0,p),S=f.slice(p+1).replace(/^[^']*'/,"");return n(m,S)}function u(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,S){if(v==="q"||v==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,w){return String.fromCharCode(parseInt(w,16))}),n(m,S);try{S=atob(S)}catch{}return n(m,S)})}return""}function M0(d,t){const e=new Headers;if(!d||!t||typeof t!="object")return e;for(const i in t){const n=t[i];n!==void 0&&e.append(i,n)}return e}function vh(d){return URL.parse(d)?.origin??null}function O0({responseHeaders:d,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(d.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*e)||i||!t||d.get("Accept-Ranges")!=="bytes"||(d.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function L0(d){const t=d.get("Content-Disposition");if(t){let e=Dw(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(mh(e))return e}return null}function il(d,t){return new Go(`Unexpected server response (${d}) while retrieving PDF "${t}".`,d,d===404||d===0&&t.startsWith("file:"))}function P0(d){return d===200||d===206}function N0(d,t,e){return{method:"GET",headers:d,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function I0(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:(Ot(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}let Mw=class{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=M0(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Yt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Ow(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Lw(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}},Ow=class{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),n=e.url;fetch(n,N0(i,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=vh(r.url),!P0(r.status))throw il(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:l,suggestedLength:c}=O0({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=L0(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Jn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:I0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}},Lw=class{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${i-1}`);const a=n.url;fetch(a,N0(r,this._withCredentials,this._abortController)).then(l=>{const c=vh(l.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!P0(l.status))throw il(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:I0(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}};const rf=200,af=206;function Pw(d){const t=d.response;return typeof t!="string"?t:Jo(t).buffer}let Nw=class{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=M0(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,a]of this.headers)e.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=af):n.expectedStatus=rf,e.responseType="arraybuffer",Yt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){i.onError(n.status);return}const r=n.status||rf;if(!(r===rf&&i.expectedStatus===af)&&r!==i.expectedStatus){i.onError(n.status);return}const l=Pw(n);if(r===af){const c=n.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?i.onDone({begin:parseInt(u[1],10),chunk:l}):(Ot('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone({begin:0,chunk:l}):i.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}},Iw=class{constructor(t){this._source=t,this._manager=new Nw(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Yt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new kw(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new Fw(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}},kw=class{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=vh(e.responseURL);const i=e.getAllResponseHeaders(),n=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=O0({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=L0(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=il(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},Fw=class{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=vh(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=il(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}};const Bw=/^[a-z][a-z0-9\-+.]+:/i;function Uw(d){if(Bw.test(d))return new URL(d);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(d))}let Hw=class{constructor(t){this.source=t,this.url=Uw(t.url),Yt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Yt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new zw(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new jw(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}},zw=class{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=il(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Jn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},jw=class{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}};const Co=Symbol("INITIAL_DATA");let k0=class{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Co}}get(t,e=null){if(e){const n=this.#e(t);return n.promise.then(()=>e(n.data)),null}const i=this.#t[t];if(!i||i.data===Co)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Co}delete(t){const e=this.#t[t];return!e||e.data===Co?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Co&&(yield[t,e])}}};const $w=1e5,hb=30;let Vo=class rn{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#s=null;#r=0;#o=0;#c=null;#l=null;#d=0;#u=0;#f=Object.create(null);#m=[];#p=null;#h=[];#g=new WeakMap;#v=null;static#b=new Map;static#y=new Map;static#C=new WeakMap;static#w=null;static#A=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(c){c.enqueue(t),c.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#u=i.scale*Ps.pixelRatio,this.#d=i.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:r,pageX:a,pageY:l}=i.rawDims;this.#v=[1,0,0,-1,-a,l+r],this.#o=n,this.#r=r,rn.#D(),Ls(e,i),this.#t.promise.finally(()=>{rn.#A.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ve.platform;return Ft(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#R(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),rn.#A.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Ps.pixelRatio,n=t.rotation;if(n!==this.#d&&(e?.(),this.#d=n,Ls(this.#l,{rotation:n})),i!==this.#u){e?.(),this.#u=i;const r={div:null,properties:null,ctx:rn.#M(this.#a)};for(const a of this.#h)r.properties=this.#g.get(a),r.div=a,this.#T(r)}}cancel(){const t=new Jn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#m}#R(t){if(this.#n)return;this.#s.ctx??=rn.#M(this.#a);const e=this.#h,i=this.#m;for(const n of t){if(e.length>$w){Ot("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),n.id&&this.#e.setAttribute("id",`${n.id}`),r.append(this.#e)}else n.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(n.str),this.#E(n)}}#E(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const n=gt.transform(this.#v,t.transform);let r=Math.atan2(n[1],n[0]);const a=this.#f[t.fontName];a.vertical&&(r+=Math.PI/2);let l=this.#i&&a.fontSubstitution||a.fontFamily;l=rn.fontFamilyMap.get(l)||l;const c=Math.hypot(n[2],n[3]),u=c*rn.#F(l,a,this.#a);let f,p;r===0?(f=n[4],p=n[5]-u):(f=n[4]+u*Math.sin(r),p=n[5]-u*Math.cos(r));const m="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#l?(v.left=`${(100*f/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#r).toFixed(2)}%`):(v.left=`${m}${f.toFixed(2)}px)`,v.top=`${m}${p.toFixed(2)}px)`),v.fontSize=`${m}${(rn.#w*c).toFixed(2)}px)`,v.fontFamily=l,i.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),r!==0&&(i.angle=r*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const b=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);b!==w&&Math.max(b,w)/Math.min(b,w)>1.5&&(S=!0)}if(S&&(i.canvasWidth=a.vertical?t.height:t.width),this.#g.set(e,i),this.#s.div=e,this.#s.properties=i,this.#T(this.#s),i.hasText&&this.#e.append(e),i.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#e.append(b)}}#T(t){const{div:e,properties:i,ctx:n}=t,{style:r}=e;let a="";if(rn.#w>1&&(a=`scale(${1/rn.#w})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:u}=i;rn.#_(n,u*this.#u,l);const{width:f}=n.measureText(e.textContent);f>0&&(a=`scaleX(${c*this.#u/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)}static cleanup(){if(!(this.#A.size>0)){this.#b.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#M(t=null){let e=this.#y.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#C.set(e,{size:0,family:""})}return e}static#_(t,e,i){const n=this.#C.get(t);e===n.size&&i===n.family||(t.font=`${e}px ${i}`,n.size=e,n.family=i)}static#D(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#F(t,e,i){const n=this.#b.get(t);if(n)return n;const r=this.#M(i);r.canvas.width=r.canvas.height=hb,this.#_(r,hb,t);const a=r.measureText(""),l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return l?u=l/(l+c):(Ve.platform.isFirefox&&Ot("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?u=e.ascent:e.descent&&(u=1+e.descent)),this.#b.set(t,u),u}};const Gw=100;function lp(d={}){typeof d=="string"||d instanceof URL?d={url:d}:(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d={data:d});const t=new Vw,{docId:e}=t,i=d.url?q1(d.url):null,n=d.data?Q1(d.data):null,r=d.httpHeaders||null,a=d.withCredentials===!0,l=d.password??null,c=d.range instanceof cp?d.range:null,u=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:2**16;let f=d.worker instanceof oh?d.worker:null;const p=d.verbosity,m=typeof d.docBaseUrl=="string"&&!tl(d.docBaseUrl)?d.docBaseUrl:null,v=Oc(d.cMapUrl),S=d.cMapPacked!==!1,b=d.CMapReaderFactory||(di?sw:Yy),w=Oc(d.iccUrl),E=Oc(d.standardFontDataUrl),C=d.StandardFontDataFactory||(di?rw:Wy),T=Oc(d.wasmUrl),_=d.WasmFactory||(di?aw:Ky),R=d.stopAtErrors!==!0,D=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,M=d.isEvalSupported!==!1,L=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!di,P=typeof d.isImageDecoderSupported=="boolean"?d.isImageDecoderSupported:!di&&(Ve.platform.isFirefox||!globalThis.chrome),B=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,U=typeof d.disableFontFace=="boolean"?d.disableFontFace:di,Z=d.fontExtraProperties===!0,q=d.enableXfa===!0,Q=d.ownerDocument||globalThis.document,nt=d.disableRange===!0,N=d.disableStream===!0,I=d.disableAutoFetch===!0,$=d.pdfBug===!0,at=d.CanvasFactory||(di?nw:tw),ut=d.FilterFactory||(di?iw:ew),k=d.enableHWA===!0,j=d.useWasm!==!1,K=c?c.length:d.length??NaN,st=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!di&&!U,ht=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:!!(b===Yy&&C===Wy&&_===Ky&&v&&E&&T&&Lo(v,document.baseURI)&&Lo(E,document.baseURI)&&Lo(T,document.baseURI)),J=null;_1(p);const V={canvasFactory:new at({ownerDocument:Q,enableHWA:k}),filterFactory:new ut({docId:e,ownerDocument:Q}),cMapReaderFactory:ht?null:new b({baseUrl:v,isCompressed:S}),standardFontDataFactory:ht?null:new C({baseUrl:E}),wasmFactory:ht?null:new _({baseUrl:T})};f||(f=oh.create({verbosity:p,port:Os.workerPort}),t._worker=f);const rt={docId:e,apiVersion:"5.4.296",data:n,password:l,disableAutoFetch:I,rangeChunkSize:u,length:K,docBaseUrl:m,enableXfa:q,evaluatorOptions:{maxImageSize:D,disableFontFace:U,ignoreErrors:R,isEvalSupported:M,isOffscreenCanvasSupported:L,isImageDecoderSupported:P,canvasMaxAreaInBytes:B,fontExtraProperties:Z,useSystemFonts:st,useWasm:j,useWorkerFetch:ht,cMapUrl:v,iccUrl:w,standardFontDataUrl:E,wasmUrl:T}},lt={ownerDocument:Q,pdfBug:$,styleElement:J,loadingParams:{disableAutoFetch:I,enableXfa:q}};return f.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const At=f.messageHandler.sendWithPromise("GetDocRequest",rt,n?[n.buffer]:null);let dt;if(c)dt=new xw(c,{disableRange:nt,disableStream:N});else if(!n){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Bt=Lo(i)?Mw:di?Hw:Iw;dt=new Bt({url:i,length:K,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:nt,disableStream:N})}return At.then(Bt=>{if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const bt=new Po(e,Bt,f.port),_t=new Ww(bt,t,dt,lt,V,k);t._transport=_t,bt.send("Ready",null)})}).catch(t._capability.reject),t}let Vw=class F0{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${F0.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}},cp=class{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#a)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){he("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Xw=class{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ft(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},Yw=class{#t=!1;constructor(t,e,i,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new Uy:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new k0,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:r=!1}={}){return new ip({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ft(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:n="display",annotationMode:r=Rn.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:f=null,printAnnotationStorage:p=null,isEditing:m=!1,recordOperations:v=!1,operationsFilter:S=null}){this._stats?.time("Overall");const b=this._transport.getRenderingIntent(n,r,p,m),{renderingIntent:w,cacheKey:E}=b;this.#t=!1,c||=this._transport.getOptionalContentConfig(w);let C=this._intentStates.get(E);C||(C=Object.create(null),this._intentStates.set(E,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const T=!!(w&Fi.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));const _=!!(this._pdfBug&&globalThis.StepperManager?.enabled),R=!this.recordedBBoxes&&(v||_),D=P=>{if(C.renderTasks.delete(M),R){const B=M.gfx?.dependencyTracker.take();B&&(M.stepper&&M.stepper.setOperatorBBoxes(B,M.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=B))}T&&(this.#t=!0),this.#e(),P?(M.capability.reject(P),this._abortOperatorList({intentState:C,reason:P instanceof Error?P:new Error(P)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new qw({callback:D,params:{canvas:e,canvasContext:t,dependencyTracker:R?new lw(e,C.operatorList.length,_):null,viewport:i,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:f,enableHWA:this._transport.enableHWA,operationsFilter:S});(C.renderTasks||=new Set).add(M);const L=M.task;return Promise.all([C.displayReadyCapability.promise,c]).then(([P,B])=>{if(this.destroyed){D();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:P,optionalContentConfig:B}),M.operatorListChanged()}).catch(D),L}getOperatorList({intent:t="display",annotationMode:e=Rn.ENABLE,printAnnotationStorage:i=null,isEditing:n=!1}={}){function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(t,e,i,n,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Ef.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function r(){a.read().then(function({value:c,done:u}){if(u){i(l);return}l.lang??=c.lang,Object.assign(l.styles,c.styles),l.items.push(...c.items),r()},n)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Uy),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:n}){const{map:r,transfer:a}=i,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:n},a).getReader(),u=this._intentStates.get(e);u.streamReader=c;const f=()=>{c.read().then(({value:p,done:m})=>{if(m){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,u),f())},p=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const m of u.renderTasks)m.operatorListChanged();this.#e()}if(u.displayReadyCapability)u.displayReadyCapability.reject(p);else if(u.opListReadCapability)u.opListReadCapability.reject(p);else throw p}})};f()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof gh){let n=Gw;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Jn(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}};var Ds,fn,Qn,rr,le,uh,ar,or,gi,Jc,B0,U0,No,Aa,th;let oh=(le=class{constructor({name:t=null,port:e=null,verbosity:i=D1()}={}){Be(this,gi);Be(this,Ds,Promise.withResolvers());Be(this,fn,null);Be(this,Qn,null);Be(this,rr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Rt(le,or).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Rt(le,or).set(e,this),Ue(this,gi,B0).call(this,e)}else Ue(this,gi,U0).call(this)}get promise(){return Rt(this,Ds).promise}get port(){return Rt(this,Qn)}get messageHandler(){return Rt(this,fn)}destroy(){this.destroyed=!0,Rt(this,rr)?.terminate(),de(this,rr,null),Rt(le,or).delete(Rt(this,Qn)),de(this,Qn,null),Rt(this,fn)?.destroy(),de(this,fn,null)}static create(t){const e=Rt(this,or).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new le(t)}static get workerSrc(){if(Os.workerSrc)return Os.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ft(this,"_setupFakeWorkerGlobal",(async()=>Rt(this,Aa,th)?Rt(this,Aa,th):(await import(this.workerSrc)).WorkerMessageHandler)())}},Ds=new WeakMap,fn=new WeakMap,Qn=new WeakMap,rr=new WeakMap,uh=new WeakMap,ar=new WeakMap,or=new WeakMap,gi=new WeakSet,Jc=function(){Rt(this,Ds).resolve(),Rt(this,fn).send("configure",{verbosity:this.verbosity})},B0=function(t){de(this,Qn,t),de(this,fn,new Po("main","worker",t)),Rt(this,fn).on("ready",()=>{}),Ue(this,gi,Jc).call(this)},U0=function(){if(Rt(le,ar)||Rt(le,Aa,th)){Ue(this,gi,No).call(this);return}let{workerSrc:t}=le;try{le._isSameOrigin(window.location,t)||(t=le._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Po("main","worker",e),n=()=>{r.abort(),i.destroy(),e.terminate(),this.destroyed?Rt(this,Ds).reject(new Error("Worker was destroyed")):Ue(this,gi,No).call(this)},r=new AbortController;e.addEventListener("error",()=>{Rt(this,rr)||n()},{signal:r.signal}),i.on("test",l=>{if(r.abort(),this.destroyed||!l){n();return}de(this,fn,i),de(this,Qn,e),de(this,rr,e),Ue(this,gi,Jc).call(this)}),i.on("ready",l=>{if(r.abort(),this.destroyed){n();return}try{a()}catch{Ue(this,gi,No).call(this)}});const a=()=>{const l=new Uint8Array;i.send("test",l,[l.buffer])};a();return}catch{ph("The worker has been disabled.")}Ue(this,gi,No).call(this)},No=function(){Rt(le,ar)||(Ot("Setting up fake worker."),de(le,ar,!0)),le._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Rt(this,Ds).reject(new Error("Worker was destroyed"));return}const e=new J1;de(this,Qn,e);const i=`fake${Vd(le,uh)._++}`,n=new Po(i+"_worker",i,e);t.setup(n,e),de(this,fn,new Po(i,i+"_worker",e)),Ue(this,gi,Jc).call(this)}).catch(t=>{Rt(this,Ds).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Aa=new WeakSet,th=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Be(le,Aa),Be(le,uh,0),Be(le,ar,!1),Be(le,or,new WeakMap),di&&(de(le,ar,!0),Os.workerSrc||="./pdf.worker.mjs"),le._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const n=new URL(e,i);return i.origin===n.origin},le._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},le.fromPort=t=>{if(B1("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return le.create(t)},le),Ww=class{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#a=null;constructor(t,e,i,n,r,a){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new k0,this.fontLoader=new W1({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}#s(t,e=null){const i=this.#t.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,n),n}get annotationStorage(){return Ft(this,"annotationStorage",new rp)}getRenderingIntent(t,e=Rn.ENABLE,i=null,n=!1,r=!1){let a=Fi.DISPLAY,l=xf;switch(t){case"any":a=Fi.ANY;break;case"display":break;case"print":a=Fi.PRINT;break;default:Ot(`getRenderingIntent - invalid intent: ${t}`)}const c=a&Fi.PRINT&&i instanceof A0?i:this.annotationStorage;switch(e){case Rn.DISABLE:a+=Fi.ANNOTATIONS_DISABLE;break;case Rn.ENABLE:break;case Rn.ENABLE_FORMS:a+=Fi.ANNOTATIONS_FORMS;break;case Rn.ENABLE_STORAGE:a+=Fi.ANNOTATIONS_STORAGE,l=c.serializable;break;default:Ot(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(a+=Fi.IS_EDITING),r&&(a+=Fi.OPLIST);const{ids:u,hash:f}=c.modifiedIds,p=[a,l.hash,f];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Vo.cleanup(),this._networkStream?.cancelAllRequests(new Jn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{Yt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){n.close();return}Yt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:a}=this._fullReader;return(!n||!r)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:a}}),t.on("GetRangeReader",(i,n)=>{Yt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:a,done:l}){if(l){n.close();return}Yt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{r.cancel(a),n.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new Xw(i,this))}),t.on("DocException",i=>{e._capability.reject(Ti(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Ti(i);const n=r=>{r instanceof Error?this.#a.reject(r):this.#a.resolve({password:r})};e.onPassword(n,i.code)}catch(n){this.#a.reject(n)}return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,r])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":if("error"in r){const f=r.error;Ot(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const a=new Ew(r),l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,c=new K1(a,l,r.extra,r.charProcOperatorList);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(i,c)});break;case"CopyLocalImage":const{imageRef:u}=r;Yt(u,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,p]of f.objs)if(p?.ref===u)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,r,a])=>{if(this.destroyed)return;const l=this.#e.get(n);if(!l.objs.has(i)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[i.type];if(!n)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ot("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#n.get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,t);const a=new Yw(e,r,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#n.set(e,n),n}getPageIndex(t){return Rf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new Cw(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>({info:n[0],metadata:n[1]?new ww(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Vo.cleanup()}}cachedPageNumber(t){if(!Rf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}},Kw=class{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}},qw=class Io{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:f=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:v=!1,operationsFilter:S=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Kw(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=v,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Io.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Io.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:n,background:r,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new qc(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:n,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Io.#e.delete(this._canvas),t||=new gh(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Io.#e.delete(this._canvas),this.callback())))}};const H0="5.4.296",z0="f56dc8601";let hp=class Tn{#t=null;#e=null;#n;#i=null;#a=!1;#s=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ft(this,"_keyboardManager",new el([[["Escape","mac+Escape"],Tn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Tn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Tn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Tn.prototype._moveToPrevious],[["Home","mac+Home"],Tn.prototype._moveToBeginning],[["End","mac+End"],Tn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#r=t):this.#s=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Tn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#n,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",zi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,n]of this.#l.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=i,r.setAttribute("data-l10n-id",Tn.#d[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=n,r.ariaSelected=n===this.#n,r.addEventListener("click",this.#f.bind(this,n),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Vt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastChild?.focus()}#m(t){Tn._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const i of this.#i.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}},j0=class Mf{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Mf.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,n=this.#t=document.createElement("input");return n.type="color",n.value=i||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",Mf.#i[t]),n.addEventListener("input",()=>{this.#n.updateParams(e,n.value)},{signal:this.#n._signal}),n}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}};function ub(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function xo(d){return Math.max(0,Math.min(255,255*d))}let db=class{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=xo(t),[t,t,t]}static G_HTML([t]){const e=ub(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(xo)}static RGB_HTML(t){return`#${t.map(ub).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[xo(1-Math.min(1,t+n)),xo(1-Math.min(1,i+n)),xo(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,r=1-e,a=1-i,l=Math.min(n,r,a);return["CMYK",n,r,a,l]}},Qw=class{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){he("Abstract method `_createSVG` called.")}},Xo=class extends Qw{_createSVG(t){return document.createElementNS(Yn,t)}};const Zw=9,dr=new WeakSet,Jw=new Date().getTimezoneOffset()*60*1e3;let fb=class{static create(t){switch(t.data.annotationType){case Re.LINK:return new up(t);case Re.TEXT:return new eT(t);case Re.WIDGET:switch(t.data.fieldType){case"Tx":return new iT(t);case"Btn":return t.data.radioButton?new G0(t):t.data.checkBox?new sT(t):new rT(t);case"Ch":return new aT(t);case"Sig":return new nT(t)}return new vr(t);case Re.POPUP:return new Of(t);case Re.FREETEXT:return new V0(t);case Re.LINE:return new lT(t);case Re.SQUARE:return new cT(t);case Re.CIRCLE:return new hT(t);case Re.POLYLINE:return new X0(t);case Re.CARET:return new dT(t);case Re.INK:return new dp(t);case Re.POLYGON:return new uT(t);case Re.HIGHLIGHT:return new Y0(t);case Re.UNDERLINE:return new fT(t);case Re.SQUIGGLY:return new pT(t);case Re.STRIKEOUT:return new gT(t);case Re.STAMP:return new W0(t);case Re.FILEATTACHMENT:return new mT(t);default:return new De(t)}}},De=class $0{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return $0._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:n}=this.data;let r=-1/0,a=-1/0;if(e?.length>=8){for(let l=0;l<e.length;l+=8)e[l+1]>a?(a=e[l+1],r=e[l+2]):e[l+1]===a&&(r=Math.max(r,e[l+2]));return[r,a]}if(i?.length>=1){for(const l of i)for(let c=0,u=l.length;c<u;c+=2)l[c+1]>a?(a=l[c+1],r=l[c]):l[c+1]===a&&(r=Math.max(r,l[c]));if(r!==1/0)return[r,a]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:a}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/i,t[1]=100*(t[1]-a)/n,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${$o}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${$o}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#i(e);let n=this.#n?.popup||this.popup;!n&&i?.text&&(this._createPopup(i),n=this.#n.popup),n&&(n.updateEdited(t),i?.deleted&&(n.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-l)/r}%`,e.top=`${100*(a-t[3]+c)/a}%`,n===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof vr)&&!(this instanceof up)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Of){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:l,height:c}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(b>0||w>0){const C=`calc(${b}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;a.borderRadius=C}else if(this instanceof G0){const C=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;a.borderRadius=C}switch(e.borderStyle.style){case oa.SOLID:a.borderStyle="solid";break;case oa.DASHED:a.borderStyle="dashed";break;case oa.BEVELED:Ot("Unimplemented border style: beveled");break;case oa.INSET:Ot("Unimplemented border style: inset");break;case oa.UNDERLINE:a.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,a.borderColor=gt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):a.borderWidth=0}const u=gt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:f,pageHeight:p,pageX:m,pageY:v}=n.rawDims;a.left=`${100*(u[0]-m)/f}%`,a.top=`${100*(u[1]-v)/p}%`;const{rotation:S}=e;return e.hasOwnCanvas||S===0?(a.width=`${100*l/f}%`,a.height=`${100*c/p}%`):this.setRotation(S,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims;let{width:r,height:a}=this;t%180!==0&&([r,a]=[a,r]),e.style.width=`${100*r/i}%`,e.style.height=`${100*a/n}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const r=n.detail[e],a=r[0],l=r.slice(1);n.target.style[i]=db[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[i]:db[`${a}_rgb`](l)})};return Ft(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail))(t[n]||i[n])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,r]of Object.entries(e)){const a=i[n];if(a){const l={detail:{[n]:r},target:t};a(l),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,r]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,w,E,C]=t.subarray(2,6);if(n===b&&r===w&&e===E&&i===C)return}const{style:a}=this.container;let l;if(this.#e){const{borderColor:b,borderWidth:w}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const c=n-e,u=r-i,{svgFactory:f}=this,p=f.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=f.createElement("defs");p.append(m);const v=f.createElement("clipPath"),S=`clippath_${this.data.id}`;v.setAttribute("id",S),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let b=2,w=t.length;b<w;b+=8){const E=t[b],C=t[b+1],T=t[b+2],_=t[b+3],R=f.createElement("rect"),D=(T-e)/c,M=(r-C)/u,L=(E-T)/c,P=(C-_)/u;R.setAttribute("x",D),R.setAttribute("y",M),R.setAttribute("width",L),R.setAttribute("height",P),v.append(R),l?.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${M}" width="${L}" height="${P}"/>`)}this.#e&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${S})`}_createPopup(t=null){const{data:e}=this;let i,n;t?(i={str:t.text},n=t.date):(i=e.contentsObj,n=e.modificationDate);const r=this.#n=new Of({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(r.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){he("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:r,id:a,exportValues:l}of n){if(r===-1||a===e)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!dr.has(u)){Ot(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:c,domElement:u})}return i}for(const n of document.getElementsByName(t)){const{exportValue:r}=n,a=n.getAttribute("data-element-id");a!==e&&dr.has(n)&&i.push({id:a,exportValue:r,domElement:n})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}},tT=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}},up=class extends De{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),n=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),n=!0):t.setOCGState?(this.#n(i,t.setOCGState,t.overlaidText),n=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",n=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#t()}#n(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const r=i.get(n);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Ot('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:n,refs:r,include:a}=e,l=[];if(n.length!==0||r.length!==0){const f=new Set(r);for(const p of n){const m=this._fieldObjects[p]||[];for(const{id:v}of m)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===a&&l.push(m)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const c=this.annotationStorage,u=[];for(const f of l){const{id:p}=f;switch(u.push(p),f.type){case"text":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;c.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!dr.has(m)){Ot(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}},eT=class extends De{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}},vr=class extends De{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ve.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,r){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a)}})})}_setEventListeners(t,e,i,n){for(const[r,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":gt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||Zw,r=t.style;let a;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),f=Math.round(u/(Zd*n))||1,p=u/f;a=Math.min(n,c(p/Zd))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(n,c(u/Zd))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=gt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}},iT=class extends vr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),r.setValue(a.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let r=n.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&r.length>a&&(r=r.slice(0,a));let l=n.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:r,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=l??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",l??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),dr.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:u,datetimeType:f,timeStep:p}=this.data,m=!!f&&this.enableScripting;u&&(i.title=u),this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(i,"value",S.target.value,"value"),c.formattedValue=null}),i.addEventListener("resetform",S=>{const b=this.data.defaultFieldValue??"";i.value=c.userValue=b,c.formattedValue=null});let v=S=>{const{formattedValue:b}=c;b!=null&&(S.target.value=b),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",b=>{if(c.focused)return;const{target:w}=b;if(m&&(w.type=f,p&&(w.step=p)),c.userValue){const E=c.userValue;if(m)if(f==="time"){const C=new Date(E),T=[C.getHours(),C.getMinutes(),C.getSeconds()];w.value=T.map(_=>_.toString().padStart(2,"0")).join(":")}else w.value=new Date(E-Jw).toISOString().split(f==="date"?"T":".",1)[0];else w.value=E}c.lastCommittedValue=w.value,c.commitKey=1,this.data.actions?.Focus||(c.focused=!0)}),i.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const w={value(E){c.userValue=E.detail.value??"",m||t.setValue(e,{value:c.userValue.toString()}),E.target.value=c.userValue},formattedValue(E){const{formattedValue:C}=E.detail;c.formattedValue=C,C!=null&&E.target!==document.activeElement&&(E.target.value=C);const T={formattedValue:C};m&&(T.value=C),t.setValue(e,T)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:C}=E.detail,{target:T}=E;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let _=c.userValue;!_||_.length<=C||(_=_.slice(0,C),T.value=c.userValue=_,t.setValue(e,{value:_}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(w,b)}),i.addEventListener("keydown",b=>{c.commitKey=1;let w=-1;if(b.key==="Escape"?w=0:b.key==="Enter"&&!this.data.multiLine?w=2:b.key==="Tab"&&(c.commitKey=3),w===-1)return;const{value:E}=b.target;c.lastCommittedValue!==E&&(c.lastCommittedValue=E,c.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:w,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const S=v;v=null,i.addEventListener("blur",b=>{if(!c.focused||!b.relatedTarget)return;this.data.actions?.Blur||(c.focused=!1);const{target:w}=b;let{value:E}=w;if(m){if(E&&f==="time"){const C=E.split(":").map(T=>parseInt(T,10));E=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),w.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();w.type="text"}c.userValue=E,c.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:c.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}),S(b)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",b=>{c.lastCommittedValue=null;const{data:w,target:E}=b,{value:C,selectionStart:T,selectionEnd:_}=E;let R=T,D=_;switch(b.inputType){case"deleteWordBackward":{const M=C.substring(0,T).match(/\w*[^\w]*$/);M&&(R-=M[0].length);break}case"deleteWordForward":{const M=C.substring(T).match(/^[^\w]*\w*/);M&&(D+=M[0].length);break}case"deleteContentBackward":T===_&&(R-=1);break;case"deleteContentForward":T===_&&(D+=1);break}b.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:w||"",willCommit:!1,selStart:R,selEnd:D}})}),this._setEventListeners(i,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(v&&i.addEventListener("blur",v),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},nT=class extends vr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}},sT=class extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return dr.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,i)){const f=c&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=f),t.setValue(u.id,{value:f})}t.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const l={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(i,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},G0=class extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(dr.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,i))t.setValue(u.id,{value:!1});t.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const f=a===u.detail.value;for(const p of this._getElementsByName(u.target.name)){const m=f&&p.id===i;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},rT=class extends up{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}},aT=class extends vr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");dr.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue;for(const m of n.options)m.selected=m.value===p});for(const f of this.data.options){const p=document.createElement("option");p.textContent=f.displayValue,p.value=f.exportValue,i.value.includes(f.exportValue)&&(p.setAttribute("selected",!0),r=!1),n.append(p)}let a=null;if(r){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),n.prepend(f),a=()=>{f.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const l=f=>{const p=f?"value":"textContent",{options:m,multiple:v}=n;return v?Array.prototype.filter.call(m,S=>S.selected).map(S=>S[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let c=l(!1);const u=f=>{const p=f.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",f=>{const p={value(m){a?.();const v=m.detail.value,S=new Set(Array.isArray(v)?v:[v]);for(const b of n.options)b.selected=S.has(b.value);t.setValue(e,{value:l(!0)}),c=l(!1)},multipleSelection(m){n.multiple=!0},remove(m){const v=n.options,S=m.detail.remove;v[S].selected=!1,n.remove(S),v.length>0&&Array.prototype.findIndex.call(v,w=>w.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},clear(m){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),c=l(!1)},insert(m){const{index:v,displayValue:S,exportValue:b}=m.detail.insert,w=n.children[v],E=document.createElement("option");E.textContent=S,E.value=b,w?w.before(E):n.append(E),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},items(m){const{items:v}=m.detail;for(;n.length!==0;)n.remove(0);for(const S of v){const{displayValue:b,exportValue:w}=S,E=document.createElement("option");E.textContent=b,E.value=w,n.append(E)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},indices(m){const v=new Set(m.detail.indices);for(const S of m.target.options)S.selected=v.has(S.index);t.setValue(e,{value:l(!0)}),c=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,f)}),n.addEventListener("input",f=>{const p=l(!0),m=l(!1);t.setValue(e,{value:p}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):n.addEventListener("input",function(f){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},Of=class extends De{constructor(t){const{data:e,elements:i,parent:n}=t,r=!!n._commentManager;if(super(t,{isRenderable:!r&&De._hasPopupData(e)}),this.elements=i,r&&De._hasPopupData(e)){const a=this.popup=this.#t();for(const l of i)l.popup=a}else this.popup=null}#t(){return new oT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",i.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(n=>`${tp}${n}`).join(",")),this.container}},oT=class{#t=null;#e=this.#G.bind(this);#n=this.#U.bind(this);#i=this.#P.bind(this);#a=this.#S.bind(this);#s=null;#r=null;#o=null;#c=null;#l=null;#d=null;#u=null;#f=!1;#m=null;#p=null;#h=null;#g=null;#v=null;#b=null;#y=null;#C=null;#w=null;#A=null;#R=!1;#E=null;#T=null;constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:r,contentsObj:a,richText:l,parent:c,rect:u,parentRect:f,open:p,commentManager:m=null}){this.#r=t,this.#w=n,this.#o=a,this.#C=l,this.#d=c,this.#s=e,this.#y=u,this.#u=f,this.#l=i,this.#t=m,this.#E=i[0],this.#c=rh.toDateObject(r),this.trigger=i.flatMap(v=>v.getElementsToTriggerPopup()),m?this.renderCommentButton():(this.#M(),this.#r.hidden=!0,p&&this.#S())}#M(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#n,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#_(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#v=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#v||this.#_(),!this.#v))return;const{signal:t}=this.#p=new AbortController,e=!!this.#E.extraPopupElement,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},n=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#g=this.#E.container;for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",this.#e,{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),a.classList.add("popupTriggerArea")}else{const a=this.#g=document.createElement("button");a.className="annotationCommentButton";const l=this.#E.container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#F(),this.#D(),a.addEventListener("keydown",this.#e,{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),l.after(a)}}#D(){if(this.#E.extraPopupElement&&!this.#E.editor)return;this.renderCommentButton();const[t,e]=this.#v,{style:i}=this.#g;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#F(){this.#E.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#E.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:n,modificationDate:r}=this.#E.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:n,modificationDate:r}}get elementBeforePopup(){return this.#g}get comment(){return this.#T||=this.#E.commentText,this.#T}set comment(t){t!==this.comment&&(this.#E.commentText=this.#T=t)}get parentBoundingClientRect(){return this.#E.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=e)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:i}=this.#g.getBoundingClientRect(),{x:n,y:r,width:a,height:l}=this.#E.layer.getBoundingClientRect();return[(t-n)/a,(e+i-r)/l]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#b||this.commentButtonPosition.map(u=>u/100),n=this.parentBoundingClientRect,{x:r,y:a,width:l,height:c}=n;this.#t.showDialog(null,this,r+e*l,a+i*c,{...t,parentDimensions:n})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#s){const i=t.style.outlineColor=gt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#w?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#w}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}np({html:this.#L||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#L(){const t=this.#C,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#C.html||null}get#N(){return this.#L?.attributes?.style?.fontSize||0}get#B(){return this.#L?.attributes?.style?.color||null}#I(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#B,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:n});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#T=null):e&&(e.deleted?this.remove():(this.#F(),this.#T=e.text)),t&&(this.#v=null,this.#_(),this.#D());return}if(i||e?.deleted){this.remove();return}this.#M(),this.#A||={contentsObj:this.#o,richText:this.#C},t&&(this.#h=null),e&&e.text&&(this.#C=this.#I(e.text),this.#c=rh.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#A&&({contentsObj:this.#o,richText:this.#C}=this.#A,this.#A=null,this.#m?.remove(),this.#m=null,this.#h=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#R=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#x(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:r}}}=this.#d;let a=!!this.#u,l=a?this.#u:this.#y;for(const S of this.#l)if(!l||gt.intersect(S.data.rect,l)!==null){l=S.data.rect,a=!0;break}const c=gt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),f=a?l[2]-l[0]+5:0,p=c[0]+f,m=c[1];this.#h=[100*(p-n)/e,100*(m-r)/i];const{style:v}=this.#r;v.left=`${this.#h[0]}%`,v.top=`${this.#h[1]}%`}#S(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#P(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#U(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#P(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#x(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#R=this.isVisible,this.#R&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#M(),this.#R&&(this.#m||this.#P(),this.#R=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}},V0=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Mt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},lT=class extends De{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},cT=class extends De{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",i-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},hT=class extends De{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",i/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},X0=class extends De{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:n},width:r,height:a}=this;if(!e)return this.container;const l=this.svgFactory.create(r,a,!0);let c=[];for(let f=0,p=e.length;f<p;f+=2){const m=e[f]-t[0],v=t[3]-e[f+1];c.push(`${m},${v}`)}c=c.join(" ");const u=this.#t=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},uT=class extends X0{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},dT=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},dp=class extends De{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Mt.HIGHLIGHT:Mt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:n,popupRef:r}}=this,{transform:a,width:l,height:c}=this.#n(e,t),u=this.svgFactory.create(l,c,!0),f=this.#t=this.svgFactory.createElement("svg:g");u.append(f),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",a);for(let p=0,m=i.length;p<m;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",i[p].join(",")),f.append(v)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:n}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),i)for(let a=0,l=this.#e.length;a<l;a++)this.#e[a].setAttribute("points",i[a].join(","));if(n){const{transform:a,width:l,height:c}=this.#n(this.data.rotation,n);r.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),r.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},Y0=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Mt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}},fT=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}},pT=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}},gT=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}},W0=class extends De{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Mt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},mT=class extends De{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:n}=Ve.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},fp=class K0{#t=null;#e=null;#n=null;#i=new Map;#a=null;#s=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:f}){this.div=t,this.#t=e,this.#e=i,this.#a=l||null,this.#s=u||null,this.#n=f||new rp,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=c||null}hasEditableAnnotations(){return this.#i.size>0}async#r(t,e,i){const n=t.firstChild||t,r=n.id=`${tp}${e}`,a=await this.#a?.getAriaAttributes(r);if(a)for(const[l,c]of a)n.setAttribute(l,c);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,n,!1))}async render(t){const{annotations:e}=t,i=this.div;Ls(i,this.viewport);const n=new Map,r={data:null,layer:i,linkService:this.#s,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Xo,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===Re.POPUP;if(l){const f=n.get(a.id);if(!f)continue;r.elements=f}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const c=fb.create(r);if(!c.isRenderable)continue;if(!l&&a.popupRef){const f=n.get(a.popupRef);f?f.push(c):n.set(a.popupRef,[c])}const u=c.render();a.hidden&&(u.style.visibility="hidden"),await this.#r(u,a.id,r.elements),c.extraPopupElement?.popup?.renderCommentButton(),c._isEditable&&(this.#i.set(c.data.id,c),this._annotationEditorUIManager?.renderAnnotationElement(c))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#s,svgFactory:new Xo,parent:this};for(const i of t){i.borderStyle||=K0._defaultBorderStyle,e.data=i;const n=fb.create(e);if(!n.isRenderable)continue;const r=n.render();await this.#r(r,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,Ls(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:r}=n;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):n.append(i);const a=this.#i.get(e);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,n.id,i),a._hasNoCanvas=!1):a.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:n}=t,r=new tT({data:{id:i,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#n}),a=r.render();return e.append(a),this.#t?.moveElementInDOM(e,a,a,!1),r.createOrUpdatePopup(),r}static get _defaultBorderStyle(){return Ft(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:oa.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const Fc=/\r\n?|\n/g;let vT=class Ze extends ve{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Ze.prototype,e=r=>r.isEmpty(),i=wa.TRANSLATE_SMALL,n=wa.TRANSLATE_BIG;return Ft(this,"_keyboardManager",new el([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=Mt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Ze._defaultColor||ve._defaultLineColor,this.#i=t.fontSize||Ze._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){ve.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Vt.FREETEXT_SIZE:Ze._defaultFontSize=e;break;case Vt.FREETEXT_COLOR:Ze._defaultColor=e;break}}updateParams(t,e){switch(t){case Vt.FREETEXT_SIZE:this.#a(e);break;case Vt.FREETEXT_COLOR:this.#s(e);break}}static get defaultPropertiesToUpdate(){return[[Vt.FREETEXT_SIZE,Ze._defaultFontSize],[Vt.FREETEXT_COLOR,Ze._defaultColor||ve._defaultLineColor]]}get propertiesToUpdate(){return[[Vt.FREETEXT_SIZE,this.#i],[Vt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new j0(this),[["colorPicker",this._colorPicker]]}get colorType(){return Vt.FREETEXT_COLOR}#a(t){const e=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--total-scale-factor))`,this.translate(0,-(n-this.#i)*this.parentScale),this.#i=n,this.#o()},i=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(t){const e=n=>{this.color=n,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ze._internalPadding*t,-(Ze._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Ze.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,a=r.style.display,l=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const i=n=>{if(this.#t=n,!n){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ze._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,f]=this.pageDimensions,[p,m]=this.pageTranslation;let v,S;switch(this.rotation){case 0:v=t+(a[0]-p)/u,S=e+this.height-(a[1]-m)/f;break;case 90:v=t+(a[0]-p)/u,S=e-(a[1]-m)/f,[l,c]=[c,-l];break;case 180:v=t-this.width+(a[0]-p)/u,S=e-(a[1]-m)/f,[l,c]=[-l,-c];break;case 270:v=t+(a[0]-p-this.height*f)/u,S=e+(a[1]-m-this.width*u)/f,[l,c]=[-c,l];break}this.setAt(v*n,S*r,l,c)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Fc,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=Ze.#u(e.getData("text")||"").replaceAll(Fc,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:l,startOffset:c}=a,u=[],f=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Fc,"")),v!==this.editorDiv){let S=u;for(const b of this.editorDiv.childNodes){if(b===v){S=f;continue}S.push(Ze.#c(b))}}u.push(l.nodeValue.slice(0,c).replaceAll(Fc,""))}else if(l===this.editorDiv){let v=u,S=0;for(const b of this.editorDiv.childNodes)S++===c&&(v=f),v.push(Ze.#c(b))}this.#t=`${u.join(`
`)}${n}${f.join(`
`)}`,this.#l();const p=new Range;let m=Math.sumPrecise(u.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const S=v.nodeValue.length;if(m<=S){p.setStart(v,m),p.setEnd(v,m);break}m-=S}r.removeAllRanges(),r.addRange(p)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#u(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ze._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let n=null;if(t instanceof V0){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:c,rotation:u,id:f,popupRef:p,richText:m,contentsObj:v,creationDate:S,modificationDate:b},textContent:w,textPosition:E,parent:{page:{pageNumber:C}}}=t;if(!w||w.length===0)return null;n=t={annotationType:Mt.FREETEXT,color:Array.from(l),fontSize:a,value:w.join(`
`),position:E,pageIndex:C-1,rect:c.slice(0),rotation:u,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:v?.str||null,richText:m,creationDate:S,modificationDate:b}}const r=await super.deserialize(t,e,i);return r.#i=t.fontSize,r.color=gt.makeHexColor(...t.color),r.#t=Ze.#u(t.value),r._initialData=n,t.comment&&r.setCommentData(t),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=ve._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:n,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((a,l)=>a!==n[l])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const n of this.#t.split(`
`)){const r=document.createElement("div");r.append(n?document.createTextNode(n):document.createElement("br")),e.append(r)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}},ft=class{static PRECISION=1e-4;toSVGPath(){he("Abstract method `toSVGPath` must be implemented.")}get box(){he("Abstract getter `box` must be implemented.")}serialize(t,e){he("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,n,r,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l]*n,a[l+1]=i+t[l+1]*r;return a}static _rescaleAndSwap(t,e,i,n,r,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l+1]*n,a[l+1]=i+t[l]*r;return a}static _translate(t,e,i,n){n||=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r+=2)n[r]=e+t[r],n[r+1]=i+t[r+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,n,r){switch(r){case 90:return[1-e/i,t/n];case 180:return[1-t/i,1-e/n];case 270:return[e/i,1-t/n];default:return[t/i,e/n]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,n,r,a){return[(t+5*i)/6,(e+5*n)/6,(5*i+r)/6,(5*n+a)/6,(i+r)/2,(n+a)/2]}},q0=class ko{#t;#e=[];#n;#i;#a=[];#s=new Float32Array(18);#r;#o;#c;#l;#d;#u;#f=[];static#m=8;static#p=2;static#h=ko.#m+ko.#p;constructor({x:t,y:e},i,n,r,a,l=0){this.#t=i,this.#u=r*n,this.#i=a,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#l=ko.#m*n,this.#c=ko.#h*n,this.#d=n,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#g(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[i,n,r,a]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/r,(this.#o+(t[1]-e[1])/2-n)/a,(this.#r+(e[0]-t[0])/2-i)/r,(this.#o+(e[1]-t[1])/2-n)/a]}add({x:t,y:e}){this.#r=t,this.#o=e;const[i,n,r,a]=this.#t;let[l,c,u,f]=this.#s.subarray(8,12);const p=t-u,m=e-f,v=Math.hypot(p,m);if(v<this.#c)return!1;const S=v-this.#l,b=S/v,w=b*p,E=b*m;let C=l,T=c;l=u,c=f,u+=w,f+=E,this.#f?.push(t,e);const _=-E/S,R=w/S,D=_*this.#u,M=R*this.#u;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([u+D,f+M],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([u-D,f-M],16),isNaN(this.#s[6])?(this.#a.length===0&&(this.#s.set([l+D,c+M],2),this.#a.push(NaN,NaN,NaN,NaN,(l+D-i)/r,(c+M-n)/a),this.#s.set([l-D,c-M],14),this.#e.push(NaN,NaN,NaN,NaN,(l-D-i)/r,(c-M-n)/a)),this.#s.set([C,T,l,c,u,f],6),!this.isEmpty()):(this.#s.set([C,T,l,c,u,f],6),Math.abs(Math.atan2(T-c,C-l)-Math.atan2(E,w))<Math.PI/2?([l,c,u,f]=this.#s.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((l+u)/2-i)/r,((c+f)/2-n)/a),[l,c,C,T]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((C+l)/2-i)/r,((T+c)/2-n)/a),!0):([C,T,l,c,u,f]=this.#s.subarray(0,6),this.#a.push(((C+5*l)/6-i)/r,((T+5*c)/6-n)/a,((5*l+u)/6-i)/r,((5*c+f)/6-n)/a,((l+u)/2-i)/r,((c+f)/2-n)/a),[u,f,l,c,C,T]=this.#s.subarray(12,18),this.#e.push(((C+5*l)/6-i)/r,((T+5*c)/6-n)/a,((5*l+u)/6-i)/r,((5*c+f)/6-n)/a,((l+u)/2-i)/r,((c+f)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?i.push(`L${t[n+4]} ${t[n+5]}`):i.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);this.#y(i);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?i.push(`L${e[n+4]} ${e[n+5]}`):i.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return this.#b(i),i.join(" ")}#v(){const[t,e,i,n]=this.#t,[r,a,l,c]=this.#g();return`M${(this.#s[2]-t)/i} ${(this.#s[3]-e)/n} L${(this.#s[4]-t)/i} ${(this.#s[5]-e)/n} L${r} ${a} L${l} ${c} L${(this.#s[16]-t)/i} ${(this.#s[17]-e)/n} L${(this.#s[14]-t)/i} ${(this.#s[15]-e)/n} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,i,n,r]=this.#t,a=this.#s.subarray(4,6),l=this.#s.subarray(16,18),[c,u,f,p]=this.#g();t.push(`L${(a[0]-e)/n} ${(a[1]-i)/r} L${c} ${u} L${f} ${p} L${(l[0]-e)/n} ${(l[1]-i)/r}`)}newFreeDrawOutline(t,e,i,n,r,a){return new Q0(t,e,i,n,r,a)}getOutlines(){const t=this.#a,e=this.#e,i=this.#s,[n,r,a,l]=this.#t,c=new Float32Array((this.#f?.length??0)+2);for(let p=0,m=c.length-2;p<m;p+=2)c[p]=(this.#f[p]-n)/a,c[p+1]=(this.#f[p+1]-r)/l;if(c[c.length-2]=(this.#r-n)/a,c[c.length-1]=(this.#o-r)/l,isNaN(i[6])&&!this.isEmpty())return this.#C(c);const u=new Float32Array(this.#a.length+24+this.#e.length);let f=t.length;for(let p=0;p<f;p+=2){if(isNaN(t[p])){u[p]=u[p+1]=NaN;continue}u[p]=t[p],u[p+1]=t[p+1]}f=this.#A(u,f);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){u[f]=u[f+1]=NaN,f+=2;continue}u[f]=e[p+m],u[f+1]=e[p+m+1],f+=2}return this.#w(u,f),this.newFreeDrawOutline(u,c,this.#t,this.#d,this.#n,this.#i)}#C(t){const e=this.#s,[i,n,r,a]=this.#t,[l,c,u,f]=this.#g(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/r,(e[3]-n)/a,NaN,NaN,NaN,NaN,(e[4]-i)/r,(e[5]-n)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(e[16]-i)/r,(e[17]-n)/a,NaN,NaN,NaN,NaN,(e[14]-i)/r,(e[15]-n)/a],0),this.newFreeDrawOutline(p,t,this.#t,this.#d,this.#n,this.#i)}#w(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#A(t,e){const i=this.#s.subarray(4,6),n=this.#s.subarray(16,18),[r,a,l,c]=this.#t,[u,f,p,m]=this.#g();return t.set([NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-a)/c,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(n[0]-r)/l,(n[1]-a)/c],e),e+=24}},Q0=class extends ft{#t;#e=new Float32Array(4);#n;#i;#a;#s;#r;constructor(t,e,i,n,r,a){super(),this.#r=t,this.#a=e,this.#t=i,this.#s=n,this.#n=r,this.#i=a,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(a);const[l,c,u,f]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/u,t[p+1]=(t[p+1]-c)/f;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-l)/u,e[p+1]=(e[p+1]-c)/f}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,n],r){const a=i-t,l=n-e;let c,u;switch(r){case 0:c=ft._rescale(this.#r,t,n,a,-l),u=ft._rescale(this.#a,t,n,a,-l);break;case 90:c=ft._rescaleAndSwap(this.#r,t,e,a,l),u=ft._rescaleAndSwap(this.#a,t,e,a,l);break;case 180:c=ft._rescale(this.#r,i,e,-a,l),u=ft._rescale(this.#a,i,e,-a,l);break;case 270:c=ft._rescaleAndSwap(this.#r,i,n,-a,-l),u=ft._rescaleAndSwap(this.#a,i,n,-a,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}#o(t){const e=this.#r;let i=e[4],n=e[5];const r=[i,n,i,n];let a=i,l=n,c=i,u=n;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,S=e.length;v<S;v+=6){const b=e[v+4],w=e[v+5];isNaN(e[v])?(gt.pointBoundingBox(b,w,r),l>w?(a=b,l=w):l===w&&(a=f(a,b)),u<w?(c=b,u=w):u===w&&(c=f(c,b))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,gt.bezierBoundingBox(i,n,...e.slice(v,v+6),p),gt.rectBoundingBox(p[0],p[1],p[2],p[3],r),l>p[1]?(a=p[0],l=p[1]):l===p[1]&&(a=f(a,p[0])),u<p[3]?(c=p[2],u=p[3]):u===p[3]&&(c=f(c,p[2]))),i=b,n=w}const m=this.#e;m[0]=r[0]-this.#n,m[1]=r[1]-this.#n,m[2]=r[2]-r[0]+2*this.#n,m[3]=r[3]-r[1]+2*this.#n,this.firstPoint=[a,l],this.lastPoint=[c,u]}get box(){return this.#e}newOutliner(t,e,i,n,r,a=0){return new q0(t,e,i,n,r,a)}getNewOutline(t,e){const[i,n,r,a]=this.#e,[l,c,u,f]=this.#t,p=r*u,m=a*f,v=i*u+l,S=n*f+c,b=this.newOutliner({x:this.#a[0]*p+v,y:this.#a[1]*m+S},this.#t,this.#s,t,this.#i,e??this.#n);for(let w=2;w<this.#a.length;w+=2)b.add({x:this.#a[w]*p+v,y:this.#a[w+1]*m+S});return b.getOutlines()}},Lf=class{#t;#e;#n;#i=[];#a=[];constructor(t,e=0,i=0,n=!0){const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:b,y:w,width:E,height:C}of t){const T=Math.floor((b-e)/a)*a,_=Math.ceil((b+E+e)/a)*a,R=Math.floor((w-e)/a)*a,D=Math.ceil((w+C+e)/a)*a,M=[T,R,D,!0],L=[_,R,D,!1];this.#i.push(M,L),gt.rectBoundingBox(T,R,_,D,r)}const l=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,u=r[0]-i,f=r[1]-i;let p=n?-1/0:1/0,m=1/0;const v=this.#i.at(n?-1:-2),S=[v[0],v[2]];for(const b of this.#i){const[w,E,C,T]=b;!T&&n?E<m?(m=E,p=w):E===m&&(p=Math.max(p,w)):T&&!n&&(E<m?(m=E,p=w):E===m&&(p=Math.min(p,w))),b[0]=(w-u)/l,b[1]=(E-f)/c,b[2]=(C-f)/c}this.#t=new Float32Array([u,f,l,c]),this.#e=[p,m],this.#n=S}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const a of t){const[l,c,u]=a;e.push([l,c,a],[l,u,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const c=e[a][2],u=e[a+1][2];c.push(u),u.push(c),i.add(c),i.add(u)}const n=[];let r;for(;i.size>0;){const a=i.values().next().value;let[l,c,u,f,p]=a;i.delete(a);let m=l,v=c;for(r=[l,u],n.push(r);;){let S;if(i.has(f))S=f;else if(i.has(p))S=p;else break;i.delete(S),[l,c,u,f,p]=S,m!==l&&(r.push(m,v,l,v===c?c:u),m=l),v=v===c?u:c}r.push(m,v)}return new yT(n,this.#t,this.#e,this.#n)}#r(t){const e=this.#a;let i=0,n=e.length-1;for(;i<=n;){const r=i+n>>1,a=e[r][0];if(a===t)return r;a<t?i=r+1:n=r-1}return n+1}#o([,t,e]){const i=this.#r(t);this.#a.splice(i,0,[t,e])}#c([,t,e]){const i=this.#r(t);for(let n=i;n<this.#a.length;n++){const[r,a]=this.#a[n];if(r!==t)break;if(r===t&&a===e){this.#a.splice(n,1);return}}for(let n=i-1;n>=0;n--){const[r,a]=this.#a[n];if(r!==t)break;if(r===t&&a===e){this.#a.splice(n,1);return}}}#l(t){const[e,i,n]=t,r=[[e,i,n]],a=this.#r(n);for(let l=0;l<a;l++){const[c,u]=this.#a[l];for(let f=0,p=r.length;f<p;f++){const[,m,v]=r[f];if(!(u<=m||v<=c)){if(m>=c){if(v>u)r[f][1]=u;else{if(p===1)return[];r.splice(f,1),f--,p--}continue}r[f][2]=c,v>u&&r.push([e,u,v])}}}return r}},yT=class extends ft{#t;#e;constructor(t,e,i,n){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[i,n]=e;t.push(`M${i} ${n}`);for(let r=2;r<e.length;r+=2){const a=e[r],l=e[r+1];a===i?(t.push(`V${l}`),n=l):l===n&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],r){const a=[],l=i-t,c=n-e;for(const u of this.#e){const f=new Array(u.length);for(let p=0;p<u.length;p+=2)f[p]=t+u[p]*l,f[p+1]=n-u[p+1]*c;a.push(f)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}},Pf=class extends q0{newFreeDrawOutline(t,e,i,n,r,a){return new bT(t,e,i,n,r,a)}},bT=class extends Q0{newOutliner(t,e,i,n,r,a=0){return new Pf(t,e,i,n,r,a)}},pb=class He extends ve{#t=null;#e=0;#n;#i=null;#a=null;#s=null;#r=null;#o=0;#c=null;#l=null;#d=null;#u=!1;#f=null;#m=null;#p=null;#h="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Mt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=He.prototype;return Ft(this,"_keyboardManager",new el([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||He._defaultColor,this.#g=t.thickness||He._defaultThickness,this.opacity=t.opacity||He._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#y(t),this.#E()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#E(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Lf(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Lf(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:n}=this.#s;this.#m=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const n=1.5;if(this.#s=t.getNewOutline(this.#g/2+n,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:He.#T(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:He.#T(this.#s.box,p),path:{d:this.#s.toSVGPath()}})}const[r,a,l,c]=t.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=l,this.height=c;break;case 90:{const[p,m]=this.parentDimensions;this.x=a,this.y=1-r,this.width=l*m/p,this.height=c*p/m;break}case 180:this.x=1-r,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-a,this.y=r,this.width=l*m/p,this.height=c*p/m;break}}const{firstPoint:u}=t;this.#f=[(u[0]-r)/l,(u[1]-a)/c];const{lastPoint:f}=this.#s;this.#m=[(f[0]-r)/l,(f[1]-a)/c]}static initialize(t,e){ve.initialize(t,e),He._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Vt.HIGHLIGHT_COLOR:He._defaultColor=e;break;case Vt.HIGHLIGHT_THICKNESS:He._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Vt.HIGHLIGHT_COLOR:this.#C(e);break;case Vt.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Vt.HIGHLIGHT_COLOR,He._defaultColor],[Vt.HIGHLIGHT_THICKNESS,He._defaultThickness]]}get propertiesToUpdate(){return[[Vt.HIGHLIGHT_COLOR,this.color||He._defaultColor],[Vt.HIGHLIGHT_THICKNESS,this.#g||He._defaultThickness],[Vt.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#C(t){const e=(r,a)=>{this.color=r,this.opacity=a,this.onUpdatedColor()},i=this.color,n=this.opacity;this.addCommands({cmd:e.bind(this,t,He._defaultOpacity),undo:e.bind(this,i,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const e=this.#g,i=n=>{this.#g=n,this.#A(n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Vt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new hp({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#R(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#E(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#R():t&&(this.#E(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#A(t){this.#u&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#R(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#E(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#i))}static#T([t,e,i,n],r){switch(r){case 90:return[1-e-n,t,n,i];case 180:return[1-t-i,1-e-n,i,n];case 270:return[e,1-t-i,n,i]}return[t,e,i,n]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=He.#T(this.#l.box,t)):i=He.#T([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:He.#T(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(this.width,this.height),g0(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(t){He._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#_(!0);break;case 1:case 3:this.#_(!1);break}}#_(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#_(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#u?this.rotation:0}#F(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,n]=this.pageTranslation,r=this.#n,a=new Float32Array(r.length*8);let l=0;for(const{x:c,y:u,width:f,height:p}of r){const m=c*t+i,v=(1-u)*e+n;a[l]=a[l+4]=m,a[l+1]=a[l+3]=v,a[l+2]=a[l+6]=m+f*t,a[l+5]=a[l+7]=v-p*e,l+=8}return a}#L(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:n,y:r}){const{x:a,y:l,width:c,height:u}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=v=>{f.abort(),this.#B(t,v)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Ae,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",zi,{signal:p}),i.addEventListener("pointermove",this.#N.bind(this,t),{signal:p}),this._freeHighlight=new Pf({x:n,y:r},[a,l,c,u],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let n=null;if(t instanceof Y0){const{data:{quadPoints:S,rect:b,rotation:w,id:E,color:C,opacity:T,popupRef:_,richText:R,contentsObj:D,creationDate:M,modificationDate:L},parent:{page:{pageNumber:P}}}=t;n=t={annotationType:Mt.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:S,boxes:null,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,popupRef:_,richText:R,comment:D?.str||null,creationDate:M,modificationDate:L}}else if(t instanceof dp){const{data:{inkLists:S,rect:b,rotation:w,id:E,color:C,borderStyle:{rawWidth:T},popupRef:_,richText:R,contentsObj:D,creationDate:M,modificationDate:L},parent:{page:{pageNumber:P}}}=t;n=t={annotationType:Mt.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:S,boxes:null,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,popupRef:_,richText:R,comment:D?.str||null,creationDate:M,modificationDate:L}}const{color:r,quadPoints:a,inkLists:l,opacity:c}=t,u=await super.deserialize(t,e,i);u.color=gt.makeHexColor(...r),u.opacity=c||1,l&&(u.#g=t.thickness),u._initialData=n,t.comment&&u.setCommentData(t);const[f,p]=u.pageDimensions,[m,v]=u.pageTranslation;if(a){const S=u.#n=[];for(let b=0;b<a.length;b+=8)S.push({x:(a[b]-m)/f,y:1-(a[b+1]-v)/p,width:(a[b+2]-a[b])/f,height:(a[b+1]-a[b+5])/p});u.#b(),u.#E(),u.rotate(u.rotation)}else if(l){u.#u=!0;const S=l[0],b={x:S[0]-m,y:p-(S[1]-v)},w=new Pf(b,[0,0,f,p],1,u.#g/2,!0,.001);for(let T=0,_=S.length;T<_;T+=2)b.x=S[T]-m,b.y=p-(S[T+1]-v),w.add(b);const{id:E,clipPathId:C}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);u.#y({highlightOutlines:w.getOutlines(),highlightId:E,clipPathId:C}),u.#E(),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=ve._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#g,quadPoints:this.#F(),outlines:this.#L(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#I(i)?null:(i.id=this.annotationElementId,i)}#I(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,n)=>i!==e[n])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}},Z0=class{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){he("Not implemented")}},J0=class Ct extends ve{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static#s=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:i}=e.drawLayer.draw(Ct._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[n,r]of Object.entries(e))i.has(n)?Object.assign(t[n],r):t[n]=r;return t}static getDefaultDrawingOptions(t){he("Not implemented")}static get typesMap(){he("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Ct.#n.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,n]of this.typesMap)t.push([i,e[n]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,n]of this.constructor.typesMap)t.push([i,e[n]]);return t}_updateProperty(t,e,i){const n=this._drawingOptions,r=n[e],a=l=>{n.updateProperty(e,l);const c=this.#t.updateProperty(e,l);c&&this.#h(c),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,i,n]){const{parentDimensions:[r,a],rotation:l}=this;switch(l){case 90:return[e,1-t,i*(a/r),n*(r/a)];case 180:return[1-t,1-e,i,n];case 270:return[1-e,t,i*(a/r),n*(r/a)];default:return[t,e,i,n]}}#p(){const{x:t,y:e,width:i,height:n,parentDimensions:[r,a],rotation:l}=this;switch(l){case 90:return[1-e,t,i*(r/a),n*(a/r)];case 180:return[1-t,1-e,i,n];case 270:return[e,1-t,i*(r/a),n*(a/r)];default:return[t,e,i,n]}}#h(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:t,y:e,width:i,height:n,rotation:r,parentRotation:a,parentDimensions:[l,c]}=this;switch((r*4+a)/90){case 1:return[1-e-n,t,n,i];case 2:return[1-t-i,1-e-n,i,n];case 3:return[e,1-t-i,n,i];case 4:return[t,e-i*(l/c),n*(c/l),i*(l/c)];case 5:return[1-e,t,i*(l/c),n*(c/l)];case 6:return[1-t-n*(c/l),1-e,n*(c/l),i*(l/c)];case 7:return[e-i*(l/c),1-t-n*(c/l),i*(l/c),n*(c/l)];case 8:return[t-i,e-n,i,n];case 9:return[1-e,t-i,n,i];case 10:return[1-t,1-e,i,n];case 11:return[e-n,1-t,n,i];case 12:return[t-n*(c/l),e,n*(c/l),i*(l/c)];case 13:return[1-e-i*(l/c),t-n*(c/l),i*(l/c),n*(c/l)];case 14:return[1-t,1-e-i*(l/c),n*(c/l),i*(l/c)];case 15:return[e,1-t,i*(l/c),n*(c/l)];default:return[t,e,i,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const n=document.createElement("div");return i.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,n,r){he("Not implemented")}static startDrawing(t,e,i,n){const{target:r,offsetX:a,offsetY:l,pointerId:c,pointerType:u}=n;if(Ct.#r&&Ct.#r!==u)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=r.getBoundingClientRect(),v=Ct.#i=new AbortController,S=t.combinedSignal(v);if(Ct.#s||=c,Ct.#r??=u,window.addEventListener("pointerup",b=>{Ct.#s===b.pointerId?this._endDraw(b):Ct.#o?.delete(b.pointerId)},{signal:S}),window.addEventListener("pointercancel",b=>{Ct.#s===b.pointerId?this._currentParent.endDrawingSession():Ct.#o?.delete(b.pointerId)},{signal:S}),window.addEventListener("pointerdown",b=>{Ct.#r===b.pointerType&&((Ct.#o||=new Set).add(b.pointerId),Ct.#n.isCancellable()&&(Ct.#n.removeLastElement(),Ct.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",zi,{signal:S}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),r.addEventListener("touchmove",b=>{b.timeStamp===Ct.#c&&Ae(b)},{signal:S}),t.toggleDrawing(),e._editorUndoBar?.hide(),Ct.#n){t.drawLayer.updateProperties(this._currentDrawId,Ct.#n.startNew(a,l,p,m,f));return}e.updateUIForDefaultProperties(this),Ct.#n=this.createDrawerInstance(a,l,p,m,f),Ct.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Ct.#a.toSVGProperties(),Ct.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ct.#c=-1,!Ct.#n)return;const{offsetX:e,offsetY:i,pointerId:n}=t;if(Ct.#s===n){if(Ct.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Ct.#n.add(e,i)),Ct.#c=t.timeStamp,Ae(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Ct.#n=null,Ct.#a=null,Ct.#r=null,Ct.#c=NaN),Ct.#i&&(Ct.#i.abort(),Ct.#i=null,Ct.#s=NaN,Ct.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Ct.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Ct.#n,n=this._currentDrawId,r=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,i.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(n,i.removeLastElement())},mustExec:!1,type:Vt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Vt.DRAW_STEP),!Ct.#n.isEmpty()){const{pageDimensions:[i,n],scale:r}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Ct.#n.getOutlines(i*r,n*r,r,this._INNER_MARGIN),drawingOptions:Ct.#a,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,n,r,a){he("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:l}}=e.viewport,c=this.deserializeDraw(a,l,n,r,this._INNER_MARGIN,t),u=await super.deserialize(t,e,i);return u.createDrawingOptions(t),u.#l({drawOutlines:c}),u.#f(),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[e,i]=this.pageTranslation,[n,r]=this.pageDimensions;return this.#t.serialize([e,i,n,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}},AT=class{#t=new Float64Array(6);#e;#n;#i;#a;#s;#r="";#o=0;#c=new nl;#l;#d;constructor(t,e,i,n,r,a){this.#l=i,this.#d=n,this.#i=r,this.#a=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:l,points:this.#s}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#u(t,e){return ft._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,n,r,a]=this.#t.subarray(2,6),l=t-r,c=e-a;return Math.hypot(this.#l*l,this.#d*c)<=2?null:(this.#s.push(t,e),isNaN(i)?(this.#t.set([r,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,n,r,a,t,e],0),this.#e.push(...ft.createBezierPoints(i,n,r,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,n,r){this.#l=i,this.#d=n,this.#i=r,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#s}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#r="";for(let t=0,e=this.#n.length;t<e;t++){const{line:i,points:n}=this.#n[t];this.#e=i,this.#s=n,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=ft.svgRound(this.#e[4]),e=ft.svgRound(this.#e[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#s.length<=6){const n=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,n)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const n=ft.svgRound(this.#e[10]),r=ft.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${n} ${r}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let n=this.#o,r=this.#e.length;n<r;n+=6){const[a,l,c,u,f,p]=this.#e.slice(n,n+6).map(ft.svgRound);i.push(`C${a} ${l} ${c} ${u} ${f} ${p}`)}return this.#r+=i.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,i,n){const r=this.#n.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#c.build(this.#n,t,e,i,this.#i,this.#a,n),this.#t=null,this.#e=null,this.#n=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}},nl=class extends ft{#t;#e=0;#n;#i;#a;#s;#r;#o;#c;build(t,e,i,n,r,a,l){this.#a=e,this.#s=i,this.#r=n,this.#o=r,this.#c=a,this.#n=l??0,this.#i=t,this.#u()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${ft.svgRound(e[4])} ${ft.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${ft.svgRound(e[10])} ${ft.svgRound(e[11])}`);continue}for(let i=6,n=e.length;i<n;i+=6){const[r,a,l,c,u,f]=e.subarray(i,i+6).map(ft.svgRound);t.push(`C${r} ${a} ${l} ${c} ${u} ${f}`)}}return t.join("")}serialize([t,e,i,n],r){const a=[],l=[],[c,u,f,p]=this.#d();let m,v,S,b,w,E,C,T,_;switch(this.#o){case 0:_=ft._rescale,m=t,v=e+n,S=i,b=-n,w=t+c*i,E=e+(1-u-p)*n,C=t+(c+f)*i,T=e+(1-u)*n;break;case 90:_=ft._rescaleAndSwap,m=t,v=e,S=i,b=n,w=t+u*i,E=e+c*n,C=t+(u+p)*i,T=e+(c+f)*n;break;case 180:_=ft._rescale,m=t+i,v=e,S=-i,b=n,w=t+(1-c-f)*i,E=e+u*n,C=t+(1-c)*i,T=e+(u+p)*n;break;case 270:_=ft._rescaleAndSwap,m=t+i,v=e+n,S=-i,b=-n,w=t+(1-u-p)*i,E=e+(1-c-f)*n,C=t+(1-u)*i,T=e+(1-c)*n;break}for(const{line:R,points:D}of this.#i)a.push(_(R,m,v,S,b,r?new Array(R.length):null)),l.push(_(D,m,v,S,b,r?new Array(D.length):null));return{lines:a,points:l,rect:[w,E,C,T]}}static deserialize(t,e,i,n,r,{paths:{lines:a,points:l},rotation:c,thickness:u}){const f=[];let p,m,v,S,b;switch(c){case 0:b=ft._rescale,p=-t/i,m=e/n+1,v=1/i,S=-1/n;break;case 90:b=ft._rescaleAndSwap,p=-e/n,m=-t/i,v=1/n,S=1/i;break;case 180:b=ft._rescale,p=t/i+1,m=-e/n,v=-1/i,S=1/n;break;case 270:b=ft._rescaleAndSwap,p=e/n+1,m=t/i+1,v=-1/n,S=-1/i;break}if(!a){a=[];for(const E of l){const C=E.length;if(C===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(C===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(C-2));a.push(T);let[_,R,D,M]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,_,R],0);for(let L=4;L<C;L+=2){const P=E[L],B=E[L+1];T.set(ft.createBezierPoints(_,R,D,M,P,B),(L-2)*3),[_,R,D,M]=[D,M,P,B]}}}for(let E=0,C=a.length;E<C;E++)f.push({line:b(a[E].map(T=>T??NaN),p,m,v,S),points:b(l[E].map(T=>T??NaN),p,m,v,S)});const w=new this.prototype.constructor;return w.build(f,i,n,1,c,u,r),w}#l(t=this.#c){const e=this.#n+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#s]:[e/this.#s,e/this.#a]}#d(){const[t,e,i,n]=this.#t,[r,a]=this.#l(0);return[t+r,e+a,i-2*r,n-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#i){if(n.length<=12){for(let l=4,c=n.length;l<c;l+=6)gt.pointBoundingBox(n[l],n[l+1],t);continue}let r=n[4],a=n[5];for(let l=6,c=n.length;l<c;l+=6){const[u,f,p,m,v,S]=n.subarray(l,l+6);gt.bezierBoundingBox(r,a,u,f,p,m,v,S,t),r=v,a=S}}const[e,i]=this.#l();t[0]=ai(t[0]-e,0,1),t[1]=ai(t[1]-i,0,1),t[2]=ai(t[2]+e,0,1),t[3]=ai(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[n,r]=this.#l(),[a,l]=[n-e,r-i],c=this.#t;return c[0]-=a,c[1]-=l,c[2]+=2*a,c[3]+=2*l,c}updateParentDimensions([t,e],i){const[n,r]=this.#l();this.#a=t,this.#s=e,this.#r=i;const[a,l]=this.#l(),c=a-n,u=l-r,f=this.#t;return f[0]-=c,f[1]-=u,f[2]+=2*c,f[3]+=2*u,f}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(ft.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(t)} ${ft.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,n=0,r=0,a=0,l=0,c=0;switch(this.#e){case 90:n=e/t,r=-t/e,l=t;break;case 180:i=-1,a=-1,l=t,c=e;break;case 270:n=-e/t,r=t/e,c=e;break;default:return""}return`matrix(${i} ${n} ${r} ${a} ${ft.svgRound(l)} ${ft.svgRound(c)})`}getPathResizingSVGProperties([t,e,i,n]){const[r,a]=this.#l(),[l,c,u,f]=this.#t;if(Math.abs(u-r)<=ft.PRECISION||Math.abs(f-a)<=ft.PRECISION){const b=t+i/2-(l+u/2),w=e+n/2-(c+f/2);return{path:{"transform-origin":`${ft.svgRound(t)} ${ft.svgRound(e)}`,transform:`${this.rotationTransform} translate(${b} ${w})`}}}const p=(i-2*r)/(u-2*r),m=(n-2*a)/(f-2*a),v=u/i,S=f/n;return{path:{"transform-origin":`${ft.svgRound(l)} ${ft.svgRound(c)}`,transform:`${this.rotationTransform} scale(${v} ${S}) translate(${ft.svgRound(r)} ${ft.svgRound(a)}) scale(${p} ${m}) translate(${ft.svgRound(-r)} ${ft.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,i,n]){const[r,a]=this.#l(),l=this.#t,[c,u,f,p]=l;if(l[0]=t,l[1]=e,l[2]=i,l[3]=n,Math.abs(f-r)<=ft.PRECISION||Math.abs(p-a)<=ft.PRECISION){const w=t+i/2-(c+f/2),E=e+n/2-(u+p/2);for(const{line:C,points:T}of this.#i)ft._translate(C,w,E,C),ft._translate(T,w,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(t)} ${ft.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*r)/(f-2*r),v=(n-2*a)/(p-2*a),S=-m*(c+r)+t+r,b=-v*(u+a)+e+a;if(m!==1||v!==1||S!==0||b!==0)for(const{line:w,points:E}of this.#i)ft._rescale(w,S,b,m,v,w),ft._rescale(E,S,b,m,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(t)} ${ft.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[n,r]=i,a=this.#t,l=t-a[0],c=e-a[1];if(this.#a===n&&this.#s===r)for(const{line:u,points:f}of this.#i)ft._translate(u,l,c,u),ft._translate(f,l,c,f);else{const u=this.#a/n,f=this.#s/r;this.#a=n,this.#s=r;for(const{line:p,points:m}of this.#i)ft._rescale(p,l,c,u,f,p),ft._rescale(m,l,c,u,f,m);a[2]*=u,a[3]*=f}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(t)} ${ft.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(t[0])} ${ft.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}},tA=class eA extends Z0{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ve._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new eA(this._viewParameters);return t.updateAll(this),t}},ST=class iA extends J0{static _type="ink";static _editorType=Mt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){ve.initialize(t,e),this._defaultDrawingOptions=new tA(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ft(this,"typesMap",new Map([[Vt.INK_THICKNESS,"stroke-width"],[Vt.INK_COLOR,"stroke"],[Vt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,n,r){return new AT(t,e,i,n,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,n,r,a){return nl.deserialize(t,e,i,n,r,a)}static async deserialize(t,e,i){let n=null;if(t instanceof dp){const{data:{inkLists:a,rect:l,rotation:c,id:u,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:v,richText:S,contentsObj:b,creationDate:w,modificationDate:E},parent:{page:{pageNumber:C}}}=t;n=t={annotationType:Mt.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:C-1,rect:l.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:v,richText:S,comment:b?.str||null,creationDate:w,modificationDate:E}}const r=await super.deserialize(t,e,i);return r._initialData=n,t.comment&&r.setCommentData(t),r}get toolbarButtons(){return this._colorPicker||=new j0(this),[["colorPicker",this._colorPicker]]}get colorType(){return Vt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=iA.getDefaultDrawingOptions({stroke:gt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:n,"stroke-opacity":r,"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{color:ve._colorManager.convert(n),opacity:r,thickness:a,paths:{lines:e,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!this.#t(l)?null:(l.id=this.annotationElementId,l)}#t(t){const{color:e,thickness:i,opacity:n,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==e[l])||t.thickness!==i||t.opacity!==n||t.pageIndex!==r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}},Nf=class extends nl{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}};const Bc=8,Ro=3;let nr=class{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,n){return i-=t,n-=e,i===0?n>0?0:4:i===1?n+6:2-n}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,n,r,a,l){const c=this.#e(i,n,r,a);for(let u=0;u<8;u++){const f=(-u+c-l+16)%8,p=this.#n[2*f],m=this.#n[2*f+1];if(t[(i+p)*e+(n+m)]!==0)return f}return-1}static#a(t,e,i,n,r,a,l){const c=this.#e(i,n,r,a);for(let u=0;u<8;u++){const f=(u+c+l+16)%8,p=this.#n[2*f],m=this.#n[2*f+1];if(t[(i+p)*e+(n+m)]!==0)return f}return-1}static#s(t,e,i,n){const r=t.length,a=new Int32Array(r);for(let f=0;f<r;f++)a[f]=t[f]<=n?1:0;for(let f=1;f<i-1;f++)a[f*e]=a[f*e+e-1]=0;for(let f=0;f<e;f++)a[f]=a[e*i-1-f]=0;let l=1,c;const u=[];for(let f=1;f<i-1;f++){c=1;for(let p=1;p<e-1;p++){const m=f*e+p,v=a[m];if(v===0)continue;let S=f,b=p;if(v===1&&a[m-1]===0)l+=1,b-=1;else if(v>=1&&a[m+1]===0)l+=1,b+=1,v>1&&(c=v);else{v!==1&&(c=Math.abs(v));continue}const w=[p,f],E=b===p+1,C={isHole:E,points:w,id:l,parent:0};u.push(C);let T;for(const U of u)if(U.id===c){T=U;break}T?T.isHole?C.parent=E?T.parent:c:C.parent=E?c:T.parent:C.parent=E?c:0;const _=this.#i(a,e,f,p,S,b,0);if(_===-1){a[m]=-l,a[m]!==1&&(c=Math.abs(a[m]));continue}let R=this.#n[2*_],D=this.#n[2*_+1];const M=f+R,L=p+D;S=M,b=L;let P=f,B=p;for(;;){const U=this.#a(a,e,P,B,S,b,1);R=this.#n[2*U],D=this.#n[2*U+1];const Z=P+R,q=B+D;w.push(q,Z);const Q=P*e+B;if(a[Q+1]===0?a[Q]=-l:a[Q]===1&&(a[Q]=l),Z===f&&q===p&&P===M&&B===L){a[m]!==1&&(c=Math.abs(a[m]));break}else S=P,b=B,P=Z,B=q}}}return u}static#r(t,e,i,n){if(i-e<=4){for(let M=e;M<i-2;M+=2)n.push(t[M],t[M+1]);return}const r=t[e],a=t[e+1],l=t[i-4]-r,c=t[i-3]-a,u=Math.hypot(l,c),f=l/u,p=c/u,m=f*a-p*r,v=c/l,S=1/u,b=Math.atan(v),w=Math.cos(b),E=Math.sin(b),C=S*(Math.abs(w)+Math.abs(E)),T=S*(1-C+C**2),_=Math.max(Math.atan(Math.abs(E+w)*T),Math.atan(Math.abs(E-w)*T));let R=0,D=e;for(let M=e+2;M<i-2;M+=2){const L=Math.abs(m-f*t[M+1]+p*t[M]);L>R&&(D=M,R=L)}R>(u*_)**2?(this.#r(t,e,D+2,n),this.#r(t,D,i,n)):n.push(r,a)}static#o(t){const e=[],i=t.length;return this.#r(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,n,r,a){const l=new Float32Array(a**2),c=-2*n**2,u=a>>1;for(let b=0;b<a;b++){const w=(b-u)**2;for(let E=0;E<a;E++)l[b*a+E]=Math.exp((w+(E-u)**2)/c)}const f=new Float32Array(256),p=-2*r**2;for(let b=0;b<256;b++)f[b]=Math.exp(b**2/p);const m=t.length,v=new Uint8Array(m),S=new Uint32Array(256);for(let b=0;b<i;b++)for(let w=0;w<e;w++){const E=b*e+w,C=t[E];let T=0,_=0;for(let D=0;D<a;D++){const M=b+D-u;if(!(M<0||M>=i))for(let L=0;L<a;L++){const P=w+L-u;if(P<0||P>=e)continue;const B=t[M*e+P],U=l[D*a+L]*f[Math.abs(B-C)];T+=B*U,_+=U}}const R=v[E]=Math.round(T/_);S[R]++}return[v,S]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let n=-1/0,r=1/0;for(let l=0,c=i.length;l<c;l++){const u=i[l]=t[l<<2];n=Math.max(n,u),r=Math.min(r,u)}const a=255/(n-r);for(let l=0,c=i.length;l<c;l++)i[l]=(i[l]-r)*a;return i}static#u(t){let e,i=-1/0,n=-1/0;const r=t.findIndex(c=>c!==0);let a=r,l=r;for(e=r;e<256;e++){const c=t[e];c>i&&(e-a>n&&(n=e-a,l=e-1),i=c,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:n}=t,{maxDim:r}=this.#t;let a=i,l=n;if(i>r||n>r){let m=i,v=n,S=Math.log2(Math.max(i,n)/r);const b=Math.floor(S);S=S===b?b-1:b;for(let E=0;E<S;E++){a=Math.ceil(m/2),l=Math.ceil(v/2);const C=new OffscreenCanvas(a,l);C.getContext("2d").drawImage(t,0,0,m,v,0,0,a,l),m=a,v=l,t!==e&&t.close(),t=C.transferToImageBitmap()}const w=Math.min(r/a,r/l);a=Math.round(a*w),l=Math.round(l*w)}const u=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,l),u.filter="grayscale(1)",u.drawImage(t,0,0,t.width,t.height,0,0,a,l);const f=u.getImageData(0,0,a,l).data;return[this.#d(f),a,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:n},r,a,l,c){let u=new OffscreenCanvas(1,1),f=u.getContext("2d",{alpha:!1});const p=200,m=f.font=`${i} ${n} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:S,actualBoundingBoxAscent:b,actualBoundingBoxDescent:w,fontBoundingBoxAscent:E,fontBoundingBoxDescent:C,width:T}=f.measureText(t),_=1.5,R=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||0,T)*_),D=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||p,Math.abs(E)+Math.abs(C)||p)*_);u=new OffscreenCanvas(R,D),f=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=m,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,R,D),f.fillStyle="black",f.fillText(t,R*(_-1)/2,D*(3-_)/2);const M=this.#d(f.getImageData(0,0,R,D).data),L=this.#l(M),P=this.#u(L),B=this.#s(M,R,D,P);return this.processDrawnLines({lines:{curves:B,width:R,height:D},pageWidth:r,pageHeight:a,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(t,e,i,n,r){const[a,l,c]=this.#f(t),[u,f]=this.#c(a,l,c,Math.hypot(l,c)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(f),m=this.#s(u,l,c,p);return this.processDrawnLines({lines:{curves:m,width:l,height:c},pageWidth:e,pageHeight:i,rotation:n,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:r,mustSmooth:a,areContours:l}){n%180!==0&&([e,i]=[i,e]);const{curves:c,width:u,height:f}=t,p=t.thickness??0,m=[],v=Math.min(e/u,i/f),S=v/e,b=v/i,w=[];for(const{points:C}of c){const T=a?this.#o(C):C;if(!T)continue;w.push(T);const _=T.length,R=new Float32Array(_),D=new Float32Array(3*(_===2?2:_-2));if(m.push({line:D,points:R}),_===2){R[0]=T[0]*S,R[1]=T[1]*b,D.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[M,L,P,B]=T;M*=S,L*=b,P*=S,B*=b,R.set([M,L,P,B],0),D.set([NaN,NaN,NaN,NaN,M,L],0);for(let U=4;U<_;U+=2){const Z=R[U]=T[U]*S,q=R[U+1]=T[U+1]*b;D.set(ft.createBezierPoints(M,L,P,B,Z,q),(U-2)*3),[M,L,P,B]=[P,B,Z,q]}}if(m.length===0)return null;const E=l?new Nf:new nl;return E.build(m,e,i,1,n,l?0:p,r),{outline:E,newCurves:w,areContours:l,thickness:p,width:u,height:f}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:n,height:r}){let a=1/0,l=-1/0,c=0;for(const T of t){c+=T.length;for(let _=2,R=T.length;_<R;_++){const D=T[_]-T[_-2];a=Math.min(a,D),l=Math.max(l,D)}}let u;a>=-128&&l<=127?u=Int8Array:a>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const f=t.length,p=Bc+Ro*f,m=new Uint32Array(p);let v=0;m[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(c-2*f)*u.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=n,m[v++]=r,m[v++]=e?0:1,m[v++]=Math.max(0,Math.floor(i??0)),m[v++]=f,m[v++]=u.BYTES_PER_ELEMENT;for(const T of t)m[v++]=T.length-2,m[v++]=T[0],m[v++]=T[1];const S=new CompressionStream("deflate-raw"),b=S.writable.getWriter();await b.ready,b.write(m);const w=u.prototype.constructor;for(const T of t){const _=new w(T.length-2);for(let R=2,D=T.length;R<D;R++)_[R-2]=T[R]-T[R-2];b.write(_)}b.close();const E=await new Response(S.readable).arrayBuffer(),C=new Uint8Array(E);return a0(C)}static async decompressSignature(t){try{const e=F1(t),{readable:i,writable:n}=new DecompressionStream("deflate-raw"),r=n.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,l=0;for await(const T of i)a||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),a.set(T,l),l+=T.length;const c=new Uint32Array(a.buffer,0,a.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const f=c[2],p=c[3],m=c[4]===0,v=c[5],S=c[6],b=c[7],w=[],E=(Bc+Ro*S)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(b){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(a.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(a.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(a.buffer,E);break}l=0;for(let T=0;T<S;T++){const _=c[Ro*T+Bc],R=new Float32Array(_+2);w.push(R);for(let D=0;D<Ro-1;D++)R[D]=c[Ro*T+Bc+D+1];for(let D=0;D<_;D++)R[D+2]=R[D]+C[l++]}return{areContours:m,thickness:v,outlines:w,width:f,height:p}}catch(e){return Ot(`decompressSignature: ${e}`),null}}},ET=class nA extends Z0{constructor(){super(),super.updateProperties({fill:ve._defaultLineColor,"stroke-width":0})}clone(){const t=new nA;return t.updateAll(this),t}},wT=class sA extends tA{constructor(t){super(t),super.updateProperties({stroke:ve._defaultLineColor,"stroke-width":1})}clone(){const t=new sA(this._viewParameters);return t.updateAll(this),t}},TT=class Wn extends J0{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=Mt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){ve.initialize(t,e),this._defaultDrawingOptions=new ET,this._defaultDrawnSignatureOptions=new wT(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ft(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:n,mustSmooth:r,areContours:a,description:l,uuid:c,heightInPage:u}=this.#n,{rawDims:{pageWidth:f,pageHeight:p},rotation:m}=this.parent.viewport,v=nr.processDrawnLines({lines:n,pageWidth:f,pageHeight:p,rotation:m,innerMargin:Wn._INNER_MARGIN,mustSmooth:r,areContours:a});this.addSignature(v,u,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:n,height:r}=this.#n,a=Math.max(n,r),l=nr.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:i,width:n,height:r},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,n){const{x:r,y:a}=this,{outline:l}=this.#n=t;this.#t=l instanceof Nf,this.description=i;let c;this.#t?c=Wn.getDefaultDrawingOptions():(c=Wn._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[,u]=this.pageDimensions;let f=e/u;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=r,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(n),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!n,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return nr.process(t,e,i,n,Wn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:r}=this.parent.viewport;return nr.extractContoursFromText(t,e,i,n,r,Wn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return nr.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:Wn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Wn.getDefaultDrawingOptions():(this._drawingOptions=Wn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":n}}=this,r=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:n});return this.addComment(r),t?(r.paths={lines:e,points:i},r.uuid=this.#i,r.isCopy=!0):r.lines=e,this.#e&&(r.accessibilityData={type:"Figure",alt:this.#e}),r}static deserializeDraw(t,e,i,n,r,a){return a.areContours?Nf.deserialize(t,e,i,n,r,a):nl.deserialize(t,e,i,n,r,a)}static async deserialize(t,e,i){const n=await super.deserialize(t,e,i);return n.#t=t.areContours,n.description=t.accessibilityData?.alt||"",n.#i=t.uuid,n}},CT=class extends ve{#t=null;#e=null;#n=null;#i=null;#a=null;#s="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Mt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){ve.initialize(t,e)}static isHandlingMimeForPasting(t){return ah.includes(t)}static paste(t,e){e.pasteEditor({mode:Mt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#s=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:r,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:n,width:r,height:a,channels:n.length/(r*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),e&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#f());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(n=>this.#u(n)).finally(()=>this.#f());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(n=>this.#u(n)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=ah.join(",");const e=this._uiManager._signal;this.#n=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(n)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:n}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,n&&(this.#t=n),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[n,r]=this.pageDimensions,a=.75;if(this.width)e=this.width*n,i=this.height*r;else if(e>a*n||i>a*r){const c=Math.min(a*n/e,a*r/i);e*=c,i*=c}this._uiManager.enableWaiting(!1);const l=this.#r=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=e/n,this.height=i/r,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:n,height:r}=this.#t,a=new Ps;let l=this.#t,c=n,u=r,f=null;if(e){if(n>e||r>e){const D=Math.min(e/n,e/r);c=Math.floor(n*D),u=Math.floor(r*D)}f=document.createElement("canvas");const m=f.width=Math.ceil(c*a.sx),v=f.height=Math.ceil(u*a.sy);this.#l||(l=this.#h(m,v));const S=f.getContext("2d");S.filter=this._uiManager.hcmFilter;let b="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":H1.isDarkMode&&(b="#8f8f9d",w="#42414d");const E=15,C=E*a.sx,T=E*a.sy,_=new OffscreenCanvas(C*2,T*2),R=_.getContext("2d");R.fillStyle=b,R.fillRect(0,0,C*2,T*2),R.fillStyle=w,R.fillRect(0,0,C,T),R.fillRect(C,T,C,T),S.fillStyle=S.createPattern(_,"repeat"),S.fillRect(0,0,m,v),S.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let p=null;if(i){let m,v;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,v=l.height;else if(l=this.#t,n>t||r>t){const w=Math.min(t/n,t/r);m=Math.floor(n*w),v=Math.floor(r*w),this.#l||(l=this.#h(m,v))}const b=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});b.drawImage(l,0,0,l.width,l.height,0,0,m,v),p={width:m,height:v,data:b.getImageData(0,0,m,v).data}}return{canvas:f,width:c,height:u,imageData:p}}#h(t,e){const{width:i,height:n}=this.#t;let r=i,a=n,l=this.#t;for(;r>2*t||a>2*e;){const c=r,u=a;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const f=new OffscreenCanvas(r,a);f.getContext("2d").drawImage(l,0,0,c,u,0,0,r,a),l=f.transferToImageBitmap()}return l}#g(){const[t,e]=this.parentDimensions,{width:i,height:n}=this,r=new Ps,a=Math.ceil(i*t*r.sx),l=Math.ceil(n*e*r.sy),c=this.#r;if(!c||c.width===a&&c.height===l)return;c.width=a,c.height=l;const u=this.#l?this.#t:this.#h(a,l),f=c.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(u,0,0,u.width,u.height,0,0,a,l)}#v(t){if(t){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#e);if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,n=Math.round(this.width*e*ur.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*ur.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let n=null,r=!1;if(t instanceof W0){const{data:{rect:b,rotation:w,id:E,structParent:C,popupRef:T,richText:_,contentsObj:R,creationDate:D,modificationDate:M},container:L,parent:{page:{pageNumber:P}},canvas:B}=t;let U,Z;B?(delete t.canvas,{id:U,bitmap:Z}=i.imageManager.getFromCanvas(L.id,B),B.remove()):(r=!0,t._hasNoCanvas=!0);const q=(await e._structTree.getAriaAttributes(`${tp}${E}`))?.get("aria-label")||"";n=t={annotationType:Mt.STAMP,bitmapId:U,bitmap:Z,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:q},isSvg:!1,structParent:C,popupRef:T,richText:_,comment:R?.str||null,creationDate:D,modificationDate:M}}const a=await super.deserialize(t,e,i),{rect:l,bitmap:c,bitmapUrl:u,bitmapId:f,isSvg:p,accessibilityData:m}=t;r?(i.addMissingCanvas(t.id,a),a.#o=!0):f&&i.imageManager.isValidId(f)?(a.#e=f,c&&(a.#t=c)):a.#i=u,a.#l=p;const[v,S]=a.pageDimensions;return a.width=(l[2]-l[0])/v,a.height=(l[3]-l[1])/S,m&&(a.altTextData=m),a._initialData=n,t.comment&&a.setCommentData(t),a.#d=!!n,a}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:n,altText:r}=this.serializeAltText(!1);if(!n&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const l=this.#b(i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const a=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#v(!1);else if(this.#l){const l=e.stamps.get(this.#e);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return i}#b(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,n=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&n&&r,isSameAltText:r}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}},rA=class Rs{#t;#e=!1;#n=null;#i=null;#a=null;#s=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#u=null;#f=null;#m=null;#p=-1;#h;static _initialized=!1;static#g=new Map([vT,ST,CT,pb,TT].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:l,textLayer:c,viewport:u,l10n:f}){const p=[...Rs.#g.values()];if(!Rs._initialized){Rs._initialized=!0;for(const m of p)m.initialize(f,t)}t.registerEditorTypes(p),this.#h=t,this.pageIndex=e,this.div=i,this.#t=r,this.#n=a,this.viewport=u,this.#u=c,this.drawLayer=l,this._structTree=n,this.#h.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===Mt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#A(),t){case Mt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Mt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Mt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===Mt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of Rs.#g.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}get#v(){return this.#s.size!==0?this.#s.values():this.#h.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#v)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#n;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const n=await this.deserialize(i);n&&(this.addOrRebuild(n),n.enableEditing())}this.#c=!1,this.#h._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const i=this.#h.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",n=>{const{clientX:a,clientY:l,timeStamp:c}=n,u=this.#p;if(c-u>500){this.#p=c;return}this.#p=-1;const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(a,l);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let m;const v=new RegExp(`^${$o}[0-9]+$`);for(const b of p)if(v.test(b.id)){m=b.id;break}if(!m)return;const S=this.#s.get(m);S?.annotationElementId===null&&(n.stopPropagation(),n.preventDefault(),S.dblclick(n))},{signal:i,capture:!0})}const t=this.#n;if(t){const i=new Map,n=new Map;for(const a of this.#v){if(a.disableEditing(),!a.annotationElementId){a.updateFakeAnnotationElement(t);continue}if(a.serialize()!==null){i.set(a.annotationElementId,a);continue}else n.set(a.annotationElementId,a);this.getEditableAnnotation(a.annotationElementId)?.show(),a.remove()}const r=t.getEditableAnnotations();for(const a of r){const{id:l}=a.data;if(this.#h.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let c=n.get(l);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=i.get(l),c&&(this.#h.addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const i of Rs.#g.values())e.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=Ve.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),pb.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),ve.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#s.values())if(e.uid===t)return e;return null}getNextId(){return this.#h.getId()}get#y(){return Rs.#g.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#C(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:n}=this.#w(),r=this.getNextId(),a=this.#C({parent:this,id:r,x:i,y:n,uiManager:this.#h,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await Rs.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),r=this.#C({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:e,width:i,height:n}=this.boundingClientRect,r=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+i),c=Math.min(window.innerHeight,e+n),u=(r+l)/2-t,f=(a+c)/2-e,[p,m]=this.viewport.rotation%180===0?[u,f]:[f,u];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Ve.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===Mt.STAMP||i===Mt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===Mt.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=Ve.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#h.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#h.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,i){const n=this.#h.findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#h.removeLayer(this)}#A(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Ls(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#A();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Ls(this.div,{rotation:i}),e!==i)for(const n of this.#s.values())n.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}},aA=class ri{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ft(this,"_svgFactory",new Xo)}static#a(t,[e,i,n,r]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*r}%`}#s(){const t=ri._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const i=ri._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const r=ri._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),n}#o(t,e){for(const[i,n]of Object.entries(e))n===null?t.removeAttribute(i):t.setAttribute(i,n)}draw(t,e=!1,i=!1){const n=ri.#i++,r=this.#s(),a=ri._svgFactory.createElement("defs");r.append(a);const l=ri._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(n,l);const u=i?this.#r(a,c):null,f=ri._svgFactory.createElement("use");return r.append(f),f.setAttribute("href",`#${c}`),this.updateProperties(r,t),this.#e.set(n,r),{id:n,clipPathId:`url(#${u})`}}drawOutline(t,e){const i=ri.#i++,n=this.#s(),r=ri._svgFactory.createElement("defs");n.append(r);const a=ri._svgFactory.createElement("path");r.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const p=ri._svgFactory.createElement("mask");r.append(p),c=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",c),p.setAttribute("maskUnits","objectBoundingBox");const m=ri._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=ri._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const u=ri._svgFactory.createElement("use");n.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const f=u.cloneNode();return n.append(f),u.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(n,t),this.#e.set(i,n),i}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:n,rootClass:r,path:a}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(i&&this.#o(l,i),n&&ri.#a(l,n),r){const{classList:c}=l;for(const[u,f]of Object.entries(r))c.toggle(u,f)}if(a){const u=l.firstChild.firstChild;this.#o(u,a)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}};globalThis._pdfjsTestingUtils={HighlightOutliner:Lf};globalThis.pdfjsLib={AbortException:Jn,AnnotationEditorLayer:rA,AnnotationEditorParamsType:Vt,AnnotationEditorType:Mt,AnnotationEditorUIManager:wa,AnnotationLayer:fp,AnnotationMode:Rn,AnnotationType:Re,applyOpacity:f0,build:z0,ColorPicker:hp,createValidAbsoluteUrl:Qf,CSSConstants:d0,DOMSVGFactory:Xo,DrawLayer:aA,FeatureTest:Ve,fetchData:xa,findContrastColor:p0,getDocument:lp,getFilenameFromUrl:c0,getPdfFilenameFromUrl:h0,getRGB:Ra,getUuid:Jf,getXfaPageViewport:u0,GlobalWorkerOptions:Os,ImageKind:Ho,InvalidPDFException:sh,isDataScheme:tl,isPdfFile:mh,isValidExplicitDest:S0,MathClamp:ai,noContextMenu:zi,normalizeUnicode:r0,OPS:Ea,OutputScale:Ps,PasswordResponses:n0,PDFDataRangeTransport:cp,PDFDateString:rh,PDFWorker:oh,PermissionFlag:i0,PixelsPerInch:ur,RenderingCancelledException:gh,renderRichText:np,ResponseException:Go,setLayerDimensions:Ls,shadow:Ft,SignatureExtractor:nr,stopEvent:Ae,SupportedImageMimeTypes:ah,TextLayer:Vo,TouchManager:sp,updateUrlHash:Zf,Util:gt,VerbosityLevel:Zo,version:H0,XfaLayer:ep};const xT=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Jn,AnnotationEditorLayer:rA,AnnotationEditorParamsType:Vt,AnnotationEditorType:Mt,AnnotationEditorUIManager:wa,AnnotationLayer:fp,AnnotationMode:Rn,AnnotationType:Re,CSSConstants:d0,ColorPicker:hp,DOMSVGFactory:Xo,DrawLayer:aA,FeatureTest:Ve,GlobalWorkerOptions:Os,ImageKind:Ho,InvalidPDFException:sh,MathClamp:ai,OPS:Ea,OutputScale:Ps,PDFDataRangeTransport:cp,PDFDateString:rh,PDFWorker:oh,PasswordResponses:n0,PermissionFlag:i0,PixelsPerInch:ur,RenderingCancelledException:gh,ResponseException:Go,SignatureExtractor:nr,SupportedImageMimeTypes:ah,TextLayer:Vo,TouchManager:sp,Util:gt,VerbosityLevel:Zo,XfaLayer:ep,applyOpacity:f0,build:z0,createValidAbsoluteUrl:Qf,fetchData:xa,findContrastColor:p0,getDocument:lp,getFilenameFromUrl:c0,getPdfFilenameFromUrl:h0,getRGB:Ra,getUuid:Jf,getXfaPageViewport:u0,isDataScheme:tl,isPdfFile:mh,isValidExplicitDest:S0,noContextMenu:zi,normalizeUnicode:r0,renderRichText:np,setLayerDimensions:Ls,shadow:Ft,stopEvent:Ae,updateUrlHash:Zf,version:H0},Symbol.toStringTag,{value:"Module"}));function RT(d){return new Worker("/react-pdf-highlight/assets/pdf.worker.min-Bm5BkDWs.js",{name:d?.name})}var of={exports:{}},lf,gb;function _T(){if(gb)return lf;gb=1;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return lf=d,lf}var cf,mb;function DT(){if(mb)return cf;mb=1;var d=_T();function t(){}function e(){}return e.resetWarningCache=t,cf=function(){function i(a,l,c,u,f,p){if(p!==d){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function n(){return i}var r={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:n,element:i,elementType:i,instanceOf:n,node:i,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:e,resetWarningCache:t};return r.PropTypes=r,r},cf}var vb;function MT(){return vb||(vb=1,of.exports=DT()()),of.exports}var OT=MT();const ze=e0(OT);function oA(d){var t,e,i="";if(typeof d=="string"||typeof d=="number")i+=d;else if(typeof d=="object")if(Array.isArray(d)){var n=d.length;for(t=0;t<n;t++)d[t]&&(e=oA(d[t]))&&(i&&(i+=" "),i+=e)}else for(e in d)d[e]&&(i&&(i+=" "),i+=e);return i}function yh(){for(var d,t,e=0,i="",n=arguments.length;e<n;e++)(d=arguments[e])&&(t=oA(d))&&(i&&(i+=" "),i+=t);return i}var yb=Object.prototype.hasOwnProperty;function bb(d,t,e){for(e of d.keys())if(ga(e,t))return e}function ga(d,t){var e,i,n;if(d===t)return!0;if(d&&t&&(e=d.constructor)===t.constructor){if(e===Date)return d.getTime()===t.getTime();if(e===RegExp)return d.toString()===t.toString();if(e===Array){if((i=d.length)===t.length)for(;i--&&ga(d[i],t[i]););return i===-1}if(e===Set){if(d.size!==t.size)return!1;for(i of d)if(n=i,n&&typeof n=="object"&&(n=bb(t,n),!n)||!t.has(n))return!1;return!0}if(e===Map){if(d.size!==t.size)return!1;for(i of d)if(n=i[0],n&&typeof n=="object"&&(n=bb(t,n),!n)||!ga(i[1],t.get(n)))return!1;return!0}if(e===ArrayBuffer)d=new Uint8Array(d),t=new Uint8Array(t);else if(e===DataView){if((i=d.byteLength)===t.byteLength)for(;i--&&d.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(d)){if((i=d.byteLength)===t.byteLength)for(;i--&&d[i]===t[i];);return i===-1}if(!e||typeof d=="object"){i=0;for(e in d)if(yb.call(d,e)&&++i&&!yb.call(t,e)||!(e in t)||!ga(d[e],t[e]))return!1;return Object.keys(t).length===i}}return d!==d&&t!==t}function sl(d){let t=!1;return{promise:new Promise((i,n)=>{d.then(r=>!t&&i(r)).catch(r=>!t&&n(r))}),cancel(){t=!0}}}const LT=["onCopy","onCut","onPaste"],PT=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],NT=["onFocus","onBlur"],IT=["onInput","onInvalid","onReset","onSubmit"],kT=["onLoad","onError"],FT=["onKeyDown","onKeyPress","onKeyUp"],BT=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],UT=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],HT=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],zT=["onSelect"],jT=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],$T=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],GT=["onScroll"],VT=["onWheel"],XT=["onAnimationStart","onAnimationEnd","onAnimationIteration"],YT=["onTransitionEnd"],WT=["onToggle"],KT=["onChange"],qT=[...LT,...PT,...NT,...IT,...kT,...FT,...BT,...UT,...HT,...zT,...jT,...$T,...GT,...VT,...XT,...YT,...KT,...WT];function lA(d,t){const e={};for(const i of qT){const n=d[i];n&&(t?e[i]=(r=>n(r,t(i))):e[i]=n)}return e}var QT="Invariant failed";function ce(d,t){if(!d)throw new Error(QT)}var hf,Ab;function ZT(){if(Ab)return hf;Ab=1;var d=function(){};return hf=d,hf}var JT=ZT();const oi=e0(JT),cA=ot.createContext(null),tC="noopener noreferrer nofollow";class eC{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return ce(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){ce(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||tC,t.target=i?"_blank":this.externalLinkTarget||""}goToDestination(t){return new Promise(e=>{ce(this.pdfDocument),ce(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{ce(Array.isArray(e));const i=e[0];new Promise(n=>{ce(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(r=>{n(r)}).catch(()=>{ce(!1)}):typeof i=="number"?n(i):ce(!1)}).then(n=>{const r=n+1;ce(this.pdfViewer),ce(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:n,pageNumber:r})})})}goToPage(t){const e=t-1;ce(this.pdfViewer),ce(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(t){this.goToDestination(t)}}function ma({children:d,type:t}){return ct.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:d})}const Sb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function iC(d,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return d}}function Ta(){return ot.useReducer(iC,{value:void 0,error:void 0})}const bh=typeof window<"u",hA=bh&&window.location.protocol==="file:";function nC(d){return typeof d<"u"}function tr(d){return nC(d)&&d!==null}function sC(d){return typeof d=="string"}function rC(d){return d instanceof ArrayBuffer}function aC(d){return ce(bh),d instanceof Blob}function If(d){return sC(d)&&/^data:/.test(d)}function Eb(d){ce(If(d));const[t="",e=""]=d.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function oC(){return bh&&window.devicePixelRatio||1}const uA="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function wb(){oi(!hA,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${uA}`)}function lC(){oi(!hA,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${uA}`)}function fr(d){d?.cancel&&d.cancel()}function kf(d,t){return Object.defineProperty(d,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(d,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(d,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(d,"originalHeight",{get(){return this.view[3]},configurable:!0}),d}function cC(d){return d.name==="RenderingCancelledException"}function hC(d){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=n=>{if(!n.target)return e(new Error("Error while reading a file."));const{error:r}=n.target;if(!r)return e(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(d)})}const{PDFDataRangeTransport:uC}=xT,dC=(d,t)=>{switch(t){case Sb.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");d(e);break}case Sb.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");d(e);break}}};function Tb(d){return typeof d=="object"&&d!==null&&("data"in d||"range"in d||"url"in d)}const fC=ot.forwardRef(function({children:t,className:e,error:i="Failed to load PDF file.",externalLinkRel:n,externalLinkTarget:r,file:a,inputRef:l,imageResourcesPath:c,loading:u="Loading PDF",noData:f="No PDF file specified.",onItemClick:p,onLoadError:m,onLoadProgress:v,onLoadSuccess:S,onPassword:b=dC,onSourceError:w,onSourceSuccess:E,options:C,renderMode:T,rotate:_,scale:R,...D},M){const[L,P]=Ta(),{value:B,error:U}=L,[Z,q]=Ta(),{value:Q,error:nt}=Z,N=ot.useRef(new eC),I=ot.useRef([]),$=ot.useRef(void 0),at=ot.useRef(void 0);a&&a!==$.current&&Tb(a)&&(oi(!ga(a,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=a),C&&C!==at.current&&(oi(!ga(C,at.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),at.current=C);const ut=ot.useRef({scrollPageIntoView:bt=>{const{dest:_t,pageNumber:Ht,pageIndex:It=Ht-1}=bt;if(p){p({dest:_t,pageIndex:It,pageNumber:Ht});return}const li=I.current[It];if(li){li.scrollIntoView();return}oi(!1,`An internal link leading to page ${Ht} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});ot.useImperativeHandle(M,()=>({linkService:N,pages:I,viewer:ut}),[]);function k(){E&&E()}function j(){U&&(oi(!1,U.toString()),w&&w(U))}function K(){P({type:"RESET"})}ot.useEffect(K,[a,P]);const st=ot.useCallback(async()=>{if(!a)return null;if(typeof a=="string")return If(a)?{data:Eb(a)}:(wb(),{url:a});if(a instanceof uC)return{range:a};if(rC(a))return{data:a};if(bh&&aC(a))return{data:await hC(a)};if(ce(typeof a=="object"),ce(Tb(a)),"url"in a&&typeof a.url=="string"){if(If(a.url)){const{url:bt,..._t}=a;return{data:Eb(bt),..._t}}wb()}return a},[a]);ot.useEffect(()=>{const bt=sl(st());return bt.promise.then(_t=>{P({type:"RESOLVE",value:_t})}).catch(_t=>{P({type:"REJECT",error:_t})}),()=>{fr(bt)}},[st,P]),ot.useEffect(()=>{if(!(typeof B>"u")){if(B===!1){j();return}k()}},[B]);function ht(){Q&&(S&&S(Q),I.current=new Array(Q.numPages),N.current.setDocument(Q))}function J(){nt&&(oi(!1,nt.toString()),m&&m(nt))}ot.useEffect(function(){q({type:"RESET"})},[q,B]),ot.useEffect(function(){if(!B)return;const _t=C?{...B,...C}:B,Ht=lp(_t);v&&(Ht.onProgress=v),b&&(Ht.onPassword=b);const It=Ht,li=It.promise.then(ji=>{q({type:"RESOLVE",value:ji})}).catch(ji=>{It.destroyed||q({type:"REJECT",error:ji})});return()=>{li.finally(()=>It.destroy())}},[C,q,B]),ot.useEffect(()=>{if(!(typeof Q>"u")){if(Q===!1){J();return}ht()}},[Q]),ot.useEffect(function(){N.current.setViewer(ut.current),N.current.setExternalLinkRel(n),N.current.setExternalLinkTarget(r)},[n,r]);const V=ot.useCallback((bt,_t)=>{I.current[bt]=_t},[]),rt=ot.useCallback(bt=>{delete I.current[bt]},[]),lt=ot.useMemo(()=>({imageResourcesPath:c,linkService:N.current,onItemClick:p,pdf:Q,registerPage:V,renderMode:T,rotate:_,scale:R,unregisterPage:rt}),[c,p,Q,V,T,_,R,rt]),At=ot.useMemo(()=>lA(D,()=>Q),[D,Q]);function dt(){function bt(Ht){return!!Ht?.pdf}if(!bt(lt))throw new Error("pdf is undefined");const _t=typeof t=="function"?t(lt):t;return ct.jsx(cA.Provider,{value:lt,children:_t})}function Bt(){return a?Q==null?ct.jsx(ma,{type:"loading",children:typeof u=="function"?u():u}):Q===!1?ct.jsx(ma,{type:"error",children:typeof i=="function"?i():i}):dt():ct.jsx(ma,{type:"no-data",children:typeof f=="function"?f():f})}return ct.jsx("div",{className:yh("react-pdf__Document",e),ref:l,...At,children:Bt()})});function dA(){return ot.useContext(cA)}function fA(){for(var d=[],t=0;t<arguments.length;t++)d[t]=arguments[t];var e=d.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(r){for(var a=0,l=e;a<l.length;a++){var c=l[a];typeof c=="function"?c(r):c&&(c.current=r)}}}const pA=ot.createContext(null);function Ah(){return ot.useContext(pA)}function pC(){const d=dA(),t=Ah();ce(t);const e={...d,...t},{imageResourcesPath:i,linkService:n,onGetAnnotationsError:r,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:c,page:u,pdf:f,renderForms:p,rotate:m,scale:v=1}=e;ce(f),ce(u),ce(n);const[S,b]=Ta(),{value:w,error:E}=S,C=ot.useRef(null);oi(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){w&&a&&a(w)}function _(){E&&(oi(!1,E.toString()),r&&r(E))}ot.useEffect(function(){b({type:"RESET"})},[b,u]),ot.useEffect(function(){if(!u)return;const P=sl(u.getAnnotations()),B=P;return P.promise.then(U=>{b({type:"RESOLVE",value:U})}).catch(U=>{b({type:"REJECT",error:U})}),()=>{fr(B)}},[b,u]),ot.useEffect(()=>{if(w!==void 0){if(w===!1){_();return}T()}},[w]);function R(){c&&c()}function D(L){oi(!1,`${L}`),l&&l(L)}const M=ot.useMemo(()=>u.getViewport({scale:v,rotation:m}),[u,m,v]);return ot.useEffect(function(){if(!f||!u||!n||!w)return;const{current:P}=C;if(!P)return;const B=M.clone({dontFlip:!0}),U={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:f.annotationStorage,commentManager:null,div:P,l10n:null,linkService:n,page:u,structTreeLayer:null,viewport:B},Z={annotations:w,annotationStorage:f.annotationStorage,div:P,imageResourcesPath:i,linkService:n,page:u,renderForms:p,viewport:B};P.innerHTML="";try{new fp(U).render(Z),R()}catch(q){D(q)}return()=>{}},[w,i,n,u,f,p,M]),ct.jsx("div",{className:yh("react-pdf__Page__annotations","annotationLayer"),ref:C})}const gA={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},gC=/^H(\d+)$/;function mC(d){return d in gA}function Sh(d){return"children"in d}function mA(d){return Sh(d)?d.children.length===1&&0 in d.children&&"id"in d.children[0]:!1}function vC(d){const t={};if(Sh(d)){const{role:e}=d,i=e.match(gC);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(mC(e)){const n=gA[e];n&&(t.role=n)}}return t}function vA(d){const t={};if(Sh(d)){if(d.alt!==void 0&&(t["aria-label"]=d.alt),d.lang!==void 0&&(t.lang=d.lang),mA(d)){const[e]=d.children;if(e){const i=vA(e);return{...t,...i}}}}else"id"in d&&(t["aria-owns"]=d.id);return t}function yC(d){return d?{...vC(d),...vA(d)}:null}function yA({className:d,node:t}){const e=ot.useMemo(()=>yC(t),[t]),i=ot.useMemo(()=>!Sh(t)||mA(t)?null:t.children.map((n,r)=>ct.jsx(yA,{node:n},r)),[t]);return ct.jsx("span",{className:d,...e,children:i})}function bC(){const d=Ah();ce(d);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=d,[i,n]=Ta(),{value:r,error:a}=i,{customTextRenderer:l,page:c}=d;function u(){r&&e&&e(r)}function f(){a&&(oi(!1,a.toString()),t&&t(a))}return ot.useEffect(function(){n({type:"RESET"})},[n,c]),ot.useEffect(function(){if(l||!c)return;const m=sl(c.getStructTree()),v=m;return m.promise.then(S=>{n({type:"RESOLVE",value:S})}).catch(S=>{n({type:"REJECT",error:S})}),()=>fr(v)},[l,c,n]),ot.useEffect(()=>{if(r!==void 0){if(r===!1){f();return}u()}},[r]),r?ct.jsx(yA,{className:"react-pdf__Page__structTree structTree",node:r}):null}const Cb=Rn;function AC(d){const t=Ah();ce(t);const e={...t,...d},{_className:i,canvasBackground:n,devicePixelRatio:r=oC(),onRenderError:a,onRenderSuccess:l,page:c,renderForms:u,renderTextLayer:f,rotate:p,scale:m}=e,{canvasRef:v}=d;ce(c);const S=ot.useRef(null);function b(){c&&l&&l(kf(c,m))}function w(_){cC(_)||(oi(!1,_.toString()),a&&a(_))}const E=ot.useMemo(()=>c.getViewport({scale:m*r,rotation:p}),[r,c,p,m]),C=ot.useMemo(()=>c.getViewport({scale:m,rotation:p}),[c,p,m]);ot.useEffect(function(){if(!c)return;c.cleanup();const{current:R}=S;if(!R)return;R.width=E.width,R.height=E.height,R.style.width=`${Math.floor(C.width)}px`,R.style.height=`${Math.floor(C.height)}px`,R.style.visibility="hidden";const D={annotationMode:u?Cb.ENABLE_FORMS:Cb.ENABLE,canvas:R,canvasContext:R.getContext("2d",{alpha:!1}),viewport:E};n&&(D.background=n);const M=c.render(D),L=M;return M.promise.then(()=>{R.style.visibility="",b()}).catch(w),()=>fr(L)},[n,c,u,E,C]);const T=ot.useCallback(()=>{const{current:_}=S;_&&(_.width=0,_.height=0)},[]);return ot.useEffect(()=>T,[T]),ct.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:fA(v,S),style:{display:"block",userSelect:"none"},children:f?ct.jsx(bC,{}):null})}function SC(d){return"str"in d}function EC(){const d=Ah();ce(d);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:n,onRenderTextLayerSuccess:r,page:a,pageIndex:l,pageNumber:c,rotate:u,scale:f}=d;ce(a);const[p,m]=Ta(),{value:v,error:S}=p,b=ot.useRef(null);oi(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function w(){v&&i&&i(v)}function E(){S&&(oi(!1,S.toString()),e&&e(S))}ot.useEffect(function(){m({type:"RESET"})},[a,m]),ot.useEffect(function(){if(!a)return;const L=sl(a.getTextContent()),P=L;return L.promise.then(B=>{m({type:"RESOLVE",value:B})}).catch(B=>{m({type:"REJECT",error:B})}),()=>fr(P)},[a,m]),ot.useEffect(()=>{if(v!==void 0){if(v===!1){E();return}w()}},[v]);const C=ot.useCallback(()=>{r&&r()},[r]),T=ot.useCallback(M=>{oi(!1,M.toString()),n&&n(M)},[n]);function _(){const M=b.current;M&&M.classList.add("selecting")}function R(){const M=b.current;M&&M.classList.remove("selecting")}const D=ot.useMemo(()=>a.getViewport({scale:f,rotation:u}),[a,u,f]);return ot.useLayoutEffect(function(){if(!a||!v)return;const{current:L}=b;if(!L)return;L.innerHTML="";const P=a.streamTextContent({includeMarkedContent:!0}),B={container:L,textContentSource:P,viewport:D},U=new Vo(B),Z=U;return U.render().then(()=>{const q=document.createElement("div");q.className="endOfContent",L.append(q);const Q=L.querySelectorAll('[role="presentation"]');if(t){let nt=0;v.items.forEach((N,I)=>{if(!SC(N))return;const $=Q[nt];if(!$)return;const at=t({pageIndex:l,pageNumber:c,itemIndex:I,...N});$.innerHTML=at,nt+=N.str&&N.hasEOL?2:1})}C()}).catch(T),()=>fr(Z)},[t,T,C,a,l,c,v,D]),ct.jsx("div",{className:yh("react-pdf__Page__textContent","textLayer"),onMouseUp:R,onMouseDown:_,ref:b})}const xb=1;function wC(d){const e={...dA(),...d},{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:n=!0,canvasBackground:r,canvasRef:a,children:l,className:c,customRenderer:u,customTextRenderer:f,devicePixelRatio:p,error:m="Failed to load the page.",height:v,inputRef:S,loading:b="Loading page",noData:w="No page specified.",onGetAnnotationsError:E,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:_,onGetTextError:R,onGetTextSuccess:D,onLoadError:M,onLoadSuccess:L,onRenderAnnotationLayerError:P,onRenderAnnotationLayerSuccess:B,onRenderError:U,onRenderSuccess:Z,onRenderTextLayerError:q,onRenderTextLayerSuccess:Q,pageIndex:nt,pageNumber:N,pdf:I,registerPage:$,renderAnnotationLayer:at=!0,renderForms:ut=!1,renderMode:k="canvas",renderTextLayer:j=!0,rotate:K,scale:st=xb,unregisterPage:ht,width:J,...V}=e,[rt,lt]=Ta(),{value:At,error:dt}=rt,Bt=ot.useRef(null);ce(I);const bt=tr(N)?N-1:nt??null,_t=N??(tr(nt)?nt+1:null),Ht=K??(At?At.rotate:null),It=ot.useMemo(()=>{if(!At)return null;let ln=1;const cn=st??xb;if(J||v){const gn=At.getViewport({scale:1,rotation:Ht});J?ln=J/gn.width:v&&(ln=v/gn.height)}return cn*ln},[v,At,Ht,st,J]);ot.useEffect(function(){return()=>{tr(bt)&&n&&ht&&ht(bt)}},[n,I,bt,ht]);function li(){if(L){if(!At||!It)return;L(kf(At,It))}if(n&&$){if(!tr(bt)||!Bt.current)return;$(bt,Bt.current)}}function ji(){dt&&(oi(!1,dt.toString()),M&&M(dt))}ot.useEffect(function(){lt({type:"RESET"})},[lt,I,bt]),ot.useEffect(function(){if(!I||!_t)return;const cn=sl(I.getPage(_t)),gn=cn;return cn.promise.then(Ar=>{lt({type:"RESOLVE",value:Ar})}).catch(Ar=>{lt({type:"REJECT",error:Ar})}),()=>fr(gn)},[lt,I,_t]),ot.useEffect(()=>{if(At!==void 0){if(At===!1){ji();return}li()}},[At,It]);const $i=ot.useMemo(()=>tr(bt)&&_t&&tr(Ht)&&tr(It)?{_className:i,canvasBackground:r,customTextRenderer:f,devicePixelRatio:p,onGetAnnotationsError:E,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:_,onGetTextError:R,onGetTextSuccess:D,onRenderAnnotationLayerError:P,onRenderAnnotationLayerSuccess:B,onRenderError:U,onRenderSuccess:Z,onRenderTextLayerError:q,onRenderTextLayerSuccess:Q,page:At,pageIndex:bt,pageNumber:_t,renderForms:ut,renderTextLayer:j,rotate:Ht,scale:It}:null,[i,r,f,p,E,C,T,_,R,D,P,B,U,Z,q,Q,At,bt,_t,ut,j,Ht,It]),_a=ot.useMemo(()=>lA(V,()=>At&&(It?kf(At,It):void 0)),[V,At,It]),ts=`${bt}@${It}/${Ht}`;function Dh(){switch(k){case"custom":return ce(u),ct.jsx(u,{},`${ts}_custom`);case"none":return null;case"canvas":default:return ct.jsx(AC,{canvasRef:a},`${ts}_canvas`)}}function Mh(){return j?ct.jsx(EC,{},`${ts}_text`):null}function ci(){return at?ct.jsx(pC,{},`${ts}_annotations`):null}function Oh(){function ln(gn){return!!gn?.page}if(!ln($i))throw new Error("page is undefined");const cn=typeof l=="function"?l($i):l;return ct.jsxs(pA.Provider,{value:$i,children:[Dh(),Mh(),ci(),cn]})}function dl(){return _t?I===null||At===void 0||At===null?ct.jsx(ma,{type:"loading",children:typeof b=="function"?b():b}):I===!1||At===!1?ct.jsx(ma,{type:"error",children:typeof m=="function"?m():m}):Oh():ct.jsx(ma,{type:"no-data",children:typeof w=="function"?w():w})}return ct.jsx("div",{className:yh(i,c),"data-page-number":_t,ref:fA(S,Bt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${It}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},..._a,children:dl()})}lC();Os.workerSrc="pdf.worker.mjs";function TC({rects:d}){return!d||d.length===0?null:ct.jsx("div",{className:"highlight-overlay",children:d.map((t,e)=>ct.jsx("div",{className:"highlight-rect",style:{position:"absolute",left:`${t.x}px`,top:`${t.y}px`,width:`${t.width}px`,height:`${t.height}px`,backgroundColor:"rgba(250, 231, 28, 0.7)",borderRadius:"2px",pointerEvents:"none",zIndex:10},"aria-hidden":"true"},e))})}var CC={34:((d,t,e)=>{var i=e(4901);d.exports=function(n){return typeof n=="object"?n!==null:i(n)}}),81:((d,t,e)=>{var i=e(9565),n=e(9306),r=e(8551),a=e(6823),l=e(851),c=TypeError;d.exports=function(u,f){var p=arguments.length<2?l(u):f;if(n(p))return r(i(p,u));throw new c(a(u)+" is not iterable")}}),116:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(2652),a=e(9306),l=e(8551),c=e(1767),u=e(9539),f=e(4549),p=f("find",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:p},{find:function(v){l(this);try{a(v)}catch(w){u(this,"throw",w)}if(p)return n(p,this,v);var S=c(this),b=0;return r(S,function(w,E){if(v(w,b++))return E(w)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})}),283:((d,t,e)=>{var i=e(9504),n=e(9039),r=e(4901),a=e(9297),l=e(3724),c=e(350).CONFIGURABLE,u=e(3706),f=e(1181),p=f.enforce,m=f.get,v=String,S=Object.defineProperty,b=i("".slice),w=i("".replace),E=i([].join),C=l&&!n(function(){return S(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),_=d.exports=function(R,D,M){b(v(D),0,7)==="Symbol("&&(D="["+w(v(D),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),M&&M.getter&&(D="get "+D),M&&M.setter&&(D="set "+D),(!a(R,"name")||c&&R.name!==D)&&(l?S(R,"name",{value:D,configurable:!0}):R.name=D),C&&M&&a(M,"arity")&&R.length!==M.arity&&S(R,"length",{value:M.arity});try{M&&a(M,"constructor")&&M.constructor?l&&S(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var L=p(R);return a(L,"source")||(L.source=E(T,typeof D=="string"?D:"")),R};Function.prototype.toString=_(function(){return r(this)&&m(this).source||u(this)},"toString")}),350:((d,t,e)=>{var i=e(3724),n=e(9297),r=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,l=n(r,"name"),c=l&&(function(){}).name==="something",u=l&&(!i||i&&a(r,"name").configurable);d.exports={EXISTS:l,PROPER:c,CONFIGURABLE:u}}),397:((d,t,e)=>{var i=e(7751);d.exports=i("document","documentElement")}),421:(d=>{d.exports={}}),456:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(9504),a=e(4154),l=e(5169),c=r(1.1.toString),u=n.Uint8Array,f=!u||!u.prototype.toHex||!(function(){try{var p=new u([255,255,255,255,255,255,255,255]);return p.toHex()==="ffffffffffffffff"}catch{return!1}})();u&&i({target:"Uint8Array",proto:!0,forced:f},{toHex:function(){a(this),l(this.buffer);for(var m="",v=0,S=this.length;v<S;v++){var b=c(this[v],16);m+=b.length===1?"0"+b:b}return m}})}),507:((d,t,e)=>{var i=e(9565);d.exports=function(n,r,a){for(var l=a?n:n.iterator,c=n.next,u,f;!(u=i(c,l)).done;)if(f=r(u.value),f!==void 0)return f}}),531:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(9306),a=e(8551),l=e(1767),c=e(8646),u=e(9462),f=e(9539),p=e(6395),m=e(684),v=e(4549),S=!p&&!m("flatMap",function(){}),b=!p&&!S&&v("flatMap",TypeError),w=p||S||b,E=u(function(){for(var C=this.iterator,T=this.mapper,_,R;;){if(R=this.inner)try{if(_=a(n(R.next,R.iterator)),!_.done)return _.value;this.inner=null}catch(D){f(C,"throw",D)}if(_=a(n(this.next,C)),this.done=!!_.done)return;try{this.inner=c(T(_.value,this.counter++),!1)}catch(D){f(C,"throw",D)}}});i({target:"Iterator",proto:!0,real:!0,forced:w},{flatMap:function(T){a(this);try{r(T)}catch(_){f(this,"throw",_)}return b?n(b,this,T):new E(l(this),{mapper:T,inner:null})}})}),616:((d,t,e)=>{var i=e(9039);d.exports=!i(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")})}),655:((d,t,e)=>{var i=e(6955),n=String;d.exports=function(r){if(i(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return n(r)}}),679:((d,t,e)=>{var i=e(1625),n=TypeError;d.exports=function(r,a){if(i(a,r))return r;throw new n("Incorrect invocation")}}),684:(d=>{d.exports=function(t,e){var i=typeof Iterator=="function"&&Iterator.prototype[t];if(i)try{i.call({next:null},e).next()}catch{return!0}}}),741:(d=>{var t=Math.ceil,e=Math.floor;d.exports=Math.trunc||function(n){var r=+n;return(r>0?e:t)(r)}}),757:((d,t,e)=>{var i=e(7751),n=e(4901),r=e(1625),a=e(7040),l=Object;d.exports=a?function(c){return typeof c=="symbol"}:function(c){var u=i("Symbol");return n(u)&&r(u.prototype,l(c))}}),851:((d,t,e)=>{var i=e(6955),n=e(5966),r=e(4117),a=e(6269),l=e(8227),c=l("iterator");d.exports=function(u){if(!r(u))return n(u,c)||n(u,"@@iterator")||a[i(u)]}}),944:(d=>{var t=TypeError;d.exports=function(e){var i=e&&e.alphabet;if(i===void 0||i==="base64"||i==="base64url")return i||"base64";throw new t("Incorrect `alphabet` option")}}),1072:((d,t,e)=>{var i=e(1828),n=e(8727);d.exports=Object.keys||function(a){return i(a,n)}}),1103:(d=>{d.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}}),1108:((d,t,e)=>{var i=e(6955);d.exports=function(n){var r=i(n);return r==="BigInt64Array"||r==="BigUint64Array"}}),1148:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(2652),a=e(9306),l=e(8551),c=e(1767),u=e(9539),f=e(4549),p=f("every",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:p},{every:function(v){l(this);try{a(v)}catch(w){u(this,"throw",w)}if(p)return n(p,this,v);var S=c(this),b=0;return!r(S,function(w,E){if(!v(w,b++))return E()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1181:((d,t,e)=>{var i=e(8622),n=e(4576),r=e(34),a=e(6699),l=e(9297),c=e(7629),u=e(6119),f=e(421),p="Object already initialized",m=n.TypeError,v=n.WeakMap,S,b,w,E=function(R){return w(R)?b(R):S(R,{})},C=function(R){return function(D){var M;if(!r(D)||(M=b(D)).type!==R)throw new m("Incompatible receiver, "+R+" required");return M}};if(i||c.state){var T=c.state||(c.state=new v);T.get=T.get,T.has=T.has,T.set=T.set,S=function(R,D){if(T.has(R))throw new m(p);return D.facade=R,T.set(R,D),D},b=function(R){return T.get(R)||{}},w=function(R){return T.has(R)}}else{var _=u("state");f[_]=!0,S=function(R,D){if(l(R,_))throw new m(p);return D.facade=R,a(R,_,D),D},b=function(R){return l(R,_)?R[_]:{}},w=function(R){return l(R,_)}}d.exports={set:S,get:b,has:w,enforce:E,getterFor:C}}),1291:((d,t,e)=>{var i=e(741);d.exports=function(n){var r=+n;return r!==r||r===0?0:i(r)}}),1385:((d,t,e)=>{var i=e(9539);d.exports=function(n,r,a){for(var l=n.length-1;l>=0;l--)if(n[l]!==void 0)try{a=i(n[l].iterator,r,a)}catch(c){r="throw",a=c}if(r==="throw")throw a;return a}}),1548:((d,t,e)=>{var i=e(4576),n=e(9039),r=e(9519),a=e(4215),l=i.structuredClone;d.exports=!!l&&!n(function(){if(a==="DENO"&&r>92||a==="NODE"&&r>94||a==="BROWSER"&&r>97)return!1;var c=new ArrayBuffer(8),u=l(c,{transfer:[c]});return c.byteLength!==0||u.byteLength!==8})}),1549:((d,t,e)=>{e(6632)}),1625:((d,t,e)=>{var i=e(9504);d.exports=i({}.isPrototypeOf)}),1689:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(8745),a=e(7680),l=e(6043),c=e(9306),u=e(1103),f=n.Promise,p=!1,m=!f||!f.try||u(function(){f.try(function(v){p=v===8},8)}).error||!p;i({target:"Promise",stat:!0,forced:m},{try:function(v){var S=arguments.length>1?a(arguments,1):[],b=l.f(this),w=u(function(){return r(c(v),void 0,S)});return(w.error?b.reject:b.resolve)(w.value),b.promise}})}),1698:((d,t,e)=>{var i=e(6518),n=e(4204),r=e(9835),a=e(4916),l=!a("union")||!r("union");i({target:"Set",proto:!0,real:!0,forced:l},{union:n})}),1701:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(9306),a=e(8551),l=e(1767),c=e(9462),u=e(6319),f=e(9539),p=e(684),m=e(4549),v=e(6395),S=!v&&!p("map",function(){}),b=!v&&!S&&m("map",TypeError),w=v||S||b,E=c(function(){var C=this.iterator,T=a(n(this.next,C)),_=this.done=!!T.done;if(!_)return u(C,this.mapper,[T.value,this.counter++],!0)});i({target:"Iterator",proto:!0,real:!0,forced:w},{map:function(T){a(this);try{r(T)}catch(_){f(this,"throw",_)}return b?n(b,this,T):new E(l(this),{mapper:T})}})}),1767:(d=>{d.exports=function(t){return{iterator:t,next:t.next,done:!1}}}),1828:((d,t,e)=>{var i=e(9504),n=e(9297),r=e(5397),a=e(9617).indexOf,l=e(421),c=i([].push);d.exports=function(u,f){var p=r(u),m=0,v=[],S;for(S in p)!n(l,S)&&n(p,S)&&c(v,S);for(;f.length>m;)n(p,S=f[m++])&&(~a(v,S)||c(v,S));return v}}),2106:((d,t,e)=>{var i=e(283),n=e(4913);d.exports=function(r,a,l){return l.get&&i(l.get,a,{getter:!0}),l.set&&i(l.set,a,{setter:!0}),n.f(r,a,l)}}),2140:((d,t,e)=>{var i=e(8227),n=i("toStringTag"),r={};r[n]="z",d.exports=String(r)==="[object z]"}),2195:((d,t,e)=>{var i=e(9504),n=i({}.toString),r=i("".slice);d.exports=function(a){return r(n(a),8,-1)}}),2211:((d,t,e)=>{var i=e(9039);d.exports=!i(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})}),2303:((d,t,e)=>{var i=e(4576),n=e(9504),r=i.Uint8Array,a=i.SyntaxError,l=i.parseInt,c=Math.min,u=/[^\da-f]/i,f=n(u.exec),p=n("".slice);d.exports=function(m,v){var S=m.length;if(S%2!==0)throw new a("String should be an even number of characters");for(var b=v?c(v.length,S/2):S/2,w=v||new r(b),E=0,C=0;C<b;){var T=p(m,E,E+=2);if(f(u,T))throw new a("String should only contain hex characters");w[C++]=l(T,16)}return{bytes:w,read:E}}}),2360:((d,t,e)=>{var i=e(8551),n=e(6801),r=e(8727),a=e(421),l=e(397),c=e(4055),u=e(6119),f=">",p="<",m="prototype",v="script",S=u("IE_PROTO"),b=function(){},w=function(R){return p+v+f+R+p+"/"+v+f},E=function(R){R.write(w("")),R.close();var D=R.parentWindow.Object;return R=null,D},C=function(){var R=c("iframe"),D="java"+v+":",M;return R.style.display="none",l.appendChild(R),R.src=String(D),M=R.contentWindow.document,M.open(),M.write(w("document.F=Object")),M.close(),M.F},T,_=function(){try{T=new ActiveXObject("htmlfile")}catch{}_=typeof document<"u"?document.domain&&T?E(T):C():E(T);for(var R=r.length;R--;)delete _[m][r[R]];return _()};a[S]=!0,d.exports=Object.create||function(D,M){var L;return D!==null?(b[m]=i(D),L=new b,b[m]=null,L[S]=D):L=_(),M===void 0?L:n.f(L,M)}}),2475:((d,t,e)=>{var i=e(6518),n=e(8527),r=e(4916),a=!r("isSupersetOf",function(l){return!l});i({target:"Set",proto:!0,real:!0,forced:a},{isSupersetOf:n})}),2489:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(9306),a=e(8551),l=e(1767),c=e(9462),u=e(6319),f=e(6395),p=e(9539),m=e(684),v=e(4549),S=!f&&!m("filter",function(){}),b=!f&&!S&&v("filter",TypeError),w=f||S||b,E=c(function(){for(var C=this.iterator,T=this.predicate,_=this.next,R,D,M;;){if(R=a(n(_,C)),D=this.done=!!R.done,D)return;if(M=R.value,u(C,T,[M,this.counter++],!0))return M}});i({target:"Iterator",proto:!0,real:!0,forced:w},{filter:function(T){a(this);try{r(T)}catch(_){p(this,"throw",_)}return b?n(b,this,T):new E(l(this),{predicate:T})}})}),2529:(d=>{d.exports=function(t,e){return{value:t,done:e}}}),2603:((d,t,e)=>{var i=e(655);d.exports=function(n,r){return n===void 0?arguments.length<2?"":r:i(n)}}),2652:((d,t,e)=>{var i=e(6080),n=e(9565),r=e(8551),a=e(6823),l=e(4209),c=e(6198),u=e(1625),f=e(81),p=e(851),m=e(9539),v=TypeError,S=function(w,E){this.stopped=w,this.result=E},b=S.prototype;d.exports=function(w,E,C){var T=C&&C.that,_=!!(C&&C.AS_ENTRIES),R=!!(C&&C.IS_RECORD),D=!!(C&&C.IS_ITERATOR),M=!!(C&&C.INTERRUPTED),L=i(E,T),P,B,U,Z,q,Q,nt,N=function($){return P&&m(P,"normal"),new S(!0,$)},I=function($){return _?(r($),M?L($[0],$[1],N):L($[0],$[1])):M?L($,N):L($)};if(R)P=w.iterator;else if(D)P=w;else{if(B=p(w),!B)throw new v(a(w)+" is not iterable");if(l(B)){for(U=0,Z=c(w);Z>U;U++)if(q=I(w[U]),q&&u(b,q))return q;return new S(!1)}P=f(w,B)}for(Q=R?w.next:P.next;!(nt=n(Q,P)).done;){try{q=I(nt.value)}catch($){m(P,"throw",$)}if(typeof q=="object"&&q&&u(b,q))return q}return new S(!1)}}),2777:((d,t,e)=>{var i=e(9565),n=e(34),r=e(757),a=e(5966),l=e(4270),c=e(8227),u=TypeError,f=c("toPrimitive");d.exports=function(p,m){if(!n(p)||r(p))return p;var v=a(p,f),S;if(v){if(m===void 0&&(m="default"),S=i(v,p,m),!n(S)||r(S))return S;throw new u("Can't convert object to primitive value")}return m===void 0&&(m="number"),l(p,m)}}),2787:((d,t,e)=>{var i=e(9297),n=e(4901),r=e(8981),a=e(6119),l=e(2211),c=a("IE_PROTO"),u=Object,f=u.prototype;d.exports=l?u.getPrototypeOf:function(p){var m=r(p);if(i(m,c))return m[c];var v=m.constructor;return n(v)&&m instanceof v?v.prototype:m instanceof u?f:null}}),2796:((d,t,e)=>{var i=e(9039),n=e(4901),r=/#|\.prototype\./,a=function(p,m){var v=c[l(p)];return v===f?!0:v===u?!1:n(m)?i(m):!!m},l=a.normalize=function(p){return String(p).replace(r,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",f=a.POLYFILL="P";d.exports=a}),2804:(d=>{var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=t+"+/",i=t+"-_",n=function(r){for(var a={},l=0;l<64;l++)a[r.charAt(l)]=l;return a};d.exports={i2c:e,c2i:n(e),i2cUrl:i,c2iUrl:n(i)}}),2812:(d=>{var t=TypeError;d.exports=function(e,i){if(e<i)throw new t("Not enough arguments");return e}}),2839:((d,t,e)=>{var i=e(4576),n=i.navigator,r=n&&n.userAgent;d.exports=r?String(r):""}),2967:((d,t,e)=>{var i=e(6706),n=e(34),r=e(7750),a=e(3506);d.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var l=!1,c={},u;try{u=i(Object.prototype,"__proto__","set"),u(c,[]),l=c instanceof Array}catch{}return function(p,m){return r(p),a(m),n(p)&&(l?u(p,m):p.__proto__=m),p}})():void 0)}),3068:((d,t,e)=>{var i=e(6518),n=e(9504),r=e(2652),a=RangeError,l=TypeError,c=1/0,u=NaN,f=Math.abs,p=Math.pow,m=n([].push),v=p(2,1023),S=p(2,53)-1,b=Number.MAX_VALUE,w=p(2,971),E={},C={},T={},_={},R={},D=function(M,L){var P=M+L,B=L-(P-M);return{hi:P,lo:B}};i({target:"Math",stat:!0},{sumPrecise:function(L){var P=[],B=0,U=_;switch(r(L,function(J){if(++B>=S)throw new a("Maximum allowed index exceeded");if(typeof J!="number")throw new l("Value is not a number");U!==E&&(J!==J?U=E:J===c?U=U===C?E:T:J===-c?U=U===T?E:C:(J!==0||1/J===c)&&(U===_||U===R)&&(U=R,m(P,J)))}),U){case E:return u;case C:return-c;case T:return c;case _:return-0}for(var Z=[],q=0,Q,nt,N,I,$,at,ut=0;ut<P.length;ut++){Q=P[ut];for(var k=0,j=0;j<Z.length;j++){if(nt=Z[j],f(Q)<f(nt)&&(at=Q,Q=nt,nt=at),N=D(Q,nt),I=N.hi,$=N.lo,f(I)===c){var K=I===c?1:-1;q+=K,Q=Q-K*v-K*v,f(Q)<f(nt)&&(at=Q,Q=nt,nt=at),N=D(Q,nt),I=N.hi,$=N.lo}$!==0&&(Z[k++]=$),Q=I}Z.length=k,Q!==0&&m(Z,Q)}var st=Z.length-1;if(I=0,$=0,q!==0){var ht=st>=0?Z[st]:0;if(st--,f(q)>1||q>0&&ht>0||q<0&&ht<0)return q>0?c:-c;if(N=D(q*v,ht/2),I=N.hi,$=N.lo,$*=2,f(2*I)===c)return I>0?I===v&&$===-(w/2)&&st>=0&&Z[st]<0?b:c:I===-v&&$===w/2&&st>=0&&Z[st]>0?-b:-c;$!==0&&(Z[++st]=$,$=0),I*=2}for(;st>=0&&(N=D(I,Z[st--]),I=N.hi,$=N.lo,$===0););return st>=0&&($<0&&Z[st]<0||$>0&&Z[st]>0)&&(nt=$*2,Q=I+nt,nt===Q-I&&(I=Q)),I}})}),3167:((d,t,e)=>{var i=e(4901),n=e(34),r=e(2967);d.exports=function(a,l,c){var u,f;return r&&i(u=l.constructor)&&u!==c&&n(f=u.prototype)&&f!==c.prototype&&r(a,f),a}}),3238:((d,t,e)=>{var i=e(4576),n=e(7811),r=e(7394),a=i.DataView;d.exports=function(l){if(!n||r(l)!==0)return!1;try{return new a(l),!1}catch{return!0}}}),3392:((d,t,e)=>{var i=e(9504),n=0,r=Math.random(),a=i(1.1.toString);d.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+a(++n+r,36)}}),3440:((d,t,e)=>{var i=e(7080),n=e(4402),r=e(9286),a=e(5170),l=e(3789),c=e(8469),u=e(507),f=n.has,p=n.remove;d.exports=function(v){var S=i(this),b=l(v),w=r(S);return a(S)<=b.size?c(S,function(E){b.includes(E)&&p(w,E)}):u(b.getIterator(),function(E){f(w,E)&&p(w,E)}),w}}),3463:(d=>{var t=TypeError;d.exports=function(e){if(typeof e=="string")return e;throw new t("Argument is not a string")}}),3506:((d,t,e)=>{var i=e(3925),n=String,r=TypeError;d.exports=function(a){if(i(a))return a;throw new r("Can't set "+n(a)+" as a prototype")}}),3579:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(2652),a=e(9306),l=e(8551),c=e(1767),u=e(9539),f=e(4549),p=f("some",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:p},{some:function(v){l(this);try{a(v)}catch(w){u(this,"throw",w)}if(p)return n(p,this,v);var S=c(this),b=0;return r(S,function(w,E){if(v(w,b++))return E()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),3650:((d,t,e)=>{var i=e(7080),n=e(4402),r=e(9286),a=e(3789),l=e(507),c=n.add,u=n.has,f=n.remove;d.exports=function(m){var v=i(this),S=a(m).getIterator(),b=r(v);return l(S,function(w){u(v,w)?f(b,w):c(b,w)}),b}}),3706:((d,t,e)=>{var i=e(9504),n=e(4901),r=e(7629),a=i(Function.toString);n(r.inspectSource)||(r.inspectSource=function(l){return a(l)}),d.exports=r.inspectSource}),3717:((d,t)=>{t.f=Object.getOwnPropertySymbols}),3724:((d,t,e)=>{var i=e(9039);d.exports=!i(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),3789:((d,t,e)=>{var i=e(9306),n=e(8551),r=e(9565),a=e(1291),l=e(1767),c="Invalid size",u=RangeError,f=TypeError,p=Math.max,m=function(v,S){this.set=v,this.size=p(S,0),this.has=i(v.has),this.keys=i(v.keys)};m.prototype={getIterator:function(){return l(n(r(this.keys,this.set)))},includes:function(v){return r(this.has,this.set,v)}},d.exports=function(v){n(v);var S=+v.size;if(S!==S)throw new f(c);var b=a(S);if(b<0)throw new u(c);return new m(v,b)}}),3838:((d,t,e)=>{var i=e(7080),n=e(5170),r=e(8469),a=e(3789);d.exports=function(c){var u=i(this),f=a(c);return n(u)>f.size?!1:r(u,function(p){if(!f.includes(p))return!1},!0)!==!1}}),3853:((d,t,e)=>{var i=e(6518),n=e(4449),r=e(4916),a=!r("isDisjointFrom",function(l){return!l});i({target:"Set",proto:!0,real:!0,forced:a},{isDisjointFrom:n})}),3925:((d,t,e)=>{var i=e(34);d.exports=function(n){return i(n)||n===null}}),3972:((d,t,e)=>{var i=e(34),n=String,r=TypeError;d.exports=function(a){if(a===void 0||i(a))return a;throw new r(n(a)+" is not an object or undefined")}}),4055:((d,t,e)=>{var i=e(4576),n=e(34),r=i.document,a=n(r)&&n(r.createElement);d.exports=function(l){return a?r.createElement(l):{}}}),4114:((d,t,e)=>{var i=e(6518),n=e(8981),r=e(6198),a=e(4527),l=e(6837),c=e(9039),u=c(function(){return[].push.call({length:4294967296},1)!==4294967297}),f=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(m){return m instanceof TypeError}},p=u||!f();i({target:"Array",proto:!0,arity:1,forced:p},{push:function(v){var S=n(this),b=r(S),w=arguments.length;l(b+w);for(var E=0;E<w;E++)S[b]=arguments[E],b++;return a(S,b),b}})}),4117:(d=>{d.exports=function(t){return t==null}}),4149:(d=>{var t=RangeError;d.exports=function(e){if(e===e)return e;throw new t("NaN is not allowed")}}),4154:((d,t,e)=>{var i=e(6955),n=TypeError;d.exports=function(r){if(i(r)==="Uint8Array")return r;throw new n("Argument is not an Uint8Array")}}),4204:((d,t,e)=>{var i=e(7080),n=e(4402).add,r=e(9286),a=e(3789),l=e(507);d.exports=function(u){var f=i(this),p=a(u).getIterator(),m=r(f);return l(p,function(v){n(m,v)}),m}}),4209:((d,t,e)=>{var i=e(8227),n=e(6269),r=i("iterator"),a=Array.prototype;d.exports=function(l){return l!==void 0&&(n.Array===l||a[r]===l)}}),4215:((d,t,e)=>{var i=e(4576),n=e(2839),r=e(2195),a=function(l){return n.slice(0,l.length)===l};d.exports=(function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":i.Bun&&typeof Bun.version=="string"?"BUN":i.Deno&&typeof Deno.version=="object"?"DENO":r(i.process)==="process"?"NODE":i.window&&i.document?"BROWSER":"REST"})()}),4226:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(3463),a=e(4154),l=e(5169),c=e(2303);n.Uint8Array&&i({target:"Uint8Array",proto:!0},{setFromHex:function(f){a(this),r(f),l(this.buffer);var p=c(f,this).read;return{read:p,written:p/2}}})}),4235:((d,t,e)=>{e(3068)}),4270:((d,t,e)=>{var i=e(9565),n=e(4901),r=e(34),a=TypeError;d.exports=function(l,c){var u,f;if(c==="string"&&n(u=l.toString)&&!r(f=i(u,l))||n(u=l.valueOf)&&!r(f=i(u,l))||c!=="string"&&n(u=l.toString)&&!r(f=i(u,l)))return f;throw new a("Can't convert object to primitive value")}}),4376:((d,t,e)=>{var i=e(2195);d.exports=Array.isArray||function(r){return i(r)==="Array"}}),4402:((d,t,e)=>{var i=e(9504),n=Set.prototype;d.exports={Set,add:i(n.add),has:i(n.has),remove:i(n.delete),proto:n}}),4449:((d,t,e)=>{var i=e(7080),n=e(4402).has,r=e(5170),a=e(3789),l=e(8469),c=e(507),u=e(9539);d.exports=function(p){var m=i(this),v=a(p);if(r(m)<=v.size)return l(m,function(b){if(v.includes(b))return!1},!0)!==!1;var S=v.getIterator();return c(S,function(b){if(n(m,b))return u(S,"normal",!1)})!==!1}}),4483:((d,t,e)=>{var i=e(4576),n=e(9429),r=e(1548),a=i.structuredClone,l=i.ArrayBuffer,c=i.MessageChannel,u=!1,f,p,m,v;if(r)u=function(S){a(S,{transfer:[S]})};else if(l)try{c||(f=n("worker_threads"),f&&(c=f.MessageChannel)),c&&(p=new c,m=new l(2),v=function(S){p.port1.postMessage(null,[S])},m.byteLength===2&&(v(m),m.byteLength===0&&(u=v)))}catch{}d.exports=u}),4495:((d,t,e)=>{var i=e(9519),n=e(9039),r=e(4576),a=r.String;d.exports=!!Object.getOwnPropertySymbols&&!n(function(){var l=Symbol("symbol detection");return!a(l)||!(Object(l)instanceof Symbol)||!Symbol.sham&&i&&i<41})}),4527:((d,t,e)=>{var i=e(3724),n=e(4376),r=TypeError,a=Object.getOwnPropertyDescriptor,l=i&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(c){return c instanceof TypeError}})();d.exports=l?function(c,u){if(n(c)&&!a(c,"length").writable)throw new r("Cannot set read only .length");return c.length=u}:function(c,u){return c.length=u}}),4549:((d,t,e)=>{var i=e(4576);d.exports=function(n,r){var a=i.Iterator,l=a&&a.prototype,c=l&&l[n],u=!1;if(c)try{c.call({next:function(){return{done:!0}},return:function(){u=!0}},-1)}catch(f){f instanceof r||(u=!1)}if(!u)return c}}),4576:(function(d){var t=function(e){return e&&e.Math===Math&&e};d.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),4603:((d,t,e)=>{var i=e(6840),n=e(9504),r=e(655),a=e(2812),l=URLSearchParams,c=l.prototype,u=n(c.append),f=n(c.delete),p=n(c.forEach),m=n([].push),v=new l("a=1&a=2&b=3");v.delete("a",1),v.delete("b",void 0),v+""!="a=2"&&i(c,"delete",function(S){var b=arguments.length,w=b<2?void 0:arguments[1];if(b&&w===void 0)return f(this,S);var E=[];p(this,function(P,B){m(E,{key:B,value:P})}),a(b,1);for(var C=r(S),T=r(w),_=0,R=0,D=!1,M=E.length,L;_<M;)L=E[_++],D||L.key===C?(D=!0,f(this,L.key)):R++;for(;R<M;)L=E[R++],L.key===C&&L.value===T||u(this,L.key,L.value)},{enumerable:!0,unsafe:!0})}),4628:((d,t,e)=>{var i=e(6518),n=e(6043);i({target:"Promise",stat:!0},{withResolvers:function(){var a=n.f(this);return{promise:a.promise,resolve:a.resolve,reject:a.reject}}})}),4644:((d,t,e)=>{var i=e(7811),n=e(3724),r=e(4576),a=e(4901),l=e(34),c=e(9297),u=e(6955),f=e(6823),p=e(6699),m=e(6840),v=e(2106),S=e(1625),b=e(2787),w=e(2967),E=e(8227),C=e(3392),T=e(1181),_=T.enforce,R=T.get,D=r.Int8Array,M=D&&D.prototype,L=r.Uint8ClampedArray,P=L&&L.prototype,B=D&&b(D),U=M&&b(M),Z=Object.prototype,q=r.TypeError,Q=E("toStringTag"),nt=C("TYPED_ARRAY_TAG"),N="TypedArrayConstructor",I=i&&!!w&&u(r.opera)!=="Opera",$=!1,at,ut,k,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},K={BigInt64Array:8,BigUint64Array:8},st=function(Bt){if(!l(Bt))return!1;var bt=u(Bt);return bt==="DataView"||c(j,bt)||c(K,bt)},ht=function(dt){var Bt=b(dt);if(l(Bt)){var bt=R(Bt);return bt&&c(bt,N)?bt[N]:ht(Bt)}},J=function(dt){if(!l(dt))return!1;var Bt=u(dt);return c(j,Bt)||c(K,Bt)},V=function(dt){if(J(dt))return dt;throw new q("Target is not a typed array")},rt=function(dt){if(a(dt)&&(!w||S(B,dt)))return dt;throw new q(f(dt)+" is not a typed array constructor")},lt=function(dt,Bt,bt,_t){if(n){if(bt)for(var Ht in j){var It=r[Ht];if(It&&c(It.prototype,dt))try{delete It.prototype[dt]}catch{try{It.prototype[dt]=Bt}catch{}}}(!U[dt]||bt)&&m(U,dt,bt?Bt:I&&M[dt]||Bt,_t)}},At=function(dt,Bt,bt){var _t,Ht;if(n){if(w){if(bt){for(_t in j)if(Ht=r[_t],Ht&&c(Ht,dt))try{delete Ht[dt]}catch{}}if(!B[dt]||bt)try{return m(B,dt,bt?Bt:I&&B[dt]||Bt)}catch{}else return}for(_t in j)Ht=r[_t],Ht&&(!Ht[dt]||bt)&&m(Ht,dt,Bt)}};for(at in j)ut=r[at],k=ut&&ut.prototype,k?_(k)[N]=ut:I=!1;for(at in K)ut=r[at],k=ut&&ut.prototype,k&&(_(k)[N]=ut);if((!I||!a(B)||B===Function.prototype)&&(B=function(){throw new q("Incorrect invocation")},I))for(at in j)r[at]&&w(r[at],B);if((!I||!U||U===Z)&&(U=B.prototype,I))for(at in j)r[at]&&w(r[at].prototype,U);if(I&&b(P)!==U&&w(P,U),n&&!c(U,Q)){$=!0,v(U,Q,{configurable:!0,get:function(){return l(this)?this[nt]:void 0}});for(at in j)r[at]&&p(r[at],nt,at)}d.exports={NATIVE_ARRAY_BUFFER_VIEWS:I,TYPED_ARRAY_TAG:$&&nt,aTypedArray:V,aTypedArrayConstructor:rt,exportTypedArrayMethod:lt,exportTypedArrayStaticMethod:At,getTypedArrayConstructor:ht,isView:st,isTypedArray:J,TypedArray:B,TypedArrayPrototype:U}}),4659:((d,t,e)=>{var i=e(3724),n=e(4913),r=e(6980);d.exports=function(a,l,c){i?n.f(a,l,r(0,c)):a[l]=c}}),4901:(d=>{var t=typeof document=="object"&&document.all;d.exports=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"}}),4913:((d,t,e)=>{var i=e(3724),n=e(5917),r=e(8686),a=e(8551),l=e(6969),c=TypeError,u=Object.defineProperty,f=Object.getOwnPropertyDescriptor,p="enumerable",m="configurable",v="writable";t.f=i?r?function(b,w,E){if(a(b),w=l(w),a(E),typeof b=="function"&&w==="prototype"&&"value"in E&&v in E&&!E[v]){var C=f(b,w);C&&C[v]&&(b[w]=E.value,E={configurable:m in E?E[m]:C[m],enumerable:p in E?E[p]:C[p],writable:!1})}return u(b,w,E)}:u:function(b,w,E){if(a(b),w=l(w),a(E),n)try{return u(b,w,E)}catch{}if("get"in E||"set"in E)throw new c("Accessors not supported");return"value"in E&&(b[w]=E.value),b}}),4916:((d,t,e)=>{var i=e(7751),n=function(a){return{size:a,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(a){return{size:a,has:function(){return!0},keys:function(){throw new Error("e")}}};d.exports=function(a,l){var c=i("Set");try{new c()[a](n(0));try{return new c()[a](n(-1)),!1}catch{if(!l)return!0;try{return new c()[a](r(-1/0)),!1}catch{var u=new c;return u.add(1),u.add(2),l(u[a](r(1/0)))}}}catch{return!1}}}),4972:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(8551),a=e(1767),l=e(4149),c=e(9590),u=e(9462),f=e(9539),p=e(4549),m=e(6395),v=!m&&p("take",RangeError),S=u(function(){var b=this.iterator;if(!this.remaining--)return this.done=!0,f(b,"normal",void 0);var w=r(n(this.next,b)),E=this.done=!!w.done;if(!E)return w.value});i({target:"Iterator",proto:!0,real:!0,forced:m||v},{take:function(w){r(this);var E;try{E=c(l(+w))}catch(C){f(this,"throw",C)}return v?n(v,this,E):new S(a(this),{remaining:E})}})}),4979:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(7751),a=e(6980),l=e(4913).f,c=e(9297),u=e(679),f=e(3167),p=e(2603),m=e(5002),v=e(8574),S=e(3724),b=e(6395),w="DOMException",E=r("Error"),C=r(w),T=function(){u(this,_);var N=arguments.length,I=p(N<1?void 0:arguments[0]),$=p(N<2?void 0:arguments[1],"Error"),at=new C(I,$),ut=new E(I);return ut.name=w,l(at,"stack",a(1,v(ut.stack,1))),f(at,this,T),at},_=T.prototype=C.prototype,R="stack"in new E(w),D="stack"in new C(1,2),M=C&&S&&Object.getOwnPropertyDescriptor(n,w),L=!!M&&!(M.writable&&M.configurable),P=R&&!L&&!D;i({global:!0,constructor:!0,forced:b||P},{DOMException:P?T:C});var B=r(w),U=B.prototype;if(U.constructor!==B){b||l(U,"constructor",a(1,B));for(var Z in m)if(c(m,Z)){var q=m[Z],Q=q.s;c(B,Q)||l(B,Q,a(6,q.c))}}}),5002:(d=>{d.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),5024:((d,t,e)=>{var i=e(6518),n=e(3650),r=e(9835),a=e(4916),l=!a("symmetricDifference")||!r("symmetricDifference");i({target:"Set",proto:!0,real:!0,forced:l},{symmetricDifference:n})}),5031:((d,t,e)=>{var i=e(7751),n=e(9504),r=e(8480),a=e(3717),l=e(8551),c=n([].concat);d.exports=i("Reflect","ownKeys")||function(f){var p=r.f(l(f)),m=a.f;return m?c(p,m(f)):p}}),5169:((d,t,e)=>{var i=e(3238),n=TypeError;d.exports=function(r){if(i(r))throw new n("ArrayBuffer is detached");return r}}),5170:((d,t,e)=>{var i=e(6706),n=e(4402);d.exports=i(n.proto,"size","get")||function(r){return r.size}}),5213:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(5370),a=e(9143),l=n.Uint8Array,c=!l||!l.fromBase64||!(function(){try{l.fromBase64("a");return}catch{}try{l.fromBase64("",null)}catch{return!0}})();l&&i({target:"Uint8Array",stat:!0,forced:c},{fromBase64:function(f){var p=a(f,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return r(l,p.bytes)}})}),5370:((d,t,e)=>{var i=e(6198);d.exports=function(n,r,a){for(var l=0,c=arguments.length>2?a:i(r),u=new n(c);c>l;)u[l]=r[l++];return u}}),5397:((d,t,e)=>{var i=e(7055),n=e(7750);d.exports=function(r){return i(n(r))}}),5610:((d,t,e)=>{var i=e(1291),n=Math.max,r=Math.min;d.exports=function(a,l){var c=i(a);return c<0?n(c+l,0):r(c,l)}}),5623:((d,t,e)=>{e(456)}),5636:((d,t,e)=>{var i=e(4576),n=e(9504),r=e(6706),a=e(7696),l=e(5169),c=e(7394),u=e(4483),f=e(1548),p=i.structuredClone,m=i.ArrayBuffer,v=i.DataView,S=Math.min,b=m.prototype,w=v.prototype,E=n(b.slice),C=r(b,"resizable","get"),T=r(b,"maxByteLength","get"),_=n(w.getInt8),R=n(w.setInt8);d.exports=(f||u)&&function(D,M,L){var P=c(D),B=M===void 0?P:a(M),U=!C||!C(D),Z;if(l(D),f&&(D=p(D,{transfer:[D]}),P===B&&(L||U)))return D;if(P>=B&&(!L||U))Z=E(D,0,B);else{var q=L&&!U&&T?{maxByteLength:T(D)}:void 0;Z=new m(B,q);for(var Q=new v(D),nt=new v(Z),N=S(B,P),I=0;I<N;I++)R(nt,I,_(Q,I))}return f||u(D),Z}}),5745:((d,t,e)=>{var i=e(7629);d.exports=function(n,r){return i[n]||(i[n]=r||{})}}),5781:((d,t,e)=>{var i=e(6518),n=e(7751),r=e(2812),a=e(655),l=e(7416),c=n("URL");i({target:"URL",stat:!0,forced:!l},{parse:function(f){var p=r(arguments.length,1),m=a(f),v=p<2||arguments[1]===void 0?void 0:a(arguments[1]);try{return new c(m,v)}catch{return null}}})}),5854:((d,t,e)=>{var i=e(2777),n=TypeError;d.exports=function(r){var a=i(r,"number");if(typeof a=="number")throw new n("Can't convert number to bigint");return BigInt(a)}}),5876:((d,t,e)=>{var i=e(6518),n=e(3838),r=e(4916),a=!r("isSubsetOf",function(l){return l});i({target:"Set",proto:!0,real:!0,forced:a},{isSubsetOf:n})}),5917:((d,t,e)=>{var i=e(3724),n=e(9039),r=e(4055);d.exports=!i&&!n(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})}),5966:((d,t,e)=>{var i=e(9306),n=e(4117);d.exports=function(r,a){var l=r[a];return n(l)?void 0:i(l)}}),6043:((d,t,e)=>{var i=e(9306),n=TypeError,r=function(a){var l,c;this.promise=new a(function(u,f){if(l!==void 0||c!==void 0)throw new n("Bad Promise constructor");l=u,c=f}),this.resolve=i(l),this.reject=i(c)};d.exports.f=function(a){return new r(a)}}),6080:((d,t,e)=>{var i=e(7476),n=e(9306),r=e(616),a=i(i.bind);d.exports=function(l,c){return n(l),c===void 0?l:r?a(l,c):function(){return l.apply(c,arguments)}}}),6119:((d,t,e)=>{var i=e(5745),n=e(3392),r=i("keys");d.exports=function(a){return r[a]||(r[a]=n(a))}}),6193:((d,t,e)=>{var i=e(4215);d.exports=i==="NODE"}),6198:((d,t,e)=>{var i=e(8014);d.exports=function(n){return i(n.length)}}),6269:(d=>{d.exports={}}),6279:((d,t,e)=>{var i=e(6840);d.exports=function(n,r,a){for(var l in r)i(n,l,r[l],a);return n}}),6319:((d,t,e)=>{var i=e(8551),n=e(9539);d.exports=function(r,a,l,c){try{return c?a(i(l)[0],l[1]):a(l)}catch(u){n(r,"throw",u)}}}),6395:(d=>{d.exports=!1}),6518:((d,t,e)=>{var i=e(4576),n=e(7347).f,r=e(6699),a=e(6840),l=e(9433),c=e(7740),u=e(2796);d.exports=function(f,p){var m=f.target,v=f.global,S=f.stat,b,w,E,C,T,_;if(v?w=i:S?w=i[m]||l(m,{}):w=i[m]&&i[m].prototype,w)for(E in p){if(T=p[E],f.dontCallGetSet?(_=n(w,E),C=_&&_.value):C=w[E],b=u(v?E:m+(S?".":"#")+E,f.forced),!b&&C!==void 0){if(typeof T==typeof C)continue;c(T,C)}(f.sham||C&&C.sham)&&r(T,"sham",!0),a(w,E,T,f)}}}),6573:((d,t,e)=>{var i=e(3724),n=e(2106),r=e(3238),a=ArrayBuffer.prototype;i&&!("detached"in a)&&n(a,"detached",{configurable:!0,get:function(){return r(this)}})}),6632:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(9143),a=e(4154),l=n.Uint8Array,c=!l||!l.prototype.setFromBase64||!(function(){var u=new l([255,255,255,255,255]);try{u.setFromBase64("",null);return}catch{}try{u.setFromBase64("a");return}catch{}try{u.setFromBase64("MjYyZg===")}catch{return u[0]===50&&u[1]===54&&u[2]===50&&u[3]===255&&u[4]===255}})();l&&i({target:"Uint8Array",proto:!0,forced:c},{setFromBase64:function(f){a(this);var p=r(f,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:p.read,written:p.written}}})}),6699:((d,t,e)=>{var i=e(3724),n=e(4913),r=e(6980);d.exports=i?function(a,l,c){return n.f(a,l,r(1,c))}:function(a,l,c){return a[l]=c,a}}),6706:((d,t,e)=>{var i=e(9504),n=e(9306);d.exports=function(r,a,l){try{return i(n(Object.getOwnPropertyDescriptor(r,a)[l]))}catch{}}}),6801:((d,t,e)=>{var i=e(3724),n=e(8686),r=e(4913),a=e(8551),l=e(5397),c=e(1072);t.f=i&&!n?Object.defineProperties:function(f,p){a(f);for(var m=l(p),v=c(p),S=v.length,b=0,w;S>b;)r.f(f,w=v[b++],m[w]);return f}}),6823:(d=>{var t=String;d.exports=function(e){try{return t(e)}catch{return"Object"}}}),6837:(d=>{var t=TypeError,e=9007199254740991;d.exports=function(i){if(i>e)throw t("Maximum allowed index exceeded");return i}}),6840:((d,t,e)=>{var i=e(4901),n=e(4913),r=e(283),a=e(9433);d.exports=function(l,c,u,f){f||(f={});var p=f.enumerable,m=f.name!==void 0?f.name:c;if(i(u)&&r(u,m,f),f.global)p?l[c]=u:a(c,u);else{try{f.unsafe?l[c]&&(p=!0):delete l[c]}catch{}p?l[c]=u:n.f(l,c,{value:u,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return l}}),6955:((d,t,e)=>{var i=e(2140),n=e(4901),r=e(2195),a=e(8227),l=a("toStringTag"),c=Object,u=r((function(){return arguments})())==="Arguments",f=function(p,m){try{return p[m]}catch{}};d.exports=i?r:function(p){var m,v,S;return p===void 0?"Undefined":p===null?"Null":typeof(v=f(m=c(p),l))=="string"?v:u?r(m):(S=r(m))==="Object"&&n(m.callee)?"Arguments":S}}),6969:((d,t,e)=>{var i=e(2777),n=e(757);d.exports=function(r){var a=i(r,"string");return n(a)?a:a+""}}),6980:(d=>{d.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}}),7040:((d,t,e)=>{var i=e(4495);d.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),7055:((d,t,e)=>{var i=e(9504),n=e(9039),r=e(2195),a=Object,l=i("".split);d.exports=n(function(){return!a("z").propertyIsEnumerable(0)})?function(c){return r(c)==="String"?l(c,""):a(c)}:a}),7080:((d,t,e)=>{var i=e(4402).has;d.exports=function(n){return i(n),n}}),7347:((d,t,e)=>{var i=e(3724),n=e(9565),r=e(8773),a=e(6980),l=e(5397),c=e(6969),u=e(9297),f=e(5917),p=Object.getOwnPropertyDescriptor;t.f=i?p:function(v,S){if(v=l(v),S=c(S),f)try{return p(v,S)}catch{}if(u(v,S))return a(!n(r.f,v,S),v[S])}}),7394:((d,t,e)=>{var i=e(4576),n=e(6706),r=e(2195),a=i.ArrayBuffer,l=i.TypeError;d.exports=a&&n(a.prototype,"byteLength","get")||function(c){if(r(c)!=="ArrayBuffer")throw new l("ArrayBuffer expected");return c.byteLength}}),7416:((d,t,e)=>{var i=e(9039),n=e(8227),r=e(3724),a=e(6395),l=n("iterator");d.exports=!i(function(){var c=new URL("b?a=1&b=2&c=3","https://a"),u=c.searchParams,f=new URLSearchParams("a=1&a=2&b=3"),p="";return c.pathname="c%20d",u.forEach(function(m,v){u.delete("b"),p+=v+m}),f.delete("a",2),f.delete("b",void 0),a&&(!c.toJSON||!f.has("a",1)||f.has("a",2)||!f.has("a",void 0)||f.has("b"))||!u.size&&(a||!r)||!u.sort||c.href!=="https://a/c%20d?a=1&c=3"||u.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!u[l]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||p!=="a1c3"||new URL("https://x",void 0).host!=="x"})}),7476:((d,t,e)=>{var i=e(2195),n=e(9504);d.exports=function(r){if(i(r)==="Function")return n(r)}}),7566:((d,t,e)=>{var i=e(6840),n=e(9504),r=e(655),a=e(2812),l=URLSearchParams,c=l.prototype,u=n(c.getAll),f=n(c.has),p=new l("a=1");(p.has("a",2)||!p.has("a",void 0))&&i(c,"has",function(v){var S=arguments.length,b=S<2?void 0:arguments[1];if(S&&b===void 0)return f(this,v);var w=u(this,v);a(S,1);for(var E=r(b),C=0;C<w.length;)if(w[C++]===E)return!0;return!1},{enumerable:!0,unsafe:!0})}),7588:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(2652),a=e(9306),l=e(8551),c=e(1767),u=e(9539),f=e(4549),p=f("forEach",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:p},{forEach:function(v){l(this);try{a(v)}catch(w){u(this,"throw",w)}if(p)return n(p,this,v);var S=c(this),b=0;r(S,function(w){v(w,b++)},{IS_RECORD:!0})}})}),7629:((d,t,e)=>{var i=e(6395),n=e(4576),r=e(9433),a="__core-js_shared__",l=d.exports=n[a]||r(a,{});(l.versions||(l.versions=[])).push({version:"3.45.1",mode:i?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.1/LICENSE",source:"https://github.com/zloirock/core-js"})}),7642:((d,t,e)=>{var i=e(6518),n=e(3440),r=e(9039),a=e(4916),l=!a("difference",function(u){return u.size===0}),c=l||r(function(){var u={size:1,has:function(){return!0},keys:function(){var p=0;return{next:function(){var m=p++>1;return f.has(1)&&f.clear(),{done:m,value:2}}}}},f=new Set([1,2,3,4]);return f.difference(u).size!==3});i({target:"Set",proto:!0,real:!0,forced:c},{difference:n})}),7657:((d,t,e)=>{var i=e(9039),n=e(4901),r=e(34),a=e(2360),l=e(2787),c=e(6840),u=e(8227),f=e(6395),p=u("iterator"),m=!1,v,S,b;[].keys&&(b=[].keys(),"next"in b?(S=l(l(b)),S!==Object.prototype&&(v=S)):m=!0);var w=!r(v)||i(function(){var E={};return v[p].call(E)!==E});w?v={}:f&&(v=a(v)),n(v[p])||c(v,p,function(){return this}),d.exports={IteratorPrototype:v,BUGGY_SAFARI_ITERATORS:m}}),7680:((d,t,e)=>{var i=e(9504);d.exports=i([].slice)}),7696:((d,t,e)=>{var i=e(1291),n=e(8014),r=RangeError;d.exports=function(a){if(a===void 0)return 0;var l=i(a),c=n(l);if(l!==c)throw new r("Wrong length or index");return c}}),7740:((d,t,e)=>{var i=e(9297),n=e(5031),r=e(7347),a=e(4913);d.exports=function(l,c,u){for(var f=n(c),p=a.f,m=r.f,v=0;v<f.length;v++){var S=f[v];!i(l,S)&&!(u&&i(u,S))&&p(l,S,m(c,S))}}}),7750:((d,t,e)=>{var i=e(4117),n=TypeError;d.exports=function(r){if(i(r))throw new n("Can't call method on "+r);return r}}),7751:((d,t,e)=>{var i=e(4576),n=e(4901),r=function(a){return n(a)?a:void 0};d.exports=function(a,l){return arguments.length<2?r(i[a]):i[a]&&i[a][l]}}),7811:(d=>{d.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7936:((d,t,e)=>{var i=e(6518),n=e(5636);n&&i({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return n(this,arguments.length?arguments[0]:void 0,!1)}})}),8004:((d,t,e)=>{var i=e(6518),n=e(9039),r=e(8750),a=e(4916),l=!a("intersection",function(c){return c.size===2&&c.has(1)&&c.has(2)})||n(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});i({target:"Set",proto:!0,real:!0,forced:l},{intersection:r})}),8014:((d,t,e)=>{var i=e(1291),n=Math.min;d.exports=function(r){var a=i(r);return a>0?n(a,9007199254740991):0}}),8100:((d,t,e)=>{var i=e(6518),n=e(5636);n&&i({target:"ArrayBuffer",proto:!0},{transfer:function(){return n(this,arguments.length?arguments[0]:void 0,!0)}})}),8111:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(679),a=e(8551),l=e(4901),c=e(2787),u=e(2106),f=e(4659),p=e(9039),m=e(9297),v=e(8227),S=e(7657).IteratorPrototype,b=e(3724),w=e(6395),E="constructor",C="Iterator",T=v("toStringTag"),_=TypeError,R=n[C],D=w||!l(R)||R.prototype!==S||!p(function(){R({})}),M=function(){if(r(this,S),c(this)===S)throw new _("Abstract class Iterator not directly constructable")},L=function(P,B){b?u(S,P,{configurable:!0,get:function(){return B},set:function(U){if(a(this),this===S)throw new _("You can't redefine this property");m(this,P)?this[P]=U:f(this,P,U)}}):S[P]=B};m(S,T)||L(T,C),(D||!m(S,E)||S[E]===Object)&&L(E,M),M.prototype=S,i({global:!0,constructor:!0,forced:D},{Iterator:M})}),8227:((d,t,e)=>{var i=e(4576),n=e(5745),r=e(9297),a=e(3392),l=e(4495),c=e(7040),u=i.Symbol,f=n("wks"),p=c?u.for||u:u&&u.withoutSetter||a;d.exports=function(m){return r(f,m)||(f[m]=l&&r(u,m)?u[m]:p("Symbol."+m)),f[m]}}),8235:((d,t,e)=>{var i=e(9504),n=e(9297),r=SyntaxError,a=parseInt,l=String.fromCharCode,c=i("".charAt),u=i("".slice),f=i(/./.exec),p={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},m=/^[\da-f]{4}$/i,v=/^[\u0000-\u001F]$/;d.exports=function(S,b){for(var w=!0,E="";b<S.length;){var C=c(S,b);if(C==="\\"){var T=u(S,b,b+2);if(n(p,T))E+=p[T],b+=2;else if(T==="\\u"){b+=2;var _=u(S,b,b+4);if(!f(m,_))throw new r("Bad Unicode escape at: "+b);E+=l(a(_,16)),b+=4}else throw new r('Unknown escape sequence: "'+T+'"')}else if(C==='"'){w=!1,b++;break}else{if(f(v,C))throw new r("Bad control character in string literal at: "+b);E+=C,b++}}if(w)throw new r("Unterminated string at: "+b);return{value:E,end:b}}}),8237:((d,t,e)=>{var i=e(6518),n=e(2652),r=e(9306),a=e(8551),l=e(1767),c=e(9539),u=e(4549),f=e(8745),p=e(9039),m=TypeError,v=p(function(){[].keys().reduce(function(){},void 0)}),S=!v&&u("reduce",m);i({target:"Iterator",proto:!0,real:!0,forced:v||S},{reduce:function(w){a(this);try{r(w)}catch(R){c(this,"throw",R)}var E=arguments.length<2,C=E?void 0:arguments[1];if(S)return f(S,this,E?[w]:[w,C]);var T=l(this),_=0;if(n(T,function(R){E?(E=!1,C=R):C=w(C,R,_),_++},{IS_RECORD:!0}),E)throw new m("Reduce of empty iterator with no initial value");return C}})}),8335:((d,t,e)=>{var i=e(6518),n=e(3724),r=e(4576),a=e(7751),l=e(9504),c=e(9565),u=e(4901),f=e(34),p=e(4376),m=e(9297),v=e(655),S=e(6198),b=e(4659),w=e(9039),E=e(8235),C=e(4495),T=r.JSON,_=r.Number,R=r.SyntaxError,D=T&&T.parse,M=a("Object","keys"),L=Object.getOwnPropertyDescriptor,P=l("".charAt),B=l("".slice),U=l(/./.exec),Z=l([].push),q=/^\d$/,Q=/^[1-9]$/,nt=/^[\d-]$/,N=/^[\t\n\r ]$/,I=0,$=1,at=function(J,V){J=v(J);var rt=new K(J,0),lt=rt.parse(),At=lt.value,dt=rt.skip(N,lt.end);if(dt<J.length)throw new R('Unexpected extra character: "'+P(J,dt)+'" after the parsed data at: '+dt);return u(V)?ut({"":At},"",V,lt):At},ut=function(J,V,rt,lt){var At=J[V],dt=lt&&At===lt.value,Bt=dt&&typeof lt.source=="string"?{source:lt.source}:{},bt,_t,Ht,It,li;if(f(At)){var ji=p(At),$i=dt?lt.nodes:ji?[]:{};if(ji)for(bt=$i.length,Ht=S(At),It=0;It<Ht;It++)k(At,It,ut(At,""+It,rt,It<bt?$i[It]:void 0));else for(_t=M(At),Ht=S(_t),It=0;It<Ht;It++)li=_t[It],k(At,li,ut(At,li,rt,m($i,li)?$i[li]:void 0))}return c(rt,J,V,At,Bt)},k=function(J,V,rt){if(n){var lt=L(J,V);if(lt&&!lt.configurable)return}rt===void 0?delete J[V]:b(J,V,rt)},j=function(J,V,rt,lt){this.value=J,this.end=V,this.source=rt,this.nodes=lt},K=function(J,V){this.source=J,this.index=V};K.prototype={fork:function(J){return new K(this.source,J)},parse:function(){var J=this.source,V=this.skip(N,this.index),rt=this.fork(V),lt=P(J,V);if(U(nt,lt))return rt.number();switch(lt){case"{":return rt.object();case"[":return rt.array();case'"':return rt.string();case"t":return rt.keyword(!0);case"f":return rt.keyword(!1);case"n":return rt.keyword(null)}throw new R('Unexpected character: "'+lt+'" at: '+V)},node:function(J,V,rt,lt,At){return new j(V,lt,J?null:B(this.source,rt,lt),At)},object:function(){for(var J=this.source,V=this.index+1,rt=!1,lt={},At={};V<J.length;){if(V=this.until(['"',"}"],V),P(J,V)==="}"&&!rt){V++;break}var dt=this.fork(V).string(),Bt=dt.value;V=dt.end,V=this.until([":"],V)+1,V=this.skip(N,V),dt=this.fork(V).parse(),b(At,Bt,dt),b(lt,Bt,dt.value),V=this.until([",","}"],dt.end);var bt=P(J,V);if(bt===",")rt=!0,V++;else if(bt==="}"){V++;break}}return this.node($,lt,this.index,V,At)},array:function(){for(var J=this.source,V=this.index+1,rt=!1,lt=[],At=[];V<J.length;){if(V=this.skip(N,V),P(J,V)==="]"&&!rt){V++;break}var dt=this.fork(V).parse();if(Z(At,dt),Z(lt,dt.value),V=this.until([",","]"],dt.end),P(J,V)===",")rt=!0,V++;else if(P(J,V)==="]"){V++;break}}return this.node($,lt,this.index,V,At)},string:function(){var J=this.index,V=E(this.source,this.index+1);return this.node(I,V.value,J,V.end)},number:function(){var J=this.source,V=this.index,rt=V;if(P(J,rt)==="-"&&rt++,P(J,rt)==="0")rt++;else if(U(Q,P(J,rt)))rt=this.skip(q,rt+1);else throw new R("Failed to parse number at: "+rt);if(P(J,rt)==="."&&(rt=this.skip(q,rt+1)),P(J,rt)==="e"||P(J,rt)==="E"){rt++,(P(J,rt)==="+"||P(J,rt)==="-")&&rt++;var lt=rt;if(rt=this.skip(q,rt),lt===rt)throw new R("Failed to parse number's exponent value at: "+rt)}return this.node(I,_(B(J,V,rt)),V,rt)},keyword:function(J){var V=""+J,rt=this.index,lt=rt+V.length;if(B(this.source,rt,lt)!==V)throw new R("Failed to parse value at: "+rt);return this.node(I,J,rt,lt)},skip:function(J,V){for(var rt=this.source;V<rt.length&&U(J,P(rt,V));V++);return V},until:function(J,V){V=this.skip(N,V);for(var rt=P(this.source,V),lt=0;lt<J.length;lt++)if(J[lt]===rt)return V;throw new R('Unexpected character: "'+rt+'" at: '+V)}};var st=w(function(){var J="9007199254740993",V;return D(J,function(rt,lt,At){V=At.source}),V!==J}),ht=C&&!w(function(){return 1/D("-0 	")!==-1/0});i({target:"JSON",stat:!0,forced:st},{parse:function(V,rt){return ht&&!u(rt)?D(V):at(V,rt)}})}),8469:((d,t,e)=>{var i=e(9504),n=e(507),r=e(4402),a=r.Set,l=r.proto,c=i(l.forEach),u=i(l.keys),f=u(new a).next;d.exports=function(p,m,v){return v?n({iterator:u(p),next:f},m):c(p,m)}}),8480:((d,t,e)=>{var i=e(1828),n=e(8727),r=n.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(l){return i(l,r)}}),8527:((d,t,e)=>{var i=e(7080),n=e(4402).has,r=e(5170),a=e(3789),l=e(507),c=e(9539);d.exports=function(f){var p=i(this),m=a(f);if(r(p)<m.size)return!1;var v=m.getIterator();return l(v,function(S){if(!n(p,S))return c(v,"normal",!1)})!==!1}}),8551:((d,t,e)=>{var i=e(34),n=String,r=TypeError;d.exports=function(a){if(i(a))return a;throw new r(n(a)+" is not an object")}}),8574:((d,t,e)=>{var i=e(9504),n=Error,r=i("".replace),a=(function(u){return String(new n(u).stack)})("zxcasd"),l=/\n\s*at [^:]*:[^\n]*/,c=l.test(a);d.exports=function(u,f){if(c&&typeof u=="string"&&!n.prepareStackTrace)for(;f--;)u=r(u,l,"");return u}}),8622:((d,t,e)=>{var i=e(4576),n=e(4901),r=i.WeakMap;d.exports=n(r)&&/native code/.test(String(r))}),8646:((d,t,e)=>{var i=e(9565),n=e(8551),r=e(1767),a=e(851);d.exports=function(l,c){(!c||typeof l!="string")&&n(l);var u=a(l);return r(n(u!==void 0?i(u,l):l))}}),8686:((d,t,e)=>{var i=e(3724),n=e(9039);d.exports=i&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),8721:((d,t,e)=>{var i=e(3724),n=e(9504),r=e(2106),a=URLSearchParams.prototype,l=n(a.forEach);i&&!("size"in a)&&r(a,"size",{get:function(){var u=0;return l(this,function(){u++}),u},configurable:!0,enumerable:!0})}),8727:(d=>{d.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),8745:((d,t,e)=>{var i=e(616),n=Function.prototype,r=n.apply,a=n.call;d.exports=typeof Reflect=="object"&&Reflect.apply||(i?a.bind(r):function(){return a.apply(r,arguments)})}),8750:((d,t,e)=>{var i=e(7080),n=e(4402),r=e(5170),a=e(3789),l=e(8469),c=e(507),u=n.Set,f=n.add,p=n.has;d.exports=function(v){var S=i(this),b=a(v),w=new u;return r(S)>b.size?c(b.getIterator(),function(E){p(S,E)&&f(w,E)}):l(S,function(E){b.includes(E)&&f(w,E)}),w}}),8773:((d,t)=>{var e={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,n=i&&!e.call({1:2},1);t.f=n?function(a){var l=i(this,a);return!!l&&l.enumerable}:e}),8981:((d,t,e)=>{var i=e(7750),n=Object;d.exports=function(r){return n(i(r))}}),9039:(d=>{d.exports=function(t){try{return!!t()}catch{return!0}}}),9143:((d,t,e)=>{var i=e(4576),n=e(9504),r=e(3972),a=e(3463),l=e(9297),c=e(2804),u=e(944),f=e(5169),p=c.c2i,m=c.c2iUrl,v=i.SyntaxError,S=i.TypeError,b=n("".charAt),w=function(T,_){for(var R=T.length;_<R;_++){var D=b(T,_);if(D!==" "&&D!=="	"&&D!==`
`&&D!=="\f"&&D!=="\r")break}return _},E=function(T,_,R){var D=T.length;D<4&&(T+=D===2?"AA":"A");var M=(_[b(T,0)]<<18)+(_[b(T,1)]<<12)+(_[b(T,2)]<<6)+_[b(T,3)],L=[M>>16&255,M>>8&255,M&255];if(D===2){if(R&&L[1]!==0)throw new v("Extra bits");return[L[0]]}if(D===3){if(R&&L[2]!==0)throw new v("Extra bits");return[L[0],L[1]]}return L},C=function(T,_,R){for(var D=_.length,M=0;M<D;M++)T[R+M]=_[M];return R+D};d.exports=function(T,_,R,D){a(T),r(_);var M=u(_)==="base64"?p:m,L=_?_.lastChunkHandling:void 0;if(L===void 0&&(L="loose"),L!=="loose"&&L!=="strict"&&L!=="stop-before-partial")throw new S("Incorrect `lastChunkHandling` option");R&&f(R.buffer);var P=T.length,B=R||[],U=0,Z=0,q="",Q=0;if(D)for(;;){if(Q=w(T,Q),Q===P){if(q.length>0){if(L==="stop-before-partial")break;if(L==="loose"){if(q.length===1)throw new v("Malformed padding: exactly one additional character");U=C(B,E(q,M,!1),U)}else throw new v("Missing padding")}Z=P;break}var nt=b(T,Q);if(++Q,nt==="="){if(q.length<2)throw new v("Padding is too early");if(Q=w(T,Q),q.length===2){if(Q===P){if(L==="stop-before-partial")break;throw new v("Malformed padding: only one =")}b(T,Q)==="="&&(++Q,Q=w(T,Q))}if(Q<P)throw new v("Unexpected character after padding");U=C(B,E(q,M,L==="strict"),U),Z=P;break}if(!l(M,nt))throw new v("Unexpected character");var N=D-U;if(N===1&&q.length===2||N===2&&q.length===3||(q+=nt,q.length===4&&(U=C(B,E(q,M,!1),U),q="",Z=Q,U===D)))break}return{bytes:B,read:Z,written:U}}}),9286:((d,t,e)=>{var i=e(4402),n=e(8469),r=i.Set,a=i.add;d.exports=function(l){var c=new r;return n(l,function(u){a(c,u)}),c}}),9297:((d,t,e)=>{var i=e(9504),n=e(8981),r=i({}.hasOwnProperty);d.exports=Object.hasOwn||function(l,c){return r(n(l),c)}}),9306:((d,t,e)=>{var i=e(4901),n=e(6823),r=TypeError;d.exports=function(a){if(i(a))return a;throw new r(n(a)+" is not a function")}}),9314:((d,t,e)=>{var i=e(6518),n=e(9565),r=e(8551),a=e(1767),l=e(4149),c=e(9590),u=e(9539),f=e(9462),p=e(684),m=e(4549),v=e(6395),S=!v&&!p("drop",0),b=!v&&!S&&m("drop",RangeError),w=v||S||b,E=f(function(){for(var C=this.iterator,T=this.next,_,R;this.remaining;)if(this.remaining--,_=r(n(T,C)),R=this.done=!!_.done,R)return;if(_=r(n(T,C)),R=this.done=!!_.done,!R)return _.value});i({target:"Iterator",proto:!0,real:!0,forced:w},{drop:function(T){r(this);var _;try{_=c(l(+T))}catch(R){u(this,"throw",R)}return b?n(b,this,_):new E(a(this),{remaining:_})}})}),9429:((d,t,e)=>{var i=e(4576),n=e(6193);d.exports=function(r){if(n){try{return i.process.getBuiltinModule(r)}catch{}try{return Function('return require("'+r+'")')()}catch{}}}}),9432:((d,t,e)=>{e(5213)}),9433:((d,t,e)=>{var i=e(4576),n=Object.defineProperty;d.exports=function(r,a){try{n(i,r,{value:a,configurable:!0,writable:!0})}catch{i[r]=a}return a}}),9462:((d,t,e)=>{var i=e(9565),n=e(2360),r=e(6699),a=e(6279),l=e(8227),c=e(1181),u=e(5966),f=e(7657).IteratorPrototype,p=e(2529),m=e(9539),v=e(1385),S=l("toStringTag"),b="IteratorHelper",w="WrapForValidIterator",E="normal",C="throw",T=c.set,_=function(M){var L=c.getterFor(M?w:b);return a(n(f),{next:function(){var B=L(this);if(M)return B.nextHandler();if(B.done)return p(void 0,!0);try{var U=B.nextHandler();return B.returnHandlerResult?U:p(U,B.done)}catch(Z){throw B.done=!0,Z}},return:function(){var P=L(this),B=P.iterator;if(P.done=!0,M){var U=u(B,"return");return U?i(U,B):p(void 0,!0)}if(P.inner)try{m(P.inner.iterator,E)}catch(Z){return m(B,C,Z)}if(P.openIters)try{v(P.openIters,E)}catch(Z){return m(B,C,Z)}return B&&m(B,E),p(void 0,!0)}})},R=_(!0),D=_(!1);r(D,S,"Iterator Helper"),d.exports=function(M,L,P){var B=function(Z,q){q?(q.iterator=Z.iterator,q.next=Z.next):q=Z,q.type=L?w:b,q.returnHandlerResult=!!P,q.nextHandler=M,q.counter=0,q.done=!1,T(this,q)};return B.prototype=L?R:D,B}}),9486:((d,t,e)=>{var i=e(6518),n=e(4576),r=e(9504),a=e(3972),l=e(4154),c=e(5169),u=e(2804),f=e(944),p=u.i2c,m=u.i2cUrl,v=r("".charAt),S=n.Uint8Array,b=!S||!S.prototype.toBase64||!(function(){try{var w=new S;w.toBase64(null)}catch{return!0}})();S&&i({target:"Uint8Array",proto:!0,forced:b},{toBase64:function(){var E=l(this),C=arguments.length?a(arguments[0]):void 0,T=f(C)==="base64"?p:m,_=!!C&&!!C.omitPadding;c(this.buffer);for(var R="",D=0,M=E.length,L,P=function(B){return v(T,L>>6*B&63)};D+2<M;D+=3)L=(E[D]<<16)+(E[D+1]<<8)+E[D+2],R+=P(3)+P(2)+P(1)+P(0);return D+2===M?(L=(E[D]<<16)+(E[D+1]<<8),R+=P(3)+P(2)+P(1)+(_?"":"=")):D+1===M&&(L=E[D]<<16,R+=P(3)+P(2)+(_?"":"==")),R}})}),9504:((d,t,e)=>{var i=e(616),n=Function.prototype,r=n.call,a=i&&n.bind.bind(r,r);d.exports=i?a:function(l){return function(){return r.apply(l,arguments)}}}),9519:((d,t,e)=>{var i=e(4576),n=e(2839),r=i.process,a=i.Deno,l=r&&r.versions||a&&a.version,c=l&&l.v8,u,f;c&&(u=c.split("."),f=u[0]>0&&u[0]<4?1:+(u[0]+u[1])),!f&&n&&(u=n.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=n.match(/Chrome\/(\d+)/),u&&(f=+u[1]))),d.exports=f}),9539:((d,t,e)=>{var i=e(9565),n=e(8551),r=e(5966);d.exports=function(a,l,c){var u,f;n(a);try{if(u=r(a,"return"),!u){if(l==="throw")throw c;return c}u=i(u,a)}catch(p){f=!0,u=p}if(l==="throw")throw c;if(f)throw u;return n(u),c}}),9565:((d,t,e)=>{var i=e(616),n=Function.prototype.call;d.exports=i?n.bind(n):function(){return n.apply(n,arguments)}}),9577:((d,t,e)=>{var i=e(9928),n=e(4644),r=e(1108),a=e(1291),l=e(5854),c=n.aTypedArray,u=n.getTypedArrayConstructor,f=n.exportTypedArrayMethod,p=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(v){return v===8}})(),m=p&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();f("with",function(v,S){var b=c(this),w=a(v),E=r(b)?l(S):+S;return i(b,u(b),w,E)},!p||m)}),9590:((d,t,e)=>{var i=e(1291),n=RangeError;d.exports=function(r){var a=i(r);if(a<0)throw new n("The argument can't be less than 0");return a}}),9617:((d,t,e)=>{var i=e(5397),n=e(5610),r=e(6198),a=function(l){return function(c,u,f){var p=i(c),m=r(p);if(m===0)return!l&&-1;var v=n(f,m),S;if(l&&u!==u){for(;m>v;)if(S=p[v++],S!==S)return!0}else for(;m>v;v++)if((l||v in p)&&p[v]===u)return l||v||0;return!l&&-1}};d.exports={includes:a(!0),indexOf:a(!1)}}),9631:((d,t,e)=>{e(9486)}),9797:((d,t,e)=>{e(4226)}),9835:(d=>{d.exports=function(t){try{var e=new Set,i={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](i);return n.size===1&&n.values().next().value===4}catch{return!1}}}),9928:((d,t,e)=>{var i=e(6198),n=e(1291),r=RangeError;d.exports=function(a,l,c,u){var f=i(a),p=n(c),m=p<0?f+p:p;if(m>=f||m<0)throw new r("Incorrect index");for(var v=new l(f),S=0;S<f;S++)v[S]=S===m?u:a[S];return v}})},Rb={};function Nt(d){var t=Rb[d];if(t!==void 0)return t.exports;var e=Rb[d]={exports:{}};return CC[d].call(e.exports,e,e.exports,Nt),e.exports}Nt.d=(d,t)=>{for(var e in t)Nt.o(t,e)&&!Nt.o(d,e)&&Object.defineProperty(d,e,{enumerable:!0,get:t[e]})};Nt.o=(d,t)=>Object.prototype.hasOwnProperty.call(d,t);Nt(4114);Nt(6573);Nt(8100);Nt(7936);Nt(8111);Nt(8237);Nt(1689);Nt(9577);Nt(4235);Nt(9432);Nt(1549);Nt(9797);Nt(9631);Nt(5623);Nt(4979);Nt(5781);const fi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ff=[.001,0,0,.001,0,0],uf=1.35,Bi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_s={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Yo="pdfjs_internal_editor_",Lt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Wt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},xC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Je={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},eh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ke={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ca={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Eh={ERRORS:0,WARNINGS:1,INFOS:5},Wo={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Uc={moveTo:0,lineTo:1,curveTo:2,closePath:3},RC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let wh=Eh.WARNINGS;function _C(d){Number.isInteger(d)&&(wh=d)}function DC(){return wh}function Th(d){wh>=Eh.INFOS&&console.info(`Info: ${d}`)}function xt(d){wh>=Eh.WARNINGS&&console.warn(`Warning: ${d}`)}function ue(d){throw new Error(d)}function Kt(d,t){d||ue(t)}function MC(d){switch(d?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function bA(d,t=null,e=null){if(!d)return null;if(e&&typeof d=="string"&&(e.addDefaultProtocol&&d.startsWith("www.")&&d.match(/\./g)?.length>=2&&(d=`http://${d}`),e.tryConvertEncoding))try{d=IC(d)}catch{}const i=t?URL.parse(d,t):URL.parse(d);return MC(i)?i:null}function AA(d,t,e=!1){const i=URL.parse(d);return i?(i.hash=t,i.href):e&&bA(d,"http://example.com")?d.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ut(d,t,e,i=!1){return Object.defineProperty(d,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const yr=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class _b extends yr{constructor(t,e){super(t,"PasswordException"),this.code=e}}class df extends yr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Bf extends yr{constructor(t){super(t,"InvalidPDFException")}}class lh extends yr{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class OC extends yr{constructor(t){super(t,"FormatError")}}class Ns extends yr{constructor(t){super(t,"AbortException")}}function SA(d){(typeof d!="object"||d?.length===void 0)&&ue("Invalid argument for bytesToString");const t=d.length,e=8192;if(t<e)return String.fromCharCode.apply(null,d);const i=[];for(let n=0;n<t;n+=e){const r=Math.min(n+e,t),a=d.subarray(n,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function rl(d){typeof d!="string"&&ue("Invalid argument for stringToBytes");const t=d.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=d.charCodeAt(i)&255;return e}function LC(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function PC(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function NC(){try{return new Function(""),!0}catch{return!1}}class ni{static get isLittleEndian(){return Ut(this,"isLittleEndian",PC())}static get isEvalSupported(){return Ut(this,"isEvalSupported",NC())}static get isOffscreenCanvasSupported(){return Ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ut(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Ut(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ff=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));class mt{static makeHexColor(t,e,i){return`#${ff[t]}${ff[e]}${ff[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const n=t[i],r=t[i+1];t[i]=n*e[0]+r*e[2]+e[4],t[i+1]=n*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5];for(let f=0;f<6;f+=2){const p=t[i+f],m=t[i+f+1];t[i+f]=p*n+m*a+c,t[i+f+1]=p*r+m*l+u}}static applyInverseTransform(t,e){const i=t[0],n=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-i*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,i){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5],f=t[0],p=t[1],m=t[2],v=t[3];let S=n*f+c,b=S,w=n*m+c,E=w,C=l*p+u,T=C,_=l*v+u,R=_;if(r!==0||a!==0){const D=r*f,M=r*m,L=a*p,P=a*v;S+=L,E+=L,w+=P,b+=P,C+=D,R+=D,_+=M,T+=M}i[0]=Math.min(i[0],S,w,b,E),i[1]=Math.min(i[1],C,_,T,R),i[2]=Math.max(i[2],S,w,b,E),i[3]=Math.max(i[3],C,_,T,R)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],n=t[1],r=t[2],a=t[3],l=i**2+n**2,c=i*r+n*a,u=r**2+a**2,f=(l+u)/2,p=Math.sqrt(f**2-(l*u-c**2));e[0]=Math.sqrt(f+p||1),e[1]=Math.sqrt(f-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[i,r,n,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,n,r){r[0]=Math.min(r[0],t,i),r[1]=Math.min(r[1],e,n),r[2]=Math.max(r[2],t,i),r[3]=Math.max(r[3],e,n)}static#t(t,e,i,n,r,a,l,c,u,f){if(u<=0||u>=1)return;const p=1-u,m=u*u,v=m*u,S=p*(p*(p*t+3*u*e)+3*m*i)+v*n,b=p*(p*(p*r+3*u*a)+3*m*l)+v*c;f[0]=Math.min(f[0],S),f[1]=Math.min(f[1],b),f[2]=Math.max(f[2],S),f[3]=Math.max(f[3],b)}static#e(t,e,i,n,r,a,l,c,u,f,p,m){if(Math.abs(u)<1e-12){Math.abs(f)>=1e-12&&this.#t(t,e,i,n,r,a,l,c,-p/f,m);return}const v=f**2-4*p*u;if(v<0)return;const S=Math.sqrt(v),b=2*u;this.#t(t,e,i,n,r,a,l,c,(-f+S)/b,m),this.#t(t,e,i,n,r,a,l,c,(-f-S)/b,m)}static bezierBoundingBox(t,e,i,n,r,a,l,c,u){u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],e,c),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],e,c),this.#e(t,i,r,l,e,n,a,c,3*(-t+3*(i-r)+l),6*(t-2*i+r),3*(i-t),u),this.#e(t,i,r,l,e,n,a,c,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),u)}}function IC(d){return decodeURIComponent(escape(d))}let pf=null,Db=null;function kC(d){return pf||(pf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Db=new Map([["","t"]])),d.replaceAll(pf,(t,e,i)=>e?e.normalize("NFKC"):Db.get(i))}function EA(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const d=new Uint8Array(32);return crypto.getRandomValues(d),SA(d)}const pp="pdfjs_internal_id_";function FC(d,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,n,...r]=e;if(!d(i)&&!Number.isInteger(i)||!t(n))return!1;const a=r.length;let l=!0;switch(n.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function pi(d,t,e){return Math.min(Math.max(d,t),e)}function wA(d){return Uint8Array.prototype.toBase64?d.toBase64():btoa(SA(d))}function BC(d){return Uint8Array.fromBase64?Uint8Array.fromBase64(d):rl(atob(d))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(d){return d.reduce((t,e)=>t+e,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(d){const t=new AbortController,{signal:e}=t;for(const i of d)if(i.aborted)return t.abort(i.reason),e;for(const i of d)i.addEventListener("abort",()=>{t.abort(i.reason)},{signal:e});return e});Nt(1701);Nt(4603);Nt(7566);Nt(8721);class Ko{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(r){if(!r)return;let a=null;const l=r.name;if(l==="#text")a=r.value;else if(Ko.shouldBuildText(l))r?.attributes?.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&e.push({str:a}),!!r.children)for(const c of r.children)n(c)}return n(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class TA{static setupStorage(t,e,i,n,r){const a=n.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",l=>{n.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of i.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:r}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}l&&r.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,r=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:r,linkService:i});const l=r!=="richText",c=t.div;if(c.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=p}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);a.append(p),l&&Ko.shouldBuildText(n.name)&&u.push(p)}return{textDivs:u}}const f=[[n,-1,a]];for(;f.length>0;){const[p,m,v]=f.at(-1);if(m+1===p.children.length){f.pop();continue}const S=p.children[++f.at(-1)[1]];if(S===null)continue;const{name:b}=S;if(b==="#text"){const E=document.createTextNode(S.value);u.push(E),v.append(E);continue}const w=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,b):document.createElement(b);if(v.append(w),S.attributes&&this.setAttributes({html:w,element:S,storage:e,intent:r,linkService:i}),S.children?.length>0)f.push([S,-1,w]);else if(S.value){const E=document.createTextNode(S.value);l&&Ko.shouldBuildText(b)&&u.push(E),w.append(E)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Kn="http://www.w3.org/2000/svg";class Ca{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function al(d,t="text"){if(Fo(d,document.baseURI)){const e=await fetch(d);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const n=new XMLHttpRequest;n.open("GET",d,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}i(new Error(n.statusText))}},n.send(null)})}class ol{constructor({viewBox:t,userUnit:e,scale:i,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=n,this.offsetX=r,this.offsetY=a,i*=e;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let f,p,m,v;switch(n%=360,n<0&&(n+=360),n){case 180:f=-1,p=0,m=0,v=1;break;case 90:f=0,p=1,m=1,v=0;break;case 270:f=0,p=-1,m=-1,v=0;break;case 0:f=1,p=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,v=-v);let S,b,w,E;f===0?(S=Math.abs(u-t[1])*i+r,b=Math.abs(c-t[0])*i+a,w=(t[3]-t[1])*i,E=(t[2]-t[0])*i):(S=Math.abs(c-t[0])*i+r,b=Math.abs(u-t[1])*i+a,w=(t[2]-t[0])*i,E=(t[3]-t[1])*i),this.transform=[f*i,p*i,m*i,v*i,S-f*i*c-m*i*u,b-p*i*c-v*i*u],this.width=w,this.height=E}get rawDims(){const t=this.viewBox;return Ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new ol({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:r})}convertToViewportPoint(t,e){const i=[t,e];return mt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];mt.applyTransform(e,this.transform);const i=[t[2],t[3]];return mt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return mt.applyInverseTransform(i,this.transform),i}}class gp extends yr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Ch(d){const t=d.length;let e=0;for(;e<t&&d[e].trim()==="";)e++;return d.substring(e,e+5).toLowerCase()==="data:"}function mp(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function UC(d){return[d]=d.split(/[#?]/,1),d.substring(d.lastIndexOf("/")+1)}function HC(d,t="document.pdf"){if(typeof d!="string")return t;if(Ch(d))return xt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(d);if(!i)return t;const n=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return n(a);if(i.searchParams.size>0){const l=Array.from(i.searchParams.values()).reverse();for(const u of l)if(r.test(u))return n(u);const c=Array.from(i.searchParams.keys()).reverse();for(const u of c)if(r.test(u))return n(u)}if(i.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(c)return n(c[0])}return t}class Mb{started=Object.create(null);times=[];time(t){t in this.started&&xt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||xt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:r}of this.times)t.push(`${i.padEnd(e)} ${r-n}ms
`);return t.join("")}}function Fo(d,t){const e=t?URL.parse(d,t):URL.parse(d);return e?.protocol==="http:"||e?.protocol==="https:"}function on(d){d.preventDefault()}function Te(d){d.preventDefault(),d.stopPropagation()}function zC(d){console.log("Deprecated API usage: "+d)}class Uf{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const u=e[7]||"Z";let f=parseInt(e[8],10);f=f>=0&&f<=23?f:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,u==="-"?(a+=f,l+=p):u==="+"&&(a-=f,l-=p),new Date(Date.UTC(i,n,r,a,l,c))}}function jC(d,{scale:t=1,rotation:e=0}){const{width:i,height:n}=d.attributes.style,r=[0,0,parseInt(i),parseInt(n)];return new ol({viewBox:r,userUnit:1,scale:t,rotation:e})}function ll(d){if(d.startsWith("#")){const t=parseInt(d.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(t=>parseInt(t)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(xt(`Not a valid color format: "${d}"`),[0,0,0])}function $C(d){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of d.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;d.set(e,ll(i))}t.remove()}function be(d){const{a:t,b:e,c:i,d:n,e:r,f:a}=d.getTransform();return[t,e,i,n,r,a]}function En(d){const{a:t,b:e,c:i,d:n,e:r,f:a}=d.getTransform().invertSelf();return[t,e,i,n,r,a]}function pr(d,t,e=!1,i=!0){if(t instanceof ol){const{pageWidth:n,pageHeight:r}=t.rawDims,{style:a}=d,l=ni.isCSSRoundSupported,c=`var(--total-scale-factor) * ${n}px`,u=`var(--total-scale-factor) * ${r}px`,f=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,p=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!e||t.rotation%180===0?(a.width=f,a.height=p):(a.width=p,a.height=f)}i&&d.setAttribute("data-main-rotation",t.rotation)}class _n{constructor(){const{pixelRatio:t}=_n;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,n,r=-1){let a=1/0,l=1/0,c=1/0;i=_n.capPixels(i,r),i>0&&(a=Math.sqrt(i/(t*e))),n!==-1&&(l=n/t,c=n/e);const u=Math.min(a,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Hf=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class GC{static get isDarkMode(){return Ut(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class VC{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),Ut(this,"commentForegroundColor",ll(i))}}function XC(d,t,e,i){i=Math.min(Math.max(i??1,0),1);const n=255*(1-i);return d=Math.round(d*i+n),t=Math.round(t*i+n),e=Math.round(e*i+n),[d,t,e]}function Ob(d,t){const e=d[0]/255,i=d[1]/255,n=d[2]/255,r=Math.max(e,i,n),a=Math.min(e,i,n),l=(r+a)/2;if(r===a)t[0]=t[1]=0;else{const c=r-a;switch(t[1]=l<.5?c/(r+a):c/(2-r-a),r){case e:t[0]=((i-n)/c+(i<n?6:0))*60;break;case i:t[0]=((n-e)/c+2)*60;break;case n:t[0]=((e-i)/c+4)*60;break}}t[2]=l}function zf(d,t){const e=d[0],i=d[1],n=d[2],r=(1-Math.abs(2*n-1))*i,a=r*(1-Math.abs(e/60%2-1)),l=n-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+l,t[1]=a+l,t[2]=l;break;case 1:t[0]=a+l,t[1]=r+l,t[2]=l;break;case 2:t[0]=l,t[1]=r+l,t[2]=a+l;break;case 3:t[0]=l,t[1]=a+l,t[2]=r+l;break;case 4:t[0]=a+l,t[1]=l,t[2]=r+l;break;case 5:case 6:t[0]=r+l,t[1]=l,t[2]=a+l;break}}function Lb(d){return d<=.03928?d/12.92:((d+.055)/1.055)**2.4}function Pb(d,t,e){zf(d,e),e.map(Lb);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];zf(t,e),e.map(Lb);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)}const Nb=new Map;function YC(d,t){const e=d[0]+d[1]*256+d[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=Nb.get(e);if(i)return i;const n=new Float32Array(9),r=n.subarray(0,3),a=n.subarray(3,6);Ob(d,a);const l=n.subarray(6,9);Ob(t,l);const c=l[2]<.5,u=c?12:4.5;if(a[2]=c?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),Pb(a,l,r)<u){let f,p;c?(f=a[2],p=1):(f=0,p=a[2]);const m=.005;for(;p-f>m;){const v=a[2]=(f+p)/2;c===Pb(a,l,r)<u?f=v:p=v}a[2]=c?p:f}return zf(a,r),i=mt.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),Nb.set(e,i),i}function CA({html:d,dir:t,className:e},i){const n=document.createDocumentFragment();if(typeof d=="string"){const r=document.createElement("p");r.dir=t||"auto";const a=d.split(/(?:\r\n?|\n)/);for(let l=0,c=a.length;l<c;++l){const u=a[l];r.append(document.createTextNode(u)),l<c-1&&r.append(document.createElement("br"))}n.append(r)}else TA.render({xfaHtml:d,div:n,intent:"richText"});n.firstChild.classList.add("richText",e),i.append(n)}Nt(4972);Nt(4628);Nt(7642);Nt(8004);Nt(3853);Nt(5876);Nt(2475);Nt(5024);Nt(1698);Nt(9314);Nt(1148);Nt(3579);Nt(8335);class zo{#t=null;#e=null;#n;#i=null;#a=null;#s=null;#r=null;#o=null;static#c=null;constructor(t){this.#n=t,zo.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",on,{signal:e}),t.addEventListener("pointerdown",zo.#l,{signal:e}));const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const n=this.#n.toolbarPosition;if(n){const{style:r}=t,a=this.#n._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,Te(t)}#u(t){this.#n._focusEventsAllowed=!0,Te(t)}#f(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",on,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",zo.#c[t]),this.#f(i)&&i.addEventListener("click",n=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#s)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const n=this.#r=this.#m;e?(this.#i.insertBefore(i,e),this.#i.insertBefore(n,e)):this.#i.append(i,n),this.#s=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#n);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,i){const n=this.#i.querySelector(i);n&&t==="comment"&&this.addComment(e,n)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class WC{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",on,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,e){let i=0,n=0;for(const r of t){const a=r.y+r.height;if(a<i)continue;const l=r.x+(e?r.width:0);if(a>i){n=l,i=a;continue}e?l>n&&(n=l):l<n&&(n=l)}return[e?1-n:n,i]}show(t,e,i){const[n,r]=this.#a(e,i),{style:a}=this.#e||=this.#i();t.append(this.#e),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,e,i,n){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",i);const l=this.#n._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",on,{signal:l}),r.addEventListener("click",n,{signal:l})),this.#t.append(r)}}function xA(d,t,e){for(const i of e)t.addEventListener(i,d[i].bind(d))}class KC{#t=0;get id(){return`${Yo}${this.#t++}`}}class vp{#t=EA();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const r=n.decode().then(()=>(i.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Ut(this,"_isSVGFittingCanvas",r)}async#i(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof e=="string"?(i.url=e,n=await al(e,"blob")):e instanceof File?n=i.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const r=vp._isSVGFittingCanvas,a=new FileReader,l=new Image,c=new Promise((u,f)=>{l.onload=()=>{i.bitmap=l,i.isSvg=!0,u()},a.onload=async()=>{const p=i.svgUrl=a.result;l.src=await r?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=f});a.readAsDataURL(n),await c}else i.bitmap=await createImageBitmap(n);i.refCounter=1}catch(n){xt(n),i=null}return this.#n.set(t,i),i&&this.#n.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:n,type:r}=t;return this.#i(`${e}_${i}_${n}_${r}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i?.bitmap)return i.refCounter+=1,i;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),i={bitmap:n.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,i),this.#n.set(i.id,i),i}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=n.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class qC{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:i,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(n&&t(),this.#e)return;const c={cmd:t,undo:e,post:i,type:r};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(c);return}if(a&&this.#t[this.#i].type===r){l&&(c.undo=this.#t[this.#i].undo),this.#t[this.#i]=c;return}const u=this.#i+1;u===this.#n?this.#t.splice(0,1):(this.#i=u,u<this.#t.length&&this.#t.splice(u)),this.#t.push(c)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class cl{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ni.platform;for(const[i,n,r={}]of t)for(const a of i){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:n,options:{bubbles:r=!1,args:a=[],checker:l=null}}=i;l&&!l(t,e)||(n.bind(t,...a,e)(),r||Te(e))}}class yp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return $C(t),Ut(this,"_colors",t)}convert(t){const e=ll(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every((r,a)=>r===e[a]))return yp._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?mt.makeHexColor(...e):t}}class Is{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#s=null;#r=null;#o=null;#c=new qC;#l=null;#d=null;#u=null;#f=0;#m=new Set;#p=null;#h=null;#g=new Set;_editorUndoBar=null;#v=!1;#b=!1;#y=!1;#C=null;#w=null;#A=null;#R=null;#E=!1;#T=null;#M=new KC;#_=!1;#D=!1;#F=!1;#L=null;#N=null;#B=null;#I=null;#G=null;#x=Lt.NONE;#S=new Set;#P=null;#U=null;#z=null;#Y=null;#X=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#k=null;#V=null;#Z=null;#J=null;#H=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Is.prototype,e=a=>a.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new cl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,i,n,r,a,l,c,u,f,p,m,v,S,b,w){const E=this._signal=this.#t.signal;this.#V=t,this.#Z=e,this.#J=i,this.#s=n,this.#l=r,this.#U=a,this.#X=c,this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:E}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),l._on("setpreference",this.onSetPreference.bind(this),{signal:E}),l._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:E}),this.#lt(),this.#dt(),this.#et(),this.#r=c.annotationStorage,this.#C=c.filterFactory,this.#z=u,this.#R=f||null,this.#v=p,this.#b=m,this.#y=v,this.#G=S||null,this.viewParameters={realScale:Ca.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=w!==!1,r?.setSidebarUiManager(this)}destroy(){this.#H?.resolve(),this.#H=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#g.clear(),this.#I?.clear(),this.#e=null,this.#S.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#T?.hide(),this.#T=null,this.#B?.destroy(),this.#B=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#k&&(clearTimeout(this.#k),this.#k=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Ut(this,"hcmFilter",this.#z?this.#C.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Ut(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Ut(this,"_highlightColors",this.#R?new Map(this.#R.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ut(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[n,r]of t){const a=n.endsWith("_HCM");if(i&&a){e.set(n.replace("_HCM",""),r);continue}!i&&!a&&e.set(n,r)}return Ut(this,"highlightColors",e)}get highlightColorNames(){return Ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#B=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,n){this.#l?.showDialog(this,t,e,i,n)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),n=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await i}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#a.values()){const{x:n,y:r,width:a,height:l}=i.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=r&&e<=r+l)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Ca.PDF_TO_CSS_UNITS;for(const e of this.#g)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#a.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l}=i,c=i.toString(),f=this.#Q(i).closest(".textLayer"),p=this.getSelectionBoxes(f);if(!p)return;i.empty();const m=this.#tt(f),v=this.#x===Lt.NONE,S=()=>{const b=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l,text:c});v&&this.showAllEditors("highlight",!0,!0),e&&b?.editComment()};if(v){this.switchToMode(Lt.HIGHLIGHT,S);return}S()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#Q(t).closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(this.#T||=new WC(this),this.#T.show(i,n,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${Yo}${t}`,i=this.#r.getRawValue(e);return i&&this.#r.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#P&&(this.#T?.hide(),this.#P=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#P)return;const n=this.#Q(t).closest(".textLayer");if(!n){this.#P&&(this.#T?.hide(),this.#P=null,this.#O({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#P=e,this.#O({hasSelectedText:!0}),!(this.#x!==Lt.HIGHLIGHT&&this.#x!==Lt.NONE)&&(this.#x===Lt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#E=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#x===Lt.HIGHLIGHT?this.#tt(n):null;if(r?.toggleDrawing(),this.#D){const a=new AbortController,l=this.combinedSignal(a),c=u=>{u.type==="pointerup"&&u.button!==0||(a.abort(),r?.toggleDrawing(!0),u.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}else r?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#x===Lt.HIGHLIGHT?this.highlightSelection(t):this.#v&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#A)return;this.#A=new AbortController;const t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ht(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#S)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#L)return;this.#L=new AbortController;const t=this.combinedSignal(this.#L);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ut(){this.#L?.abort(),this.#L=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ut(),this.#nt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#S){const n=i.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of this.#h)if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){xt(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const c of i){const u=await n.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)this.#st(c);this.#rt(r)},l=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(r){xt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#x!==Lt.NONE&&!this.isEditorHandlingKeyboard&&Is._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,n])=>this.#W[i]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#x===Lt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[Wt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#O({isEditing:this.#x!==Lt.NONE,isEmpty:this.#q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ht(),this.#nt(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#_?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,n=!1,r=!1){if(this.#x!==t&&!(this.#H&&(await this.#H.promise,!this.#H))){if(this.#H=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#x===Lt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#x=t,t===Lt.NONE){this.setEditingState(!1),this.#pt();for(const a of this.#i.values())a.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#H.resolve();return}for(const a of this.#i.values())a.addStandaloneCommentButton();t===Lt.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const a of this.#a.values())a.updateMode(t);if(t===Lt.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#h.map(c=>c._editorType)));const a=new Set,l=[];for(const c of this.#i.values()){const{annotationElementId:u,hasComment:f,deleted:p}=c;u&&a.add(u),f&&!p&&l.push(c.getData())}for(const c of this.#n){const{id:u,popupRef:f,contentsObj:p}=c;f&&p?.str&&!a.has(u)&&!this.#m.has(u)&&l.push(c)}this.#l?.showSidebar(l)}if(!e){i&&this.addNewEditorFromKeyboard(),this.#H.resolve();return}for(const a of this.#i.values())a.uid===e?(this.setSelected(a),r?a.editComment():n?a.enterInEditMode():a.focus()):a.unselect();this.#H.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#x&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case Wt.CREATE:this.currentLayer.addNewEditor(e);return;case Wt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#S)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const r of this.#i.values())r.editorType===t&&r.show(e);(this.#Y?.get(Wt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[Wt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#F!==t){this.#F=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#_){this.#_=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#_){this.#_=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#I?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#S);return t}updateUI(t){this.#gt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#S.has(t)){this.#S.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#S.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#S)e!==t&&e.unselect();this.#S.clear(),this.#S.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#S.has(t)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(t){t.unselect(),this.#S.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#q()})}cleanUndoStack(t){this.#c.cleanType(t)}#q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#S],i=()=>{this._editorUndoBar?.show(n,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},n=()=>{for(const r of e)this.#st(r)};this.addCommands({cmd:i,undo:n,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#S)e.unselect();this.#S.clear();for(const e of t)e.isEmpty()||(this.#S.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#S)t.commit();this.#rt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#x!==Lt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#S)t.unselect();this.#S.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[n,r]=this.#j,a=[...this.#S],l=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const c of a)this.#i.has(c.id)&&(c.translateInPage(n,r),c.translationDone())},undo:()=>{for(const c of a)this.#i.has(c.id)&&(c.translateInPage(-n,-r),c.translationDone())},mustExec:!1})},l);for(const c of a)c.translateInPage(t,e),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#S)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:n,y:r,pageIndex:a},l]of t)l.newX=n,l.newY=r,l.newPageIndex=a,e||=n!==l.savedX||r!==l.savedY||a!==l.savedPageIndex;if(!e)return!1;const i=(n,r,a,l)=>{if(this.#i.has(n.id)){const c=this.#a.get(l);c?n._setParentAndPosition(c,r,a):(n.pageIndex=l,n.x=r,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:a,newPageIndex:l}]of t)i(n,r,a,l)},undo:()=>{for(const[n,{savedX:r,savedY:a,savedPageIndex:l}]of t)i(n,r,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const i of this.#p.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#x}isEditingMode(){return this.#x!==Lt.NONE}get imageManager(){return Ut(this,"imageManager",new vp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,f=e.rangeCount;u<f;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:n,width:r,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,f,p,m)=>({x:(f-n)/a,y:1-(u+p-i)/r,width:m/a,height:p/r});break;case"180":l=(u,f,p,m)=>({x:1-(u+p-i)/r,y:1-(f+m-n)/a,width:p/r,height:m/a});break;case"270":l=(u,f,p,m)=>({x:1-(f+m-n)/a,y:(u-i)/r,width:m/a,height:p/r});break;default:l=(u,f,p,m)=>({x:(u-i)/r,y:(f-n)/a,width:p/r,height:m/a});break}const c=[];for(let u=0,f=e.rangeCount;u<f;u++){const p=e.getRangeAt(u);if(!p.collapsed)for(const{x:m,y:v,width:S,height:b}of p.getClientRects())S===0||b===0||c.push(l(m,v,S,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#x===Lt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const n=this.#I?.get(t);n&&(n.setCanvas(e,i),this.#I.delete(t))}addMissingCanvas(t,e){(this.#I||=new Map).set(t,e)}}class xn{#t=null;#e=!1;#n=null;#i=null;#a=null;#s=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#u=t._uiManager.useNewAltTextFlow,xn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){xn._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",xn.#f.missing),e.setAttribute("data-l10n-id",xn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",on,{signal:i}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const n=r=>{r.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#r=!0,n(r))},{signal:i}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await xn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:n,cancel:r=!1}){i&&(this.#l=i,this.#d=n),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",xn.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",xn.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const n=100,r=this.#c._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Hc{#t=null;#e=null;#n=!1;#i=null;#a=null;#s=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=this.#i.commentButtonColor;n&&(i.backgroundColor=n)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:n,y:r,width:a,height:l}=this.#i.parent.boundingClientRect;return[(t-n)/a,(e+i-r)/l]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=this.#i._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",on,{signal:i}),e&&(t.addEventListener("focusin",r=>{this.#i._focusEventsAllowed=!1,Te(r)},{capture:!0,signal:i}),t.addEventListener("focusout",r=>{this.#i._focusEventsAllowed=!0,Te(r)},{capture:!0,signal:i})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const n=r=>{r.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#n=!0,n(r))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,n;if(e)[i,n]=e;else{[i,n]=this.#i.commentButtonPosition;const{width:f,height:p,x:m,y:v}=this.#i;i=m+i*f,n=v+n*p}const r=this.#i.parent.boundingClientRect,{x:a,y:l,width:c,height:u}=r;this.#i._uiManager.editComment(this.#i,a+i*c,l+n*u,{...t,parentDimensions:r})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#s=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#s=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#s=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class xh{#t;#e=!1;#n=null;#i;#a;#s;#r;#o=null;#c;#l=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:a=null,signal:l}){this.#t=t,this.#n=i,this.#i=e,this.#a=n,this.#s=r,this.#r=a,this.#d=new AbortController,this.#c=AbortSignal.any([l,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/_n.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const n=this.#o=new AbortController,r=AbortSignal.any([this.#c,n.signal]),a=this.#t,l={capture:!0,signal:r,passive:!1},c=u=>{u.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};a.addEventListener("pointerdown",u=>{u.pointerType==="touch"&&(Te(u),c(u))},l),a.addEventListener("pointerup",c,l),a.addEventListener("pointercancel",c,l);return}if(!this.#u){this.#u=new AbortController;const n=AbortSignal.any([this.#c,this.#u.signal]),r=this.#t,a={signal:n,capture:!1,passive:!1};r.addEventListener("touchmove",this.#m.bind(this),a);const l=this.#p.bind(this);r.addEventListener("touchend",l,a),r.addEventListener("touchcancel",l,a),a.capture=!0,r.addEventListener("pointerdown",Te,a),r.addEventListener("pointermove",Te,a),r.addEventListener("pointercancel",Te,a),r.addEventListener("pointerup",Te,a),this.#a?.()}if(Te(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;Te(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:n,screenY:r}=e,{screenX:a,screenY:l}=i,c=this.#l,{touch0X:u,touch0Y:f,touch1X:p,touch1Y:m}=c,v=p-u,S=m-f,b=a-n,w=l-r,E=Math.hypot(b,w)||1,C=Math.hypot(v,S)||1;if(!this.#e&&Math.abs(C-E)<=xh.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=n,c.touch0Y=r,c.touch1X=a,c.touch1Y=l,!this.#e){this.#e=!0;return}const T=[(n+a)/2,(r+l)/2];this.#s?.(T,C,E)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#r?.()),this.#l&&(Te(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Et{#t=null;#e=null;#n=null;#i=null;#a=null;#s=!1;#r=null;#o="";#c=null;#l=null;#d=null;#u=null;#f=null;#m="";#p=!1;#h=null;#g=!1;#v=!1;#b=!1;#y=null;#C=0;#w=0;#A=null;#R=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#E=!1;#T=Et._zIndex++;static _borderLineWidth=-1;static _colorManager=new yp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Et.prototype._resizeWithKeyboard,e=Is.TRANSLATE_SMALL,i=Is.TRANSLATE_BIG;return Ut(this,"_resizerKeyboardManager",new cl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Et.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[r,a];const[l,c]=this.parentDimensions;this.x=t.x/l,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new QC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Et._l10n??=t,Et._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Et._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Et._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ue("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#E}set _isDraggable(t){this.#E=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#k(),this.#u?.remove(),this.#u=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[r,a]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/r,this.y=(e+n)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n),this._onTranslated()}#M([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#M(this.parentDimensions,t,e)}translateInPage(t,e){this.#h||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#h||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[n,r]}=this;if(this.x+=t/n,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[c,u]=this.getBaseTranslation();a+=c,l+=u;const{style:f}=i;f.left=`${(100*a).toFixed(2)}%`,f.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}get _hasBeenResized(){return!!this.#h&&(this.#h[2]!==this.width||this.#h[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Et,n=i/t,r=i/e;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,n]}=this;let{x:r,y:a,width:l,height:c}=this;if(l*=i,c*=n,r*=i,a*=n,this._mustFixPosition)switch(t){case 0:r=pi(r,0,i-l),a=pi(a,0,n-c);break;case 90:r=pi(r,0,i-c),a=pi(a,l,n);break;case 180:r=pi(r,l,i),a=pi(a,c,n);break;case 270:r=pi(r,c,i),a=pi(a,0,n-l);break}this.x=r/=i,this.y=a/=n;const[u,f]=this.getBaseTranslation();r+=u,a+=f,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#_(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Et.#_(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Et.#_(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#F(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const n=document.createElement("div");this.#c.append(n),n.classList.add("resizer",i),n.setAttribute("data-resizer-name",i),n.addEventListener("pointerdown",this.#L.bind(this,i),{signal:e}),n.addEventListener("contextmenu",on,{signal:e}),n.tabIndex=-1}this.div.prepend(this.#c)}#L(t,e){e.preventDefault();const{isMac:i}=ni.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#n?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#I.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Te,{passive:!1,signal:a}),window.addEventListener("contextmenu",on,{signal:a}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=l,this.div.style.cursor=c,this.#B()};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})}#N(t,e,i,n){this.width=i,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=this.#d;this.#d=null;const r=this.x,a=this.y,l=this.width,c=this.height;r===t&&a===e&&l===i&&c===n||this.addCommands({cmd:this.#N.bind(this,r,a,l,c),undo:this.#N.bind(this,t,e,i,n),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#I(t,e){const[i,n]=this.parentDimensions,r=this.x,a=this.y,l=this.width,c=this.height,u=Et.MIN_SIZE/i,f=Et.MIN_SIZE/n,p=this.#D(this.rotation),m=(N,I)=>[p[0]*N+p[2]*I,p[1]*N+p[3]*I],v=this.#D(360-this.rotation),S=(N,I)=>[v[0]*N+v[2]*I,v[1]*N+v[3]*I];let b,w,E=!1,C=!1;switch(t){case"topLeft":E=!0,b=(N,I)=>[0,0],w=(N,I)=>[N,I];break;case"topMiddle":b=(N,I)=>[N/2,0],w=(N,I)=>[N/2,I];break;case"topRight":E=!0,b=(N,I)=>[N,0],w=(N,I)=>[0,I];break;case"middleRight":C=!0,b=(N,I)=>[N,I/2],w=(N,I)=>[0,I/2];break;case"bottomRight":E=!0,b=(N,I)=>[N,I],w=(N,I)=>[0,0];break;case"bottomMiddle":b=(N,I)=>[N/2,I],w=(N,I)=>[N/2,0];break;case"bottomLeft":E=!0,b=(N,I)=>[0,I],w=(N,I)=>[N,0];break;case"middleLeft":C=!0,b=(N,I)=>[0,I/2],w=(N,I)=>[N,I/2];break}const T=b(l,c),_=w(l,c);let R=m(..._);const D=Et._round(r+R[0]),M=Et._round(a+R[1]);let L=1,P=1,B,U;if(e.fromKeyboard)({deltaX:B,deltaY:U}=e);else{const{screenX:N,screenY:I}=e,[$,at]=this.#l;[B,U]=this.screenToPageTranslation(N-$,I-at),this.#l[0]=N,this.#l[1]=I}if([B,U]=S(B/i,U/n),E){const N=Math.hypot(l,c);L=P=Math.max(Math.min(Math.hypot(_[0]-T[0]-B,_[1]-T[1]-U)/N,1/l,1/c),u/l,f/c)}else C?L=pi(Math.abs(_[0]-T[0]-B),u,1)/l:P=pi(Math.abs(_[1]-T[1]-U),f,1)/c;const Z=Et._round(l*L),q=Et._round(c*P);R=m(...w(Z,q));const Q=D-R[0],nt=M-R[1];this.#h||=[this.x,this.y,this.width,this.height],this.width=Z,this.height=q,this.x=Q,this.y=nt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new zo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(xn.initialize(Et._l10n),this.#n=new xn(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new Hc(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:n}}=this.#i;return{text:e,richText:t,date:i,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Hc(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#i||=new Hc(this),this.#i.setInitialText(t,i),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Hc(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,n]=t.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,l=a+r+1,c=n-100,u=l+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),xA(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#R||=new xh({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#x.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#x(t,e,i){let r=.7*(i/e)+1-.7;if(r===1)return;const a=this.#D(this.rotation),l=(D,M)=>[a[0]*D+a[2]*M,a[1]*D+a[3]*M],[c,u]=this.parentDimensions,f=this.x,p=this.y,m=this.width,v=this.height,S=Et.MIN_SIZE/c,b=Et.MIN_SIZE/u;r=Math.max(Math.min(r,1/m,1/v),S/m,b/v);const w=Et._round(m*r),E=Et._round(v*r);if(w===m&&E===v)return;this.#h||=[f,p,m,v];const C=l(m/2,v/2),T=Et._round(f+C[0]),_=Et._round(p+C[1]),R=l(w/2,E/2);this.x=T-R[0],this.y=_-R[1],this.width=w,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(t){const{isMac:e}=ni.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(t);return}this.#P(t)}#P(t){const{isMac:e}=ni.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:r},l=u=>{n.abort(),this.#r=null,this.#p=!1,this._uiManager.endDragSession()||this.#P(u),i&&this._onStopDragging()};e&&(this.#C=t.clientX,this.#w=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",u=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:f,clientY:p,pointerId:m}=u;if(m!==this.#r){Te(u);return}const[v,S]=this.screenToPageTranslation(f-this.#C,p-this.#w);this.#C=f,this.#w=p,this._uiManager.dragSelectedEditors(v,S)},a),window.addEventListener("touchmove",Te,a),window.addEventListener("pointerdown",u=>{u.pointerType===this.#o&&(this.#R||u.isPrimary)&&l(u),Te(u)},a));const c=u=>{if(!this.#r||this.#r===u.pointerId){l(u);return}Te(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const n=this.parentScale,[r,a]=this.pageDimensions,[l,c]=this.pageTranslation,u=t/n,f=e/n,p=this.x*r,m=this.y*a,v=this.width*r,S=this.height*a;switch(i){case 0:return[p+u+l,a-m-f-S+c,p+u+v+l,a-m-f+c];case 90:return[p+f+l,a-m+u+c,p+f+S+l,a-m+u+v+c];case 180:return[p-u-v+l,a-m+f+c,p-u+l,a-m+f+S+c];case 270:return[p-f-S+l,a-m-u-v+c,p-f+l,a-m-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,r,a]=t,l=r-i,c=a-n;switch(this.rotation){case 0:return[i,e-a,l,c];case 90:return[i,e-n,c,l];case 180:return[r,e-n,l,c];case 270:return[r,e-a,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Et._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:n,deleted:r,richText:a},uid:l,pageIndex:c,creationDate:u,modificationDate:f}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:a,contentsObj:{str:t},creationDate:u,modificationDate:i||f,popupRef:!r,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return e<a&&n>0&&t<r&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,n.#t=t.accessibilityData,n._isCopy=t.isCopy||!1;const[r,a]=n.pageDimensions,[l,c,u,f]=n.getRectInCurrentCoords(t.rect,a);return n.x=l/r,n.y=c/a,n.width=u/r,n.height=f/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#k(),this.removeEditToolbar(),this.#A){for(const t of this.#A.values())clearTimeout(t);this.#A=null}this.parent=null,this.#R?.destroy(),this.#R=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,n,r,a]=this.getPDFRect();return[Et._round(i+(r-i)*t),Et._round(n+(a-n)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const a=this.#Y.bind(this),l=this.#X.bind(this),c=this._uiManager._signal;for(const u of this.#e){const f=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",this.#W.bind(this,f),{signal:c}),u.setAttribute("data-l10n-id",Et._l10nResizer[f])}}const i=this.#e[0];let n=0;for(const a of e){if(a===i)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==n){if(r<n)for(let l=0;l<n-r;l++)this.#c.append(this.#c.firstChild);else if(r>n)for(let l=0;l<r-n;l++)this.#c.firstChild.before(this.#c.lastChild);let a=0;for(const l of e){const u=this.#e[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Et._l10nResizer[u])}}this.#j(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){Et._resizerKeyboardManager.exec(this,t)}#X(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#k()}#W(t){this.#m=this.#b?t:""}#j(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#I(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#k(){this.#b=!1,this.#j(-1),this.#B()}_stopResizingWithKeyboard(){this.#k(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#A||=new Map;const{action:i}=t;let n=this.#A.get(i);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),this.#A.delete(i),this.#A.size===0&&(this.#A=null)},Et._telemetryTimeout),this.#A.set(i,n);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(t){if(!this.#u&&!this.deleted){this.#u=t.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class QC extends Et{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ib=3285377520,nn=4294901760,wn=65535;class RA{constructor(t){this.h1=t?t&4294967295:Ib,this.h2=t?t&4294967295:Ib}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let b=0,w=t.length;b<w;b++){const E=t.charCodeAt(b);E<=255?e[i++]=E:(e[i++]=E>>>8,e[i++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=i>>2,r=i-n*4,a=new Uint32Array(e.buffer,0,n);let l=0,c=0,u=this.h1,f=this.h2;const p=3432918353,m=461845907,v=p&wn,S=m&wn;for(let b=0;b<n;b++)b&1?(l=a[b],l=l*p&nn|l*v&wn,l=l<<15|l>>>17,l=l*m&nn|l*S&wn,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[b],c=c*p&nn|c*v&wn,c=c<<15|c>>>17,c=c*m&nn|c*S&wn,f^=c,f=f<<13|f>>>19,f=f*5+3864292196);switch(l=0,r){case 3:l^=e[n*4+2]<<16;case 2:l^=e[n*4+1]<<8;case 1:l^=e[n*4],l=l*p&nn|l*v&wn,l=l<<15|l>>>17,l=l*m&nn|l*S&wn,n&1?u^=l:f^=l}this.h1=u,this.h2=f}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&nn|t*36045&wn,e=e*4283543511&nn|((e<<16|t>>>16)*2950163797&nn)>>>16,t^=e>>>1,t=t*444984403&nn|t*60499&wn,e=e*3301882366&nn|((e<<16|t>>>16)*3120437893&nn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const jf=Object.freeze({map:null,hash:"",transfer:void 0});class bp{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof Et&&this.#n.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#i.values())if(i instanceof Et)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let n=!1;if(i!==void 0)for(const[r,a]of Object.entries(e))i[r]!==a&&(n=!0,i[r]=a);else n=!0,this.#i.set(t,e);n&&this.#a(),e instanceof Et&&((this.#n||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new _A(this)}get serializable(){if(this.#i.size===0)return jf;const t=new Map,e=new RA,i=[],n=Object.create(null);let r=!1;for(const[a,l]of this.#i){const c=l instanceof Et?l.serialize(!1,n):l;c&&(t.set(a,c),e.update(`${a}:${JSON.stringify(c)}`),r||=!!c.bitmap)}if(r)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:jf}get editorStats(){let t=null;const e=new Map;let i=0,n=0;for(const r of this.#i.values()){if(!(r instanceof Et)){r.popup&&(r.popup.deleted?n+=1:i+=1);continue}r.isCommentDeleted?n+=1:r.hasEditedComment&&(i+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:l}=a;e.has(l)||e.set(l,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const c=t[l]||=new Map;for(const[u,f]of Object.entries(a)){if(u==="type")continue;let p=c.get(u);p||(p=new Map,c.set(u,p));const m=p.get(f)??0;p.set(f,m+1)}}if((n>0||i>0)&&(t||=Object.create(null),t.comments={deleted:n,edited:i}),!t)return null;for(const[r,a]of e)t[r]=a.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#n?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const e of this.#n.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class _A extends bp{#t;constructor(t){super();const{map:e,hash:i,transfer:n}=t.serializable,r=structuredClone(e,n?{transfer:n}:null);this.#t={map:r,hash:i,transfer:n}}get print(){ue("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ut(this,"modifiedIds",{ids:new Set,hash:""})}}class ZC{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Kt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:a}=t,l=new FontFace(n,r,a);this.addNativeFontFace(l);try{await l.load(),this.#t.add(n),i?.(t)}catch{xt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}ue("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(n){throw xt(`Failed to load font '${i.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const n=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ut(this,"isSyncFontLoadingSupported",fi||ni.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Kt(!n.done,"completeRequest() cannot be called twice."),n.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(_,R){return _.charCodeAt(R)<<24|_.charCodeAt(R+1)<<16|_.charCodeAt(R+2)<<8|_.charCodeAt(R+3)&255}function n(_,R,D,M){const L=_.substring(0,R),P=_.substring(R+D);return L+M+P}let r,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function f(_,R){if(++u>30){xt("Load test font never loaded."),R();return}if(c.font="30px "+_,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(f.bind(null,_,R))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=n(m,976,p.length,p);const S=16,b=1482184792;let w=i(m,S);for(r=0,a=p.length-3;r<a;r+=4)w=w-b+i(p,r)|0;r<p.length&&(w=w-b+i(p+"XXX",r)|0),m=n(m,S,4,LC(w));const E=`url(data:font/opentype;base64,${btoa(m)});`,C=`@font-face {font-family:"${p}";src:${E}}`;this.insertRule(C);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const _ of[t.loadedName,p]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=_,T.append(R)}this._document.body.append(T),f(p,()=>{T.remove(),e.complete()})}}class JC{#t;constructor(t,e=null,i,n){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),n&&(this.charProcOperatorList=n)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${wA(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let n;try{n=t.get(i)}catch(a){xt(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(n||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=r}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function tx(d){if(d instanceof URL)return d.href;if(typeof d=="string"){if(fi)return d;const t=URL.parse(d,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ex(d){if(fi&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return rl(d);if(d instanceof ArrayBuffer||ArrayBuffer.isView(d)||typeof d=="object"&&!isNaN(d?.length))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function zc(d){if(typeof d!="string")return null;if(d.endsWith("/"))return d;throw new Error(`Invalid factory url: "${d}" must include trailing slash.`)}const $f=d=>typeof d=="object"&&Number.isInteger(d?.num)&&d.num>=0&&Number.isInteger(d?.gen)&&d.gen>=0,ix=d=>typeof d=="object"&&typeof d?.name=="string",nx=FC.bind(null,$f,ix);class sx{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[n]of this.#t)n.call(this,i)})}addEventListener(t,e,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:r}=i;if(r.aborted){xt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);n=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}this.#t.set(e,n)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const jc={DATA:1,ERROR:2},Ie={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function kb(){}function Ci(d){if(d instanceof Ns||d instanceof Bf||d instanceof _b||d instanceof lh||d instanceof df)return d;switch(d instanceof Error||typeof d=="object"&&d!==null||ue('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new Ns(d.message);case"InvalidPDFException":return new Bf(d.message);case"PasswordException":return new _b(d.message,d.code);case"ResponseException":return new lh(d.message,d.status,d.missing);case"UnknownErrorException":return new df(d.message,d.details)}return new df(d.message,d.toString())}class Bo{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,n=this.callbackCapabilities[i];if(!n)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===jc.DATA)n.resolve(t.data);else if(t.callback===jc.ERROR)n.reject(Ci(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,n=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(a){r.postMessage({sourceName:i,targetName:n,callback:jc.DATA,callbackId:t.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:n,callback:jc.ERROR,callbackId:t.callbackId,reason:Ci(a)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,i,n){const r=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const f=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:t,streamId:r,data:e,desiredSize:u.desiredSize},n),f.promise},pull:u=>{const f=Promise.withResolvers();return this.streamControllers[r].pullCall=f,c.postMessage({sourceName:a,targetName:l,stream:Ie.PULL,streamId:r,desiredSize:u.desiredSize}),f.promise},cancel:u=>{Kt(u instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[r].cancelCall=f,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:Ie.CANCEL,streamId:r,reason:Ci(u)}),f.promise}},i)}#n(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,r=this.comObj,a=this,l=this.actionHandler[t.action],c={enqueue(u,f=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=f,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:n,stream:Ie.ENQUEUE,streamId:e,chunk:u},p)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:n,stream:Ie.CLOSE,streamId:e}),delete a.streamSinks[e])},error(u){Kt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:n,stream:Ie.ERROR,streamId:e,reason:Ci(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(l,t.data,c).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ie.START_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ie.START_COMPLETE,streamId:e,reason:Ci(u)})})}#i(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,r=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case Ie.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Ci(t.reason));break;case Ie.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Ci(t.reason));break;case Ie.PULL:if(!l){r.postMessage({sourceName:i,targetName:n,stream:Ie.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||kb).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ie.PULL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ie.PULL_COMPLETE,streamId:e,reason:Ci(u)})});break;case Ie.ENQUEUE:if(Kt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Ie.CLOSE:if(Kt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#a(a,e);break;case Ie.ERROR:Kt(a,"error should have stream controller"),a.controller.error(Ci(t.reason)),this.#a(a,e);break;case Ie.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Ci(t.reason)),this.#a(a,e);break;case Ie.CANCEL:if(!l)break;const c=Ci(t.reason);Promise.try(l.onCancel||kb,c).then(function(){r.postMessage({sourceName:i,targetName:n,stream:Ie.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:i,targetName:n,stream:Ie.CANCEL_COMPLETE,streamId:e,reason:Ci(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class DA{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ue("Abstract method `_createCanvas` called.")}}class rx extends DA{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class MA{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){ue("Abstract method `_fetch` called.")}}class Fb extends MA{async _fetch(t){const e=await al(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):rl(e)}}Nt(2489);class OA{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,r){return"none"}destroy(t=!1){}}class ax extends OA{#t;#e;#n;#i;#a;#s;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#n){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#a.createElementNS(Kn,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#a.createElementNS(Kn,"defs"),t.append(i),i.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const c=t[0],u=new Array(256);for(let p=0;p<256;p++)u[p]=c[p]/255;const f=u.join(",");return[f,f,f]}const[e,i,n]=t,r=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)r[c]=e[c]/255,a[c]=i[c]/255,l[c]=n[c]/255;return[r.join(","),a.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Ch(e)?xt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=AA(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,n,r]=this.#d(t),a=t.length===1?i:`${i}${n}${r}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#i}_transfer_map_${this.#r++}`,c=this.#u(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#p(l);return this.#g(i,n,r,u),c}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let r=this.#c.get(n);if(r?.key===i||(r?(r.filter?.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},this.#c.set(n,r)),!t||!e))return r.url;const a=this.#b(t);t=mt.makeHexColor(...a);const l=this.#b(e);if(e=mt.makeHexColor(...l),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const c=new Array(256);for(let v=0;v<=255;v++){const S=v/255;c[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const u=c.join(","),f=`g_${this.#i}_hcm_filter`,p=r.filter=this.#p(f);this.#g(u,u,u,p),this.#m(p);const m=(v,S)=>{const b=a[v]/255,w=l[v]/255,E=new Array(S+1);for(let C=0;C<=S;C++)E[C]=b+C/S*(w-b);return E.join(",")};return this.#g(m(0,5),m(1,5),m(2,5),p),r.url=this.#u(f),r.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),n=`alpha_${i}`;if(e=this.#o.get(n),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_alpha_map_${this.#r++}`,a=this.#u(r);this.#o.set(t,a),this.#o.set(n,a);const l=this.#p(r);return this.#v(i,l),a}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,n;if(t?([i]=this.#d([t]),n=`luminosity_${i}`):n="luminosity",e=this.#o.get(n),e)return this.#o.set(t,e),e;const r=`g_${this.#i}_luminosity_map_${this.#r++}`,a=this.#u(r);this.#o.set(t,a),this.#o.set(n,a);const l=this.#p(r);return this.#f(l),t&&this.#v(i,l),a}addHighlightHCMFilter(t,e,i,n,r){const a=`${e}-${i}-${n}-${r}`;let l=this.#c.get(t);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#c.set(t,l)),!e||!i))return l.url;const[c,u]=[e,i].map(this.#b.bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[m,v]=[n,r].map(this.#b.bind(this));p<f&&([f,p,m,v]=[p,f,v,m]),this.#l.style.color="";const S=(E,C,T)=>{const _=new Array(256),R=(p-f)/T,D=E/255,M=(C-E)/(255*T);let L=0;for(let P=0;P<=T;P++){const B=Math.round(f+P*R),U=D+P*M;for(let Z=L;Z<=B;Z++)_[Z]=U;L=B+1}for(let P=L;P<256;P++)_[P]=_[L-1];return _.join(",")},b=`g_${this.#i}_hcm_${t}_filter`,w=l.filter=this.#p(b);return this.#m(w),this.#g(S(m[0],v[0],5),S(m[1],v[1],5),S(m[2],v[2],5),w),l.url=this.#u(b),l.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(Kn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(Kn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#a.createElementNS(Kn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#h(t,e,i){const n=this.#a.createElementNS(Kn,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)}#g(t,e,i,n){const r=this.#a.createElementNS(Kn,"feComponentTransfer");n.append(r),this.#h(r,"feFuncR",t),this.#h(r,"feFuncG",e),this.#h(r,"feFuncB",i)}#v(t,e){const i=this.#a.createElementNS(Kn,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#b(t){return this.#l.style.color=t,ll(getComputedStyle(this.#l).getPropertyValue("color"))}}class LA{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){ue("Abstract method `_fetch` called.")}}class Bb extends LA{async _fetch(t){const e=await al(t,"arraybuffer");return new Uint8Array(e)}}class PA{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){ue("Abstract method `_fetch` called.")}}class Ub extends PA{async _fetch(t){const e=await al(t,"arraybuffer");return new Uint8Array(e)}}if(fi){let d;try{const t=process.getBuiltinModule("module").createRequire(import.meta.url);try{d=t("@napi-rs/canvas")}catch(e){xt(`Cannot load "@napi-rs/canvas" package: "${e}".`)}}catch(t){xt(`Cannot access the \`require\` function: "${t}".`)}globalThis.DOMMatrix||(d?.DOMMatrix?globalThis.DOMMatrix=d.DOMMatrix:xt("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(d?.ImageData?globalThis.ImageData=d.ImageData:xt("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(d?.Path2D?globalThis.Path2D=d.Path2D:xt("Cannot polyfill `Path2D`, rendering may be broken.")),globalThis.navigator?.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function Ap(d){const e=await process.getBuiltinModule("fs").promises.readFile(d);return new Uint8Array(e)}class ox extends OA{}class lx extends DA{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class cx extends MA{async _fetch(t){return Ap(t)}}class hx extends LA{async _fetch(t){return Ap(t)}}class ux extends PA{async _fetch(t){return Ap(t)}}Nt(7588);const aa="__forcedDependency",{floor:Hb,ceil:zb}=Math;function $c(d,t,e,i,n,r){d[t*4+0]=Math.min(d[t*4+0],e),d[t*4+1]=Math.min(d[t*4+1],i),d[t*4+2]=Math.max(d[t*4+2],n),d[t*4+3]=Math.max(d[t*4+3],r)}const Gf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class dx{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Gf}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Gc=(d,t)=>{if(!d)return;let e=d.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},d.set(t,e)),e};class fx{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[aa]:[]};#n=new Map;#i=[];#a=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#u=new Map;#f;#m;#p;#h;#g;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#v(e),i&&(this.#g=new Map)}growOperationsCount(t){t>=this.#h.length&&this.#v(t,this.#h)}#v(t,e){const i=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(i),this.#h=new Uint32Array(i),e&&e.length>0?(this.#h.set(e),this.#h.fill(Gf,e.length)):this.#h.fill(Gf)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[aa]:{__proto__:this.#e[aa]}},this.#r={__proto__:this.#r},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const i=this.#i.pop();return i!==void 0&&(Gc(this.#g,t)?.dependencies.add(i),this.#h[t]=this.#h[i]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(Gc(this.#g,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(Gc(this.#g,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}pushBaseTransform(t){return this.#s.push(mt.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#n.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(aa,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(aa,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,n,r,a){const l=mt.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform()),c=[1/0,1/0,-1/0,-1/0];mt.axialAlignedBoundingBox([i,r,n,a],l,c);const u=mt.intersect(this.#r,c);return u?(this.#r[0]=u[0],this.#r[1]=u[1],this.#r[2]=u[2],this.#r[3]=u[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,i,n,r,a){const l=this.#r;if(l[0]===1/0)return this;const c=mt.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform());if(l[0]===-1/0)return mt.axialAlignedBoundingBox([i,r,n,a],c,this.#o),this;const u=[1/0,1/0,-1/0,-1/0];return mt.axialAlignedBoundingBox([i,r,n,a],c,u),this.#o[0]=Math.min(this.#o[0],Math.max(u[0],l[0])),this.#o[1]=Math.min(this.#o[1],Math.max(u[1],l[1])),this.#o[2]=Math.max(this.#o[2],Math.min(u[2],l[2])),this.#o[3]=Math.max(this.#o[3],Math.min(u[3],l[3])),this}recordCharacterBBox(t,e,i,n=1,r=0,a=0,l){const c=i.bbox;let u,f;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&this.#u.get(i),u!==!1&&(f=[0,0,0,0],mt.axialAlignedBoundingBox(c,i.fontMatrix,f),(n!==1||r!==0||a!==0)&&mt.scaleMinMax([n,0,0,-n,r,a],f),u)))return this.recordBBox(t,e,f[0],f[2],f[1],f[3]);if(!l)return this.recordFullPageBBox(t);const p=l();return c&&f&&u===void 0&&(u=f[0]<=r-p.actualBoundingBoxLeft&&f[2]>=r+p.actualBoundingBoxRight&&f[1]<=a-p.actualBoundingBoxAscent&&f[3]>=a+p.actualBoundingBoxDescent,this.#u.set(i,u),u)?this.recordBBox(t,e,f[0],f[2],f[1],f[3]):this.recordBBox(t,e,r-p.actualBoundingBoxLeft,r+p.actualBoundingBoxRight,a-p.actualBoundingBoxAscent,a+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,n=this.#t,r=this.#e;for(const a of e)a in this.#t?i.add(n[a]):a in r&&r[a].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#l.add(this.#n.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[aa]),this.#g){const i=Gc(this.#g,t),{dependencies:n}=i;this.#l.forEach(n.add,n),this.#i.forEach(n.add,n),this.#a.forEach(n.add,n),n.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=Hb(this.#o[0]*256/this.#f),n=Hb(this.#o[1]*256/this.#m),r=zb(this.#o[2]*256/this.#f),a=zb(this.#o[3]*256/this.#m);$c(this.#p,t,i,n,r,a);for(const l of this.#l)l!==t&&$c(this.#p,l,i,n,r,a);for(const l of this.#i)l!==t&&$c(this.#p,l,i,n,r,a);for(const l of this.#a)l!==t&&$c(this.#p,l,i,n,r,a);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of i)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#u.clear(),new dx(this.#h,this.#p)}takeDebugMetadata(){return this.#g}}class ch{#t;#e;#n;#i=0;#a=0;constructor(t,e,i){if(t instanceof ch&&t.#n===!!i)return t;this.#t=t,this.#e=e,this.#n=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,n,r,a){return this.#n||this.#t.recordClipBox(this.#e,e,i,n,r,a),this}recordBBox(t,e,i,n,r,a){return this.#n||this.#t.recordBBox(this.#e,e,i,n,r,a),this}recordCharacterBBox(t,e,i,n,r,a,l){return this.#n||this.#t.recordCharacterBBox(this.#e,e,i,n,r,a,l),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const sn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ii={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Vf(d,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,i),d.clip(n)}class Sp{isModifyingCurrentTransform(){return!1}getPattern(){ue("Abstract method `getPattern` called.")}}class px extends Sp{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let r;if(n===ii.STROKE||n===ii.FILL){const a=e.current.getClippedPathBoundingBox(n,be(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=e.cachedCanvases.getCanvas("pattern",l,c),f=u.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-a[0],-a[1]),i=mt.transform(i,[1,0,0,1,a[0],a[1]]),f.transform(...e.baseTransform),this.matrix&&f.transform(...this.matrix),Vf(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),r=t.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(i);r.setTransform(p)}else Vf(t,this._bbox),r=this._createGradient(t);return r}}function gf(d,t,e,i,n,r,a,l){const c=t.coords,u=t.colors,f=d.data,p=d.width*4;let m;c[e+1]>c[i+1]&&(m=e,e=i,i=m,m=r,r=a,a=m),c[i+1]>c[n+1]&&(m=i,i=n,n=m,m=a,a=l,l=m),c[e+1]>c[i+1]&&(m=e,e=i,i=m,m=r,r=a,a=m);const v=(c[e]+t.offsetX)*t.scaleX,S=(c[e+1]+t.offsetY)*t.scaleY,b=(c[i]+t.offsetX)*t.scaleX,w=(c[i+1]+t.offsetY)*t.scaleY,E=(c[n]+t.offsetX)*t.scaleX,C=(c[n+1]+t.offsetY)*t.scaleY;if(S>=C)return;const T=u[r],_=u[r+1],R=u[r+2],D=u[a],M=u[a+1],L=u[a+2],P=u[l],B=u[l+1],U=u[l+2],Z=Math.round(S),q=Math.round(C);let Q,nt,N,I,$,at,ut,k;for(let j=Z;j<=q;j++){if(j<w){const V=j<S?0:(S-j)/(S-w);Q=v-(v-b)*V,nt=T-(T-D)*V,N=_-(_-M)*V,I=R-(R-L)*V}else{let V;j>C?V=1:w===C?V=0:V=(w-j)/(w-C),Q=b-(b-E)*V,nt=D-(D-P)*V,N=M-(M-B)*V,I=L-(L-U)*V}let K;j<S?K=0:j>C?K=1:K=(S-j)/(S-C),$=v-(v-E)*K,at=T-(T-P)*K,ut=_-(_-B)*K,k=R-(R-U)*K;const st=Math.round(Math.min(Q,$)),ht=Math.round(Math.max(Q,$));let J=p*j+st*4;for(let V=st;V<=ht;V++)K=(Q-V)/(Q-$),K<0?K=0:K>1&&(K=1),f[J++]=nt-(nt-at)*K|0,f[J++]=N-(N-ut)*K|0,f[J++]=I-(I-k)*K|0,f[J++]=255}}function gx(d,t,e){const i=t.coords,n=t.colors;let r,a;switch(t.type){case"lattice":const l=t.verticesPerRow,c=Math.floor(i.length/l)-1,u=l-1;for(r=0;r<c;r++){let f=r*l;for(let p=0;p<u;p++,f++)gf(d,e,i[f],i[f+1],i[f+l],n[f],n[f+1],n[f+l]),gf(d,e,i[f+l+1],i[f+1],i[f+l],n[f+l+1],n[f+1],n[f+l])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)gf(d,e,i[r],i[r+1],i[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class mx extends Sp{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,f=Math.ceil(this._bounds[3])-c,p=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(f*t[1]*1.1)),3e3),v=u/p,S=f/m,b={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/v,scaleY:1/S},w=p+4,E=m+4,C=i.getCanvas("mesh",w,E),T=C.context,_=T.createImageData(p,m);if(e){const D=_.data;for(let M=0,L=D.length;M<L;M+=4)D[M]=e[0],D[M+1]=e[1],D[M+2]=e[2],D[M+3]=255}for(const D of this._figures)gx(_,D,b);return T.putImageData(_,2,2),{canvas:C.canvas,offsetX:l-2*v,offsetY:c-2*S,scaleX:v,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,n){Vf(t,this._bbox);const r=new Float32Array(2);if(n===ii.SHADING)mt.singularValueDecompose2dScale(be(t),r);else if(this.matrix){mt.singularValueDecompose2dScale(this.matrix,r);const[l,c]=r;mt.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=l,r[1]*=c}else mt.singularValueDecompose2dScale(e.baseTransform,r);const a=this._createMeshCanvas(r,n===ii.SHADING?null:this._background,e.cachedCanvases);return n!==ii.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class vx extends Sp{getPattern(){return"hotpink"}}function yx(d){switch(d[0]){case"RadialAxial":return new px(d);case"Mesh":return new mx(d);case"Dummy":return new vx}throw new Error(`Unknown IR type: ${d[0]}`)}const jb={COLORED:1,UNCOLORED:2};class Ep{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t,e){const{bbox:i,operatorList:n,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:f}=this;u=Math.abs(u),f=Math.abs(f),Th("TilingType: "+a);const p=i[0],m=i[1],v=i[2],S=i[3],b=v-p,w=S-m,E=new Float32Array(2);mt.singularValueDecompose2dScale(this.matrix,E);const[C,T]=E;mt.singularValueDecompose2dScale(this.baseTransform,E);const _=C*E[0],R=T*E[1];let D=b,M=w,L=!1,P=!1;const B=Math.ceil(u*_),U=Math.ceil(f*R),Z=Math.ceil(b*_),q=Math.ceil(w*R);B>=Z?D=u:L=!0,U>=q?M=f:P=!0;const Q=this.getSizeAndScale(D,this.ctx.canvas.width,_),nt=this.getSizeAndScale(M,this.ctx.canvas.height,R),N=t.cachedCanvases.getCanvas("pattern",Q.size,nt.size),I=N.context,$=c.createCanvasGraphics(I,e);if($.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext($,r,l),I.translate(-Q.scale*p,-nt.scale*m),$.transform(0,Q.scale,0,0,nt.scale,0,0),I.save(),$.dependencyTracker?.save(),this.clipBbox($,p,m,v,S),$.baseTransform=be($.ctx),$.executeOperatorList(n),$.endDrawing(),$.dependencyTracker?.restore(),I.restore(),L||P){const at=N.canvas;L&&(D=u),P&&(M=f);const ut=this.getSizeAndScale(D,this.ctx.canvas.width,_),k=this.getSizeAndScale(M,this.ctx.canvas.height,R),j=ut.size,K=k.size,st=t.cachedCanvases.getCanvas("pattern-workaround",j,K),ht=st.context,J=L?Math.floor(b/u):0,V=P?Math.floor(w/f):0;for(let rt=0;rt<=J;rt++)for(let lt=0;lt<=V;lt++)ht.drawImage(at,j*rt,K*lt,j,K,0,0,j,K);return{canvas:st.canvas,scaleX:ut.scale,scaleY:k.scale,offsetX:p,offsetY:m}}return{canvas:N.canvas,scaleX:Q.scale,scaleY:nt.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,i){const n=Math.max(Ep.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*i);return r>=n?r=n:i=r/t,{scale:i,size:r}}clipBbox(t,e,i,n,r){const a=n-e,l=r-i;t.ctx.rect(e,i,a,l),mt.axialAlignedBoundingBox([e,i,n,r],be(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,r=t.current;switch(e){case jb.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;n.fillStyle=r.fillColor=a,n.strokeStyle=r.strokeColor=l;break;case jb.UNCOLORED:n.fillStyle=n.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new OC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,n,r){let a=i;n!==ii.SHADING&&(a=mt.transform(a,e.baseTransform),this.matrix&&(a=mt.transform(a,this.matrix)));const l=this.createPatternCanvas(e,r);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=t.createPattern(l.canvas,"repeat");return u.setTransform(c),u}}function bx({src:d,srcPos:t=0,dest:e,width:i,height:n,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const l=ni.isLittleEndian?4278190080:255,[c,u]=a?[r,l]:[l,r],f=i>>3,p=i&7,m=d.length;e=new Uint32Array(e.buffer);let v=0;for(let S=0;S<n;S++){for(const w=t+f;t<w;t++){const E=t<m?d[t]:255;e[v++]=E&128?u:c,e[v++]=E&64?u:c,e[v++]=E&32?u:c,e[v++]=E&16?u:c,e[v++]=E&8?u:c,e[v++]=E&4?u:c,e[v++]=E&2?u:c,e[v++]=E&1?u:c}if(p===0)continue;const b=t<m?d[t++]:255;for(let w=0;w<p;w++)e[v++]=b&1<<7-w?u:c}return{srcPos:t,destPos:v}}const $b=16,Gb=100,Ax=15,Vb=10,Ri=16,mf=new DOMMatrix,Hi=new Float32Array(2),fa=new Float32Array([1/0,1/0,-1/0,-1/0]);function Sx(d,t){if(d._removeMirroring)throw new Error("Context is already forwarding operations.");d.__originalSave=d.save,d.__originalRestore=d.restore,d.__originalRotate=d.rotate,d.__originalScale=d.scale,d.__originalTranslate=d.translate,d.__originalTransform=d.transform,d.__originalSetTransform=d.setTransform,d.__originalResetTransform=d.resetTransform,d.__originalClip=d.clip,d.__originalMoveTo=d.moveTo,d.__originalLineTo=d.lineTo,d.__originalBezierCurveTo=d.bezierCurveTo,d.__originalRect=d.rect,d.__originalClosePath=d.closePath,d.__originalBeginPath=d.beginPath,d._removeMirroring=()=>{d.save=d.__originalSave,d.restore=d.__originalRestore,d.rotate=d.__originalRotate,d.scale=d.__originalScale,d.translate=d.__originalTranslate,d.transform=d.__originalTransform,d.setTransform=d.__originalSetTransform,d.resetTransform=d.__originalResetTransform,d.clip=d.__originalClip,d.moveTo=d.__originalMoveTo,d.lineTo=d.__originalLineTo,d.bezierCurveTo=d.__originalBezierCurveTo,d.rect=d.__originalRect,d.closePath=d.__originalClosePath,d.beginPath=d.__originalBeginPath,delete d._removeMirroring},d.save=function(){t.save(),this.__originalSave()},d.restore=function(){t.restore(),this.__originalRestore()},d.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},d.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},d.transform=function(e,i,n,r,a,l){t.transform(e,i,n,r,a,l),this.__originalTransform(e,i,n,r,a,l)},d.setTransform=function(e,i,n,r,a,l){t.setTransform(e,i,n,r,a,l),this.__originalSetTransform(e,i,n,r,a,l)},d.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},d.rotate=function(e){t.rotate(e),this.__originalRotate(e)},d.clip=function(e){t.clip(e),this.__originalClip(e)},d.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},d.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},d.bezierCurveTo=function(e,i,n,r,a,l){t.bezierCurveTo(e,i,n,r,a,l),this.__originalBezierCurveTo(e,i,n,r,a,l)},d.rect=function(e,i,n,r){t.rect(e,i,n,r),this.__originalRect(e,i,n,r)},d.closePath=function(){t.closePath(),this.__originalClosePath()},d.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Ex{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Vc(d,t,e,i,n,r,a,l,c,u){const[f,p,m,v,S,b]=be(d);if(p===0&&m===0){const C=a*f+S,T=Math.round(C),_=l*v+b,R=Math.round(_),D=(a+c)*f+S,M=Math.abs(Math.round(D)-T)||1,L=(l+u)*v+b,P=Math.abs(Math.round(L)-R)||1;return d.setTransform(Math.sign(f),0,0,Math.sign(v),T,R),d.drawImage(t,e,i,n,r,0,0,M,P),d.setTransform(f,p,m,v,S,b),[M,P]}if(f===0&&v===0){const C=l*m+S,T=Math.round(C),_=a*p+b,R=Math.round(_),D=(l+u)*m+S,M=Math.abs(Math.round(D)-T)||1,L=(a+c)*p+b,P=Math.abs(Math.round(L)-R)||1;return d.setTransform(0,Math.sign(p),Math.sign(m),0,T,R),d.drawImage(t,e,i,n,r,0,0,P,M),d.setTransform(f,p,m,v,S,b),[P,M]}d.drawImage(t,e,i,n,r,a,l,c,u);const w=Math.hypot(f,p),E=Math.hypot(m,v);return[w*c,E*u]}class Xb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Ff;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Je.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=fa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=ii.FILL,e=null){const i=this.minMax.slice();if(t===ii.STROKE){e||ue("Stroke bounding box must include transform."),mt.singularValueDecompose2dScale(e,Hi);const n=Hi[0]*this.lineWidth/2,r=Hi[1]*this.lineWidth/2;i[0]-=n,i[1]-=r,i[2]+=n,i[3]+=r}return i}updateClipFromPath(){const t=mt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(fa,0)}getClippedPathBoundingBox(t=ii.FILL,e=null){return mt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Yb(d,t){if(t instanceof ImageData){d.putImageData(t,0,0);return}const e=t.height,i=t.width,n=e%Ri,r=(e-n)/Ri,a=n===0?r:r+1,l=d.createImageData(i,Ri);let c=0,u;const f=t.data,p=l.data;let m,v,S,b;if(t.kind===eh.GRAYSCALE_1BPP){const w=f.byteLength,E=new Uint32Array(p.buffer,0,p.byteLength>>2),C=E.length,T=i+7>>3,_=4294967295,R=ni.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(S=m<r?Ri:n,u=0,v=0;v<S;v++){const D=w-c;let M=0;const L=D>T?i:D*8-7,P=L&-8;let B=0,U=0;for(;M<P;M+=8)U=f[c++],E[u++]=U&128?_:R,E[u++]=U&64?_:R,E[u++]=U&32?_:R,E[u++]=U&16?_:R,E[u++]=U&8?_:R,E[u++]=U&4?_:R,E[u++]=U&2?_:R,E[u++]=U&1?_:R;for(;M<L;M++)B===0&&(U=f[c++],B=128),E[u++]=U&B?_:R,B>>=1}for(;u<C;)E[u++]=0;d.putImageData(l,0,m*Ri)}}else if(t.kind===eh.RGBA_32BPP){for(v=0,b=i*Ri*4,m=0;m<r;m++)p.set(f.subarray(c,c+b)),c+=b,d.putImageData(l,0,v),v+=Ri;m<a&&(b=i*n*4,p.set(f.subarray(c,c+b)),d.putImageData(l,0,v))}else if(t.kind===eh.RGB_24BPP)for(S=Ri,b=i*S,m=0;m<a;m++){for(m>=r&&(S=n,b=i*S),u=0,v=b;v--;)p[u++]=f[c++],p[u++]=f[c++],p[u++]=f[c++],p[u++]=255;d.putImageData(l,0,m*Ri)}else throw new Error(`bad image kind: ${t.kind}`)}function Wb(d,t){if(t.bitmap){d.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,n=e%Ri,r=(e-n)/Ri,a=n===0?r:r+1,l=d.createImageData(i,Ri);let c=0;const u=t.data,f=l.data;for(let p=0;p<a;p++){const m=p<r?Ri:n;({srcPos:c}=bx({src:u,srcPos:c,dest:f,width:i,height:m,nonBlackColor:0})),d.putImageData(l,0,p*Ri)}}function _o(d,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)d[i]!==void 0&&(t[i]=d[i]);d.setLineDash!==void 0&&(t.setLineDash(d.getLineDash()),t.lineDashOffset=d.lineDashOffset)}function Xc(d){d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0);const{filter:t}=d;t!=="none"&&t!==""&&(d.filter="none")}function Kb(d,t){if(t)return!0;mt.singularValueDecompose2dScale(d,Hi);const e=Math.fround(_n.pixelRatio*Ca.PDF_TO_CSS_UNITS);return Hi[0]<=e&&Hi[1]<=e}const wx=["butt","round","square"],Tx=["miter","round","bevel"],Cx={},qb={};class va{constructor(t,e,i,n,r,{optionalContentConfig:a,markedContentStack:l=null},c,u,f){this.ctx=t,this.current=new Xb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new Ex(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=f??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=l,i){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...be(this.compositeCtx))}this.ctx.save(),Xc(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=be(this.ctx)}executeOperatorList(t,e,i,n,r){const a=t.argsArray,l=t.fnArray;let c=e||0;const u=a.length;if(u===c)return c;const f=u-c>Vb&&typeof i=="function",p=f?Date.now()+Ax:0;let m=0;const v=this.commonObjs,S=this.objs;let b,w;for(;;){if(n!==void 0&&c===n.nextBreakPoint)return n.breakIt(c,i),c;if(!r||r(c))if(b=l[c],w=a[c]??null,b!==Wo.dependency)w===null?this[b](c):this[b](c,...w);else for(const E of w){this.dependencyTracker?.recordNamedData(E,c);const C=E.startsWith("g_")?v:S;if(!C.has(E))return C.get(E,i),c}if(c++,c===u)return c;if(f&&++m>Vb){if(Date.now()>p)return i(),c;m=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,n=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=i,c=n,u="prescale1",f,p;for(;r>2&&l>1||a>2&&c>1;){let m=l,v=c;r>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/m),a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/v),f=this.cachedCanvases.getCanvas(u,m,v),p=f.context,p.clearRect(0,0,m,v),p.drawImage(t,0,0,l,c,0,0,m,v),t=f.canvas,l=m,c=v,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t,e){const i=this.ctx,{width:n,height:r}=e,a=this.current.fillColor,l=this.current.patternFill,c=be(i);let u,f,p,m;if((e.bitmap||e.data)&&e.count>1){const B=e.bitmap||e.data.buffer;f=JSON.stringify(l?c:[c.slice(0,4),a]),u=this._cachedBitmapsMap.get(B),u||(u=new Map,this._cachedBitmapsMap.set(B,u));const U=u.get(f);if(U&&!l){const Z=Math.round(Math.min(c[0],c[2])+c[4]),q=Math.round(Math.min(c[1],c[3])+c[5]);return this.dependencyTracker?.recordDependencies(t,sn.transformAndFill),{canvas:U,offsetX:Z,offsetY:q}}p=U}p||(m=this.cachedCanvases.getCanvas("maskCanvas",n,r),Wb(m.context,e));let v=mt.transform(c,[1/n,0,0,-1/r,0,0]);v=mt.transform(v,[1,0,0,1,0,-r]);const S=fa.slice();mt.axialAlignedBoundingBox([0,0,n,r],v,S);const[b,w,E,C]=S,T=Math.round(E-b)||1,_=Math.round(C-w)||1,R=this.cachedCanvases.getCanvas("fillCanvas",T,_),D=R.context,M=b,L=w;D.translate(-M,-L),D.transform(...v),p||(p=this._scaleImage(m.canvas,En(D)),p=p.img,u&&l&&u.set(f,p)),D.imageSmoothingEnabled=Kb(be(D),e.interpolate),Vc(D,p,0,0,p.width,p.height,0,0,n,r),D.globalCompositeOperation="source-in";const P=mt.transform(En(D),[1,0,0,1,-M,-L]);return D.fillStyle=l?a.getPattern(i,this,P,ii.FILL,t):a,D.fillRect(0,0,n,r),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(f,R.canvas)),this.dependencyTracker?.recordDependencies(t,sn.transformAndFill),{canvas:R.canvas,offsetX:Math.round(M),offsetY:Math.round(L)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=wx[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Tx[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,n]of e)switch(i){case"LW":this.setLineWidth(t,n);break;case"LC":this.setLineCap(t,n);break;case"LJ":this.setLineJoin(t,n);break;case"ML":this.setMiterLimit(t,n);break;case"D":this.setDash(t,n[0],n[1]);break;case"RI":this.setRenderingIntent(t,n);break;case"FL":this.setFlatness(t,n);break;case"Font":this.setFont(t,n[0],n[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=n;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=n;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,i);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),_o(this.suspendedCtx,a),Sx(a,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),_o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const r=n[0],a=n[1],l=n[2]-r,c=n[3]-a;l===0||c===0||(this.genericComposeSMask(e.context,i,l,c,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,r,a,l,c,u,f,p){let m=t.canvas,v=c-f,S=u-p;if(a)if(v<0||S<0||v+i>m.width||S+n>m.height){const w=this.cachedCanvases.getCanvas("maskExtension",i,n),E=w.context;E.drawImage(m,-v,-S),E.globalCompositeOperation="destination-atop",E.fillStyle=a,E.fillRect(0,0,i,n),E.globalCompositeOperation="source-over",m=w.canvas,v=S=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(v,S,i,n),t.clip(w),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(v,S,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const b=new Path2D;b.rect(c,u,i,n),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(m,v,S,i,n,c,u,i,n),e.restore()}save(t){this.inSMaskMode&&_o(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&_o(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,n,r,a,l){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,n,r,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,n){let[r]=i;if(!n){r||=i[0]=new Path2D,this[e](t,r);return}if(this.dependencyTracker!==null){const a=e===Wo.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-a,n[2]+a,n[1]-a,n[3]+a).recordDependencies(t,["transform"])}if(!(r instanceof Path2D)){const a=i[0]=new Path2D;for(let l=0,c=r.length;l<c;)switch(r[l++]){case Uc.moveTo:a.moveTo(r[l++],r[l++]);break;case Uc.lineTo:a.lineTo(r[l++],r[l++]);break;case Uc.curveTo:a.bezierCurveTo(r[l++],r[l++],r[l++],r[l++],r[l++],r[l++]);break;case Uc.closePath:a.closePath();break;default:xt(`Unrecognized drawing path operator: ${r[l-1]}`);break}r=a}mt.axialAlignedBoundingBox(n,be(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const n=this.ctx,r=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const a=r.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=r.getPattern(n,this,En(n),ii.STROKE,t),a){const l=new Path2D;l.addPath(e,n.getTransform().invertSelf().multiplySelf(a)),e=l}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,sn.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(ii.STROKE,be(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const n=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const u=r.isModifyingCurrentTransform()?n.getTransform():null;if(this.dependencyTracker?.save(t),n.save(),n.fillStyle=r.getPattern(n,this,En(n),ii.FILL,t),u){const f=new Path2D;f.addPath(e,n.getTransform().invertSelf().multiplySelf(u)),e=f}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),this.dependencyTracker?.recordDependencies(t,sn.fill),l&&(n.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,c)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,sn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Cx}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=qb}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;e!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",t),n.recordCloseMarker(t)}if(e!==void 0){const n=new Path2D,r=i.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:u,path:f}of e)f&&n.addPath(f,new DOMMatrix(a).preMultiplySelf(r).translate(l,c).scale(u,-u));i.clip(n)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||Ff,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&xt("Invalid font matrix for font "+e),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=n.systemFontInfo?.css||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const u=n.italic?"italic":"normal";let f=i;i<$b?f=$b:i>Gb&&(f=Gb),this.current.fontSizeScale=i/f,this.ctx.font=`${u} ${c} ${f}px ${l}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,i){const n=new Path2D;return n.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),n}paintChar(t,e,i,n,r,a){const l=this.ctx,c=this.current,u=c.font,f=c.textRenderingMode,p=c.fontSize/c.fontSizeScale,m=f&Je.FILL_STROKE_MASK,v=!!(f&Je.ADD_TO_PATH_FLAG),S=c.patternFill&&!u.missingFile,b=c.patternStroke&&!u.missingFile;let w;if((u.disableFontFace||v||S||b)&&!u.missingFile&&(w=u.getPathGenerator(this.commonObjs,e)),w&&(u.disableFontFace||S||b)){l.save(),l.translate(i,n),l.scale(p,-p),this.dependencyTracker?.recordCharacterBBox(t,l,u);let E;if(m===Je.FILL||m===Je.FILL_STROKE)if(r){E=l.getTransform(),l.setTransform(...r);const C=this.#n(w,E,r);l.fill(C)}else l.fill(w);if(m===Je.STROKE||m===Je.FILL_STROKE)if(a){E||=l.getTransform(),l.setTransform(...a);const{a:C,b:T,c:_,d:R}=E,D=mt.inverseTransform(a),M=mt.transform([C,T,_,R,0,0],D);mt.singularValueDecompose2dScale(M,Hi),l.lineWidth*=Math.max(Hi[0],Hi[1])/p,l.stroke(this.#n(w,E,a))}else l.lineWidth/=p,l.stroke(w);l.restore()}else(m===Je.FILL||m===Je.FILL_STROKE)&&(l.fillText(e,i,n),this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n,()=>l.measureText(e))),(m===Je.STROKE||m===Je.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n,()=>l.measureText(e)).recordDependencies(t,sn.stroke),l.strokeText(e,i,n));v&&((this.pendingTextPaths||=[]).push({transform:be(l),x:i,y:n,fontSize:p,path:w}),this.dependencyTracker?.recordCharacterBBox(t,l,u,p,i,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return Ut(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,sn.showText).resetBBox(t),this.current.textRenderingMode&Je.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,n=i.font;if(n.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const r=i.fontSize;if(r===0){this.dependencyTracker?.recordOperation(t);return}const a=this.ctx,l=i.fontSizeScale,c=i.charSpacing,u=i.wordSpacing,f=i.fontDirection,p=i.textHScale*f,m=e.length,v=n.vertical,S=v?1:-1,b=n.defaultVMetrics,w=r*i.fontMatrix[0],E=i.textRenderingMode===Je.FILL&&!n.disableFontFace&&!i.patternFill;a.save(),i.textMatrix&&a.transform(...i.textMatrix),a.translate(i.x,i.y+i.textRise),f>0?a.scale(p,-1):a.scale(p,1);let C,T;if(i.patternFill){a.save();const L=i.fillColor.getPattern(a,this,En(a),ii.FILL,t);C=be(a),a.restore(),a.fillStyle=L}if(i.patternStroke){a.save();const L=i.strokeColor.getPattern(a,this,En(a),ii.STROKE,t);T=be(a),a.restore(),a.strokeStyle=L}let _=i.lineWidth;const R=i.textMatrixScale;if(R===0||_===0){const L=i.textRenderingMode&Je.FILL_STROKE_MASK;(L===Je.STROKE||L===Je.FILL_STROKE)&&(_=this.getSinglePixelWidth())}else _/=R;if(l!==1&&(a.scale(l,l),_/=l),a.lineWidth=_,n.isInvalidPDFjsFont){const L=[];let P=0;for(const U of e)L.push(U.unicode),P+=U.width;const B=L.join("");if(a.fillText(B,0,0),this.dependencyTracker!==null){const U=a.measureText(B);this.dependencyTracker.recordBBox(t,this.ctx,-U.actualBoundingBoxLeft,U.actualBoundingBoxRight,-U.actualBoundingBoxAscent,U.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=P*w*p,a.restore(),this.compose();return}let D=0,M;for(M=0;M<m;++M){const L=e[M];if(typeof L=="number"){D+=S*L*r/1e3;continue}let P=!1;const B=(L.isSpace?u:0)+c,U=L.fontChar,Z=L.accent;let q,Q,nt=L.width;if(v){const $=L.vmetric||b,at=-(L.vmetric?$[1]:nt*.5)*w,ut=$[2]*w;nt=$?-$[0]:nt,q=at/l,Q=(D+ut)/l}else q=D/l,Q=0;let N;if(n.remeasure&&nt>0){N=a.measureText(U);const $=N.width*1e3/r*l;if(nt<$&&this.isFontSubpixelAAEnabled){const at=nt/$;P=!0,a.save(),a.scale(at,1),q/=at}else nt!==$&&(q+=(nt-$)/2e3*r/l)}if(this.contentVisible&&(L.isInFont||n.missingFile)){if(E&&!Z)a.fillText(U,q,Q),this.dependencyTracker?.recordCharacterBBox(t,a,N?{bbox:null}:n,r/l,q,Q,()=>N??a.measureText(U));else if(this.paintChar(t,U,q,Q,C,T),Z){const $=q+r*Z.offset.x/l,at=Q-r*Z.offset.y/l;this.paintChar(t,Z.fontChar,$,at,C,T)}}const I=v?nt*w-B*f:nt*w+B*f;D+=I,P&&a.restore()}v?i.y-=D:i.x+=D*p,a.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,n=this.current,r=n.font,a=n.fontSize,l=n.fontDirection,c=r.vertical?1:-1,u=n.charSpacing,f=n.wordSpacing,p=n.textHScale*l,m=n.fontMatrix||Ff,v=e.length,S=n.textRenderingMode===Je.INVISIBLE;let b,w,E,C;if(S||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(p,l);const T=this.dependencyTracker;for(this.dependencyTracker=T?new ch(T,t):null,b=0;b<v;++b){if(w=e[b],typeof w=="number"){C=c*w*a/1e3,this.ctx.translate(C,0),n.x+=C*p;continue}const _=(w.isSpace?f:0)+u,R=r.charProcOperatorList[w.operatorListId];R?this.contentVisible&&(this.save(),i.scale(a,a),i.transform(...m),this.executeOperatorList(R),this.restore()):xt(`Type3 character "${w.operatorListId}" is not available.`);const D=[w.width,0];mt.applyTransform(D,m),E=D[0]*a+_,i.translate(E,0),n.x+=E*p}i.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,n,r,a,l){const c=new Path2D;c.rect(n,r,a-n,l-r),this.ctx.clip(c),this.dependencyTracker?.recordBBox(t,this.ctx,n,a,r,l).recordClipBox(t,this.ctx,n,a,r,l),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const n=this.baseTransform||be(this.ctx),r={createCanvasGraphics:(a,l)=>new va(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new ch(this.dependencyTracker,l,!0):null)};i=new Ep(e,this.ctx,r,n)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=yx(this.getObject(t,e)),this.cachedPatterns.set(e,n)),i&&(n.matrix=i),n}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const n=this._getPattern(t,e);i.fillStyle=n.getPattern(i,this,En(i),ii.SHADING,t);const r=En(i);if(r){const{width:a,height:l}=i.canvas,c=fa.slice();mt.axialAlignedBoundingBox([0,0,a,l],r,c);const[u,f,p,m]=c;this.ctx.fillRect(u,f,p-u,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,sn.transform).recordDependencies(t,sn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){ue("Should not call beginInlineImage")}beginImageData(){ue("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=be(this.ctx),i)){mt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[n,r,a,l]=i,c=new Path2D;c.rect(n,r,a-n,l-r),this.ctx.clip(c),this.dependencyTracker?.recordClipBox(t,this.ctx,n,a,r,l),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||Th("TODO: Support non-isolated groups."),e.knockout&&xt("Knockout groups not supported.");const n=be(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=fa.slice();mt.axialAlignedBoundingBox(e.bbox,be(i),r);const a=[0,0,i.canvas.width,i.canvas.height];r=mt.intersect(r,a)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-l,1),f=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,f]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(p,u,f),v=m.context;v.translate(-l,-c),v.transform(...n);let S=new Path2D;const[b,w,E,C]=e.bbox;if(S.rect(b,w,E-b,C-w),e.matrix){const T=new Path2D;T.addPath(S,new DOMMatrix(e.matrix)),S=T}v.clip(S),e.smask&&this.smaskStack.push({canvas:m.canvas,context:v,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(l,c),i.save()),_o(i,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const r=be(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...r);const a=fa.slice();mt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],r,a),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(t,e,i,n,r,a){if(this.#t(),Xc(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const l=i[2]-i[0],c=i[3]-i[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=i[0],n[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=l,i[3]=c,mt.singularValueDecompose2dScale(be(this.ctx),Hi);const{viewportScale:u}=this,f=Math.ceil(l*this.outputScaleX*u),p=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(Hi[0],0,0,-Hi[1],0,c*Hi[1]),Xc(this.ctx)}else{Xc(this.ctx),this.endPath(t);const u=new Path2D;u.rect(i[0],i[1],l,c),this.ctx.clip(u)}}this.current=new Xb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const n=this.ctx,r=this._createMaskCanvas(t,e),a=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,r.offsetX,r.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,n=0,r=0,a,l){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const c=this.ctx;c.save();const u=be(c);c.transform(i,n,r,a,0,0);const f=this._createMaskCanvas(t,e);c.setTransform(1,0,0,1,f.offsetX-u[4],f.offsetY-u[5]),this.dependencyTracker?.resetBBox(t);for(let p=0,m=l.length;p<m;p+=2){const v=mt.transform(u,[i,n,r,a,l[p],l[p+1]]);c.drawImage(f.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(t,this.ctx,v[4],v[4]+f.canvas.width,v[5],v[5]+f.canvas.height)}c.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,r=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,sn.transformAndFill);for(const a of e){const{data:l,width:c,height:u,transform:f}=a,p=this.cachedCanvases.getCanvas("maskCanvas",c,u),m=p.context;m.save();const v=this.getObject(t,l,a);Wb(m,v),m.globalCompositeOperation="source-in",m.fillStyle=r?n.getPattern(m,this,En(i),ii.FILL,t):n,m.fillRect(0,0,c,u),m.restore(),i.save(),i.transform(...f),i.scale(1,-1),Vc(i,p.canvas,0,0,c,u,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,c,0,u),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){xt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,n,r){if(!this.contentVisible)return;const a=this.getObject(t,e);if(!a){xt("Dependent image isn't ready yet");return}const l=a.width,c=a.height,u=[];for(let f=0,p=r.length;f<p;f+=2)u.push({transform:[i,0,0,n,r[f],r[f+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(t,a,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:n}=t,r=this.cachedCanvases.getCanvas("inlineImage",i,n),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,n=e.height,r=this.ctx;this.save(t);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/i,-1/n);let l;if(e.bitmap)l=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)l=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",i,n).context;Yb(f,e),l=this.applyTransferMapsToCanvas(f)}const c=this._scaleImage(l,En(r));r.imageSmoothingEnabled=Kb(be(r),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,r,0,i,-n,0).recordDependencies(t,sn.imageXObject).recordOperation(t),Vc(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,i,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const a=e.width,l=e.height,u=this.cachedCanvases.getCanvas("inlineImage",a,l).context;Yb(u,e),r=this.applyTransferMapsToCanvas(u)}this.dependencyTracker?.resetBBox(t);for(const a of i)n.save(),n.transform(...a.transform),n.scale(1,-1),Vc(n,r,a.x,a.y,a.w,a.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,1,-1,0),n.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,sn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(n||(this.pendingClip===qb?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=be(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:r}=this.ctx.getTransform();let a,l;if(i===0&&n===0){const c=Math.abs(e),u=Math.abs(r);if(c===u)if(t===0)a=l=1/c;else{const f=c*t;a=l=f<1?1/f:1}else if(t===0)a=1/c,l=1/u;else{const f=c*t,p=u*t;a=f<1?1/f:1,l=p<1?1/p:1}}else{const c=Math.abs(e*r-i*n),u=Math.hypot(e,i),f=Math.hypot(n,r);if(t===0)a=f/c,l=u/c;else{const p=t*c;a=f>p?f/p:1,l=u>p?u/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:n}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(n||1)*r,i.stroke(t);return}const l=i.getLineDash();e&&i.save(),i.scale(r,a),mf.a=1/r,mf.d=1/a;const c=new Path2D;if(c.addPath(t,mf),l.length>0){const u=Math.max(r,a);i.setLineDash(l.map(f=>f/u)),i.lineDashOffset/=u}i.lineWidth=n||1,i.stroke(c),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const d in Wo)va.prototype[d]!==void 0&&(va.prototype[Wo[d]]=va.prototype[d]);class ya{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let n=0;for(const u of ya.strings){const f=e.encode(t[u]);i[u]=f,n+=4+f.length}const r=new ArrayBuffer(n),a=new Uint8Array(r),l=new DataView(r);let c=0;for(const u of ya.strings){const f=i[u],p=f.length;l.setUint32(c,p),a.set(f,c+4),c+=4+p}return Kt(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Kt(t<ya.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ba{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let n=0;for(const m of ba.strings){const v=e.encode(t[m]);i[m]=v,n+=4+v.length}n+=4;let r,a,l=1+n;t.style&&(r=e.encode(t.style.style),a=e.encode(t.style.weight),l+=4+r.length+4+a.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),f=new DataView(c);let p=0;f.setUint8(p++,t.guessFallback?1:0),f.setUint32(p,0),p+=4,n=0;for(const m of ba.strings){const v=i[m],S=v.length;n+=4+S,f.setUint32(p,S),u.set(v,p+4),p+=4+S}return f.setUint32(p-n-4,n),t.style&&(f.setUint32(p,r.length),u.set(r,p+4),p+=4+r.length,f.setUint32(p,a.length),u.set(a,p+4),p+=4+a.length),Kt(p<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(p)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Kt(t<ba.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#n.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const n=this.#e.getUint32(t),r=this.#n.decode(new Uint8Array(this.#t,t+4,n));return{style:i,weight:r}}}class re{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#a=this.#i+1+6;#s;#r;#o;constructor({data:t,extra:e}){this.#s=t,this.#r=new TextDecoder,this.#o=new DataView(this.#s),e&&Object.assign(this,e)}#c(t){Kt(t<re.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,n=this.#o.getUint8(e)>>i&3;return n===0?void 0:n===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Kt(t<re.numbers.length,"Invalid number index"),this.#o.getFloat64(re.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=re.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<4;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=re.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<6;n++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=re.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let n=0;n<3;n++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Kt(t<re.strings.length,"Invalid string index");let e=re.#a+4;for(let r=0;r<t;r++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),n=new Uint8Array(i);return n.set(new Uint8Array(this.#s,e+4,i)),this.#r.decode(n)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=re.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);if(r!==0)return new Uint8Array(this.#s,t+4,r)}clearData(){let t=re.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);t+=4+n;const r=this.#o.getUint32(t);new Uint8Array(this.#s,t+4,r).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=re.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const n=this.#o.getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(this.#s,t+4,n)),new ya(r.buffer)}get systemFontInfo(){let t=re.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const n=new Uint8Array(i);return n.set(new Uint8Array(this.#s,t+4,i)),new ba(n.buffer)}static write(t){const e=t.systemFontInfo?ba.write(t.systemFontInfo):null,i=t.cssFontInfo?ya.write(t.cssFontInfo):null,n=new TextEncoder,r={};let a=0;for(const b of re.strings)r[b]=n.encode(t[b]),a+=4+r[b].length;const l=re.#a+4+a+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),f=new DataView(c);let p=0;const m=re.bools.length;let v=0,S=0;for(let b=0;b<m;b++){const w=t[re.bools[b]];v|=(w===void 0?0:w?2:1)<<S,S+=2,(S===8||b===m-1)&&(f.setUint8(p++,v),v=0,S=0)}Kt(p===re.#t,"FontInfo.write: Boolean properties offset mismatch");for(const b of re.numbers)f.setFloat64(p,t[b]),p+=8;if(Kt(p===re.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){f.setUint8(p++,4);for(const b of t.bbox)f.setInt16(p,b,!0),p+=2}else f.setUint8(p++,0),p+=8;if(Kt(p===re.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){f.setUint8(p++,6);for(const b of t.fontMatrix)f.setFloat64(p,b,!0),p+=8}else f.setUint8(p++,0),p+=48;if(Kt(p===re.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){f.setUint8(p++,1);for(const b of t.defaultVMetrics)f.setInt16(p,b,!0),p+=2}else f.setUint8(p++,0),p+=6;Kt(p===re.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),f.setUint32(re.#a,0),p+=4;for(const b of re.strings){const w=r[b],E=w.length;f.setUint32(p,E),u.set(w,p+4),p+=4+E}if(f.setUint32(re.#a,p-re.#a-4),!e)f.setUint32(p,0),p+=4;else{const b=e.byteLength;f.setUint32(p,b),Kt(p+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(e),p+4),p+=4+b}if(!i)f.setUint32(p,0),p+=4;else{const b=i.byteLength;f.setUint32(p,b),Kt(p+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(i),p+4),p+=4+b}return t.data===void 0?(f.setUint32(p,0),p+=4):(f.setUint32(p,t.data.length),u.set(t.data,p+4),p+=4+t.data.length),Kt(p<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(p)}}class jo{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class xx{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ha=Symbol("INTERNAL");class Rx{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:i,usage:n,rbGroups:r}){this.#t=!!(t&Bi.DISPLAY),this.#e=!!(t&Bi.PRINT),this.name=e,this.intent=i,this.usage=n,this.rbGroups=r}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==ha&&ue("Internal method `_setVisible` called."),this.#n=i,this.#i=e}}class _x{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=Bi.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new Rx(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(ha,!1);for(const i of t.on)this.#e.get(i)._setVisible(ha,!0);for(const i of t.off)this.#e.get(i)._setVisible(ha,!1);this.#n=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const r=t[n];let a;if(Array.isArray(r))a=this.#a(r);else if(this.#e.has(r))a=this.#e.get(r).visible;else return xt(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Th("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(xt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return xt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return xt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return xt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return xt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return xt(`Unknown optional content policy ${t.policy}.`),!0}return xt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const n=this.#e.get(t);if(!n){xt(`Optional content group not found: ${t}`);return}if(i&&e&&n.rbGroups.length)for(const r of n.rbGroups)for(const a of r)a!==t&&this.#e.get(a)?._setVisible(ha,!1,!0);n._setVisible(ha,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const r=this.#e.get(n);if(r)switch(i){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new RA;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Dx{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Kt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,r?.length>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const n=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(i),!0)});Kt(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Kt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Mx(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Ox(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class Mx{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=mp(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ox{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Lx(d){let t=!0,e=i("filename\\*","i").exec(d);if(e){e=e[1];let f=l(e);return f=unescape(f),f=c(f),f=u(f),r(f)}if(e=a(d),e){const f=u(e);return r(f)}if(e=i("filename","i").exec(d),e){e=e[1];let f=l(e);return f=u(f),r(f)}function i(f,p){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function n(f,p){if(f){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(f,{fatal:!0}),v=rl(p);p=m.decode(v),t=!1}catch{}}return p}function r(f){return t&&/[\x80-\xff]/.test(f)&&(f=n("utf-8",f),t&&(f=n("iso-8859-1",f))),f}function a(f){const p=[];let m;const v=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(f))!==null;){let[,b,w,E]=m;if(b=parseInt(b,10),b in p){if(b===0)break;continue}p[b]=[w,E]}const S=[];for(let b=0;b<p.length&&b in p;++b){let[w,E]=p[b];E=l(E),w&&(E=unescape(E),b===0&&(E=c(E))),S.push(E)}return S.join("")}function l(f){if(f.startsWith('"')){const p=f.slice(1).split('\\"');for(let m=0;m<p.length;++m){const v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}f=p.join('"')}return f}function c(f){const p=f.indexOf("'");if(p===-1)return f;const m=f.slice(0,p),S=f.slice(p+1).replace(/^[^']*'/,"");return n(m,S)}function u(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,S){if(v==="q"||v==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,w){return String.fromCharCode(parseInt(w,16))}),n(m,S);try{S=atob(S)}catch{}return n(m,S)})}return""}function NA(d,t){const e=new Headers;if(!d||!t||typeof t!="object")return e;for(const i in t){const n=t[i];n!==void 0&&e.append(i,n)}return e}function Rh(d){return URL.parse(d)?.origin??null}function IA({responseHeaders:d,isHttp:t,rangeChunkSize:e,disableRange:i}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(d.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*e)||i||!t||d.get("Accept-Ranges")!=="bytes"||(d.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function kA(d){const t=d.get("Content-Disposition");if(t){let e=Lx(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(mp(e))return e}return null}function hl(d,t){return new lh(`Unexpected server response (${d}) while retrieving PDF "${t}".`,d,d===404||d===0&&t.startsWith("file:"))}function FA(d){return d===200||d===206}function BA(d,t,e){return{method:"GET",headers:d,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function UA(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:(xt(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class Px{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=NA(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Nx(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Ix(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Nx{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),n=e.url;fetch(n,BA(i,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=Rh(r.url),!FA(r.status))throw hl(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:l,suggestedLength:c}=IA({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=kA(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ns("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:UA(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Ix{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${i-1}`);const a=n.url;fetch(a,BA(r,this._withCredentials,this._abortController)).then(l=>{const c=Rh(l.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!FA(l.status))throw hl(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:UA(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const vf=200,yf=206;function kx(d){const t=d.response;return typeof t!="string"?t:rl(t).buffer}class Fx{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=NA(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,a]of this.headers)e.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=yf):n.expectedStatus=vf,e.responseType="arraybuffer",Kt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){i.onError(n.status);return}const r=n.status||vf;if(!(r===vf&&i.expectedStatus===yf)&&r!==i.expectedStatus){i.onError(n.status);return}const l=kx(n);if(r===yf){const c=n.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?i.onDone({begin:parseInt(u[1],10),chunk:l}):(xt('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone({begin:0,chunk:l}):i.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Bx{constructor(t){this._source=t,this._manager=new Fx(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Kt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Ux(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new Hx(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Ux{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Rh(e.responseURL);const i=e.getAllResponseHeaders(),n=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=IA({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=kA(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=hl(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Hx{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Rh(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=hl(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const zx=/^[a-z][a-z0-9\-+.]+:/i;function jx(d){if(zx.test(d))return new URL(d);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(d))}class $x{constructor(t){this.source=t,this.url=jx(t.url),Kt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Gx(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Vx(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Gx{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=hl(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ns("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Vx{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Do=Symbol("INITIAL_DATA");class HA{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Do}}get(t,e=null){if(e){const n=this.#e(t);return n.promise.then(()=>e(n.data)),null}const i=this.#t[t];if(!i||i.data===Do)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Do}delete(t){const e=this.#t[t];return!e||e.data===Do?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Do&&(yield[t,e])}}}const Xx=1e5,Qb=30;class ui{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#s=null;#r=0;#o=0;#c=null;#l=null;#d=0;#u=0;#f=Object.create(null);#m=[];#p=null;#h=[];#g=new WeakMap;#v=null;static#b=new Map;static#y=new Map;static#C=new WeakMap;static#w=null;static#A=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(c){c.enqueue(t),c.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#u=i.scale*_n.pixelRatio,this.#d=i.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:r,pageX:a,pageY:l}=i.rawDims;this.#v=[1,0,0,-1,-a,l+r],this.#o=n,this.#r=r,ui.#D(),pr(e,i),this.#t.promise.finally(()=>{ui.#A.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ni.platform;return Ut(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#R(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),ui.#A.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*_n.pixelRatio,n=t.rotation;if(n!==this.#d&&(e?.(),this.#d=n,pr(this.#l,{rotation:n})),i!==this.#u){e?.(),this.#u=i;const r={div:null,properties:null,ctx:ui.#M(this.#a)};for(const a of this.#h)r.properties=this.#g.get(a),r.div=a,this.#T(r)}}cancel(){const t=new Ns("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#m}#R(t){if(this.#n)return;this.#s.ctx??=ui.#M(this.#a);const e=this.#h,i=this.#m;for(const n of t){if(e.length>Xx){xt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),n.id&&this.#e.setAttribute("id",`${n.id}`),r.append(this.#e)}else n.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(n.str),this.#E(n)}}#E(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const n=mt.transform(this.#v,t.transform);let r=Math.atan2(n[1],n[0]);const a=this.#f[t.fontName];a.vertical&&(r+=Math.PI/2);let l=this.#i&&a.fontSubstitution||a.fontFamily;l=ui.fontFamilyMap.get(l)||l;const c=Math.hypot(n[2],n[3]),u=c*ui.#F(l,a,this.#a);let f,p;r===0?(f=n[4],p=n[5]-u):(f=n[4]+u*Math.sin(r),p=n[5]-u*Math.cos(r));const m="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#l?(v.left=`${(100*f/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#r).toFixed(2)}%`):(v.left=`${m}${f.toFixed(2)}px)`,v.top=`${m}${p.toFixed(2)}px)`),v.fontSize=`${m}${(ui.#w*c).toFixed(2)}px)`,v.fontFamily=l,i.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),r!==0&&(i.angle=r*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const b=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);b!==w&&Math.max(b,w)/Math.min(b,w)>1.5&&(S=!0)}if(S&&(i.canvasWidth=a.vertical?t.height:t.width),this.#g.set(e,i),this.#s.div=e,this.#s.properties=i,this.#T(this.#s),i.hasText&&this.#e.append(e),i.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#e.append(b)}}#T(t){const{div:e,properties:i,ctx:n}=t,{style:r}=e;let a="";if(ui.#w>1&&(a=`scale(${1/ui.#w})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:u}=i;ui.#_(n,u*this.#u,l);const{width:f}=n.measureText(e.textContent);f>0&&(a=`scaleX(${c*this.#u/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)}static cleanup(){if(!(this.#A.size>0)){this.#b.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#M(t=null){let e=this.#y.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#C.set(e,{size:0,family:""})}return e}static#_(t,e,i){const n=this.#C.get(t);e===n.size&&i===n.family||(t.font=`${e}px ${i}`,n.size=e,n.family=i)}static#D(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#F(t,e,i){const n=this.#b.get(t);if(n)return n;const r=this.#M(i);r.canvas.width=r.canvas.height=Qb,this.#_(r,Qb,t);const a=r.measureText(""),l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return l?u=l/(l+c):(ni.platform.isFirefox&&xt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?u=e.ascent:e.descent&&(u=1+e.descent)),this.#b.set(t,u),u}}const Yx=100;function Wx(d={}){typeof d=="string"||d instanceof URL?d={url:d}:(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d={data:d});const t=new wp,{docId:e}=t,i=d.url?tx(d.url):null,n=d.data?ex(d.data):null,r=d.httpHeaders||null,a=d.withCredentials===!0,l=d.password??null,c=d.range instanceof zA?d.range:null,u=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:2**16;let f=d.worker instanceof qo?d.worker:null;const p=d.verbosity,m=typeof d.docBaseUrl=="string"&&!Ch(d.docBaseUrl)?d.docBaseUrl:null,v=zc(d.cMapUrl),S=d.cMapPacked!==!1,b=d.CMapReaderFactory||(fi?cx:Fb),w=zc(d.iccUrl),E=zc(d.standardFontDataUrl),C=d.StandardFontDataFactory||(fi?hx:Bb),T=zc(d.wasmUrl),_=d.WasmFactory||(fi?ux:Ub),R=d.stopAtErrors!==!0,D=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,M=d.isEvalSupported!==!1,L=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!fi,P=typeof d.isImageDecoderSupported=="boolean"?d.isImageDecoderSupported:!fi&&(ni.platform.isFirefox||!globalThis.chrome),B=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,U=typeof d.disableFontFace=="boolean"?d.disableFontFace:fi,Z=d.fontExtraProperties===!0,q=d.enableXfa===!0,Q=d.ownerDocument||globalThis.document,nt=d.disableRange===!0,N=d.disableStream===!0,I=d.disableAutoFetch===!0,$=d.pdfBug===!0,at=d.CanvasFactory||(fi?lx:rx),ut=d.FilterFactory||(fi?ox:ax),k=d.enableHWA===!0,j=d.useWasm!==!1,K=c?c.length:d.length??NaN,st=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!fi&&!U,ht=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:!!(b===Fb&&C===Bb&&_===Ub&&v&&E&&T&&Fo(v,document.baseURI)&&Fo(E,document.baseURI)&&Fo(T,document.baseURI)),J=null;_C(p);const V={canvasFactory:new at({ownerDocument:Q,enableHWA:k}),filterFactory:new ut({docId:e,ownerDocument:Q}),cMapReaderFactory:ht?null:new b({baseUrl:v,isCompressed:S}),standardFontDataFactory:ht?null:new C({baseUrl:E}),wasmFactory:ht?null:new _({baseUrl:T})};f||(f=qo.create({verbosity:p,port:jo.workerPort}),t._worker=f);const rt={docId:e,apiVersion:"5.4.296",data:n,password:l,disableAutoFetch:I,rangeChunkSize:u,length:K,docBaseUrl:m,enableXfa:q,evaluatorOptions:{maxImageSize:D,disableFontFace:U,ignoreErrors:R,isEvalSupported:M,isOffscreenCanvasSupported:L,isImageDecoderSupported:P,canvasMaxAreaInBytes:B,fontExtraProperties:Z,useSystemFonts:st,useWasm:j,useWorkerFetch:ht,cMapUrl:v,iccUrl:w,standardFontDataUrl:E,wasmUrl:T}},lt={ownerDocument:Q,pdfBug:$,styleElement:J,loadingParams:{disableAutoFetch:I,enableXfa:q}};return f.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const At=f.messageHandler.sendWithPromise("GetDocRequest",rt,n?[n.buffer]:null);let dt;if(c)dt=new Dx(c,{disableRange:nt,disableStream:N});else if(!n){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Bt=Fo(i)?Px:fi?$x:Bx;dt=new Bt({url:i,length:K,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:nt,disableStream:N})}return At.then(Bt=>{if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const bt=new Bo(e,Bt,f.port),_t=new Qx(bt,t,dt,lt,V,k);t._transport=_t,bt.send("Ready",null)})}).catch(t._capability.reject),t}class wp{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${wp.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class zA{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#a)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){ue("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Kx{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class qx{#t=!1;constructor(t,e,i,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new Mb:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new HA,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:r=!1}={}){return new ol({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:n="display",annotationMode:r=_s.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:f=null,printAnnotationStorage:p=null,isEditing:m=!1,recordOperations:v=!1,operationsFilter:S=null}){this._stats?.time("Overall");const b=this._transport.getRenderingIntent(n,r,p,m),{renderingIntent:w,cacheKey:E}=b;this.#t=!1,c||=this._transport.getOptionalContentConfig(w);let C=this._intentStates.get(E);C||(C=Object.create(null),this._intentStates.set(E,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const T=!!(w&Bi.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));const _=!!(this._pdfBug&&globalThis.StepperManager?.enabled),R=!this.recordedBBoxes&&(v||_),D=P=>{if(C.renderTasks.delete(M),R){const B=M.gfx?.dependencyTracker.take();B&&(M.stepper&&M.stepper.setOperatorBBoxes(B,M.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=B))}T&&(this.#t=!0),this.#e(),P?(M.capability.reject(P),this._abortOperatorList({intentState:C,reason:P instanceof Error?P:new Error(P)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new pa({callback:D,params:{canvas:e,canvasContext:t,dependencyTracker:R?new fx(e,C.operatorList.length,_):null,viewport:i,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:f,enableHWA:this._transport.enableHWA,operationsFilter:S});(C.renderTasks||=new Set).add(M);const L=M.task;return Promise.all([C.displayReadyCapability.promise,c]).then(([P,B])=>{if(this.destroyed){D();return}if(this._stats?.time("Rendering"),!(B.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:P,optionalContentConfig:B}),M.operatorListChanged()}).catch(D),L}getOperatorList({intent:t="display",annotationMode:e=_s.ENABLE,printAnnotationStorage:i=null,isEditing:n=!1}={}){function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(t,e,i,n,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Ko.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,n){function r(){a.read().then(function({value:c,done:u}){if(u){i(l);return}l.lang??=c.lang,Object.assign(l.styles,c.styles),l.items.push(...c.items),r()},n)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Mb),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:n}){const{map:r,transfer:a}=i,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:n},a).getReader(),u=this._intentStates.get(e);u.streamReader=c;const f=()=>{c.read().then(({value:p,done:m})=>{if(m){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,u),f())},p=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const m of u.renderTasks)m.operatorListChanged();this.#e()}if(u.displayReadyCapability)u.displayReadyCapability.reject(p);else if(u.opListReadCapability)u.opListReadCapability.reject(p);else throw p}})};f()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof gp){let n=Yx;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Ns(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}var Ms,pn,Zn,lr,dh,cr,hr,mi,ih,jA,$A,Uo,Sa,nh;const me=class me{constructor({name:t=null,port:e=null,verbosity:i=DC()}={}){Be(this,mi);Be(this,Ms,Promise.withResolvers());Be(this,pn,null);Be(this,Zn,null);Be(this,lr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Rt(me,hr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Rt(me,hr).set(e,this),Ue(this,mi,jA).call(this,e)}else Ue(this,mi,$A).call(this)}get promise(){return Rt(this,Ms).promise}get port(){return Rt(this,Zn)}get messageHandler(){return Rt(this,pn)}destroy(){this.destroyed=!0,Rt(this,lr)?.terminate(),de(this,lr,null),Rt(me,hr).delete(Rt(this,Zn)),de(this,Zn,null),Rt(this,pn)?.destroy(),de(this,pn,null)}static create(t){const e=Rt(this,hr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new me(t)}static get workerSrc(){if(jo.workerSrc)return jo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ut(this,"_setupFakeWorkerGlobal",(async()=>Rt(this,Sa,nh)?Rt(this,Sa,nh):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ms=new WeakMap,pn=new WeakMap,Zn=new WeakMap,lr=new WeakMap,dh=new WeakMap,cr=new WeakMap,hr=new WeakMap,mi=new WeakSet,ih=function(){Rt(this,Ms).resolve(),Rt(this,pn).send("configure",{verbosity:this.verbosity})},jA=function(t){de(this,Zn,t),de(this,pn,new Bo("main","worker",t)),Rt(this,pn).on("ready",()=>{}),Ue(this,mi,ih).call(this)},$A=function(){if(Rt(me,cr)||Rt(me,Sa,nh)){Ue(this,mi,Uo).call(this);return}let{workerSrc:t}=me;try{me._isSameOrigin(window.location,t)||(t=me._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Bo("main","worker",e),n=()=>{r.abort(),i.destroy(),e.terminate(),this.destroyed?Rt(this,Ms).reject(new Error("Worker was destroyed")):Ue(this,mi,Uo).call(this)},r=new AbortController;e.addEventListener("error",()=>{Rt(this,lr)||n()},{signal:r.signal}),i.on("test",l=>{if(r.abort(),this.destroyed||!l){n();return}de(this,pn,i),de(this,Zn,e),de(this,lr,e),Ue(this,mi,ih).call(this)}),i.on("ready",l=>{if(r.abort(),this.destroyed){n();return}try{a()}catch{Ue(this,mi,Uo).call(this)}});const a=()=>{const l=new Uint8Array;i.send("test",l,[l.buffer])};a();return}catch{Th("The worker has been disabled.")}Ue(this,mi,Uo).call(this)},Uo=function(){Rt(me,cr)||(xt("Setting up fake worker."),de(me,cr,!0)),me._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Rt(this,Ms).reject(new Error("Worker was destroyed"));return}const e=new sx;de(this,Zn,e);const i=`fake${Vd(me,dh)._++}`,n=new Bo(i+"_worker",i,e);t.setup(n,e),de(this,pn,new Bo(i,i+"_worker",e)),Ue(this,mi,ih).call(this)}).catch(t=>{Rt(this,Ms).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Sa=new WeakSet,nh=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Be(me,Sa),Be(me,dh,0),Be(me,cr,!1),Be(me,hr,new WeakMap),fi&&(de(me,cr,!0),jo.workerSrc||="./pdf.worker.mjs"),me._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const n=new URL(e,i);return i.origin===n.origin},me._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},me.fromPort=t=>{if(zC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return me.create(t)};let qo=me;class Qx{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#a=null;constructor(t,e,i,n,r,a){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new HA,this.fontLoader=new ZC({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}#s(t,e=null){const i=this.#t.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,n),n}get annotationStorage(){return Ut(this,"annotationStorage",new bp)}getRenderingIntent(t,e=_s.ENABLE,i=null,n=!1,r=!1){let a=Bi.DISPLAY,l=jf;switch(t){case"any":a=Bi.ANY;break;case"display":break;case"print":a=Bi.PRINT;break;default:xt(`getRenderingIntent - invalid intent: ${t}`)}const c=a&Bi.PRINT&&i instanceof _A?i:this.annotationStorage;switch(e){case _s.DISABLE:a+=Bi.ANNOTATIONS_DISABLE;break;case _s.ENABLE:break;case _s.ENABLE_FORMS:a+=Bi.ANNOTATIONS_FORMS;break;case _s.ENABLE_STORAGE:a+=Bi.ANNOTATIONS_STORAGE,l=c.serializable;break;default:xt(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(a+=Bi.IS_EDITING),r&&(a+=Bi.OPLIST);const{ids:u,hash:f}=c.modifiedIds,p=[a,l.hash,f];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),ui.cleanup(),this._networkStream?.cancelAllRequests(new Ns("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,n)=>{Kt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){n.close();return}Kt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:a}=this._fullReader;return(!n||!r)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:a}}),t.on("GetRangeReader",(i,n)=>{Kt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:a,done:l}){if(l){n.close();return}Kt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{r.cancel(a),n.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new Kx(i,this))}),t.on("DocException",i=>{e._capability.reject(Ci(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Ci(i);const n=r=>{r instanceof Error?this.#a.reject(r):this.#a.resolve({password:r})};e.onPassword(n,i.code)}catch(n){this.#a.reject(n)}return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,n,r])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(n){case"Font":if("error"in r){const f=r.error;xt(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const a=new re(r),l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,c=new JC(a,l,r.extra,r.charProcOperatorList);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(i,c)});break;case"CopyLocalImage":const{imageRef:u}=r;Kt(u,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,p]of f.objs)if(p?.ref===u)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([i,n,r,a])=>{if(this.destroyed)return;const l=this.#e.get(n);if(!l.objs.has(i)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[i.type];if(!n)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&xt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#n.get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#i.set(r.refStr,t);const a=new qx(e,r,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#n.set(e,n),n}getPageIndex(t){return $f(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new _x(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(n=>({info:n[0],metadata:n[1]?new xx(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),ui.cleanup()}}cachedPageNumber(t){if(!$f(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class Zx{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class pa{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:f=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:v=!1,operationsFilter:S=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Zx(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=v,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(pa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");pa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:n,background:r,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new va(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:n,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),pa.#e.delete(this._canvas),t||=new gp(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),pa.#e.delete(this._canvas),this.callback())))}}const Jx="5.4.296",tR="f56dc8601";class an{#t=null;#e=null;#n;#i=null;#a=!1;#s=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ut(this,"_keyboardManager",new cl([[["Escape","mac+Escape"],an.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],an.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],an.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],an.prototype._moveToPrevious],[["Home","mac+Home"],an.prototype._moveToBeginning],[["End","mac+End"],an.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#r=t):this.#s=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",an.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#n,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",on,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,n]of this.#l.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=i,r.setAttribute("data-l10n-id",an.#d[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=n,r.ariaSelected=n===this.#n,r.addEventListener("click",this.#f.bind(this,n),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Wt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastChild?.focus()}#m(t){an._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const i of this.#i.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Qo{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Qo.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,n=this.#t=document.createElement("input");return n.type="color",n.value=i||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",Qo.#i[t]),n.addEventListener("input",()=>{this.#n.updateParams(e,n.value)},{signal:this.#n._signal}),n}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}Nt(116);Nt(531);function Zb(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function Mo(d){return Math.max(0,Math.min(255,255*d))}class Jb{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Mo(t),[t,t,t]}static G_HTML([t]){const e=Zb(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Mo)}static RGB_HTML(t){return`#${t.map(Zb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[Mo(1-Math.min(1,t+n)),Mo(1-Math.min(1,i+n)),Mo(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,r=1-e,a=1-i,l=Math.min(n,r,a);return["CMYK",n,r,a,l]}}class eR{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ue("Abstract method `_createSVG` called.")}}class hh extends eR{_createSVG(t){return document.createElementNS(Kn,t)}}const iR=9,gr=new WeakSet,nR=new Date().getTimezoneOffset()*60*1e3;class t0{static create(t){switch(t.data.annotationType){case ke.LINK:return new Tp(t);case ke.TEXT:return new rR(t);case ke.WIDGET:switch(t.data.fieldType){case"Tx":return new aR(t);case"Btn":return t.data.radioButton?new GA(t):t.data.checkBox?new lR(t):new cR(t);case"Ch":return new hR(t);case"Sig":return new oR(t)}return new br(t);case ke.POPUP:return new Xf(t);case ke.FREETEXT:return new VA(t);case ke.LINE:return new dR(t);case ke.SQUARE:return new fR(t);case ke.CIRCLE:return new pR(t);case ke.POLYLINE:return new XA(t);case ke.CARET:return new mR(t);case ke.INK:return new Cp(t);case ke.POLYGON:return new gR(t);case ke.HIGHLIGHT:return new YA(t);case ke.UNDERLINE:return new vR(t);case ke.SQUIGGLY:return new yR(t);case ke.STRIKEOUT:return new bR(t);case ke.STAMP:return new WA(t);case ke.FILEATTACHMENT:return new AR(t);default:return new Se(t)}}}class Se{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Se._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:n}=this.data;let r=-1/0,a=-1/0;if(e?.length>=8){for(let l=0;l<e.length;l+=8)e[l+1]>a?(a=e[l+1],r=e[l+2]):e[l+1]===a&&(r=Math.max(r,e[l+2]));return[r,a]}if(i?.length>=1){for(const l of i)for(let c=0,u=l.length;c<u;c+=2)l[c+1]>a?(a=l[c+1],r=l[c]):l[c+1]===a&&(r=Math.max(r,l[c]));if(r!==1/0)return[r,a]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:a}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/i,t[1]=100*(t[1]-a)/n,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Yo}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Yo}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#i(e);let n=this.#n?.popup||this.popup;!n&&i?.text&&(this._createPopup(i),n=this.#n.popup),n&&(n.updateEdited(t),i?.deleted&&(n.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-l)/r}%`,e.top=`${100*(a-t[3]+c)/a}%`,n===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof br)&&!(this instanceof Tp)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Xf){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:l,height:c}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(b>0||w>0){const C=`calc(${b}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;a.borderRadius=C}else if(this instanceof GA){const C=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;a.borderRadius=C}switch(e.borderStyle.style){case ca.SOLID:a.borderStyle="solid";break;case ca.DASHED:a.borderStyle="dashed";break;case ca.BEVELED:xt("Unimplemented border style: beveled");break;case ca.INSET:xt("Unimplemented border style: inset");break;case ca.UNDERLINE:a.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,a.borderColor=mt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):a.borderWidth=0}const u=mt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:f,pageHeight:p,pageX:m,pageY:v}=n.rawDims;a.left=`${100*(u[0]-m)/f}%`,a.top=`${100*(u[1]-v)/p}%`;const{rotation:S}=e;return e.hasOwnCanvas||S===0?(a.width=`${100*l/f}%`,a.height=`${100*c/p}%`):this.setRotation(S,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims;let{width:r,height:a}=this;t%180!==0&&([r,a]=[a,r]),e.style.width=`${100*r/i}%`,e.style.height=`${100*a/n}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,n)=>{const r=n.detail[e],a=r[0],l=r.slice(1);n.target.style[i]=Jb[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[i]:Jb[`${a}_rgb`](l)})};return Ut(this,"_commonActions",{display:e=>{const{display:i}=e.detail,n=i%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail))(t[n]||i[n])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,r]of Object.entries(e)){const a=i[n];if(a){const l={detail:{[n]:r},target:t};a(l),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,r]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,w,E,C]=t.subarray(2,6);if(n===b&&r===w&&e===E&&i===C)return}const{style:a}=this.container;let l;if(this.#e){const{borderColor:b,borderWidth:w}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const c=n-e,u=r-i,{svgFactory:f}=this,p=f.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=f.createElement("defs");p.append(m);const v=f.createElement("clipPath"),S=`clippath_${this.data.id}`;v.setAttribute("id",S),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let b=2,w=t.length;b<w;b+=8){const E=t[b],C=t[b+1],T=t[b+2],_=t[b+3],R=f.createElement("rect"),D=(T-e)/c,M=(r-C)/u,L=(E-T)/c,P=(C-_)/u;R.setAttribute("x",D),R.setAttribute("y",M),R.setAttribute("width",L),R.setAttribute("height",P),v.append(R),l?.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${M}" width="${L}" height="${P}"/>`)}this.#e&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${S})`}_createPopup(t=null){const{data:e}=this;let i,n;t?(i={str:t.text},n=t.date):(i=e.contentsObj,n=e.modificationDate);const r=this.#n=new Xf({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(r.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){ue("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:r,id:a,exportValues:l}of n){if(r===-1||a===e)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!gr.has(u)){xt(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:c,domElement:u})}return i}for(const n of document.getElementsByName(t)){const{exportValue:r}=n,a=n.getAttribute("data-element-id");a!==e&&gr.has(n)&&i.push({id:a,exportValue:r,domElement:n})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class sR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class Tp extends Se{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),n=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),n=!0):t.setOCGState?(this.#n(i,t.setOCGState,t.overlaidText),n=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",n=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#t()}#n(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const r=i.get(n);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){xt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:n,refs:r,include:a}=e,l=[];if(n.length!==0||r.length!==0){const f=new Set(r);for(const p of n){const m=this._fieldObjects[p]||[];for(const{id:v}of m)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===a&&l.push(m)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const c=this.annotationStorage,u=[];for(const f of l){const{id:p}=f;switch(u.push(p),f.type){case"text":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;c.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";c.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!gr.has(m)){xt(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}}class rR extends Se{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class br extends Se{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ni.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,r){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a)}})})}_setEventListeners(t,e,i,n){for(const[r,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":mt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||iR,r=t.style;let a;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),f=Math.round(u/(uf*n))||1,p=u/f;a=Math.min(n,c(p/uf))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(n,c(u/uf))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=mt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class aR extends br{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),r.setValue(a.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let r=n.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&r.length>a&&(r=r.slice(0,a));let l=n.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:r,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=l??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",l??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),gr.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:u,datetimeType:f,timeStep:p}=this.data,m=!!f&&this.enableScripting;u&&(i.title=u),this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(i,"value",S.target.value,"value"),c.formattedValue=null}),i.addEventListener("resetform",S=>{const b=this.data.defaultFieldValue??"";i.value=c.userValue=b,c.formattedValue=null});let v=S=>{const{formattedValue:b}=c;b!=null&&(S.target.value=b),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",b=>{if(c.focused)return;const{target:w}=b;if(m&&(w.type=f,p&&(w.step=p)),c.userValue){const E=c.userValue;if(m)if(f==="time"){const C=new Date(E),T=[C.getHours(),C.getMinutes(),C.getSeconds()];w.value=T.map(_=>_.toString().padStart(2,"0")).join(":")}else w.value=new Date(E-nR).toISOString().split(f==="date"?"T":".",1)[0];else w.value=E}c.lastCommittedValue=w.value,c.commitKey=1,this.data.actions?.Focus||(c.focused=!0)}),i.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const w={value(E){c.userValue=E.detail.value??"",m||t.setValue(e,{value:c.userValue.toString()}),E.target.value=c.userValue},formattedValue(E){const{formattedValue:C}=E.detail;c.formattedValue=C,C!=null&&E.target!==document.activeElement&&(E.target.value=C);const T={formattedValue:C};m&&(T.value=C),t.setValue(e,T)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:C}=E.detail,{target:T}=E;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let _=c.userValue;!_||_.length<=C||(_=_.slice(0,C),T.value=c.userValue=_,t.setValue(e,{value:_}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(w,b)}),i.addEventListener("keydown",b=>{c.commitKey=1;let w=-1;if(b.key==="Escape"?w=0:b.key==="Enter"&&!this.data.multiLine?w=2:b.key==="Tab"&&(c.commitKey=3),w===-1)return;const{value:E}=b.target;c.lastCommittedValue!==E&&(c.lastCommittedValue=E,c.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:w,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const S=v;v=null,i.addEventListener("blur",b=>{if(!c.focused||!b.relatedTarget)return;this.data.actions?.Blur||(c.focused=!1);const{target:w}=b;let{value:E}=w;if(m){if(E&&f==="time"){const C=E.split(":").map(T=>parseInt(T,10));E=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),w.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();w.type="text"}c.userValue=E,c.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,willCommit:!0,commitKey:c.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}),S(b)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",b=>{c.lastCommittedValue=null;const{data:w,target:E}=b,{value:C,selectionStart:T,selectionEnd:_}=E;let R=T,D=_;switch(b.inputType){case"deleteWordBackward":{const M=C.substring(0,T).match(/\w*[^\w]*$/);M&&(R-=M[0].length);break}case"deleteWordForward":{const M=C.substring(T).match(/^[^\w]*\w*/);M&&(D+=M[0].length);break}case"deleteContentBackward":T===_&&(R-=1);break;case"deleteContentForward":T===_&&(D+=1);break}b.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,change:w||"",willCommit:!1,selStart:R,selEnd:D}})}),this._setEventListeners(i,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(v&&i.addEventListener("blur",v),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class oR extends br{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class lR extends br{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return gr.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,i)){const f=c&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=f),t.setValue(u.id,{value:f})}t.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const l={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(i,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class GA extends br{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(gr.add(r),r.setAttribute("data-element-id",i),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,i))t.setValue(u.id,{value:!1});t.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const f=a===u.detail.value;for(const p of this._getElementsByName(u.target.name)){const m=f&&p.id===i;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class cR extends Tp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class hR extends br{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");gr.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue;for(const m of n.options)m.selected=m.value===p});for(const f of this.data.options){const p=document.createElement("option");p.textContent=f.displayValue,p.value=f.exportValue,i.value.includes(f.exportValue)&&(p.setAttribute("selected",!0),r=!1),n.append(p)}let a=null;if(r){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),n.prepend(f),a=()=>{f.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const l=f=>{const p=f?"value":"textContent",{options:m,multiple:v}=n;return v?Array.prototype.filter.call(m,S=>S.selected).map(S=>S[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let c=l(!1);const u=f=>{const p=f.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",f=>{const p={value(m){a?.();const v=m.detail.value,S=new Set(Array.isArray(v)?v:[v]);for(const b of n.options)b.selected=S.has(b.value);t.setValue(e,{value:l(!0)}),c=l(!1)},multipleSelection(m){n.multiple=!0},remove(m){const v=n.options,S=m.detail.remove;v[S].selected=!1,n.remove(S),v.length>0&&Array.prototype.findIndex.call(v,w=>w.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},clear(m){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),c=l(!1)},insert(m){const{index:v,displayValue:S,exportValue:b}=m.detail.insert,w=n.children[v],E=document.createElement("option");E.textContent=S,E.value=b,w?w.before(E):n.append(E),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},items(m){const{items:v}=m.detail;for(;n.length!==0;)n.remove(0);for(const S of v){const{displayValue:b,exportValue:w}=S,E=document.createElement("option");E.textContent=b,E.value=w,n.append(E)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:l(!0),items:u(m)}),c=l(!1)},indices(m){const v=new Set(m.detail.indices);for(const S of m.target.options)S.selected=v.has(S.index);t.setValue(e,{value:l(!0)}),c=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,f)}),n.addEventListener("input",f=>{const p=l(!0),m=l(!1);t.setValue(e,{value:p}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):n.addEventListener("input",function(f){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Xf extends Se{constructor(t){const{data:e,elements:i,parent:n}=t,r=!!n._commentManager;if(super(t,{isRenderable:!r&&Se._hasPopupData(e)}),this.elements=i,r&&Se._hasPopupData(e)){const a=this.popup=this.#t();for(const l of i)l.popup=a}else this.popup=null}#t(){return new uR({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",i.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(n=>`${pp}${n}`).join(",")),this.container}}class uR{#t=null;#e=this.#G.bind(this);#n=this.#U.bind(this);#i=this.#P.bind(this);#a=this.#S.bind(this);#s=null;#r=null;#o=null;#c=null;#l=null;#d=null;#u=null;#f=!1;#m=null;#p=null;#h=null;#g=null;#v=null;#b=null;#y=null;#C=null;#w=null;#A=null;#R=!1;#E=null;#T=null;constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:r,contentsObj:a,richText:l,parent:c,rect:u,parentRect:f,open:p,commentManager:m=null}){this.#r=t,this.#w=n,this.#o=a,this.#C=l,this.#d=c,this.#s=e,this.#y=u,this.#u=f,this.#l=i,this.#t=m,this.#E=i[0],this.#c=Uf.toDateObject(r),this.trigger=i.flatMap(v=>v.getElementsToTriggerPopup()),m?this.renderCommentButton():(this.#M(),this.#r.hidden=!0,p&&this.#S())}#M(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#n,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#_(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#v=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#v||this.#_(),!this.#v))return;const{signal:t}=this.#p=new AbortController,e=!!this.#E.extraPopupElement,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},n=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#g=this.#E.container;for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",this.#e,{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),a.classList.add("popupTriggerArea")}else{const a=this.#g=document.createElement("button");a.className="annotationCommentButton";const l=this.#E.container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#F(),this.#D(),a.addEventListener("keydown",this.#e,{signal:t}),a.addEventListener("click",i,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),l.after(a)}}#D(){if(this.#E.extraPopupElement&&!this.#E.editor)return;this.renderCommentButton();const[t,e]=this.#v,{style:i}=this.#g;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#F(){this.#E.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#E.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:n,modificationDate:r}=this.#E.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:n,modificationDate:r}}get elementBeforePopup(){return this.#g}get comment(){return this.#T||=this.#E.commentText,this.#T}set comment(t){t!==this.comment&&(this.#E.commentText=this.#T=t)}get parentBoundingClientRect(){return this.#E.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=e)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:i}=this.#g.getBoundingClientRect(),{x:n,y:r,width:a,height:l}=this.#E.layer.getBoundingClientRect();return[(t-n)/a,(e+i-r)/l]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#b||this.commentButtonPosition.map(u=>u/100),n=this.parentBoundingClientRect,{x:r,y:a,width:l,height:c}=n;this.#t.showDialog(null,this,r+e*l,a+i*c,{...t,parentDimensions:n})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#s){const i=t.style.outlineColor=mt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#w?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#w}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}CA({html:this.#L||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#L(){const t=this.#C,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#C.html||null}get#N(){return this.#L?.attributes?.style?.fontSize||0}get#B(){return this.#L?.attributes?.style?.color||null}#I(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#B,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:n});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#T=null):e&&(e.deleted?this.remove():(this.#F(),this.#T=e.text)),t&&(this.#v=null,this.#_(),this.#D());return}if(i||e?.deleted){this.remove();return}this.#M(),this.#A||={contentsObj:this.#o,richText:this.#C},t&&(this.#h=null),e&&e.text&&(this.#C=this.#I(e.text),this.#c=Uf.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#A&&({contentsObj:this.#o,richText:this.#C}=this.#A,this.#A=null,this.#m?.remove(),this.#m=null,this.#h=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#R=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#x(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:r}}}=this.#d;let a=!!this.#u,l=a?this.#u:this.#y;for(const S of this.#l)if(!l||mt.intersect(S.data.rect,l)!==null){l=S.data.rect,a=!0;break}const c=mt.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),f=a?l[2]-l[0]+5:0,p=c[0]+f,m=c[1];this.#h=[100*(p-n)/e,100*(m-r)/i];const{style:v}=this.#r;v.left=`${this.#h[0]}%`,v.top=`${this.#h[1]}%`}#S(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#P(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#U(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#P(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#x(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#R=this.isVisible,this.#R&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#M(),this.#R&&(this.#m||this.#P(),this.#R=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class VA extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Lt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class dR extends Se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class fR extends Se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",i-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class pR extends Se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",i/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class XA extends Se{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:n},width:r,height:a}=this;if(!e)return this.container;const l=this.svgFactory.create(r,a,!0);let c=[];for(let f=0,p=e.length;f<p;f+=2){const m=e[f]-t[0],v=t[3]-e[f+1];c.push(`${m},${v}`)}c=c.join(" ");const u=this.#t=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class gR extends XA{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class mR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Cp extends Se{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Lt.HIGHLIGHT:Lt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:n,popupRef:r}}=this,{transform:a,width:l,height:c}=this.#n(e,t),u=this.svgFactory.create(l,c,!0),f=this.#t=this.svgFactory.createElement("svg:g");u.append(f),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",a);for(let p=0,m=i.length;p<m;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",i[p].join(",")),f.append(v)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:n}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),i)for(let a=0,l=this.#e.length;a<l;a++)this.#e[a].setAttribute("points",i[a].join(","));if(n){const{transform:a,width:l,height:c}=this.#n(this.data.rotation,n);r.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),r.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class YA extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Lt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class vR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class yR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class bR extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class WA extends Se{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Lt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class AR extends Se{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:n}=ni.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class xp{#t=null;#e=null;#n=null;#i=new Map;#a=null;#s=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:f}){this.div=t,this.#t=e,this.#e=i,this.#a=l||null,this.#s=u||null,this.#n=f||new bp,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=c||null}hasEditableAnnotations(){return this.#i.size>0}async#r(t,e,i){const n=t.firstChild||t,r=n.id=`${pp}${e}`,a=await this.#a?.getAriaAttributes(r);if(a)for(const[l,c]of a)n.setAttribute(l,c);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,n,!1))}async render(t){const{annotations:e}=t,i=this.div;pr(i,this.viewport);const n=new Map,r={data:null,layer:i,linkService:this.#s,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new hh,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===ke.POPUP;if(l){const f=n.get(a.id);if(!f)continue;r.elements=f}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const c=t0.create(r);if(!c.isRenderable)continue;if(!l&&a.popupRef){const f=n.get(a.popupRef);f?f.push(c):n.set(a.popupRef,[c])}const u=c.render();a.hidden&&(u.style.visibility="hidden"),await this.#r(u,a.id,r.elements),c.extraPopupElement?.popup?.renderCommentButton(),c._isEditable&&(this.#i.set(c.data.id,c),this._annotationEditorUIManager?.renderAnnotationElement(c))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#s,svgFactory:new hh,parent:this};for(const i of t){i.borderStyle||=xp._defaultBorderStyle,e.data=i;const n=t0.create(e);if(!n.isRenderable)continue;const r=n.render();await this.#r(r,i.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,pr(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:r}=n;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):n.append(i);const a=this.#i.get(e);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,n.id,i),a._hasNoCanvas=!1):a.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:n}=t,r=new sR({data:{id:i,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#n}),a=r.render();return e.append(a),this.#t?.moveElementInDOM(e,a,a,!1),r.createOrUpdatePopup(),r}static get _defaultBorderStyle(){return Ut(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ca.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Yc=/\r\n?|\n/g;class Ge extends Et{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Ge.prototype,e=r=>r.isEmpty(),i=Is.TRANSLATE_SMALL,n=Is.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new cl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=Lt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Ge._defaultColor||Et._defaultLineColor,this.#i=t.fontSize||Ge._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){Et.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Wt.FREETEXT_SIZE:Ge._defaultFontSize=e;break;case Wt.FREETEXT_COLOR:Ge._defaultColor=e;break}}updateParams(t,e){switch(t){case Wt.FREETEXT_SIZE:this.#a(e);break;case Wt.FREETEXT_COLOR:this.#s(e);break}}static get defaultPropertiesToUpdate(){return[[Wt.FREETEXT_SIZE,Ge._defaultFontSize],[Wt.FREETEXT_COLOR,Ge._defaultColor||Et._defaultLineColor]]}get propertiesToUpdate(){return[[Wt.FREETEXT_SIZE,this.#i],[Wt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Qo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Wt.FREETEXT_COLOR}#a(t){const e=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--total-scale-factor))`,this.translate(0,-(n-this.#i)*this.parentScale),this.#i=n,this.#o()},i=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(t){const e=n=>{this.color=n,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ge._internalPadding*t,-(Ge._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Ge.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,a=r.style.display,l=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const i=n=>{if(this.#t=n,!n){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ge._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,f]=this.pageDimensions,[p,m]=this.pageTranslation;let v,S;switch(this.rotation){case 0:v=t+(a[0]-p)/u,S=e+this.height-(a[1]-m)/f;break;case 90:v=t+(a[0]-p)/u,S=e-(a[1]-m)/f,[l,c]=[c,-l];break;case 180:v=t-this.width+(a[0]-p)/u,S=e-(a[1]-m)/f,[l,c]=[-l,-c];break;case 270:v=t+(a[0]-p-this.height*f)/u,S=e+(a[1]-m-this.width*u)/f,[l,c]=[-c,l];break}this.setAt(v*n,S*r,l,c)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Yc,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=Ge.#u(e.getData("text")||"").replaceAll(Yc,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:l,startOffset:c}=a,u=[],f=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Yc,"")),v!==this.editorDiv){let S=u;for(const b of this.editorDiv.childNodes){if(b===v){S=f;continue}S.push(Ge.#c(b))}}u.push(l.nodeValue.slice(0,c).replaceAll(Yc,""))}else if(l===this.editorDiv){let v=u,S=0;for(const b of this.editorDiv.childNodes)S++===c&&(v=f),v.push(Ge.#c(b))}this.#t=`${u.join(`
`)}${n}${f.join(`
`)}`,this.#l();const p=new Range;let m=Math.sumPrecise(u.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const S=v.nodeValue.length;if(m<=S){p.setStart(v,m),p.setEnd(v,m);break}m-=S}r.removeAllRanges(),r.addRange(p)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#u(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ge._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let n=null;if(t instanceof VA){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:c,rotation:u,id:f,popupRef:p,richText:m,contentsObj:v,creationDate:S,modificationDate:b},textContent:w,textPosition:E,parent:{page:{pageNumber:C}}}=t;if(!w||w.length===0)return null;n=t={annotationType:Lt.FREETEXT,color:Array.from(l),fontSize:a,value:w.join(`
`),position:E,pageIndex:C-1,rect:c.slice(0),rotation:u,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:v?.str||null,richText:m,creationDate:S,modificationDate:b}}const r=await super.deserialize(t,e,i);return r.#i=t.fontSize,r.color=mt.makeHexColor(...t.color),r.#t=Ge.#u(t.value),r._initialData=n,t.comment&&r.setCommentData(t),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Et._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:n,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((a,l)=>a!==n[l])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const n of this.#t.split(`
`)){const r=document.createElement("div");r.append(n?document.createTextNode(n):document.createElement("br")),e.append(r)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class pt{static PRECISION=1e-4;toSVGPath(){ue("Abstract method `toSVGPath` must be implemented.")}get box(){ue("Abstract getter `box` must be implemented.")}serialize(t,e){ue("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,n,r,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l]*n,a[l+1]=i+t[l+1]*r;return a}static _rescaleAndSwap(t,e,i,n,r,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l+1]*n,a[l+1]=i+t[l]*r;return a}static _translate(t,e,i,n){n||=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r+=2)n[r]=e+t[r],n[r+1]=i+t[r+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,n,r){switch(r){case 90:return[1-e/i,t/n];case 180:return[1-t/i,1-e/n];case 270:return[e/i,1-t/n];default:return[t/i,e/n]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,n,r,a){return[(t+5*i)/6,(e+5*n)/6,(5*i+r)/6,(5*n+a)/6,(i+r)/2,(n+a)/2]}}class sr{#t;#e=[];#n;#i;#a=[];#s=new Float32Array(18);#r;#o;#c;#l;#d;#u;#f=[];static#m=8;static#p=2;static#h=sr.#m+sr.#p;constructor({x:t,y:e},i,n,r,a,l=0){this.#t=i,this.#u=r*n,this.#i=a,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#l=sr.#m*n,this.#c=sr.#h*n,this.#d=n,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#g(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[i,n,r,a]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/r,(this.#o+(t[1]-e[1])/2-n)/a,(this.#r+(e[0]-t[0])/2-i)/r,(this.#o+(e[1]-t[1])/2-n)/a]}add({x:t,y:e}){this.#r=t,this.#o=e;const[i,n,r,a]=this.#t;let[l,c,u,f]=this.#s.subarray(8,12);const p=t-u,m=e-f,v=Math.hypot(p,m);if(v<this.#c)return!1;const S=v-this.#l,b=S/v,w=b*p,E=b*m;let C=l,T=c;l=u,c=f,u+=w,f+=E,this.#f?.push(t,e);const _=-E/S,R=w/S,D=_*this.#u,M=R*this.#u;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([u+D,f+M],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([u-D,f-M],16),isNaN(this.#s[6])?(this.#a.length===0&&(this.#s.set([l+D,c+M],2),this.#a.push(NaN,NaN,NaN,NaN,(l+D-i)/r,(c+M-n)/a),this.#s.set([l-D,c-M],14),this.#e.push(NaN,NaN,NaN,NaN,(l-D-i)/r,(c-M-n)/a)),this.#s.set([C,T,l,c,u,f],6),!this.isEmpty()):(this.#s.set([C,T,l,c,u,f],6),Math.abs(Math.atan2(T-c,C-l)-Math.atan2(E,w))<Math.PI/2?([l,c,u,f]=this.#s.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((l+u)/2-i)/r,((c+f)/2-n)/a),[l,c,C,T]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((C+l)/2-i)/r,((T+c)/2-n)/a),!0):([C,T,l,c,u,f]=this.#s.subarray(0,6),this.#a.push(((C+5*l)/6-i)/r,((T+5*c)/6-n)/a,((5*l+u)/6-i)/r,((5*c+f)/6-n)/a,((l+u)/2-i)/r,((c+f)/2-n)/a),[u,f,l,c,C,T]=this.#s.subarray(12,18),this.#e.push(((C+5*l)/6-i)/r,((T+5*c)/6-n)/a,((5*l+u)/6-i)/r,((5*c+f)/6-n)/a,((l+u)/2-i)/r,((c+f)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?i.push(`L${t[n+4]} ${t[n+5]}`):i.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);this.#y(i);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?i.push(`L${e[n+4]} ${e[n+5]}`):i.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return this.#b(i),i.join(" ")}#v(){const[t,e,i,n]=this.#t,[r,a,l,c]=this.#g();return`M${(this.#s[2]-t)/i} ${(this.#s[3]-e)/n} L${(this.#s[4]-t)/i} ${(this.#s[5]-e)/n} L${r} ${a} L${l} ${c} L${(this.#s[16]-t)/i} ${(this.#s[17]-e)/n} L${(this.#s[14]-t)/i} ${(this.#s[15]-e)/n} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,i,n,r]=this.#t,a=this.#s.subarray(4,6),l=this.#s.subarray(16,18),[c,u,f,p]=this.#g();t.push(`L${(a[0]-e)/n} ${(a[1]-i)/r} L${c} ${u} L${f} ${p} L${(l[0]-e)/n} ${(l[1]-i)/r}`)}newFreeDrawOutline(t,e,i,n,r,a){return new KA(t,e,i,n,r,a)}getOutlines(){const t=this.#a,e=this.#e,i=this.#s,[n,r,a,l]=this.#t,c=new Float32Array((this.#f?.length??0)+2);for(let p=0,m=c.length-2;p<m;p+=2)c[p]=(this.#f[p]-n)/a,c[p+1]=(this.#f[p+1]-r)/l;if(c[c.length-2]=(this.#r-n)/a,c[c.length-1]=(this.#o-r)/l,isNaN(i[6])&&!this.isEmpty())return this.#C(c);const u=new Float32Array(this.#a.length+24+this.#e.length);let f=t.length;for(let p=0;p<f;p+=2){if(isNaN(t[p])){u[p]=u[p+1]=NaN;continue}u[p]=t[p],u[p+1]=t[p+1]}f=this.#A(u,f);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){u[f]=u[f+1]=NaN,f+=2;continue}u[f]=e[p+m],u[f+1]=e[p+m+1],f+=2}return this.#w(u,f),this.newFreeDrawOutline(u,c,this.#t,this.#d,this.#n,this.#i)}#C(t){const e=this.#s,[i,n,r,a]=this.#t,[l,c,u,f]=this.#g(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/r,(e[3]-n)/a,NaN,NaN,NaN,NaN,(e[4]-i)/r,(e[5]-n)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(e[16]-i)/r,(e[17]-n)/a,NaN,NaN,NaN,NaN,(e[14]-i)/r,(e[15]-n)/a],0),this.newFreeDrawOutline(p,t,this.#t,this.#d,this.#n,this.#i)}#w(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#A(t,e){const i=this.#s.subarray(4,6),n=this.#s.subarray(16,18),[r,a,l,c]=this.#t,[u,f,p,m]=this.#g();return t.set([NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-a)/c,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(n[0]-r)/l,(n[1]-a)/c],e),e+=24}}class KA extends pt{#t;#e=new Float32Array(4);#n;#i;#a;#s;#r;constructor(t,e,i,n,r,a){super(),this.#r=t,this.#a=e,this.#t=i,this.#s=n,this.#n=r,this.#i=a,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(a);const[l,c,u,f]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/u,t[p+1]=(t[p+1]-c)/f;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-l)/u,e[p+1]=(e[p+1]-c)/f}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,n],r){const a=i-t,l=n-e;let c,u;switch(r){case 0:c=pt._rescale(this.#r,t,n,a,-l),u=pt._rescale(this.#a,t,n,a,-l);break;case 90:c=pt._rescaleAndSwap(this.#r,t,e,a,l),u=pt._rescaleAndSwap(this.#a,t,e,a,l);break;case 180:c=pt._rescale(this.#r,i,e,-a,l),u=pt._rescale(this.#a,i,e,-a,l);break;case 270:c=pt._rescaleAndSwap(this.#r,i,n,-a,-l),u=pt._rescaleAndSwap(this.#a,i,n,-a,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}#o(t){const e=this.#r;let i=e[4],n=e[5];const r=[i,n,i,n];let a=i,l=n,c=i,u=n;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,S=e.length;v<S;v+=6){const b=e[v+4],w=e[v+5];isNaN(e[v])?(mt.pointBoundingBox(b,w,r),l>w?(a=b,l=w):l===w&&(a=f(a,b)),u<w?(c=b,u=w):u===w&&(c=f(c,b))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,mt.bezierBoundingBox(i,n,...e.slice(v,v+6),p),mt.rectBoundingBox(p[0],p[1],p[2],p[3],r),l>p[1]?(a=p[0],l=p[1]):l===p[1]&&(a=f(a,p[0])),u<p[3]?(c=p[2],u=p[3]):u===p[3]&&(c=f(c,p[2]))),i=b,n=w}const m=this.#e;m[0]=r[0]-this.#n,m[1]=r[1]-this.#n,m[2]=r[2]-r[0]+2*this.#n,m[3]=r[3]-r[1]+2*this.#n,this.firstPoint=[a,l],this.lastPoint=[c,u]}get box(){return this.#e}newOutliner(t,e,i,n,r,a=0){return new sr(t,e,i,n,r,a)}getNewOutline(t,e){const[i,n,r,a]=this.#e,[l,c,u,f]=this.#t,p=r*u,m=a*f,v=i*u+l,S=n*f+c,b=this.newOutliner({x:this.#a[0]*p+v,y:this.#a[1]*m+S},this.#t,this.#s,t,this.#i,e??this.#n);for(let w=2;w<this.#a.length;w+=2)b.add({x:this.#a[w]*p+v,y:this.#a[w+1]*m+S});return b.getOutlines()}}class Yf{#t;#e;#n;#i=[];#a=[];constructor(t,e=0,i=0,n=!0){const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:b,y:w,width:E,height:C}of t){const T=Math.floor((b-e)/a)*a,_=Math.ceil((b+E+e)/a)*a,R=Math.floor((w-e)/a)*a,D=Math.ceil((w+C+e)/a)*a,M=[T,R,D,!0],L=[_,R,D,!1];this.#i.push(M,L),mt.rectBoundingBox(T,R,_,D,r)}const l=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,u=r[0]-i,f=r[1]-i;let p=n?-1/0:1/0,m=1/0;const v=this.#i.at(n?-1:-2),S=[v[0],v[2]];for(const b of this.#i){const[w,E,C,T]=b;!T&&n?E<m?(m=E,p=w):E===m&&(p=Math.max(p,w)):T&&!n&&(E<m?(m=E,p=w):E===m&&(p=Math.min(p,w))),b[0]=(w-u)/l,b[1]=(E-f)/c,b[2]=(C-f)/c}this.#t=new Float32Array([u,f,l,c]),this.#e=[p,m],this.#n=S}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const a of t){const[l,c,u]=a;e.push([l,c,a],[l,u,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const c=e[a][2],u=e[a+1][2];c.push(u),u.push(c),i.add(c),i.add(u)}const n=[];let r;for(;i.size>0;){const a=i.values().next().value;let[l,c,u,f,p]=a;i.delete(a);let m=l,v=c;for(r=[l,u],n.push(r);;){let S;if(i.has(f))S=f;else if(i.has(p))S=p;else break;i.delete(S),[l,c,u,f,p]=S,m!==l&&(r.push(m,v,l,v===c?c:u),m=l),v=v===c?u:c}r.push(m,v)}return new SR(n,this.#t,this.#e,this.#n)}#r(t){const e=this.#a;let i=0,n=e.length-1;for(;i<=n;){const r=i+n>>1,a=e[r][0];if(a===t)return r;a<t?i=r+1:n=r-1}return n+1}#o([,t,e]){const i=this.#r(t);this.#a.splice(i,0,[t,e])}#c([,t,e]){const i=this.#r(t);for(let n=i;n<this.#a.length;n++){const[r,a]=this.#a[n];if(r!==t)break;if(r===t&&a===e){this.#a.splice(n,1);return}}for(let n=i-1;n>=0;n--){const[r,a]=this.#a[n];if(r!==t)break;if(r===t&&a===e){this.#a.splice(n,1);return}}}#l(t){const[e,i,n]=t,r=[[e,i,n]],a=this.#r(n);for(let l=0;l<a;l++){const[c,u]=this.#a[l];for(let f=0,p=r.length;f<p;f++){const[,m,v]=r[f];if(!(u<=m||v<=c)){if(m>=c){if(v>u)r[f][1]=u;else{if(p===1)return[];r.splice(f,1),f--,p--}continue}r[f][2]=c,v>u&&r.push([e,u,v])}}}return r}}class SR extends pt{#t;#e;constructor(t,e,i,n){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[i,n]=e;t.push(`M${i} ${n}`);for(let r=2;r<e.length;r+=2){const a=e[r],l=e[r+1];a===i?(t.push(`V${l}`),n=l):l===n&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],r){const a=[],l=i-t,c=n-e;for(const u of this.#e){const f=new Array(u.length);for(let p=0;p<u.length;p+=2)f[p]=t+u[p]*l,f[p+1]=n-u[p+1]*c;a.push(f)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Wf extends sr{newFreeDrawOutline(t,e,i,n,r,a){return new ER(t,e,i,n,r,a)}}class ER extends KA{newOutliner(t,e,i,n,r,a=0){return new Wf(t,e,i,n,r,a)}}class _e extends Et{#t=null;#e=0;#n;#i=null;#a=null;#s=null;#r=null;#o=0;#c=null;#l=null;#d=null;#u=!1;#f=null;#m=null;#p=null;#h="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Lt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=_e.prototype;return Ut(this,"_keyboardManager",new cl([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||_e._defaultColor,this.#g=t.thickness||_e._defaultThickness,this.opacity=t.opacity||_e._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#y(t),this.#E()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#E(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Yf(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Yf(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:n}=this.#s;this.#m=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const n=1.5;if(this.#s=t.getNewOutline(this.#g/2+n,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:_e.#T(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:_e.#T(this.#s.box,p),path:{d:this.#s.toSVGPath()}})}const[r,a,l,c]=t.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=l,this.height=c;break;case 90:{const[p,m]=this.parentDimensions;this.x=a,this.y=1-r,this.width=l*m/p,this.height=c*p/m;break}case 180:this.x=1-r,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-a,this.y=r,this.width=l*m/p,this.height=c*p/m;break}}const{firstPoint:u}=t;this.#f=[(u[0]-r)/l,(u[1]-a)/c];const{lastPoint:f}=this.#s;this.#m=[(f[0]-r)/l,(f[1]-a)/c]}static initialize(t,e){Et.initialize(t,e),_e._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Wt.HIGHLIGHT_COLOR:_e._defaultColor=e;break;case Wt.HIGHLIGHT_THICKNESS:_e._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Wt.HIGHLIGHT_COLOR:this.#C(e);break;case Wt.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Wt.HIGHLIGHT_COLOR,_e._defaultColor],[Wt.HIGHLIGHT_THICKNESS,_e._defaultThickness]]}get propertiesToUpdate(){return[[Wt.HIGHLIGHT_COLOR,this.color||_e._defaultColor],[Wt.HIGHLIGHT_THICKNESS,this.#g||_e._defaultThickness],[Wt.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#C(t){const e=(r,a)=>{this.color=r,this.opacity=a,this.onUpdatedColor()},i=this.color,n=this.opacity;this.addCommands({cmd:e.bind(this,t,_e._defaultOpacity),undo:e.bind(this,i,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const e=this.#g,i=n=>{this.#g=n,this.#A(n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new an({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#R(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#E(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#R():t&&(this.#E(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#A(t){this.#u&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#R(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#E(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#i))}static#T([t,e,i,n],r){switch(r){case 90:return[1-e-n,t,n,i];case 180:return[1-t-i,1-e-n,i,n];case 270:return[e,1-t-i,n,i]}return[t,e,i,n]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=_e.#T(this.#l.box,t)):i=_e.#T([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:_e.#T(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(this.width,this.height),xA(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(t){_e._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#_(!0);break;case 1:case 3:this.#_(!1);break}}#_(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#_(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#u?this.rotation:0}#F(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,n]=this.pageTranslation,r=this.#n,a=new Float32Array(r.length*8);let l=0;for(const{x:c,y:u,width:f,height:p}of r){const m=c*t+i,v=(1-u)*e+n;a[l]=a[l+4]=m,a[l+1]=a[l+3]=v,a[l+2]=a[l+6]=m+f*t,a[l+5]=a[l+7]=v-p*e,l+=8}return a}#L(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:n,y:r}){const{x:a,y:l,width:c,height:u}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=v=>{f.abort(),this.#B(t,v)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Te,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",on,{signal:p}),i.addEventListener("pointermove",this.#N.bind(this,t),{signal:p}),this._freeHighlight=new Wf({x:n,y:r},[a,l,c,u],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let n=null;if(t instanceof YA){const{data:{quadPoints:S,rect:b,rotation:w,id:E,color:C,opacity:T,popupRef:_,richText:R,contentsObj:D,creationDate:M,modificationDate:L},parent:{page:{pageNumber:P}}}=t;n=t={annotationType:Lt.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:S,boxes:null,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,popupRef:_,richText:R,comment:D?.str||null,creationDate:M,modificationDate:L}}else if(t instanceof Cp){const{data:{inkLists:S,rect:b,rotation:w,id:E,color:C,borderStyle:{rawWidth:T},popupRef:_,richText:R,contentsObj:D,creationDate:M,modificationDate:L},parent:{page:{pageNumber:P}}}=t;n=t={annotationType:Lt.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:S,boxes:null,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,popupRef:_,richText:R,comment:D?.str||null,creationDate:M,modificationDate:L}}const{color:r,quadPoints:a,inkLists:l,opacity:c}=t,u=await super.deserialize(t,e,i);u.color=mt.makeHexColor(...r),u.opacity=c||1,l&&(u.#g=t.thickness),u._initialData=n,t.comment&&u.setCommentData(t);const[f,p]=u.pageDimensions,[m,v]=u.pageTranslation;if(a){const S=u.#n=[];for(let b=0;b<a.length;b+=8)S.push({x:(a[b]-m)/f,y:1-(a[b+1]-v)/p,width:(a[b+2]-a[b])/f,height:(a[b+1]-a[b+5])/p});u.#b(),u.#E(),u.rotate(u.rotation)}else if(l){u.#u=!0;const S=l[0],b={x:S[0]-m,y:p-(S[1]-v)},w=new Wf(b,[0,0,f,p],1,u.#g/2,!0,.001);for(let T=0,_=S.length;T<_;T+=2)b.x=S[T]-m,b.y=p-(S[T+1]-v),w.add(b);const{id:E,clipPathId:C}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);u.#y({highlightOutlines:w.getOutlines(),highlightId:E,clipPathId:C}),u.#E(),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Et._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#g,quadPoints:this.#F(),outlines:this.#L(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#I(i)?null:(i.id=this.annotationElementId,i)}#I(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,n)=>i!==e[n])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class qA{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){ue("Not implemented")}}class Tt extends Et{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static#s=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:i}=e.drawLayer.draw(Tt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[n,r]of Object.entries(e))i.has(n)?Object.assign(t[n],r):t[n]=r;return t}static getDefaultDrawingOptions(t){ue("Not implemented")}static get typesMap(){ue("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Tt.#n.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,n]of this.typesMap)t.push([i,e[n]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,n]of this.constructor.typesMap)t.push([i,e[n]]);return t}_updateProperty(t,e,i){const n=this._drawingOptions,r=n[e],a=l=>{n.updateProperty(e,l);const c=this.#t.updateProperty(e,l);c&&this.#h(c),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,i,n]){const{parentDimensions:[r,a],rotation:l}=this;switch(l){case 90:return[e,1-t,i*(a/r),n*(r/a)];case 180:return[1-t,1-e,i,n];case 270:return[1-e,t,i*(a/r),n*(r/a)];default:return[t,e,i,n]}}#p(){const{x:t,y:e,width:i,height:n,parentDimensions:[r,a],rotation:l}=this;switch(l){case 90:return[1-e,t,i*(r/a),n*(a/r)];case 180:return[1-t,1-e,i,n];case 270:return[e,1-t,i*(r/a),n*(a/r)];default:return[t,e,i,n]}}#h(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:t,y:e,width:i,height:n,rotation:r,parentRotation:a,parentDimensions:[l,c]}=this;switch((r*4+a)/90){case 1:return[1-e-n,t,n,i];case 2:return[1-t-i,1-e-n,i,n];case 3:return[e,1-t-i,n,i];case 4:return[t,e-i*(l/c),n*(c/l),i*(l/c)];case 5:return[1-e,t,i*(l/c),n*(c/l)];case 6:return[1-t-n*(c/l),1-e,n*(c/l),i*(l/c)];case 7:return[e-i*(l/c),1-t-n*(c/l),i*(l/c),n*(c/l)];case 8:return[t-i,e-n,i,n];case 9:return[1-e,t-i,n,i];case 10:return[1-t,1-e,i,n];case 11:return[e-n,1-t,n,i];case 12:return[t-n*(c/l),e,n*(c/l),i*(l/c)];case 13:return[1-e-i*(l/c),t-n*(c/l),i*(l/c),n*(c/l)];case 14:return[1-t,1-e-i*(l/c),n*(c/l),i*(l/c)];case 15:return[e,1-t,i*(l/c),n*(c/l)];default:return[t,e,i,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const n=document.createElement("div");return i.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,n,r){ue("Not implemented")}static startDrawing(t,e,i,n){const{target:r,offsetX:a,offsetY:l,pointerId:c,pointerType:u}=n;if(Tt.#r&&Tt.#r!==u)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=r.getBoundingClientRect(),v=Tt.#i=new AbortController,S=t.combinedSignal(v);if(Tt.#s||=c,Tt.#r??=u,window.addEventListener("pointerup",b=>{Tt.#s===b.pointerId?this._endDraw(b):Tt.#o?.delete(b.pointerId)},{signal:S}),window.addEventListener("pointercancel",b=>{Tt.#s===b.pointerId?this._currentParent.endDrawingSession():Tt.#o?.delete(b.pointerId)},{signal:S}),window.addEventListener("pointerdown",b=>{Tt.#r===b.pointerType&&((Tt.#o||=new Set).add(b.pointerId),Tt.#n.isCancellable()&&(Tt.#n.removeLastElement(),Tt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",on,{signal:S}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),r.addEventListener("touchmove",b=>{b.timeStamp===Tt.#c&&Te(b)},{signal:S}),t.toggleDrawing(),e._editorUndoBar?.hide(),Tt.#n){t.drawLayer.updateProperties(this._currentDrawId,Tt.#n.startNew(a,l,p,m,f));return}e.updateUIForDefaultProperties(this),Tt.#n=this.createDrawerInstance(a,l,p,m,f),Tt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Tt.#a.toSVGProperties(),Tt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Tt.#c=-1,!Tt.#n)return;const{offsetX:e,offsetY:i,pointerId:n}=t;if(Tt.#s===n){if(Tt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Tt.#n.add(e,i)),Tt.#c=t.timeStamp,Te(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Tt.#n=null,Tt.#a=null,Tt.#r=null,Tt.#c=NaN),Tt.#i&&(Tt.#i.abort(),Tt.#i=null,Tt.#s=NaN,Tt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Tt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Tt.#n,n=this._currentDrawId,r=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,i.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(n,i.removeLastElement())},mustExec:!1,type:Wt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Wt.DRAW_STEP),!Tt.#n.isEmpty()){const{pageDimensions:[i,n],scale:r}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Tt.#n.getOutlines(i*r,n*r,r,this._INNER_MARGIN),drawingOptions:Tt.#a,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,n,r,a){ue("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:l}}=e.viewport,c=this.deserializeDraw(a,l,n,r,this._INNER_MARGIN,t),u=await super.deserialize(t,e,i);return u.createDrawingOptions(t),u.#l({drawOutlines:c}),u.#f(),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[e,i]=this.pageTranslation,[n,r]=this.pageDimensions;return this.#t.serialize([e,i,n,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class wR{#t=new Float64Array(6);#e;#n;#i;#a;#s;#r="";#o=0;#c=new ul;#l;#d;constructor(t,e,i,n,r,a){this.#l=i,this.#d=n,this.#i=r,this.#a=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:l,points:this.#s}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#u(t,e){return pt._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,n,r,a]=this.#t.subarray(2,6),l=t-r,c=e-a;return Math.hypot(this.#l*l,this.#d*c)<=2?null:(this.#s.push(t,e),isNaN(i)?(this.#t.set([r,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,n,r,a,t,e],0),this.#e.push(...pt.createBezierPoints(i,n,r,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,n,r){this.#l=i,this.#d=n,this.#i=r,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#s}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#r="";for(let t=0,e=this.#n.length;t<e;t++){const{line:i,points:n}=this.#n[t];this.#e=i,this.#s=n,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=pt.svgRound(this.#e[4]),e=pt.svgRound(this.#e[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#s.length<=6){const n=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,n)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const n=pt.svgRound(this.#e[10]),r=pt.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${n} ${r}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let n=this.#o,r=this.#e.length;n<r;n+=6){const[a,l,c,u,f,p]=this.#e.slice(n,n+6).map(pt.svgRound);i.push(`C${a} ${l} ${c} ${u} ${f} ${p}`)}return this.#r+=i.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,i,n){const r=this.#n.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#c.build(this.#n,t,e,i,this.#i,this.#a,n),this.#t=null,this.#e=null,this.#n=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class ul extends pt{#t;#e=0;#n;#i;#a;#s;#r;#o;#c;build(t,e,i,n,r,a,l){this.#a=e,this.#s=i,this.#r=n,this.#o=r,this.#c=a,this.#n=l??0,this.#i=t,this.#u()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${pt.svgRound(e[4])} ${pt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${pt.svgRound(e[10])} ${pt.svgRound(e[11])}`);continue}for(let i=6,n=e.length;i<n;i+=6){const[r,a,l,c,u,f]=e.subarray(i,i+6).map(pt.svgRound);t.push(`C${r} ${a} ${l} ${c} ${u} ${f}`)}}return t.join("")}serialize([t,e,i,n],r){const a=[],l=[],[c,u,f,p]=this.#d();let m,v,S,b,w,E,C,T,_;switch(this.#o){case 0:_=pt._rescale,m=t,v=e+n,S=i,b=-n,w=t+c*i,E=e+(1-u-p)*n,C=t+(c+f)*i,T=e+(1-u)*n;break;case 90:_=pt._rescaleAndSwap,m=t,v=e,S=i,b=n,w=t+u*i,E=e+c*n,C=t+(u+p)*i,T=e+(c+f)*n;break;case 180:_=pt._rescale,m=t+i,v=e,S=-i,b=n,w=t+(1-c-f)*i,E=e+u*n,C=t+(1-c)*i,T=e+(u+p)*n;break;case 270:_=pt._rescaleAndSwap,m=t+i,v=e+n,S=-i,b=-n,w=t+(1-u-p)*i,E=e+(1-c-f)*n,C=t+(1-u)*i,T=e+(1-c)*n;break}for(const{line:R,points:D}of this.#i)a.push(_(R,m,v,S,b,r?new Array(R.length):null)),l.push(_(D,m,v,S,b,r?new Array(D.length):null));return{lines:a,points:l,rect:[w,E,C,T]}}static deserialize(t,e,i,n,r,{paths:{lines:a,points:l},rotation:c,thickness:u}){const f=[];let p,m,v,S,b;switch(c){case 0:b=pt._rescale,p=-t/i,m=e/n+1,v=1/i,S=-1/n;break;case 90:b=pt._rescaleAndSwap,p=-e/n,m=-t/i,v=1/n,S=1/i;break;case 180:b=pt._rescale,p=t/i+1,m=-e/n,v=-1/i,S=1/n;break;case 270:b=pt._rescaleAndSwap,p=e/n+1,m=t/i+1,v=-1/n,S=-1/i;break}if(!a){a=[];for(const E of l){const C=E.length;if(C===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(C===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(C-2));a.push(T);let[_,R,D,M]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,_,R],0);for(let L=4;L<C;L+=2){const P=E[L],B=E[L+1];T.set(pt.createBezierPoints(_,R,D,M,P,B),(L-2)*3),[_,R,D,M]=[D,M,P,B]}}}for(let E=0,C=a.length;E<C;E++)f.push({line:b(a[E].map(T=>T??NaN),p,m,v,S),points:b(l[E].map(T=>T??NaN),p,m,v,S)});const w=new this.prototype.constructor;return w.build(f,i,n,1,c,u,r),w}#l(t=this.#c){const e=this.#n+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#s]:[e/this.#s,e/this.#a]}#d(){const[t,e,i,n]=this.#t,[r,a]=this.#l(0);return[t+r,e+a,i-2*r,n-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#i){if(n.length<=12){for(let l=4,c=n.length;l<c;l+=6)mt.pointBoundingBox(n[l],n[l+1],t);continue}let r=n[4],a=n[5];for(let l=6,c=n.length;l<c;l+=6){const[u,f,p,m,v,S]=n.subarray(l,l+6);mt.bezierBoundingBox(r,a,u,f,p,m,v,S,t),r=v,a=S}}const[e,i]=this.#l();t[0]=pi(t[0]-e,0,1),t[1]=pi(t[1]-i,0,1),t[2]=pi(t[2]+e,0,1),t[3]=pi(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[n,r]=this.#l(),[a,l]=[n-e,r-i],c=this.#t;return c[0]-=a,c[1]-=l,c[2]+=2*a,c[3]+=2*l,c}updateParentDimensions([t,e],i){const[n,r]=this.#l();this.#a=t,this.#s=e,this.#r=i;const[a,l]=this.#l(),c=a-n,u=l-r,f=this.#t;return f[0]-=c,f[1]-=u,f[2]+=2*c,f[3]+=2*u,f}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(pt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,n=0,r=0,a=0,l=0,c=0;switch(this.#e){case 90:n=e/t,r=-t/e,l=t;break;case 180:i=-1,a=-1,l=t,c=e;break;case 270:n=-e/t,r=t/e,c=e;break;default:return""}return`matrix(${i} ${n} ${r} ${a} ${pt.svgRound(l)} ${pt.svgRound(c)})`}getPathResizingSVGProperties([t,e,i,n]){const[r,a]=this.#l(),[l,c,u,f]=this.#t;if(Math.abs(u-r)<=pt.PRECISION||Math.abs(f-a)<=pt.PRECISION){const b=t+i/2-(l+u/2),w=e+n/2-(c+f/2);return{path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${b} ${w})`}}}const p=(i-2*r)/(u-2*r),m=(n-2*a)/(f-2*a),v=u/i,S=f/n;return{path:{"transform-origin":`${pt.svgRound(l)} ${pt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${v} ${S}) translate(${pt.svgRound(r)} ${pt.svgRound(a)}) scale(${p} ${m}) translate(${pt.svgRound(-r)} ${pt.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,i,n]){const[r,a]=this.#l(),l=this.#t,[c,u,f,p]=l;if(l[0]=t,l[1]=e,l[2]=i,l[3]=n,Math.abs(f-r)<=pt.PRECISION||Math.abs(p-a)<=pt.PRECISION){const w=t+i/2-(c+f/2),E=e+n/2-(u+p/2);for(const{line:C,points:T}of this.#i)pt._translate(C,w,E,C),pt._translate(T,w,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*r)/(f-2*r),v=(n-2*a)/(p-2*a),S=-m*(c+r)+t+r,b=-v*(u+a)+e+a;if(m!==1||v!==1||S!==0||b!==0)for(const{line:w,points:E}of this.#i)pt._rescale(w,S,b,m,v,w),pt._rescale(E,S,b,m,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[n,r]=i,a=this.#t,l=t-a[0],c=e-a[1];if(this.#a===n&&this.#s===r)for(const{line:u,points:f}of this.#i)pt._translate(u,l,c,u),pt._translate(f,l,c,f);else{const u=this.#a/n,f=this.#s/r;this.#a=n,this.#s=r;for(const{line:p,points:m}of this.#i)pt._rescale(p,l,c,u,f,p),pt._rescale(m,l,c,u,f,m);a[2]*=u,a[3]*=f}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t[0])} ${pt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class _h extends qA{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Et._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new _h(this._viewParameters);return t.updateAll(this),t}}class Rp extends Tt{static _type="ink";static _editorType=Lt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Et.initialize(t,e),this._defaultDrawingOptions=new _h(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ut(this,"typesMap",new Map([[Wt.INK_THICKNESS,"stroke-width"],[Wt.INK_COLOR,"stroke"],[Wt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,n,r){return new wR(t,e,i,n,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,n,r,a){return ul.deserialize(t,e,i,n,r,a)}static async deserialize(t,e,i){let n=null;if(t instanceof Cp){const{data:{inkLists:a,rect:l,rotation:c,id:u,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:v,richText:S,contentsObj:b,creationDate:w,modificationDate:E},parent:{page:{pageNumber:C}}}=t;n=t={annotationType:Lt.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:C-1,rect:l.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:v,richText:S,comment:b?.str||null,creationDate:w,modificationDate:E}}const r=await super.deserialize(t,e,i);return r._initialData=n,t.comment&&r.setCommentData(t),r}get toolbarButtons(){return this._colorPicker||=new Qo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Wt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Rp.getDefaultDrawingOptions({stroke:mt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:n,"stroke-opacity":r,"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{color:Et._colorManager.convert(n),opacity:r,thickness:a,paths:{lines:e,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!this.#t(l)?null:(l.id=this.annotationElementId,l)}#t(t){const{color:e,thickness:i,opacity:n,pageIndex:r}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==e[l])||t.thickness!==i||t.opacity!==n||t.pageIndex!==r}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Kf extends ul{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Wc=8,Oo=3;class ua{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,n){return i-=t,n-=e,i===0?n>0?0:4:i===1?n+6:2-n}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,n,r,a,l){const c=this.#e(i,n,r,a);for(let u=0;u<8;u++){const f=(-u+c-l+16)%8,p=this.#n[2*f],m=this.#n[2*f+1];if(t[(i+p)*e+(n+m)]!==0)return f}return-1}static#a(t,e,i,n,r,a,l){const c=this.#e(i,n,r,a);for(let u=0;u<8;u++){const f=(u+c+l+16)%8,p=this.#n[2*f],m=this.#n[2*f+1];if(t[(i+p)*e+(n+m)]!==0)return f}return-1}static#s(t,e,i,n){const r=t.length,a=new Int32Array(r);for(let f=0;f<r;f++)a[f]=t[f]<=n?1:0;for(let f=1;f<i-1;f++)a[f*e]=a[f*e+e-1]=0;for(let f=0;f<e;f++)a[f]=a[e*i-1-f]=0;let l=1,c;const u=[];for(let f=1;f<i-1;f++){c=1;for(let p=1;p<e-1;p++){const m=f*e+p,v=a[m];if(v===0)continue;let S=f,b=p;if(v===1&&a[m-1]===0)l+=1,b-=1;else if(v>=1&&a[m+1]===0)l+=1,b+=1,v>1&&(c=v);else{v!==1&&(c=Math.abs(v));continue}const w=[p,f],E=b===p+1,C={isHole:E,points:w,id:l,parent:0};u.push(C);let T;for(const U of u)if(U.id===c){T=U;break}T?T.isHole?C.parent=E?T.parent:c:C.parent=E?c:T.parent:C.parent=E?c:0;const _=this.#i(a,e,f,p,S,b,0);if(_===-1){a[m]=-l,a[m]!==1&&(c=Math.abs(a[m]));continue}let R=this.#n[2*_],D=this.#n[2*_+1];const M=f+R,L=p+D;S=M,b=L;let P=f,B=p;for(;;){const U=this.#a(a,e,P,B,S,b,1);R=this.#n[2*U],D=this.#n[2*U+1];const Z=P+R,q=B+D;w.push(q,Z);const Q=P*e+B;if(a[Q+1]===0?a[Q]=-l:a[Q]===1&&(a[Q]=l),Z===f&&q===p&&P===M&&B===L){a[m]!==1&&(c=Math.abs(a[m]));break}else S=P,b=B,P=Z,B=q}}}return u}static#r(t,e,i,n){if(i-e<=4){for(let M=e;M<i-2;M+=2)n.push(t[M],t[M+1]);return}const r=t[e],a=t[e+1],l=t[i-4]-r,c=t[i-3]-a,u=Math.hypot(l,c),f=l/u,p=c/u,m=f*a-p*r,v=c/l,S=1/u,b=Math.atan(v),w=Math.cos(b),E=Math.sin(b),C=S*(Math.abs(w)+Math.abs(E)),T=S*(1-C+C**2),_=Math.max(Math.atan(Math.abs(E+w)*T),Math.atan(Math.abs(E-w)*T));let R=0,D=e;for(let M=e+2;M<i-2;M+=2){const L=Math.abs(m-f*t[M+1]+p*t[M]);L>R&&(D=M,R=L)}R>(u*_)**2?(this.#r(t,e,D+2,n),this.#r(t,D,i,n)):n.push(r,a)}static#o(t){const e=[],i=t.length;return this.#r(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,n,r,a){const l=new Float32Array(a**2),c=-2*n**2,u=a>>1;for(let b=0;b<a;b++){const w=(b-u)**2;for(let E=0;E<a;E++)l[b*a+E]=Math.exp((w+(E-u)**2)/c)}const f=new Float32Array(256),p=-2*r**2;for(let b=0;b<256;b++)f[b]=Math.exp(b**2/p);const m=t.length,v=new Uint8Array(m),S=new Uint32Array(256);for(let b=0;b<i;b++)for(let w=0;w<e;w++){const E=b*e+w,C=t[E];let T=0,_=0;for(let D=0;D<a;D++){const M=b+D-u;if(!(M<0||M>=i))for(let L=0;L<a;L++){const P=w+L-u;if(P<0||P>=e)continue;const B=t[M*e+P],U=l[D*a+L]*f[Math.abs(B-C)];T+=B*U,_+=U}}const R=v[E]=Math.round(T/_);S[R]++}return[v,S]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let n=-1/0,r=1/0;for(let l=0,c=i.length;l<c;l++){const u=i[l]=t[l<<2];n=Math.max(n,u),r=Math.min(r,u)}const a=255/(n-r);for(let l=0,c=i.length;l<c;l++)i[l]=(i[l]-r)*a;return i}static#u(t){let e,i=-1/0,n=-1/0;const r=t.findIndex(c=>c!==0);let a=r,l=r;for(e=r;e<256;e++){const c=t[e];c>i&&(e-a>n&&(n=e-a,l=e-1),i=c,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:n}=t,{maxDim:r}=this.#t;let a=i,l=n;if(i>r||n>r){let m=i,v=n,S=Math.log2(Math.max(i,n)/r);const b=Math.floor(S);S=S===b?b-1:b;for(let E=0;E<S;E++){a=Math.ceil(m/2),l=Math.ceil(v/2);const C=new OffscreenCanvas(a,l);C.getContext("2d").drawImage(t,0,0,m,v,0,0,a,l),m=a,v=l,t!==e&&t.close(),t=C.transferToImageBitmap()}const w=Math.min(r/a,r/l);a=Math.round(a*w),l=Math.round(l*w)}const u=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,l),u.filter="grayscale(1)",u.drawImage(t,0,0,t.width,t.height,0,0,a,l);const f=u.getImageData(0,0,a,l).data;return[this.#d(f),a,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:n},r,a,l,c){let u=new OffscreenCanvas(1,1),f=u.getContext("2d",{alpha:!1});const p=200,m=f.font=`${i} ${n} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:S,actualBoundingBoxAscent:b,actualBoundingBoxDescent:w,fontBoundingBoxAscent:E,fontBoundingBoxDescent:C,width:T}=f.measureText(t),_=1.5,R=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||0,T)*_),D=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||p,Math.abs(E)+Math.abs(C)||p)*_);u=new OffscreenCanvas(R,D),f=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=m,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,R,D),f.fillStyle="black",f.fillText(t,R*(_-1)/2,D*(3-_)/2);const M=this.#d(f.getImageData(0,0,R,D).data),L=this.#l(M),P=this.#u(L),B=this.#s(M,R,D,P);return this.processDrawnLines({lines:{curves:B,width:R,height:D},pageWidth:r,pageHeight:a,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(t,e,i,n,r){const[a,l,c]=this.#f(t),[u,f]=this.#c(a,l,c,Math.hypot(l,c)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(f),m=this.#s(u,l,c,p);return this.processDrawnLines({lines:{curves:m,width:l,height:c},pageWidth:e,pageHeight:i,rotation:n,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:r,mustSmooth:a,areContours:l}){n%180!==0&&([e,i]=[i,e]);const{curves:c,width:u,height:f}=t,p=t.thickness??0,m=[],v=Math.min(e/u,i/f),S=v/e,b=v/i,w=[];for(const{points:C}of c){const T=a?this.#o(C):C;if(!T)continue;w.push(T);const _=T.length,R=new Float32Array(_),D=new Float32Array(3*(_===2?2:_-2));if(m.push({line:D,points:R}),_===2){R[0]=T[0]*S,R[1]=T[1]*b,D.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[M,L,P,B]=T;M*=S,L*=b,P*=S,B*=b,R.set([M,L,P,B],0),D.set([NaN,NaN,NaN,NaN,M,L],0);for(let U=4;U<_;U+=2){const Z=R[U]=T[U]*S,q=R[U+1]=T[U+1]*b;D.set(pt.createBezierPoints(M,L,P,B,Z,q),(U-2)*3),[M,L,P,B]=[P,B,Z,q]}}if(m.length===0)return null;const E=l?new Kf:new ul;return E.build(m,e,i,1,n,l?0:p,r),{outline:E,newCurves:w,areContours:l,thickness:p,width:u,height:f}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:n,height:r}){let a=1/0,l=-1/0,c=0;for(const T of t){c+=T.length;for(let _=2,R=T.length;_<R;_++){const D=T[_]-T[_-2];a=Math.min(a,D),l=Math.max(l,D)}}let u;a>=-128&&l<=127?u=Int8Array:a>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const f=t.length,p=Wc+Oo*f,m=new Uint32Array(p);let v=0;m[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(c-2*f)*u.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=n,m[v++]=r,m[v++]=e?0:1,m[v++]=Math.max(0,Math.floor(i??0)),m[v++]=f,m[v++]=u.BYTES_PER_ELEMENT;for(const T of t)m[v++]=T.length-2,m[v++]=T[0],m[v++]=T[1];const S=new CompressionStream("deflate-raw"),b=S.writable.getWriter();await b.ready,b.write(m);const w=u.prototype.constructor;for(const T of t){const _=new w(T.length-2);for(let R=2,D=T.length;R<D;R++)_[R-2]=T[R]-T[R-2];b.write(_)}b.close();const E=await new Response(S.readable).arrayBuffer(),C=new Uint8Array(E);return wA(C)}static async decompressSignature(t){try{const e=BC(t),{readable:i,writable:n}=new DecompressionStream("deflate-raw"),r=n.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,l=0;for await(const T of i)a||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),a.set(T,l),l+=T.length;const c=new Uint32Array(a.buffer,0,a.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const f=c[2],p=c[3],m=c[4]===0,v=c[5],S=c[6],b=c[7],w=[],E=(Wc+Oo*S)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(b){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(a.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(a.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(a.buffer,E);break}l=0;for(let T=0;T<S;T++){const _=c[Oo*T+Wc],R=new Float32Array(_+2);w.push(R);for(let D=0;D<Oo-1;D++)R[D]=c[Oo*T+Wc+D+1];for(let D=0;D<_;D++)R[D+2]=R[D]+C[l++]}return{areContours:m,thickness:v,outlines:w,width:f,height:p}}catch(e){return xt(`decompressSignature: ${e}`),null}}}class _p extends qA{constructor(){super(),super.updateProperties({fill:Et._defaultLineColor,"stroke-width":0})}clone(){const t=new _p;return t.updateAll(this),t}}class Dp extends _h{constructor(t){super(t),super.updateProperties({stroke:Et._defaultLineColor,"stroke-width":1})}clone(){const t=new Dp(this._viewParameters);return t.updateAll(this),t}}class Cn extends Tt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=Lt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Et.initialize(t,e),this._defaultDrawingOptions=new _p,this._defaultDrawnSignatureOptions=new Dp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ut(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:n,mustSmooth:r,areContours:a,description:l,uuid:c,heightInPage:u}=this.#n,{rawDims:{pageWidth:f,pageHeight:p},rotation:m}=this.parent.viewport,v=ua.processDrawnLines({lines:n,pageWidth:f,pageHeight:p,rotation:m,innerMargin:Cn._INNER_MARGIN,mustSmooth:r,areContours:a});this.addSignature(v,u,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:n,height:r}=this.#n,a=Math.max(n,r),l=ua.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:i,width:n,height:r},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,n){const{x:r,y:a}=this,{outline:l}=this.#n=t;this.#t=l instanceof Kf,this.description=i;let c;this.#t?c=Cn.getDefaultDrawingOptions():(c=Cn._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[,u]=this.pageDimensions;let f=e/u;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=r,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(n),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!n,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return ua.process(t,e,i,n,Cn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:r}=this.parent.viewport;return ua.extractContoursFromText(t,e,i,n,r,Cn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:n}=this.parent.viewport;return ua.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:Cn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Cn.getDefaultDrawingOptions():(this._drawingOptions=Cn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":n}}=this,r=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:n});return this.addComment(r),t?(r.paths={lines:e,points:i},r.uuid=this.#i,r.isCopy=!0):r.lines=e,this.#e&&(r.accessibilityData={type:"Figure",alt:this.#e}),r}static deserializeDraw(t,e,i,n,r,a){return a.areContours?Kf.deserialize(t,e,i,n,r,a):ul.deserialize(t,e,i,n,r,a)}static async deserialize(t,e,i){const n=await super.deserialize(t,e,i);return n.#t=t.areContours,n.description=t.accessibilityData?.alt||"",n.#i=t.uuid,n}}class TR extends Et{#t=null;#e=null;#n=null;#i=null;#a=null;#s="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Lt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Et.initialize(t,e)}static isHandlingMimeForPasting(t){return Hf.includes(t)}static paste(t,e){e.pasteEditor({mode:Lt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#s=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:r,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:n,width:r,height:a,channels:n.length/(r*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),e&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#f());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(n=>this.#u(n)).finally(()=>this.#f());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(n=>this.#u(n)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Hf.join(",");const e=this._uiManager._signal;this.#n=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(n)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:n}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,n&&(this.#t=n),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[n,r]=this.pageDimensions,a=.75;if(this.width)e=this.width*n,i=this.height*r;else if(e>a*n||i>a*r){const c=Math.min(a*n/e,a*r/i);e*=c,i*=c}this._uiManager.enableWaiting(!1);const l=this.#r=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=e/n,this.height=i/r,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:n,height:r}=this.#t,a=new _n;let l=this.#t,c=n,u=r,f=null;if(e){if(n>e||r>e){const D=Math.min(e/n,e/r);c=Math.floor(n*D),u=Math.floor(r*D)}f=document.createElement("canvas");const m=f.width=Math.ceil(c*a.sx),v=f.height=Math.ceil(u*a.sy);this.#l||(l=this.#h(m,v));const S=f.getContext("2d");S.filter=this._uiManager.hcmFilter;let b="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":GC.isDarkMode&&(b="#8f8f9d",w="#42414d");const E=15,C=E*a.sx,T=E*a.sy,_=new OffscreenCanvas(C*2,T*2),R=_.getContext("2d");R.fillStyle=b,R.fillRect(0,0,C*2,T*2),R.fillStyle=w,R.fillRect(0,0,C,T),R.fillRect(C,T,C,T),S.fillStyle=S.createPattern(_,"repeat"),S.fillRect(0,0,m,v),S.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let p=null;if(i){let m,v;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,v=l.height;else if(l=this.#t,n>t||r>t){const w=Math.min(t/n,t/r);m=Math.floor(n*w),v=Math.floor(r*w),this.#l||(l=this.#h(m,v))}const b=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});b.drawImage(l,0,0,l.width,l.height,0,0,m,v),p={width:m,height:v,data:b.getImageData(0,0,m,v).data}}return{canvas:f,width:c,height:u,imageData:p}}#h(t,e){const{width:i,height:n}=this.#t;let r=i,a=n,l=this.#t;for(;r>2*t||a>2*e;){const c=r,u=a;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const f=new OffscreenCanvas(r,a);f.getContext("2d").drawImage(l,0,0,c,u,0,0,r,a),l=f.transferToImageBitmap()}return l}#g(){const[t,e]=this.parentDimensions,{width:i,height:n}=this,r=new _n,a=Math.ceil(i*t*r.sx),l=Math.ceil(n*e*r.sy),c=this.#r;if(!c||c.width===a&&c.height===l)return;c.width=a,c.height=l;const u=this.#l?this.#t:this.#h(a,l),f=c.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(u,0,0,u.width,u.height,0,0,a,l)}#v(t){if(t){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#e);if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,n=Math.round(this.width*e*Ca.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*Ca.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let n=null,r=!1;if(t instanceof WA){const{data:{rect:b,rotation:w,id:E,structParent:C,popupRef:T,richText:_,contentsObj:R,creationDate:D,modificationDate:M},container:L,parent:{page:{pageNumber:P}},canvas:B}=t;let U,Z;B?(delete t.canvas,{id:U,bitmap:Z}=i.imageManager.getFromCanvas(L.id,B),B.remove()):(r=!0,t._hasNoCanvas=!0);const q=(await e._structTree.getAriaAttributes(`${pp}${E}`))?.get("aria-label")||"";n=t={annotationType:Lt.STAMP,bitmapId:U,bitmap:Z,pageIndex:P-1,rect:b.slice(0),rotation:w,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:q},isSvg:!1,structParent:C,popupRef:T,richText:_,comment:R?.str||null,creationDate:D,modificationDate:M}}const a=await super.deserialize(t,e,i),{rect:l,bitmap:c,bitmapUrl:u,bitmapId:f,isSvg:p,accessibilityData:m}=t;r?(i.addMissingCanvas(t.id,a),a.#o=!0):f&&i.imageManager.isValidId(f)?(a.#e=f,c&&(a.#t=c)):a.#i=u,a.#l=p;const[v,S]=a.pageDimensions;return a.width=(l[2]-l[0])/v,a.height=(l[3]-l[1])/S,m&&(a.altTextData=m),a._initialData=n,t.comment&&a.setCommentData(t),a.#d=!!n,a}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:n,altText:r}=this.serializeAltText(!1);if(!n&&r&&(i.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const l=this.#b(i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const a=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#v(!1);else if(this.#l){const l=e.stamps.get(this.#e);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return i}#b(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,n=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&n&&r,isSameAltText:r}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class qn{#t;#e=!1;#n=null;#i=null;#a=null;#s=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#u=null;#f=null;#m=null;#p=-1;#h;static _initialized=!1;static#g=new Map([Ge,Rp,TR,_e,Cn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:l,textLayer:c,viewport:u,l10n:f}){const p=[...qn.#g.values()];if(!qn._initialized){qn._initialized=!0;for(const m of p)m.initialize(f,t)}t.registerEditorTypes(p),this.#h=t,this.pageIndex=e,this.div=i,this.#t=r,this.#n=a,this.viewport=u,this.#u=c,this.drawLayer=l,this._structTree=n,this.#h.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===Lt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#A(),t){case Lt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Lt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Lt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===Lt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of qn.#g.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}get#v(){return this.#s.size!==0?this.#s.values():this.#h.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#v)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#n;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const n=await this.deserialize(i);n&&(this.addOrRebuild(n),n.enableEditing())}this.#c=!1,this.#h._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const i=this.#h.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",n=>{const{clientX:a,clientY:l,timeStamp:c}=n,u=this.#p;if(c-u>500){this.#p=c;return}this.#p=-1;const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(a,l);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let m;const v=new RegExp(`^${Yo}[0-9]+$`);for(const b of p)if(v.test(b.id)){m=b.id;break}if(!m)return;const S=this.#s.get(m);S?.annotationElementId===null&&(n.stopPropagation(),n.preventDefault(),S.dblclick(n))},{signal:i,capture:!0})}const t=this.#n;if(t){const i=new Map,n=new Map;for(const a of this.#v){if(a.disableEditing(),!a.annotationElementId){a.updateFakeAnnotationElement(t);continue}if(a.serialize()!==null){i.set(a.annotationElementId,a);continue}else n.set(a.annotationElementId,a);this.getEditableAnnotation(a.annotationElementId)?.show(),a.remove()}const r=t.getEditableAnnotations();for(const a of r){const{id:l}=a.data;if(this.#h.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let c=n.get(l);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=i.get(l),c&&(this.#h.addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const i of qn.#g.values())e.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=ni.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),_e.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),Et.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#s.values())if(e.uid===t)return e;return null}getNextId(){return this.#h.getId()}get#y(){return qn.#g.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#C(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:n}=this.#w(),r=this.getNextId(),a=this.#C({parent:this,id:r,x:i,y:n,uiManager:this.#h,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await qn.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),r=this.#C({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:e,width:i,height:n}=this.boundingClientRect,r=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+i),c=Math.min(window.innerHeight,e+n),u=(r+l)/2-t,f=(a+c)/2-e,[p,m]=this.viewport.rotation%180===0?[u,f]:[f,u];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=ni.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===Lt.STAMP||i===Lt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===Lt.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=ni.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#h.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#h.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,i){const n=this.#h.findParent(e,i);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#h.removeLayer(this)}#A(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,pr(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#A();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,pr(this.div,{rotation:i}),e!==i)for(const n of this.#s.values())n.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class ti{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ut(this,"_svgFactory",new hh)}static#a(t,[e,i,n,r]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*r}%`}#s(){const t=ti._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const i=ti._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const r=ti._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),n}#o(t,e){for(const[i,n]of Object.entries(e))n===null?t.removeAttribute(i):t.setAttribute(i,n)}draw(t,e=!1,i=!1){const n=ti.#i++,r=this.#s(),a=ti._svgFactory.createElement("defs");r.append(a);const l=ti._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(n,l);const u=i?this.#r(a,c):null,f=ti._svgFactory.createElement("use");return r.append(f),f.setAttribute("href",`#${c}`),this.updateProperties(r,t),this.#e.set(n,r),{id:n,clipPathId:`url(#${u})`}}drawOutline(t,e){const i=ti.#i++,n=this.#s(),r=ti._svgFactory.createElement("defs");n.append(r);const a=ti._svgFactory.createElement("path");r.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const p=ti._svgFactory.createElement("mask");r.append(p),c=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",c),p.setAttribute("maskUnits","objectBoundingBox");const m=ti._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=ti._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const u=ti._svgFactory.createElement("use");n.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const f=u.cloneNode();return n.append(f),u.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(n,t),this.#e.set(i,n),i}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:n,rootClass:r,path:a}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(i&&this.#o(l,i),n&&ti.#a(l,n),r){const{classList:c}=l;for(const[u,f]of Object.entries(r))c.toggle(u,f)}if(a){const u=l.firstChild.firstChild;this.#o(u,a)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Yf};globalThis.pdfjsLib={AbortException:Ns,AnnotationEditorLayer:qn,AnnotationEditorParamsType:Wt,AnnotationEditorType:Lt,AnnotationEditorUIManager:Is,AnnotationLayer:xp,AnnotationMode:_s,AnnotationType:ke,applyOpacity:XC,build:tR,ColorPicker:an,createValidAbsoluteUrl:bA,CSSConstants:VC,DOMSVGFactory:hh,DrawLayer:ti,FeatureTest:ni,fetchData:al,findContrastColor:YC,getDocument:Wx,getFilenameFromUrl:UC,getPdfFilenameFromUrl:HC,getRGB:ll,getUuid:EA,getXfaPageViewport:jC,GlobalWorkerOptions:jo,ImageKind:eh,InvalidPDFException:Bf,isDataScheme:Ch,isPdfFile:mp,isValidExplicitDest:nx,MathClamp:pi,noContextMenu:on,normalizeUnicode:kC,OPS:Wo,OutputScale:_n,PasswordResponses:RC,PDFDataRangeTransport:zA,PDFDateString:Uf,PDFWorker:qo,PermissionFlag:xC,PixelsPerInch:Ca,RenderingCancelledException:gp,renderRichText:CA,ResponseException:lh,setLayerDimensions:pr,shadow:Ut,SignatureExtractor:ua,stopEvent:Te,SupportedImageMimeTypes:Hf,TextLayer:ui,TouchManager:xh,updateUrlHash:AA,Util:mt,VerbosityLevel:Eh,version:Jx,XfaLayer:TA};function CR(d,t=1.5){return d.getViewport({scale:t})}async function bf(d,t,e,i=1.5){try{const n=CR(d,i),a=(await d.getTextContent()).items||[],l=e.getBoundingClientRect(),c=e.querySelector("canvas"),u=c?c.getBoundingClientRect():l,f=u.left-l.left,p=u.top-l.top,m=u.width/n.width,v=u.height/n.height,S=(t||"").toLowerCase().trim();if(!S)return[];const b=xR(a,t),w=[];for(const E of b)if(E.matchedItems.length>0){const C=a[E.matchedItems[0].itemIndex],T=a[E.matchedItems.at(-1).itemIndex],_=Af(C,n),R=Af(T,n),D=Math.min(_.x,R.x),M=Math.max(_.x+_.width,R.x+R.width),L=Math.min(_.y-_.height,R.y-R.height),P=Math.max(_.y,R.y);w.push({x:f+D*m,y:p+L*v,width:(M-D)*m,height:(P-L)*v,str:t})}if(w.length===0)for(const E of a){const C=(E.str||"").toLowerCase();if(C&&C.includes(S)){const T=Af(E,n),_=T.y-T.height;w.push({x:f+T.x*m,y:p+_*v,width:T.width*m,height:T.height*v,str:E.str})}}return w}catch(n){return console.error("Error computing bounding boxes:",n),[]}}function xR(d,t){const e=t.toLowerCase().trim(),i=[],r=d.map(c=>c.str).join("").toLowerCase();let a=0,l=r.indexOf(e,a);for(;l!==-1;){const c=l+e.length,u=[];let f=0;for(let p=0;p<d.length;p++){const m=d[p],v=f,S=f+m.str.length;if(v<c&&S>l){const b=Math.max(l,v),w=Math.min(c,S);u.push({itemIndex:p,text:m.str,overlapStart:b-v,overlapLength:w-b})}f=S}u.length>0&&i.push({startIndex:l,endIndex:c,matchedItems:u}),a=l+1,l=r.indexOf(e,a)}return i}function Af(d,t){const e=mt.transform(t.transform,d.transform),i=(d.width||d.fontSize||12)*t.scale,n=(d.height||d.fontSize||12)*t.scale,r=e[4],a=e[5];return{x:r,y:a,width:i,height:n}}function QA({pdf:d,pageNumber:t,scale:e=1.5,targetPhrase:i="gain on sale of non-current assets",shouldHighlight:n=!1,onRectsReady:r}){const a=ot.useRef(),l=ot.useRef(),[c,u]=ot.useState(null),[f,p]=ot.useState([]),[m,v]=ot.useState(!1);return ot.useEffect(()=>{let S=!0;return(async()=>{if(d)try{const w=await d.getPage(t);if(!S)return;if(u(w),n&&i){v(!0);const E=await bf(w,i,a.current,e);S&&(p(E),v(!1),r&&r(E))}else p([])}catch(w){console.error("Error loading page:",w),S&&v(!1)}})(),()=>{S=!1}},[d,t,e,n,i,r]),ot.useEffect(()=>{if(!c||!n||!i){p([]);return}(async()=>{v(!0);try{const b=await bf(c,i,a.current,e);p(b),r&&r(b)}catch(b){console.error("Error updating highlights:",b),p([])}finally{v(!1)}})()},[n,i,c,e,r]),ot.useEffect(()=>{if(!c||!n||!i)return;let S,b;const w=()=>{b||(b=requestAnimationFrame(async()=>{try{const R=await bf(c,i,a.current,e);p(R),r&&r(R)}catch(R){console.error("Error recomputing highlights:",R)}finally{b=null}}))},E=()=>{clearTimeout(S),S=setTimeout(w,100)},C=()=>{w()},T=new ResizeObserver(E);a.current&&T.observe(a.current);const _=a.current?.parentElement;return _&&_.addEventListener("scroll",C),()=>{clearTimeout(S),b&&cancelAnimationFrame(b),T.disconnect(),_&&_.removeEventListener("scroll",C)}},[c,n,i,e,r]),ct.jsxs("div",{ref:a,className:"pdf-page-container",style:{position:"relative"},children:[ct.jsx(wC,{pageNumber:t,scale:e,renderTextLayer:!1,renderAnnotationLayer:!1,loading:ct.jsxs("div",{className:"page-loading",children:["Loading page ",t,"..."]})}),ct.jsx("div",{ref:l,className:"textLayer",style:{position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none",visibility:"hidden"}}),n&&!m&&f.length>0&&ct.jsx(TC,{rects:f}),m&&ct.jsx("div",{className:"highlight-processing",children:"Finding highlights..."})]})}QA.propTypes={pdf:ze.object,pageNumber:ze.number.isRequired,scale:ze.number,targetPhrase:ze.string,shouldHighlight:ze.bool,onRectsReady:ze.func};function ZA({onDocumentLoadSuccess:d,onDocumentLoadError:t,shouldHighlight:e=!1,targetPhrase:i="gain on sale of non-current assets",pageNumber:n=1}){const[r,a]=ot.useState(null),[l,c]=ot.useState(null),[u,f]=ot.useState(n),[p,m]=ot.useState(n.toString()),[v,S]=ot.useState(!0);ot.useEffect(()=>{f(n),m(n.toString()),S(!0)},[n]);const b=ot.useCallback(L=>{const P=L?.numPages;a(P),c(L),d&&d({numPages:P})},[d]),w=ot.useCallback(L=>{console.error("Error loading PDF:",L),t&&t(L)},[t]),E=ot.useCallback(()=>{f(L=>Math.max(1,L-1))},[]),C=ot.useCallback(()=>{f(L=>Math.min(r||1,L+1))},[r]),T=ot.useCallback(L=>{const P=Number.parseInt(L)||0;return P>=1&&P<=(r||1)},[r]),_=ot.useCallback(L=>{const P=L.target.value;m(P),S(T(P))},[T]),R=ot.useCallback(()=>{if(v){const L=Number.parseInt(p)||1;M(L)}else m(u.toString()),S(!0)},[v,p,u]),D=ot.useCallback(L=>{L.key==="Enter"&&R()},[R]),M=ot.useCallback(L=>{L>=1&&L<=(r||1)&&f(L)},[r]);return ct.jsxs("div",{className:"pdf-viewer",children:[r&&ct.jsxs("div",{className:"pdf-navigation",children:[ct.jsx("button",{className:"nav-btn",onClick:E,disabled:u<=1,"aria-label":"Previous page",children:" Previous"}),ct.jsxs("div",{className:"page-input-container",children:[ct.jsx("input",{type:"number",min:"1",max:r,value:p,onChange:_,onBlur:R,onKeyDown:D,className:`page-input ${v?"":"invalid"}`,"aria-label":"Go to page"}),ct.jsxs("span",{className:"page-total",children:["of ",r]})]}),ct.jsx("button",{className:"nav-btn",onClick:C,disabled:u>=r,"aria-label":"Next page",children:"Next "})]}),ct.jsx(fC,{file:"/react-pdf-highlight/Maersk_Q2_2025_Interim_Report.pdf",onLoadSuccess:b,onLoadError:w,loading:ct.jsx("div",{className:"pdf-loading",children:"Loading PDF..."}),error:ct.jsx("div",{className:"pdf-error",children:"Error loading PDF. Please ensure the PDF file is placed in /public/Maersk_Q2_2025_Interim_Report.pdf"}),children:ct.jsx(QA,{pdf:l,pageNumber:u,scale:1.5,targetPhrase:i,shouldHighlight:e,onRectsReady:L=>{}})}),r&&ct.jsxs("div",{className:"pdf-info",children:["Page ",u," of ",r]})]})}ZA.propTypes={onDocumentLoadSuccess:ze.func,onDocumentLoadError:ze.func,shouldHighlight:ze.bool,targetPhrase:ze.string,pageNumber:ze.number};const er=({pageNumber:d,onPageClick:t})=>ct.jsxs("button",{className:"page-link",onClick:()=>t(d),"aria-label":`Go to page ${d}`,tabIndex:0,children:["Page ",d]});er.propTypes={pageNumber:ze.number.isRequired,onPageClick:ze.func.isRequired};const ir=({referenceNumber:d,onReferenceClick:t})=>ct.jsxs("button",{className:"reference-link",onClick:()=>t(d),"aria-label":`Highlight reference ${d}`,tabIndex:0,children:["[",d,"]"]});ir.propTypes={referenceNumber:ze.number.isRequired,onReferenceClick:ze.func.isRequired};function JA({onHighlightToggle:d,highlightActive:t,onReferenceClick:e,onPageNavigate:i}){const n=a=>{e?e(a):a===3&&d()},r=a=>{i&&i(a)};return ct.jsxs("div",{className:"analysis-panel","aria-label":"Analysis",children:[ct.jsx("h2",{children:"Analysis"}),ct.jsxs("div",{className:"analysis-content",children:[ct.jsx("p",{children:"No extraordinary or one-off items affecting EBITDA were reported in Maersk's Q2 2025 results. The report explicitly notes that EBITDA improvements stemmed from operational performance including volume growth, cost control, and margin improvement across Ocean, Logistics & Services, and Terminals segments [1][2]. Gains or losses from asset sales, which could qualify as extraordinary items, are shown separately under EBIT and not included in EBITDA. The gain on sale of non-current assets was USD 25 m in Q2 2025, significantly lower than USD 208 m in Q2 2024, but these affect EBIT, not EBITDA [3]. Hence, Q2 2025 EBITDA reflects core operating activities without one-off extraordinary adjustments."}),ct.jsx("h3",{children:"Findings"}),ct.jsxs("p",{children:[ct.jsx(er,{pageNumber:3,onPageClick:r}),"  Highlights Q2 2025",ct.jsx("br",{}),"EBITDA increase (USD 2.3 bn vs USD 2.1 bn prior year) attributed to operational improvements; no mention of extraordinary or one-off items."," ",ct.jsx(ir,{referenceNumber:1,onReferenceClick:n})]}),ct.jsxs("p",{children:[ct.jsx(er,{pageNumber:5,onPageClick:r}),"  Review Q2 2025",ct.jsx("br",{}),"EBITDA rise driven by higher revenue and cost control across all segments; no extraordinary gains or losses included."," ",ct.jsx(ir,{referenceNumber:2,onReferenceClick:n})]}),ct.jsxs("p",{children:[ct.jsx(er,{pageNumber:15,onPageClick:r}),"  Condensed Income Statement",ct.jsx("br",{}),"Gain on sale of non-current assets USD 25 m (vs USD 208 m prior year) reported separately below EBITDA; therefore, not part of EBITDA."," ",ct.jsx(ir,{referenceNumber:3,onReferenceClick:n})]}),ct.jsx("h3",{children:"Supporting Evidence"}),ct.jsxs("p",{children:[ct.jsx(ir,{referenceNumber:1,onReferenceClick:n})," A.P. Moller  Maersk Q2 2025 Interim Report (7 Aug 2025)  ",ct.jsx(er,{pageNumber:3,onPageClick:r}),`  "Maersk's results continued to improve year-on-year  EBITDA of USD 2.3 bn (USD 2.1 bn)  driven by volume and other revenue growth in Ocean, margin improvements in Logistics & Services and significant top line growth in Terminals."`]}),ct.jsxs("p",{children:[ct.jsx(ir,{referenceNumber:2,onReferenceClick:n})," A.P. Moller  Maersk Q2 2025 Interim Report (7 Aug 2025)  ",ct.jsx(er,{pageNumber:5,onPageClick:r}),`  "EBITDA increased to USD 2.3 bn (USD 2.1 bn)  driven by higher revenue and cost management  Ocean's EBITDA  slightly increased by USD 36 m  Logistics & Services contributed significantly with a USD 71 m increase  Terminals' EBITDA increased by USD 50 m."`]}),ct.jsxs("p",{children:[ct.jsx(ir,{referenceNumber:3,onReferenceClick:n})," A.P. Moller  Maersk Q2 2025 Interim Report (7 Aug 2025)  ",ct.jsx(er,{pageNumber:15,onPageClick:r}),'  "Gain on sale of non-current assets, etc., net 25 (208)  Profit before depreciation, amortisation and impairment losses, etc. (EBITDA) 2,298"']})]}),ct.jsx("div",{className:"analysis-controls",children:ct.jsx("button",{className:"clear-highlight-btn",onClick:d,disabled:!t,"aria-label":t?"Clear highlight":"No highlight to clear",children:t?"Clear Highlight":"No Highlight"})})]})}JA.propTypes={onHighlightToggle:ze.func,highlightActive:ze.bool,onReferenceClick:ze.func,onPageNavigate:ze.func};function RR(){const[d,t]=ot.useState(!1),[e,i]=ot.useState("gain on sale of non-current assets"),[n,r]=ot.useState(1),a=()=>{t(!d)},l=u=>{const p={1:{page:3,phrase:"Maersks results continued to improve year-on-year"},2:{page:5,phrase:"EBITDA increased to USD 2.3bn (USD 2.1bn)"},3:{page:15,phrase:"Gain on sale of non-current assets"}}[u];p&&(r(p.page),i(p.phrase),t(!0))},c=u=>{r(u),t(!1)};return ct.jsxs("div",{className:"app",children:[ct.jsx("div",{className:"pdf-panel",children:ct.jsx(ZA,{onDocumentLoadSuccess:u=>{},onDocumentLoadError:u=>console.error("PDF load error:",u),shouldHighlight:d,targetPhrase:e,pageNumber:n})}),ct.jsx(JA,{onHighlightToggle:a,highlightActive:d,onReferenceClick:l,onPageNavigate:c})]})}Os.workerPort=new RT;R1.createRoot(document.getElementById("root")).render(ct.jsx(ot.StrictMode,{children:ct.jsx(RR,{})}));
